[0m13:33:35.914113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D8C88D820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D86A7CE60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D8C19BFE0>]}


============================== 13:33:35.918112 | d5c37c8b-faec-495b-b364-f0e506db94c9 ==============================
[0m13:33:35.918112 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:33:35.919041 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:33:35.936038 [info ] [MainThread]: dbt version: 1.9.4
[0m13:33:35.936038 [info ] [MainThread]: python version: 3.12.2
[0m13:33:35.937038 [info ] [MainThread]: python path: C:\Users\JohanBroman\AppData\Local\Programs\Python\Python312\python.exe
[0m13:33:35.937038 [info ] [MainThread]: os info: Windows-11-10.0.22621-SP0
[0m13:33:38.092583 [debug] [MainThread]: Traceback (most recent call last):
  File "C:\Users\JohanBroman\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\adapters\factory.py", line 68, in load_plugin
    mod: Any = import_module("." + name, "dbt.adapters")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\AppData\Local\Programs\Python\Python312\Lib\importlib\__init__.py", line 90, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 995, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "C:\Users\JohanBroman\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\adapters\snowflake\__init__.py", line 5, in <module>
    from dbt.adapters.snowflake.impl import SnowflakeAdapter
  File "C:\Users\JohanBroman\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\adapters\snowflake\impl.py", line 8, in <module>
    from dbt.adapters.catalogs import CatalogRelation, CatalogIntegration, CatalogIntegrationConfig
ModuleNotFoundError: No module named 'dbt.adapters.catalogs'

[0m13:33:38.093573 [error] [MainThread]: Encountered an error:
No module named 'dbt.adapters.catalogs'
[0m13:33:38.095517 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\JohanBroman\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\main.py", line 414, in debug
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\JohanBroman\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\task\debug.py", line 114, in run
    load_profile_status: SubtaskStatus = self._load_profile()
                                         ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\task\debug.py", line 205, in _load_profile
    profile: Profile = Profile.render(
                       ^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\config\profile.py", line 402, in render
    return cls.from_raw_profiles(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\config\profile.py", line 368, in from_raw_profiles
    return cls.from_raw_profile_info(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\config\profile.py", line 324, in from_raw_profile_info
    credentials: Credentials = cls._credentials_from_profile(
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\config\profile.py", line 148, in _credentials_from_profile
    cls = load_plugin(typename)
          ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\adapters\factory.py", line 239, in load_plugin
    return FACTORY.load_plugin(name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\adapters\factory.py", line 68, in load_plugin
    mod: Any = import_module("." + name, "dbt.adapters")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\AppData\Local\Programs\Python\Python312\Lib\importlib\__init__.py", line 90, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 995, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "C:\Users\JohanBroman\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\adapters\snowflake\__init__.py", line 5, in <module>
    from dbt.adapters.snowflake.impl import SnowflakeAdapter
  File "C:\Users\JohanBroman\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\adapters\snowflake\impl.py", line 8, in <module>
    from dbt.adapters.catalogs import CatalogRelation, CatalogIntegration, CatalogIntegrationConfig
ModuleNotFoundError: No module named 'dbt.adapters.catalogs'

[0m13:33:38.097569 [debug] [MainThread]: Command `dbt debug` failed at 13:33:38.097569 after 2.33 seconds
[0m13:33:38.098505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D89B77AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014DAD2BD430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014DAD4AA240>]}
[0m13:33:38.098505 [debug] [MainThread]: Flushing usage events
[0m13:33:38.880128 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:34:01.861538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219157C8830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219183BB380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219183B82C0>]}


============================== 13:34:01.865470 | e49d177e-07b2-4383-9d17-f3994ce99034 ==============================
[0m13:34:01.865470 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:34:01.866398 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:34:01.882238 [info ] [MainThread]: dbt version: 1.9.4
[0m13:34:01.883260 [info ] [MainThread]: python version: 3.12.2
[0m13:34:01.884276 [info ] [MainThread]: python path: C:\Users\JohanBroman\AppData\Local\Programs\Python\Python312\python.exe
[0m13:34:01.884276 [info ] [MainThread]: os info: Windows-11-10.0.22621-SP0
[0m13:34:02.650830 [debug] [MainThread]: Traceback (most recent call last):
  File "C:\Users\JohanBroman\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\adapters\factory.py", line 68, in load_plugin
    mod: Any = import_module("." + name, "dbt.adapters")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\AppData\Local\Programs\Python\Python312\Lib\importlib\__init__.py", line 90, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 995, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "C:\Users\JohanBroman\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\adapters\snowflake\__init__.py", line 5, in <module>
    from dbt.adapters.snowflake.impl import SnowflakeAdapter
  File "C:\Users\JohanBroman\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\adapters\snowflake\impl.py", line 8, in <module>
    from dbt.adapters.catalogs import CatalogRelation, CatalogIntegration, CatalogIntegrationConfig
ModuleNotFoundError: No module named 'dbt.adapters.catalogs'

[0m13:34:02.651834 [error] [MainThread]: Encountered an error:
No module named 'dbt.adapters.catalogs'
[0m13:34:02.654838 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\JohanBroman\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\main.py", line 414, in debug
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\JohanBroman\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\task\debug.py", line 114, in run
    load_profile_status: SubtaskStatus = self._load_profile()
                                         ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\task\debug.py", line 205, in _load_profile
    profile: Profile = Profile.render(
                       ^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\config\profile.py", line 402, in render
    return cls.from_raw_profiles(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\config\profile.py", line 368, in from_raw_profiles
    return cls.from_raw_profile_info(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\config\profile.py", line 324, in from_raw_profile_info
    credentials: Credentials = cls._credentials_from_profile(
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\config\profile.py", line 148, in _credentials_from_profile
    cls = load_plugin(typename)
          ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\adapters\factory.py", line 239, in load_plugin
    return FACTORY.load_plugin(name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\adapters\factory.py", line 68, in load_plugin
    mod: Any = import_module("." + name, "dbt.adapters")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\AppData\Local\Programs\Python\Python312\Lib\importlib\__init__.py", line 90, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 995, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "C:\Users\JohanBroman\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\adapters\snowflake\__init__.py", line 5, in <module>
    from dbt.adapters.snowflake.impl import SnowflakeAdapter
  File "C:\Users\JohanBroman\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\adapters\snowflake\impl.py", line 8, in <module>
    from dbt.adapters.catalogs import CatalogRelation, CatalogIntegration, CatalogIntegrationConfig
ModuleNotFoundError: No module named 'dbt.adapters.catalogs'

[0m13:34:02.656847 [debug] [MainThread]: Command `dbt debug` failed at 13:34:02.656847 after 0.97 seconds
[0m13:34:02.656847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021912D44E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021937A4F230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002193A206450>]}
[0m13:34:02.657834 [debug] [MainThread]: Flushing usage events
[0m13:34:03.410102 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:43:05.218565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B46371A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B4636BF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B46370BD0>]}


============================== 13:43:05.232573 | be75c7b8-38a9-4a63-9ce7-d12503c2f4a7 ==============================
[0m13:43:05.232573 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:43:05.233580 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:43:05.439768 [info ] [MainThread]: dbt version: 1.9.4
[0m13:43:05.440775 [info ] [MainThread]: python version: 3.11.9
[0m13:43:05.441788 [info ] [MainThread]: python path: C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Scripts\python.exe
[0m13:43:05.442775 [info ] [MainThread]: os info: Windows-10-10.0.22621-SP0
[0m13:43:09.145061 [info ] [MainThread]: Using profiles dir at C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo
[0m13:43:09.147064 [info ] [MainThread]: Using profiles.yml file at C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\profiles.yml
[0m13:43:09.148053 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\dbt_project.yml
[0m13:43:09.156061 [info ] [MainThread]: adapter type: snowflake
[0m13:43:09.156061 [info ] [MainThread]: adapter version: 1.9.4
[0m13:43:09.224595 [info ] [MainThread]: Configuration:
[0m13:43:09.225611 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:43:09.226600 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:43:09.227596 [info ] [MainThread]: Required dependencies:
[0m13:43:09.228588 [debug] [MainThread]: Executing "git --help"
[0m13:43:09.279098 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:43:09.280103 [debug] [MainThread]: STDERR: "b''"
[0m13:43:09.280103 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:43:09.281100 [info ] [MainThread]: Connection:
[0m13:43:09.281100 [info ] [MainThread]:   account: XF88916
[0m13:43:09.282104 [info ] [MainThread]:   user: epicaldemo
[0m13:43:09.282104 [info ] [MainThread]:   database: EPICALDEMO
[0m13:43:09.283098 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m13:43:09.283098 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m13:43:09.284101 [info ] [MainThread]:   schema: RAW
[0m13:43:09.284101 [info ] [MainThread]:   authenticator: None
[0m13:43:09.285103 [info ] [MainThread]:   oauth_client_id: None
[0m13:43:09.285103 [info ] [MainThread]:   query_tag: None
[0m13:43:09.285103 [info ] [MainThread]:   client_session_keep_alive: False
[0m13:43:09.286156 [info ] [MainThread]:   host: None
[0m13:43:09.287097 [info ] [MainThread]:   port: None
[0m13:43:09.288099 [info ] [MainThread]:   proxy_host: None
[0m13:43:09.288099 [info ] [MainThread]:   proxy_port: None
[0m13:43:09.289098 [info ] [MainThread]:   protocol: None
[0m13:43:09.289098 [info ] [MainThread]:   connect_retries: 1
[0m13:43:09.290099 [info ] [MainThread]:   connect_timeout: None
[0m13:43:09.290099 [info ] [MainThread]:   retry_on_database_errors: False
[0m13:43:09.291108 [info ] [MainThread]:   retry_all: False
[0m13:43:09.292108 [info ] [MainThread]:   insecure_mode: False
[0m13:43:09.292108 [info ] [MainThread]:   reuse_connections: True
[0m13:43:09.293108 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m13:43:09.557226 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m13:43:10.950275 [debug] [MainThread]: Using snowflake connection "debug"
[0m13:43:10.951274 [debug] [MainThread]: On debug: select 1 as id
[0m13:43:10.951274 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:43:12.661925 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m13:43:12.662939 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m13:43:12.662939 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m13:43:12.663929 [info ] [MainThread]: [31m1 check failed:[0m
[0m13:43:12.664935 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250003 (08001): 404 Not Found: post https://XF88916.snowflakecomputing.com:443/session/v1/login-request?request_id=973cc4b5-b8a6-42eb-b506-0fb49d2ef70f&databaseName=EPICALDEMO&schemaName=RAW&warehouse=COMPUTE_WH&roleName=ACCOUNTADMIN&request_guid=8e225bb7-505c-45a6-9c68-c0d01c1ec226

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m13:43:12.666929 [debug] [MainThread]: Command `dbt debug` failed at 13:43:12.666929 after 7.53 seconds
[0m13:43:12.666929 [debug] [MainThread]: Connection 'debug' was left open.
[0m13:43:12.667937 [debug] [MainThread]: On debug: No close available on handle
[0m13:43:12.667937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B44055010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B40C93090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B4791C110>]}
[0m13:43:12.668930 [debug] [MainThread]: Flushing usage events
[0m13:43:13.198870 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:44:25.864662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA7106DF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA6EC8BC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA70990990>]}


============================== 13:44:25.867663 | 7767d44f-51af-472d-bd16-87f31b9e993c ==============================
[0m13:44:25.867663 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:44:25.868664 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'c:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'profiles_dir': 'c:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m13:44:25.972254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7767d44f-51af-472d-bd16-87f31b9e993c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA710E92D0>]}
[0m13:44:26.134847 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:44:26.135853 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:44:26.137845 [debug] [MainThread]: Command `cli deps` succeeded at 13:44:26.137845 after 0.35 seconds
[0m13:44:26.138859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA710BF450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA710BD8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA6B274E90>]}
[0m13:44:26.138859 [debug] [MainThread]: Flushing usage events
[0m13:44:26.677430 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:45:21.022087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEE6A70E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEE66B4910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEE6A72C50>]}


============================== 13:45:21.025087 | fe7d01ca-0ca7-4f66-94f4-c6cd63d34ced ==============================
[0m13:45:21.025087 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:45:21.026078 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:45:21.038096 [info ] [MainThread]: dbt version: 1.9.4
[0m13:45:21.039096 [info ] [MainThread]: python version: 3.11.9
[0m13:45:21.040096 [info ] [MainThread]: python path: C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Scripts\python.exe
[0m13:45:21.040096 [info ] [MainThread]: os info: Windows-10-10.0.22621-SP0
[0m13:45:21.297314 [info ] [MainThread]: Using profiles dir at C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo
[0m13:45:21.297314 [info ] [MainThread]: Using profiles.yml file at C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\profiles.yml
[0m13:45:21.298315 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\dbt_project.yml
[0m13:45:21.299309 [info ] [MainThread]: adapter type: snowflake
[0m13:45:21.300307 [info ] [MainThread]: adapter version: 1.9.4
[0m13:45:21.373220 [info ] [MainThread]: Configuration:
[0m13:45:21.374218 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:45:21.375210 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:45:21.375210 [info ] [MainThread]: Required dependencies:
[0m13:45:21.376210 [debug] [MainThread]: Executing "git --help"
[0m13:45:21.417209 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:45:21.417209 [debug] [MainThread]: STDERR: "b''"
[0m13:45:21.418209 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:45:21.419218 [info ] [MainThread]: Connection:
[0m13:45:21.419218 [info ] [MainThread]:   account: XGOYSZJ-XF88916
[0m13:45:21.420210 [info ] [MainThread]:   user: epicaldemo
[0m13:45:21.420210 [info ] [MainThread]:   database: EPICALDEMO
[0m13:45:21.421210 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m13:45:21.421210 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m13:45:21.422212 [info ] [MainThread]:   schema: RAW
[0m13:45:21.423223 [info ] [MainThread]:   authenticator: None
[0m13:45:21.423223 [info ] [MainThread]:   oauth_client_id: None
[0m13:45:21.424210 [info ] [MainThread]:   query_tag: None
[0m13:45:21.424210 [info ] [MainThread]:   client_session_keep_alive: False
[0m13:45:21.425211 [info ] [MainThread]:   host: None
[0m13:45:21.425211 [info ] [MainThread]:   port: None
[0m13:45:21.426211 [info ] [MainThread]:   proxy_host: None
[0m13:45:21.426211 [info ] [MainThread]:   proxy_port: None
[0m13:45:21.427210 [info ] [MainThread]:   protocol: None
[0m13:45:21.427210 [info ] [MainThread]:   connect_retries: 1
[0m13:45:21.428210 [info ] [MainThread]:   connect_timeout: None
[0m13:45:21.428210 [info ] [MainThread]:   retry_on_database_errors: False
[0m13:45:21.428210 [info ] [MainThread]:   retry_all: False
[0m13:45:21.429217 [info ] [MainThread]:   insecure_mode: False
[0m13:45:21.429217 [info ] [MainThread]:   reuse_connections: True
[0m13:45:21.430217 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m13:45:21.684923 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m13:45:21.778443 [debug] [MainThread]: Using snowflake connection "debug"
[0m13:45:21.779435 [debug] [MainThread]: On debug: select 1 as id
[0m13:45:21.779435 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:45:23.177925 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.399 seconds
[0m13:45:23.178924 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:45:23.180925 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:45:23.181930 [debug] [MainThread]: Command `dbt debug` succeeded at 13:45:23.181930 after 2.22 seconds
[0m13:45:23.182926 [debug] [MainThread]: Connection 'debug' was left open.
[0m13:45:23.182926 [debug] [MainThread]: On debug: Close
[0m13:45:23.335524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEE0E72190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEE885E6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEE6BA8BD0>]}
[0m13:45:23.336524 [debug] [MainThread]: Flushing usage events
[0m13:45:23.828071 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:51:58.129847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E993AB50D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E993AB4C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E993EBAC90>]}


============================== 13:51:58.132863 | 785323bd-d77d-41d5-9fa2-268857cfcd3b ==============================
[0m13:51:58.132863 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:51:58.143994 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s stg_customers', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:51:58.473110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '785323bd-d77d-41d5-9fa2-268857cfcd3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9950E5090>]}
[0m13:51:58.513111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '785323bd-d77d-41d5-9fa2-268857cfcd3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E995031590>]}
[0m13:51:58.514111 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m13:51:58.768035 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:51:58.905546 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:51:58.906547 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:51:58.911738 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.mart
[0m13:51:58.930748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '785323bd-d77d-41d5-9fa2-268857cfcd3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E995143B90>]}
[0m13:51:58.985260 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m13:51:58.990262 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m13:51:59.015261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '785323bd-d77d-41d5-9fa2-268857cfcd3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E99580C0D0>]}
[0m13:51:59.016262 [info ] [MainThread]: Found 1 model, 3 sources, 476 macros
[0m13:51:59.016262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '785323bd-d77d-41d5-9fa2-268857cfcd3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9955F6C90>]}
[0m13:51:59.018263 [info ] [MainThread]: 
[0m13:51:59.018263 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:51:59.018263 [info ] [MainThread]: 
[0m13:51:59.019262 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:51:59.021262 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m13:51:59.085819 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m13:51:59.086816 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m13:51:59.086816 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:51:59.877511 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.791 seconds
[0m13:51:59.879595 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_EPICALDEMO, now create_EPICALDEMO_broman_analytics)
[0m13:51:59.880627 [debug] [ThreadPool]: Creating schema "database: "EPICALDEMO"
schema: "broman_analytics"
"
[0m13:51:59.884611 [debug] [ThreadPool]: Using snowflake connection "create_EPICALDEMO_broman_analytics"
[0m13:51:59.884611 [debug] [ThreadPool]: On create_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "create_EPICALDEMO_broman_analytics"} */
create schema if not exists EPICALDEMO.broman_analytics
[0m13:52:00.028613 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.143 seconds
[0m13:52:00.030676 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m13:52:00.039739 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m13:52:00.039739 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m13:52:00.039739 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:52:00.530736 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.490 seconds
[0m13:52:00.535807 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m13:52:00.536801 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m13:52:00.676011 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.138 seconds
[0m13:52:00.678007 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m13:52:00.679970 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m13:52:00.777378 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.097 seconds
[0m13:52:00.779376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '785323bd-d77d-41d5-9fa2-268857cfcd3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E995806CD0>]}
[0m13:52:00.788377 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_customers
[0m13:52:00.789388 [info ] [Thread-1 (]: 1 of 1 START sql view model broman_analytics.stg_customers ..................... [RUN]
[0m13:52:00.791380 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_customers'
[0m13:52:00.791380 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_customers
[0m13:52:00.797384 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_customers"
[0m13:52:00.801377 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_customers
[0m13:52:00.822386 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.stg_customers"
[0m13:52:00.828377 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.stg_customers"
[0m13:52:00.829377 [debug] [Thread-1 (]: On model.epicaldemo.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_customers"} */
create or replace   view EPICALDEMO.broman_analytics.stg_customers
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.RAW.customers
),

final AS (
    SELECT
        customer_id
        ,INITCAP(first_name || ' ' || last_name) AS customer
        ,COALESCE(email, 'Missing') AS email
    FROM source
)

SELECT * FROM final
  );
[0m13:52:00.829377 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:52:01.493619 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.664 seconds
[0m13:52:01.520641 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '785323bd-d77d-41d5-9fa2-268857cfcd3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E98F7D4B90>]}
[0m13:52:01.521642 [info ] [Thread-1 (]: 1 of 1 OK created sql view model broman_analytics.stg_customers ................ [[32mSUCCESS 1[0m in 0.72s]
[0m13:52:01.522646 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_customers
[0m13:52:01.524570 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:52:01.524570 [debug] [MainThread]: Connection 'create_EPICALDEMO_broman_analytics' was left open.
[0m13:52:01.525569 [debug] [MainThread]: On create_EPICALDEMO_broman_analytics: Close
[0m13:52:01.666135 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m13:52:01.667077 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m13:52:01.828559 [debug] [MainThread]: Connection 'model.epicaldemo.stg_customers' was left open.
[0m13:52:01.828559 [debug] [MainThread]: On model.epicaldemo.stg_customers: Close
[0m13:52:01.979332 [info ] [MainThread]: 
[0m13:52:01.980353 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.96 seconds (2.96s).
[0m13:52:01.981336 [debug] [MainThread]: Command end result
[0m13:52:02.003337 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m13:52:02.005351 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m13:52:02.010338 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m13:52:02.011340 [info ] [MainThread]: 
[0m13:52:02.012340 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:52:02.012340 [info ] [MainThread]: 
[0m13:52:02.013338 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:52:02.014354 [debug] [MainThread]: Command `dbt run` succeeded at 13:52:02.014354 after 3.94 seconds
[0m13:52:02.014354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E993AB4C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E991855010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E98E2C1210>]}
[0m13:52:02.015345 [debug] [MainThread]: Flushing usage events
[0m13:52:02.572548 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:47:57.772585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A588E6F750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A588E63890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A588E63F50>]}


============================== 20:47:57.776585 | 4f5fa0b8-53ac-4d2a-8637-bf20193de4e5 ==============================
[0m20:47:57.776585 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:47:57.778585 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'c:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'profiles_dir': 'c:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m20:47:57.877911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f5fa0b8-53ac-4d2a-8637-bf20193de4e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A588F2D510>]}
[0m20:47:57.988234 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m20:47:57.990234 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m20:47:57.992247 [debug] [MainThread]: Command `cli deps` succeeded at 20:47:57.992247 after 0.31 seconds
[0m20:47:57.993246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A588EB7C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A588E78090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5879A1710>]}
[0m20:47:57.993246 [debug] [MainThread]: Flushing usage events
[0m20:47:58.530299 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:48:51.984156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FA5273810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FA5273450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FA5273BD0>]}


============================== 20:48:51.987149 | 540a2f98-4953-43ca-b829-5468a620c230 ==============================
[0m20:48:51.987149 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:48:51.989151 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m20:48:52.018213 [info ] [MainThread]: dbt version: 1.9.4
[0m20:48:52.019216 [info ] [MainThread]: python version: 3.11.9
[0m20:48:52.020209 [info ] [MainThread]: python path: C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Scripts\python.exe
[0m20:48:52.021202 [info ] [MainThread]: os info: Windows-10-10.0.22621-SP0
[0m20:48:52.322923 [info ] [MainThread]: Using profiles dir at C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo
[0m20:48:52.322923 [info ] [MainThread]: Using profiles.yml file at C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\profiles.yml
[0m20:48:52.324807 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\dbt_project.yml
[0m20:48:52.325819 [info ] [MainThread]: adapter type: snowflake
[0m20:48:52.325819 [info ] [MainThread]: adapter version: 1.9.4
[0m20:48:52.395146 [info ] [MainThread]: Configuration:
[0m20:48:52.397165 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:48:52.398138 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:48:52.398138 [info ] [MainThread]: Required dependencies:
[0m20:48:52.399137 [debug] [MainThread]: Executing "git --help"
[0m20:48:52.439141 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:48:52.440144 [debug] [MainThread]: STDERR: "b''"
[0m20:48:52.440144 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:48:52.441141 [info ] [MainThread]: Connection:
[0m20:48:52.441141 [info ] [MainThread]:   account: XGOYSZJ-XF88916
[0m20:48:52.442140 [info ] [MainThread]:   user: epicaldemo
[0m20:48:52.442140 [info ] [MainThread]:   database: EPICALDEMO
[0m20:48:52.443140 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m20:48:52.443140 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m20:48:52.444160 [info ] [MainThread]:   schema: broman_analytics
[0m20:48:52.444160 [info ] [MainThread]:   authenticator: None
[0m20:48:52.445166 [info ] [MainThread]:   oauth_client_id: None
[0m20:48:52.445166 [info ] [MainThread]:   query_tag: None
[0m20:48:52.446166 [info ] [MainThread]:   client_session_keep_alive: False
[0m20:48:52.447173 [info ] [MainThread]:   host: None
[0m20:48:52.447173 [info ] [MainThread]:   port: None
[0m20:48:52.448165 [info ] [MainThread]:   proxy_host: None
[0m20:48:52.448165 [info ] [MainThread]:   proxy_port: None
[0m20:48:52.448165 [info ] [MainThread]:   protocol: None
[0m20:48:52.449173 [info ] [MainThread]:   connect_retries: 1
[0m20:48:52.449173 [info ] [MainThread]:   connect_timeout: None
[0m20:48:52.450167 [info ] [MainThread]:   retry_on_database_errors: False
[0m20:48:52.450167 [info ] [MainThread]:   retry_all: False
[0m20:48:52.451167 [info ] [MainThread]:   insecure_mode: False
[0m20:48:52.451167 [info ] [MainThread]:   reuse_connections: True
[0m20:48:52.452166 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m20:48:52.789611 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m20:48:54.958523 [debug] [MainThread]: Using snowflake connection "debug"
[0m20:48:54.958523 [debug] [MainThread]: On debug: select 1 as id
[0m20:48:54.959523 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:48:57.000075 [debug] [MainThread]: SQL status: SUCCESS 1 in 2.040 seconds
[0m20:48:57.002147 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:48:57.004088 [info ] [MainThread]: [32mAll checks passed![0m
[0m20:48:57.006069 [debug] [MainThread]: Command `dbt debug` succeeded at 20:48:57.006069 after 5.08 seconds
[0m20:48:57.007093 [debug] [MainThread]: Connection 'debug' was left open.
[0m20:48:57.008069 [debug] [MainThread]: On debug: Close
[0m20:48:57.243130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F9F6F2FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FA4A04C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FA6BE5A10>]}
[0m20:48:57.244128 [debug] [MainThread]: Flushing usage events
[0m20:48:57.758579 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:50:13.229330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EACF673350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EACF670D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EACF6719D0>]}


============================== 20:50:13.232337 | f5567a3d-2847-432f-9847-0cc2830174ad ==============================
[0m20:50:13.232337 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:50:13.233336 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:50:13.662862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5567a3d-2847-432f-9847-0cc2830174ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EACF6913D0>]}
[0m20:50:13.702864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5567a3d-2847-432f-9847-0cc2830174ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAD08318D0>]}
[0m20:50:13.704863 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m20:50:14.034379 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:50:14.193391 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:50:14.194392 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:50:14.198392 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.mart
[0m20:50:14.220393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5567a3d-2847-432f-9847-0cc2830174ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAD10E6C50>]}
[0m20:50:14.260399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5567a3d-2847-432f-9847-0cc2830174ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAD08D0F10>]}
[0m20:50:14.261394 [info ] [MainThread]: Found 1 model, 3 sources, 476 macros
[0m20:50:14.262401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5567a3d-2847-432f-9847-0cc2830174ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAD1016810>]}
[0m20:50:14.263394 [info ] [MainThread]: 
[0m20:50:14.264395 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:50:14.265410 [info ] [MainThread]: 
[0m20:50:14.266394 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:50:14.267394 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m20:50:14.352955 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m20:50:14.352955 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m20:50:14.353953 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:50:15.138865 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.785 seconds
[0m20:50:15.141879 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m20:50:15.142874 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m20:50:15.276692 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.134 seconds
[0m20:50:15.278695 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m20:50:15.278695 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m20:50:15.399424 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.119 seconds
[0m20:50:15.403342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5567a3d-2847-432f-9847-0cc2830174ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAD145A790>]}
[0m20:50:15.428803 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_customers
[0m20:50:15.429812 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_customers'
[0m20:50:15.429812 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_customers
[0m20:50:15.436827 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_customers"
[0m20:50:15.437818 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_customers
[0m20:50:15.438834 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_customers
[0m20:50:15.439841 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:50:15.440829 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m20:50:15.440829 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m20:50:15.603865 [debug] [MainThread]: Connection 'model.epicaldemo.stg_customers' was properly closed.
[0m20:50:15.604919 [debug] [MainThread]: Command end result
[0m20:50:15.653382 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m20:50:15.675223 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m20:50:15.681221 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m20:50:15.921113 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m20:50:15.922112 [info ] [MainThread]: Building catalog
[0m20:50:15.931112 [debug] [ThreadPool]: Acquiring new snowflake connection 'EPICALDEMO.information_schema'
[0m20:50:15.944128 [debug] [ThreadPool]: Using snowflake connection "EPICALDEMO.information_schema"
[0m20:50:15.945117 [debug] [ThreadPool]: On EPICALDEMO.information_schema: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "EPICALDEMO.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from EPICALDEMO.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'categories' and upper("table_name") = upper('categories')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_customers' and upper("table_name") = upper('stg_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'brands' and upper("table_name") = upper('brands')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'customers' and upper("table_name") = upper('customers')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from EPICALDEMO.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'categories' and upper("table_name") = upper('categories')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_customers' and upper("table_name") = upper('stg_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'brands' and upper("table_name") = upper('brands')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'customers' and upper("table_name") = upper('customers')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m20:50:15.946129 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:50:20.843248 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 4.897 seconds
[0m20:50:20.859809 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\catalog.json
[0m20:50:20.878786 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m20:50:20.880794 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m20:50:20.881784 [info ] [MainThread]: Catalog written to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\catalog.json
[0m20:50:20.882796 [debug] [MainThread]: Command `dbt docs generate` succeeded at 20:50:20.882796 after 7.71 seconds
[0m20:50:20.882796 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m20:50:20.883790 [debug] [MainThread]: Connection 'EPICALDEMO.information_schema' was left open.
[0m20:50:20.883790 [debug] [MainThread]: On EPICALDEMO.information_schema: Close
[0m20:50:21.041748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EACDACADD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EACE053FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAD07FD250>]}
[0m20:50:21.043760 [debug] [MainThread]: Flushing usage events
[0m20:50:21.601520 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:50:26.514685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1EDC70990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1ED595250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1EDC70A90>]}


============================== 20:50:26.517694 | a6b49c52-889a-4a1b-b3fd-1475c2ad435f ==============================
[0m20:50:26.517694 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:50:26.518685 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:50:26.905850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a6b49c52-889a-4a1b-b3fd-1475c2ad435f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1ED44E890>]}
[0m20:50:26.946852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a6b49c52-889a-4a1b-b3fd-1475c2ad435f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1EC64FB50>]}
[0m09:52:54.568181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD3FC6E710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD3FC6E6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD3FC6F590>]}


============================== 09:52:54.573701 | ce005934-8aca-4eca-9ad7-38a6fa93a1af ==============================
[0m09:52:54.573701 [info ] [MainThread]: Running with dbt=1.9.4
[0m09:52:54.574700 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'c:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'profiles_dir': 'c:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:52:54.681091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce005934-8aca-4eca-9ad7-38a6fa93a1af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD3FCB7350>]}
[0m09:52:54.796171 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m09:52:54.799295 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m09:52:54.801306 [debug] [MainThread]: Command `cli deps` succeeded at 09:52:54.801306 after 0.32 seconds
[0m09:52:54.801306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD3FCB7650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD3FCB6F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD3FCB7C50>]}
[0m09:52:54.802817 [debug] [MainThread]: Flushing usage events
[0m09:52:55.212380 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:17:46.730446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F565873F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5658909D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5658739D0>]}


============================== 10:17:46.746070 | 5116a4aa-f577-418d-90da-1890ccfdab33 ==============================
[0m10:17:46.746070 [info ] [MainThread]: Running with dbt=1.9.4
[0m10:17:46.746070 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -s stg_snowflake__customers', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:17:49.269485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5116a4aa-f577-418d-90da-1890ccfdab33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F565890F50>]}
[0m10:17:49.301140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5116a4aa-f577-418d-90da-1890ccfdab33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5642578D0>]}
[0m10:17:49.332398 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m10:17:49.693285 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m10:17:49.834346 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:17:49.834346 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:17:49.849965 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.mart
[0m10:17:49.865590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5116a4aa-f577-418d-90da-1890ccfdab33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5672925D0>]}
[0m10:17:49.927081 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m10:17:49.948327 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m10:17:50.147508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5116a4aa-f577-418d-90da-1890ccfdab33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F566FB8610>]}
[0m10:17:50.147508 [info ] [MainThread]: Found 1 model, 8 sources, 476 macros
[0m10:17:50.147508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5116a4aa-f577-418d-90da-1890ccfdab33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F566FF0A10>]}
[0m10:17:50.147508 [info ] [MainThread]: 
[0m10:17:50.147508 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:17:50.147508 [info ] [MainThread]: 
[0m10:17:50.147508 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:17:50.163014 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m10:17:51.291625 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m10:17:51.291625 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m10:17:51.291625 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:17:53.016746 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.724 seconds
[0m10:17:53.016746 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m10:17:53.032390 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m10:17:53.032390 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m10:17:53.032390 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:17:53.393304 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.369 seconds
[0m10:17:53.408934 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m10:17:53.408934 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m10:17:53.597208 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.201 seconds
[0m10:17:53.612838 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m10:17:53.612838 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m10:17:53.675340 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.065 seconds
[0m10:17:53.675340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5116a4aa-f577-418d-90da-1890ccfdab33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5673ADA50>]}
[0m10:17:53.690844 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_snowflake__customers
[0m10:17:53.690844 [info ] [Thread-1 (]: 1 of 1 START sql view model broman_analytics.stg_snowflake__customers .......... [RUN]
[0m10:17:53.690844 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_snowflake__customers'
[0m10:17:53.690844 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_snowflake__customers
[0m10:17:53.709316 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_snowflake__customers"
[0m10:17:53.711346 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_snowflake__customers
[0m10:17:53.734549 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.stg_snowflake__customers"
[0m10:17:53.735550 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.stg_snowflake__customers"
[0m10:17:53.735550 [debug] [Thread-1 (]: On model.epicaldemo.stg_snowflake__customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_snowflake__customers"} */
create or replace   view EPICALDEMO.broman_analytics.stg_snowflake__customers
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.RAW.customer
),

final AS (
    SELECT
        id AS "customer_id"
        ,customernumber AS "Customer Number"
        ,age AS "Customer Age"

        ,CASE
            WHEN age < 20 THEN '< 20'
            WHEN age >= 20 AND age < 30 THEN '20 - 30'
            WHEN age >= 30 AND age < 50 THEN '30 - 50'
            WHEN age >= 50 AND age < 60 THEN '50 - 60'
            ELSE '60+'
         END AS "Customer Age Group"

        ,CASE
            WHEN age < 20 THEN 1
            WHEN age >= 20 AND age < 30 THEN 2
            WHEN age >= 30 AND age < 50 THEN 3
            WHEN age >= 50 AND age < 60 THEN 4
            ELSE 5
         END AS "customer_age_group_sort"

        ,state AS "Customer State"
    FROM source
)

SELECT * FROM final
  );
[0m10:17:53.735550 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:17:54.505310 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.774 seconds
[0m10:17:54.536565 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5116a4aa-f577-418d-90da-1890ccfdab33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F56740DD50>]}
[0m10:17:54.536565 [info ] [Thread-1 (]: 1 of 1 OK created sql view model broman_analytics.stg_snowflake__customers ..... [[32mSUCCESS 1[0m in 0.83s]
[0m10:17:54.536565 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_snowflake__customers
[0m10:17:54.536565 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:17:54.536565 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m10:17:54.536565 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m10:17:54.596651 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m10:17:54.596651 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m10:17:54.677795 [debug] [MainThread]: Connection 'model.epicaldemo.stg_snowflake__customers' was left open.
[0m10:17:54.677795 [debug] [MainThread]: On model.epicaldemo.stg_snowflake__customers: Close
[0m10:17:54.756311 [info ] [MainThread]: 
[0m10:17:54.756311 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.61 seconds (4.61s).
[0m10:17:54.756311 [debug] [MainThread]: Command end result
[0m10:17:54.784436 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m10:17:54.785428 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m10:17:54.785428 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m10:17:54.792476 [info ] [MainThread]: 
[0m10:17:54.792476 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:17:54.793851 [info ] [MainThread]: 
[0m10:17:54.793851 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:17:54.793851 [debug] [MainThread]: Command `dbt run` succeeded at 10:17:54.793851 after 8.13 seconds
[0m10:17:54.796023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5654B4E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5654B5290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F55FB25E10>]}
[0m10:17:54.796023 [debug] [MainThread]: Flushing usage events
[0m10:17:55.226773 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:21:04.529643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEB4471350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEB4471E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEB4471C50>]}


============================== 10:21:04.529643 | 0fdc10f0-d4fa-4551-89fc-0bea5edb9cba ==============================
[0m10:21:04.529643 [info ] [MainThread]: Running with dbt=1.9.4
[0m10:21:04.529643 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:21:04.903500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0fdc10f0-d4fa-4551-89fc-0bea5edb9cba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEB4491450>]}
[0m10:21:04.950295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0fdc10f0-d4fa-4551-89fc-0bea5edb9cba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEB56316D0>]}
[0m10:21:04.950295 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m10:21:05.233932 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m10:21:05.391440 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:21:05.391440 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:21:05.391440 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.mart
[0m10:21:05.423604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0fdc10f0-d4fa-4551-89fc-0bea5edb9cba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEB5EC2BD0>]}
[0m10:21:05.454325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0fdc10f0-d4fa-4551-89fc-0bea5edb9cba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEB56D0710>]}
[0m10:21:05.454325 [info ] [MainThread]: Found 1 model, 8 sources, 476 macros
[0m10:21:05.454325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fdc10f0-d4fa-4551-89fc-0bea5edb9cba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEB5E22450>]}
[0m10:21:05.454325 [info ] [MainThread]: 
[0m10:21:05.454325 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:21:05.454325 [info ] [MainThread]: 
[0m10:21:05.454325 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:21:05.467830 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m10:21:05.556604 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m10:21:05.556604 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m10:21:05.557611 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:21:06.095383 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.545 seconds
[0m10:21:06.095383 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m10:21:06.095383 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m10:21:06.189519 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.090 seconds
[0m10:21:06.189519 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m10:21:06.189519 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m10:21:06.253240 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.055 seconds
[0m10:21:06.253240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fdc10f0-d4fa-4551-89fc-0bea5edb9cba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEB5766E90>]}
[0m10:21:06.253240 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_snowflake__customers
[0m10:21:06.253240 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_snowflake__customers'
[0m10:21:06.253240 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_snowflake__customers
[0m10:21:06.253240 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_snowflake__customers"
[0m10:21:06.253240 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_snowflake__customers
[0m10:21:06.268748 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_snowflake__customers
[0m10:21:06.268748 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:21:06.268748 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m10:21:06.268748 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m10:21:06.315630 [debug] [MainThread]: Connection 'model.epicaldemo.stg_snowflake__customers' was properly closed.
[0m10:21:06.315630 [debug] [MainThread]: Command end result
[0m10:21:06.369134 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m10:21:06.378727 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m10:21:06.394376 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m10:21:06.629803 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m10:21:06.629803 [info ] [MainThread]: Building catalog
[0m10:21:06.629803 [debug] [ThreadPool]: Acquiring new snowflake connection 'EPICALDEMO.information_schema'
[0m10:21:06.656223 [debug] [ThreadPool]: Using snowflake connection "EPICALDEMO.information_schema"
[0m10:21:06.656223 [debug] [ThreadPool]: On EPICALDEMO.information_schema: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "EPICALDEMO.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from EPICALDEMO.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'transactions' and upper("table_name") = upper('transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'customer' and upper("table_name") = upper('customer')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_snowflake__customers' and upper("table_name") = upper('stg_snowflake__customers')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'item_attributes' and upper("table_name") = upper('item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'item' and upper("table_name") = upper('item')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'store' and upper("table_name") = upper('store')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'category' and upper("table_name") = upper('category')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'manager' and upper("table_name") = upper('manager')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'date' and upper("table_name") = upper('date')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from EPICALDEMO.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'transactions' and upper("table_name") = upper('transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'customer' and upper("table_name") = upper('customer')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_snowflake__customers' and upper("table_name") = upper('stg_snowflake__customers')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'item_attributes' and upper("table_name") = upper('item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'item' and upper("table_name") = upper('item')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'store' and upper("table_name") = upper('store')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'category' and upper("table_name") = upper('category')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'manager' and upper("table_name") = upper('manager')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'date' and upper("table_name") = upper('date')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m10:21:06.657222 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:21:12.477132 [debug] [ThreadPool]: SQL status: SUCCESS 48 in 5.828 seconds
[0m10:21:12.508283 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\catalog.json
[0m10:21:12.523899 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m10:21:12.539524 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m10:21:12.539524 [info ] [MainThread]: Catalog written to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\catalog.json
[0m10:21:12.539524 [debug] [MainThread]: Command `dbt docs generate` succeeded at 10:21:12.539524 after 8.09 seconds
[0m10:21:12.539524 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m10:21:12.539524 [debug] [MainThread]: Connection 'EPICALDEMO.information_schema' was left open.
[0m10:21:12.539524 [debug] [MainThread]: On EPICALDEMO.information_schema: Close
[0m10:21:12.624262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEB40B49D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEB44C6850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEB44C6D50>]}
[0m10:21:12.625258 [debug] [MainThread]: Flushing usage events
[0m10:21:13.011934 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:21:26.126800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018797171CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018796E4DA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018797170710>]}


============================== 10:21:26.126800 | e5e24ad5-6222-4a85-89d7-307883bd5953 ==============================
[0m10:21:26.126800 [info ] [MainThread]: Running with dbt=1.9.4
[0m10:21:26.126800 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt docs serve', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:21:28.478697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e5e24ad5-6222-4a85-89d7-307883bd5953', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187985F2410>]}
[0m10:21:28.526306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e5e24ad5-6222-4a85-89d7-307883bd5953', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001879852D350>]}
[0m10:21:55.174630 [error] [MainThread]: Encountered an error:

[0m10:21:55.218389 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m10:21:55.221893 [debug] [MainThread]: Command `dbt docs serve` failed at 10:21:55.221893 after 29.17 seconds
[0m10:21:55.221893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001879716B390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018797171950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187971726D0>]}
[0m10:21:55.221893 [debug] [MainThread]: Flushing usage events
[0m10:21:55.613694 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:37:30.272219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B69F73E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B69FA0310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B69F735D0>]}


============================== 10:37:30.287856 | 9ec30e01-ddd0-4b16-a9c6-ef5800e75d53 ==============================
[0m10:37:30.287856 [info ] [MainThread]: Running with dbt=1.9.4
[0m10:37:30.287856 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m10:37:32.733607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ec30e01-ddd0-4b16-a9c6-ef5800e75d53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B671CE950>]}
[0m10:37:32.780483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ec30e01-ddd0-4b16-a9c6-ef5800e75d53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B6B35E790>]}
[0m10:37:32.796123 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m10:37:33.178426 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m10:37:33.272708 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m10:37:33.272708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9ec30e01-ddd0-4b16-a9c6-ef5800e75d53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B6879DC90>]}
[0m10:37:34.051142 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.epicaldemo.stg_salesforce__customers' (models\staging\stg_salesforce__customers.sql) depends on a source named 'salesforce.customer' which was not found
[0m10:37:34.051142 [debug] [MainThread]: Command `dbt run` failed at 10:37:34.051142 after 3.87 seconds
[0m10:37:34.051142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B69F73190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B69F71F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B64893090>]}
[0m10:37:34.051142 [debug] [MainThread]: Flushing usage events
[0m10:37:34.442301 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:40:13.705560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025959470310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025959473790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025959473850>]}


============================== 10:40:13.705560 | 2e796333-39c2-40d2-8ca2-056452fe21e6 ==============================
[0m10:40:13.705560 [info ] [MainThread]: Running with dbt=1.9.4
[0m10:40:13.721177 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:40:13.878255 [info ] [MainThread]: dbt version: 1.9.4
[0m10:40:13.878255 [info ] [MainThread]: python version: 3.11.9
[0m10:40:13.878255 [info ] [MainThread]: python path: C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Scripts\python.exe
[0m10:40:13.878255 [info ] [MainThread]: os info: Windows-10-10.0.22621-SP0
[0m10:40:14.192084 [info ] [MainThread]: Using profiles dir at C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo
[0m10:40:14.192084 [info ] [MainThread]: Using profiles.yml file at C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\profiles.yml
[0m10:40:14.192084 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\dbt_project.yml
[0m10:40:14.204135 [info ] [MainThread]: adapter type: snowflake
[0m10:40:14.204135 [info ] [MainThread]: adapter version: 1.9.4
[0m10:40:14.275654 [info ] [MainThread]: Configuration:
[0m10:40:14.276727 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:40:14.277659 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:40:14.277659 [info ] [MainThread]: Required dependencies:
[0m10:40:14.278741 [debug] [MainThread]: Executing "git --help"
[0m10:40:14.315057 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:40:14.315057 [debug] [MainThread]: STDERR: "b''"
[0m10:40:14.315057 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:40:14.315057 [info ] [MainThread]: Connection:
[0m10:40:14.315057 [info ] [MainThread]:   account: XGOYSZJ-XF88916
[0m10:40:14.315057 [info ] [MainThread]:   user: epicaldemo
[0m10:40:14.315057 [info ] [MainThread]:   database: EPICALDEMO
[0m10:40:14.315057 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m10:40:14.315057 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m10:40:14.315057 [info ] [MainThread]:   schema: broman_analytics
[0m10:40:14.315057 [info ] [MainThread]:   authenticator: None
[0m10:40:14.315057 [info ] [MainThread]:   oauth_client_id: None
[0m10:40:14.315057 [info ] [MainThread]:   query_tag: None
[0m10:40:14.315057 [info ] [MainThread]:   client_session_keep_alive: False
[0m10:40:14.315057 [info ] [MainThread]:   host: None
[0m10:40:14.315057 [info ] [MainThread]:   port: None
[0m10:40:14.323864 [info ] [MainThread]:   proxy_host: None
[0m10:40:14.323864 [info ] [MainThread]:   proxy_port: None
[0m10:40:14.324872 [info ] [MainThread]:   protocol: None
[0m10:40:14.324872 [info ] [MainThread]:   connect_retries: 1
[0m10:40:14.325874 [info ] [MainThread]:   connect_timeout: None
[0m10:40:14.325874 [info ] [MainThread]:   retry_on_database_errors: False
[0m10:40:14.326870 [info ] [MainThread]:   retry_all: False
[0m10:40:14.326870 [info ] [MainThread]:   insecure_mode: False
[0m10:40:14.327956 [info ] [MainThread]:   reuse_connections: True
[0m10:40:14.327956 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m10:40:14.642897 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m10:40:16.640069 [debug] [MainThread]: Using snowflake connection "debug"
[0m10:40:16.640069 [debug] [MainThread]: On debug: select 1 as id
[0m10:40:16.640069 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:40:17.268872 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.628 seconds
[0m10:40:17.268872 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m10:40:17.268872 [info ] [MainThread]: [32mAll checks passed![0m
[0m10:40:17.268872 [debug] [MainThread]: Command `dbt debug` succeeded at 10:40:17.268872 after 3.62 seconds
[0m10:40:17.268872 [debug] [MainThread]: Connection 'debug' was left open.
[0m10:40:17.268872 [debug] [MainThread]: On debug: Close
[0m10:40:17.325855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002595946B150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259594BF250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259594BEBD0>]}
[0m10:40:17.325855 [debug] [MainThread]: Flushing usage events
[0m10:40:17.769727 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:40:50.628140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3D0373E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3D0373590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3D0373390>]}


============================== 10:40:50.631713 | 94c08907-b77b-4bd4-af28-3115c13a9e34 ==============================
[0m10:40:50.631713 [info ] [MainThread]: Running with dbt=1.9.4
[0m10:40:50.632755 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m10:40:50.730156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '94c08907-b77b-4bd4-af28-3115c13a9e34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3D03F2FD0>]}
[0m10:40:50.773577 [debug] [MainThread]: Command `dbt clean` succeeded at 10:40:50.773577 after 0.21 seconds
[0m10:40:50.773577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3D0392FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3D01B4DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3D03E6D50>]}
[0m10:40:50.774576 [debug] [MainThread]: Flushing usage events
[0m10:40:51.214028 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:41:21.626827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FE62BA150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FE6570D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FE6572ED0>]}


============================== 10:41:21.630692 | 647b04da-11de-41a3-a60e-31c6c228ee10 ==============================
[0m10:41:21.630692 [info ] [MainThread]: Running with dbt=1.9.4
[0m10:41:21.631694 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:41:22.044457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '647b04da-11de-41a3-a60e-31c6c228ee10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FE79F1E50>]}
[0m10:41:22.085726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '647b04da-11de-41a3-a60e-31c6c228ee10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FE79314D0>]}
[0m10:41:22.085726 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m10:41:22.387266 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m10:41:22.387266 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m10:41:22.387266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '647b04da-11de-41a3-a60e-31c6c228ee10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FE7E82ED0>]}
[0m10:41:23.323812 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.epicaldemo.intermediate
- models.epicaldemo.mart
[0m10:41:23.330318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '647b04da-11de-41a3-a60e-31c6c228ee10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FE82D3290>]}
[0m10:41:23.387279 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m10:41:23.403871 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m10:41:23.437565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '647b04da-11de-41a3-a60e-31c6c228ee10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FE86DC790>]}
[0m10:41:23.437565 [info ] [MainThread]: Found 5 models, 8 sources, 476 macros
[0m10:41:23.437565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '647b04da-11de-41a3-a60e-31c6c228ee10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FE8380FD0>]}
[0m10:41:23.437565 [info ] [MainThread]: 
[0m10:41:23.437565 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:41:23.437565 [info ] [MainThread]: 
[0m10:41:23.437565 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:41:23.437565 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m10:41:23.538105 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m10:41:23.538105 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m10:41:23.538105 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:41:24.037791 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.504 seconds
[0m10:41:24.037791 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m10:41:24.054075 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m10:41:24.054075 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m10:41:24.054075 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:41:24.772230 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.722 seconds
[0m10:41:24.772230 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m10:41:24.772230 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m10:41:24.874958 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.089 seconds
[0m10:41:24.875958 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m10:41:24.876958 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m10:41:24.936404 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.061 seconds
[0m10:41:24.936404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '647b04da-11de-41a3-a60e-31c6c228ee10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FE8216D10>]}
[0m10:41:24.936404 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__category
[0m10:41:24.936404 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_d365_fo__date
[0m10:41:24.936404 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_salesforce__customers
[0m10:41:24.936404 [info ] [Thread-1 (]: 1 of 3 START sql view model broman_analytics.stg_d365_fo__category ............. [RUN]
[0m10:41:24.936404 [info ] [Thread-2 (]: 2 of 3 START sql view model broman_analytics.stg_d365_fo__date ................. [RUN]
[0m10:41:24.936404 [info ] [Thread-3 (]: 3 of 3 START sql view model broman_analytics.stg_salesforce__customers ......... [RUN]
[0m10:41:24.936404 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__category'
[0m10:41:24.936404 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__date'
[0m10:41:24.936404 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_salesforce__customers'
[0m10:41:24.936404 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__category
[0m10:41:24.951421 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_d365_fo__date
[0m10:41:24.951421 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_salesforce__customers
[0m10:41:24.957674 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__category"
[0m10:41:24.960674 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__date"
[0m10:41:24.962674 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_salesforce__customers"
[0m10:41:24.964677 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__category
[0m10:41:24.965677 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_salesforce__customers
[0m10:41:24.976670 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_d365_fo__date
[0m10:41:24.989453 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__category"
[0m10:41:24.990518 [debug] [Thread-3 (]: Writing runtime sql for node "model.epicaldemo.stg_salesforce__customers"
[0m10:41:24.990518 [debug] [Thread-2 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__date"
[0m10:41:24.990518 [debug] [Thread-2 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__date"
[0m10:41:24.990518 [debug] [Thread-3 (]: Using snowflake connection "model.epicaldemo.stg_salesforce__customers"
[0m10:41:24.990518 [debug] [Thread-2 (]: On model.epicaldemo.stg_d365_fo__date: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__date"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__date
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.date
),

final AS (
    SELECT
        id AS date_id
        ,date AS "Date"
        ,year AS "Year"
        ,yearmonth AS "Year Month"
        ,monthnumber AS "Month Number"
        ,quarter AS "Quarter"
        ,quarternumber AS "Quarter Number"
        ,monthname AS "Month"
    FROM source
)

SELECT * FROM final
  );
[0m10:41:24.990518 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__category"
[0m10:41:24.990518 [debug] [Thread-3 (]: On model.epicaldemo.stg_salesforce__customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_salesforce__customers"} */
create or replace   view EPICALDEMO.broman_analytics.stg_salesforce__customers
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.salesforce.customer
),

final AS (
    SELECT
        id AS "customer_id"
        ,customernumber AS "Customer Number"
        ,age AS "Customer Age"

        ,CASE
            WHEN age < 20 THEN '< 20'
            WHEN age >= 20 AND age < 30 THEN '20 - 30'
            WHEN age >= 30 AND age < 50 THEN '30 - 50'
            WHEN age >= 50 AND age < 60 THEN '50 - 60'
            ELSE '60+'
         END AS "Customer Age Group"

        ,CASE
            WHEN age < 20 THEN 1
            WHEN age >= 20 AND age < 30 THEN 2
            WHEN age >= 30 AND age < 50 THEN 3
            WHEN age >= 50 AND age < 60 THEN 4
            ELSE 5
         END AS "customer_age_group_sort"

        ,state AS "Customer State"
    FROM source
)

SELECT * FROM final
  );
[0m10:41:24.990518 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:41:25.003176 [debug] [Thread-1 (]: On model.epicaldemo.stg_d365_fo__category: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__category"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__category
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.category
),

final AS (
    SELECT
        id AS "category_id"
        ,INITCAP(name) AS "Category"
        ,managerid AS "manager_id"
    FROM source
)

SELECT * FROM final
  );
[0m10:41:25.003176 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:41:25.004565 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:41:25.436365 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.445 seconds
[0m10:41:25.466190 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.460 seconds
[0m10:41:25.469988 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.466 seconds
[0m10:41:25.473030 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '647b04da-11de-41a3-a60e-31c6c228ee10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FE825C250>]}
[0m10:41:25.473030 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '647b04da-11de-41a3-a60e-31c6c228ee10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FE7E83850>]}
[0m10:41:25.473030 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '647b04da-11de-41a3-a60e-31c6c228ee10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FE8EE3850>]}
[0m10:41:25.474029 [info ] [Thread-2 (]: 2 of 3 OK created sql view model broman_analytics.stg_d365_fo__date ............ [[32mSUCCESS 1[0m in 0.53s]
[0m10:41:25.475030 [info ] [Thread-1 (]: 1 of 3 OK created sql view model broman_analytics.stg_d365_fo__category ........ [[32mSUCCESS 1[0m in 0.53s]
[0m10:41:25.476029 [info ] [Thread-3 (]: 3 of 3 OK created sql view model broman_analytics.stg_salesforce__customers .... [[32mSUCCESS 1[0m in 0.54s]
[0m10:41:25.476029 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_d365_fo__date
[0m10:41:25.477052 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__category
[0m10:41:25.478030 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_salesforce__customers
[0m10:41:25.479030 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:41:25.480029 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m10:41:25.480029 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m10:41:25.520588 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m10:41:25.520588 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m10:41:25.580000 [debug] [MainThread]: Connection 'model.epicaldemo.stg_d365_fo__category' was left open.
[0m10:41:25.580000 [debug] [MainThread]: On model.epicaldemo.stg_d365_fo__category: Close
[0m10:41:25.624883 [debug] [MainThread]: Connection 'model.epicaldemo.stg_d365_fo__date' was left open.
[0m10:41:25.624883 [debug] [MainThread]: On model.epicaldemo.stg_d365_fo__date: Close
[0m10:41:25.677512 [debug] [MainThread]: Connection 'model.epicaldemo.stg_salesforce__customers' was left open.
[0m10:41:25.678512 [debug] [MainThread]: On model.epicaldemo.stg_salesforce__customers: Close
[0m10:41:25.734113 [info ] [MainThread]: 
[0m10:41:25.735117 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 2.30 seconds (2.30s).
[0m10:41:25.737046 [debug] [MainThread]: Command end result
[0m10:41:25.820439 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m10:41:25.820439 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m10:41:25.820439 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m10:41:25.820439 [info ] [MainThread]: 
[0m10:41:25.834446 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:41:25.835455 [info ] [MainThread]: 
[0m10:41:25.836273 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m10:41:25.837282 [debug] [MainThread]: Command `dbt run` succeeded at 10:41:25.837282 after 4.27 seconds
[0m10:41:25.838280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FE0E93090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FE0E12190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FE0E12210>]}
[0m10:41:25.839069 [debug] [MainThread]: Flushing usage events
[0m10:41:25.890229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017CD586F550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017CD586EB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017CD586F650>]}


============================== 10:41:25.896692 | 53b51aee-69b5-4eda-8b3e-f06eb58acc0b ==============================
[0m10:41:25.896692 [info ] [MainThread]: Running with dbt=1.9.4
[0m10:41:25.899172 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'profiles_dir': 'c:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:41:26.002128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53b51aee-69b5-4eda-8b3e-f06eb58acc0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017CD12B0E90>]}
[0m10:41:26.086501 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:41:26.086501 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:41:26.086501 [debug] [MainThread]: Command `cli deps` succeeded at 10:41:26.086501 after 0.28 seconds
[0m10:41:26.086501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017CD54B0410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017CD58781D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017CCFA75150>]}
[0m10:41:26.086501 [debug] [MainThread]: Flushing usage events
[0m10:41:26.287040 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:41:26.520281 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:44:07.274295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000123C4D71610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000123C35DBD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000123C4D71110>]}


============================== 10:44:07.274295 | 765a0672-74a3-4872-995d-407a49d526f9 ==============================
[0m10:44:07.274295 [info ] [MainThread]: Running with dbt=1.9.4
[0m10:44:07.274295 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:44:07.668408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '765a0672-74a3-4872-995d-407a49d526f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000123C61A70D0>]}
[0m10:44:07.715877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '765a0672-74a3-4872-995d-407a49d526f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000123C61310D0>]}
[0m10:45:46.467951 [error] [MainThread]: Encountered an error:

[0m10:45:46.467951 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m10:45:46.483621 [debug] [MainThread]: Command `dbt docs serve` failed at 10:45:46.483621 after 99.26 seconds
[0m10:45:46.485073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000123C4DDE350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000123C4D6B290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000123C0B2D5D0>]}
[0m10:45:46.485133 [debug] [MainThread]: Flushing usage events
[0m10:45:46.934627 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:49:33.822629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002142F473A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002142F46BBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002142F471B90>]}


============================== 10:49:33.838255 | 459a601d-f5c7-4f68-a17f-33ffc7e2b04b ==============================
[0m10:49:33.838255 [info ] [MainThread]: Running with dbt=1.9.4
[0m10:49:33.838255 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:49:34.228921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '459a601d-f5c7-4f68-a17f-33ffc7e2b04b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214307210D0>]}
[0m10:49:34.276103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '459a601d-f5c7-4f68-a17f-33ffc7e2b04b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002142DE4F990>]}
[0m10:49:34.276103 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m10:49:34.574451 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m10:49:34.731310 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:49:34.731310 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:49:34.731310 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.epicaldemo.intermediate
- models.epicaldemo.mart
[0m10:49:34.762546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '459a601d-f5c7-4f68-a17f-33ffc7e2b04b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021430E14AD0>]}
[0m10:49:34.797587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '459a601d-f5c7-4f68-a17f-33ffc7e2b04b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021430BF8190>]}
[0m10:49:34.799828 [info ] [MainThread]: Found 8 models, 8 sources, 476 macros
[0m10:49:34.799828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '459a601d-f5c7-4f68-a17f-33ffc7e2b04b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214306B2D10>]}
[0m10:49:34.799828 [info ] [MainThread]: 
[0m10:49:34.799828 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:49:34.799828 [info ] [MainThread]: 
[0m10:49:34.799828 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:49:34.799828 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m10:49:34.914076 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m10:49:34.914076 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m10:49:34.914076 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:49:35.357720 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.441 seconds
[0m10:49:35.357720 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m10:49:35.357720 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m10:49:35.474513 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.115 seconds
[0m10:49:35.474513 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m10:49:35.474513 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m10:49:35.531612 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.062 seconds
[0m10:49:35.546679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '459a601d-f5c7-4f68-a17f-33ffc7e2b04b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021430E789D0>]}
[0m10:49:35.550684 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__category
[0m10:49:35.551683 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_d365_fo__date
[0m10:49:35.551683 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__category'
[0m10:49:35.552683 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_d365_fo__item
[0m10:49:35.552683 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_d365_fo__manager
[0m10:49:35.553683 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__date'
[0m10:49:35.553683 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__category
[0m10:49:35.554683 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__item'
[0m10:49:35.554683 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__manager'
[0m10:49:35.555682 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_d365_fo__date
[0m10:49:35.561686 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__category"
[0m10:49:35.562687 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_d365_fo__item
[0m10:49:35.563198 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_d365_fo__manager
[0m10:49:35.563198 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__date"
[0m10:49:35.563198 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__item"
[0m10:49:35.563198 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__manager"
[0m10:49:35.563198 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__category
[0m10:49:35.563198 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_d365_fo__date
[0m10:49:35.563198 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__category
[0m10:49:35.563198 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_d365_fo__date
[0m10:49:35.563198 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__store
[0m10:49:35.574703 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_d365_fo__transactions
[0m10:49:35.574703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__category, now model.epicaldemo.stg_d365_fo__store)
[0m10:49:35.574703 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__date, now model.epicaldemo.stg_d365_fo__transactions)
[0m10:49:35.574703 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__store
[0m10:49:35.574703 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_d365_fo__transactions
[0m10:49:35.578709 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__store"
[0m10:49:35.578709 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__transactions"
[0m10:49:35.578709 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__store
[0m10:49:35.578709 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__store
[0m10:49:35.578709 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_inriver__item_attributes
[0m10:49:35.578709 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_d365_fo__item
[0m10:49:35.578709 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_d365_fo__manager
[0m10:49:35.578709 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__store, now model.epicaldemo.stg_inriver__item_attributes)
[0m10:49:35.578709 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_d365_fo__transactions
[0m10:49:35.578709 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_d365_fo__item
[0m10:49:35.578709 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_d365_fo__manager
[0m10:49:35.578709 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_inriver__item_attributes
[0m10:49:35.578709 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_d365_fo__transactions
[0m10:49:35.578709 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_salesforce__customers
[0m10:49:35.578709 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_inriver__item_attributes"
[0m10:49:35.578709 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__item, now model.epicaldemo.stg_salesforce__customers)
[0m10:49:35.578709 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_salesforce__customers
[0m10:49:35.594341 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_salesforce__customers"
[0m10:49:35.594341 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_inriver__item_attributes
[0m10:49:35.594341 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_inriver__item_attributes
[0m10:49:35.594341 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_salesforce__customers
[0m10:49:35.594341 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_salesforce__customers
[0m10:49:35.594341 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:49:35.594341 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m10:49:35.594341 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m10:49:35.656842 [debug] [MainThread]: Connection 'model.epicaldemo.stg_inriver__item_attributes' was properly closed.
[0m10:49:35.656842 [debug] [MainThread]: Connection 'model.epicaldemo.stg_d365_fo__transactions' was properly closed.
[0m10:49:35.656842 [debug] [MainThread]: Connection 'model.epicaldemo.stg_salesforce__customers' was properly closed.
[0m10:49:35.656842 [debug] [MainThread]: Connection 'model.epicaldemo.stg_d365_fo__manager' was properly closed.
[0m10:49:35.656842 [debug] [MainThread]: Command end result
[0m10:49:35.704145 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m10:49:35.704145 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m10:49:35.719768 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m10:49:35.719768 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m10:49:35.719768 [info ] [MainThread]: Building catalog
[0m10:49:35.738434 [debug] [ThreadPool]: Acquiring new snowflake connection 'EPICALDEMO.information_schema'
[0m10:49:35.747059 [debug] [ThreadPool]: Using snowflake connection "EPICALDEMO.information_schema"
[0m10:49:35.747059 [debug] [ThreadPool]: On EPICALDEMO.information_schema: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "EPICALDEMO.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from EPICALDEMO.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'category' and upper("table_name") = upper('category')

                )
             or 
                (
                    
    "table_schema" ilike 'inriver' and upper("table_schema") = upper('inriver')

                    and 
    "table_name" ilike 'item_attributes' and upper("table_name") = upper('item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__store' and upper("table_name") = upper('stg_d365_fo__store')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__date' and upper("table_name") = upper('stg_d365_fo__date')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__item' and upper("table_name") = upper('stg_d365_fo__item')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'date' and upper("table_name") = upper('date')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_inriver__item_attributes' and upper("table_name") = upper('stg_inriver__item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'store' and upper("table_name") = upper('store')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__category' and upper("table_name") = upper('stg_d365_fo__category')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_salesforce__customers' and upper("table_name") = upper('stg_salesforce__customers')

                )
             or 
                (
                    
    "table_schema" ilike 'salesforce' and upper("table_schema") = upper('salesforce')

                    and 
    "table_name" ilike 'customer' and upper("table_name") = upper('customer')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'transactions' and upper("table_name") = upper('transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'item' and upper("table_name") = upper('item')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__manager' and upper("table_name") = upper('stg_d365_fo__manager')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'manager' and upper("table_name") = upper('manager')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__transactions' and upper("table_name") = upper('stg_d365_fo__transactions')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from EPICALDEMO.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'category' and upper("table_name") = upper('category')

                )
             or 
                (
                    
    "table_schema" ilike 'inriver' and upper("table_schema") = upper('inriver')

                    and 
    "table_name" ilike 'item_attributes' and upper("table_name") = upper('item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__store' and upper("table_name") = upper('stg_d365_fo__store')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__date' and upper("table_name") = upper('stg_d365_fo__date')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__item' and upper("table_name") = upper('stg_d365_fo__item')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'date' and upper("table_name") = upper('date')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_inriver__item_attributes' and upper("table_name") = upper('stg_inriver__item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'store' and upper("table_name") = upper('store')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__category' and upper("table_name") = upper('stg_d365_fo__category')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_salesforce__customers' and upper("table_name") = upper('stg_salesforce__customers')

                )
             or 
                (
                    
    "table_schema" ilike 'salesforce' and upper("table_schema") = upper('salesforce')

                    and 
    "table_name" ilike 'customer' and upper("table_name") = upper('customer')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'transactions' and upper("table_name") = upper('transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'item' and upper("table_name") = upper('item')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__manager' and upper("table_name") = upper('stg_d365_fo__manager')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'manager' and upper("table_name") = upper('manager')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__transactions' and upper("table_name") = upper('stg_d365_fo__transactions')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m10:49:35.747059 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:49:43.636456 [debug] [ThreadPool]: SQL status: SUCCESS 59 in 7.887 seconds
[0m10:49:43.652072 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\catalog.json
[0m10:49:43.683270 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m10:49:43.683270 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m10:49:43.689781 [info ] [MainThread]: Catalog written to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\catalog.json
[0m10:49:43.689781 [debug] [MainThread]: Command `dbt docs generate` succeeded at 10:49:43.689781 after 9.91 seconds
[0m10:49:43.689781 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m10:49:43.689781 [debug] [MainThread]: Connection 'EPICALDEMO.information_schema' was left open.
[0m10:49:43.689781 [debug] [MainThread]: On EPICALDEMO.information_schema: Close
[0m10:49:43.745195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002142F4D61D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002142F4D6990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002142B5E7950>]}
[0m10:49:43.745195 [debug] [MainThread]: Flushing usage events
[0m10:49:44.136667 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:49:48.793386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E00D73C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E00D70F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E00D71950>]}


============================== 10:49:48.796893 | 81442324-14f1-419f-aca5-4b6eaaa996bd ==============================
[0m10:49:48.796893 [info ] [MainThread]: Running with dbt=1.9.4
[0m10:49:48.796893 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:49:49.201394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '81442324-14f1-419f-aca5-4b6eaaa996bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E021CEAD0>]}
[0m10:49:49.248350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '81442324-14f1-419f-aca5-4b6eaaa996bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E02131150>]}
[0m10:50:51.848838 [error] [MainThread]: Encountered an error:

[0m10:50:51.858304 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socketserver.py", line 238, in serve_forever
    self._handle_request_noblock()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socketserver.py", line 317, in _handle_request_noblock
    self.process_request(request, client_address)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socketserver.py", line 348, in process_request
    self.finish_request(request, client_address)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socketserver.py", line 361, in finish_request
    self.RequestHandlerClass(request, client_address, self)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\http\server.py", line 671, in __init__
    super().__init__(*args, **kwargs)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socketserver.py", line 755, in __init__
    self.handle()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\http\server.py", line 436, in handle
    self.handle_one_request()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\http\server.py", line 404, in handle_one_request
    self.raw_requestline = self.rfile.readline(65537)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socket.py", line 706, in readinto
    return self._sock.recv_into(b)
           ^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m10:50:51.867409 [debug] [MainThread]: Command `dbt docs serve` failed at 10:50:51.865868 after 63.13 seconds
[0m10:50:51.869915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E00D6B410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E00D71950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E00D72710>]}
[0m10:50:51.874262 [debug] [MainThread]: Flushing usage events
[0m10:50:52.331338 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:07:38.864660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A34F772790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A34F773750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A34F773650>]}


============================== 11:07:38.880288 | 769ab57b-9359-44a9-abff-6598de08afda ==============================
[0m11:07:38.880288 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:07:38.880288 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:07:41.320559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '769ab57b-9359-44a9-abff-6598de08afda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A34DFDA210>]}
[0m11:07:41.367505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '769ab57b-9359-44a9-abff-6598de08afda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A34DF4FA90>]}
[0m11:07:41.367505 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m11:07:41.759836 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:07:41.911291 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m11:07:41.911291 [debug] [MainThread]: Partial parsing: added file: epicaldemo://models\mart\dimensions\dim_customers.sql
[0m11:07:42.044223 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.epicaldemo.dim_customers' (models\mart\dimensions\dim_customers.sql) depends on a node named 'stg_customer' which was not found
[0m11:07:42.044223 [debug] [MainThread]: Command `dbt run` failed at 11:07:42.044223 after 3.25 seconds
[0m11:07:42.044223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A34F7DFFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A350E84710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A34F4951D0>]}
[0m11:07:42.044223 [debug] [MainThread]: Flushing usage events
[0m11:07:42.448834 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:24:27.479438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E84F371990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E84F3739D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E84F371E90>]}


============================== 11:24:27.479438 | bc58a5c4-3dc6-4f73-a38e-617d344f939a ==============================
[0m11:24:27.479438 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:24:27.479438 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:24:29.879750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc58a5c4-3dc6-4f73-a38e-617d344f939a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E84F391410>]}
[0m11:24:29.922911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc58a5c4-3dc6-4f73-a38e-617d344f939a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E850731A10>]}
[0m11:24:29.929937 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m11:24:30.315973 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:24:30.478296 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:24:30.478653 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:24:30.484105 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m11:24:30.506619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc58a5c4-3dc6-4f73-a38e-617d344f939a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E850DD3850>]}
[0m11:24:30.736948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc58a5c4-3dc6-4f73-a38e-617d344f939a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E850CC5F90>]}
[0m11:24:30.736948 [info ] [MainThread]: Found 11 models, 8 sources, 476 macros
[0m11:24:30.737947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc58a5c4-3dc6-4f73-a38e-617d344f939a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E84BFE8D10>]}
[0m11:24:30.739947 [info ] [MainThread]: 
[0m11:24:30.739947 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:24:30.740950 [info ] [MainThread]: 
[0m11:24:30.741915 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:24:30.746597 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m11:24:32.884660 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m11:24:32.884660 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m11:24:32.885661 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:24:33.505655 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.620 seconds
[0m11:24:33.509659 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m11:24:33.510655 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m11:24:33.692864 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bcd2b4-0004-ccb2-0000-d2e900015766
[0m11:24:33.692864 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m11:24:33.695084 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m11:24:33.695084 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m11:24:33.696130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc58a5c4-3dc6-4f73-a38e-617d344f939a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8510FACD0>]}
[0m11:24:33.701126 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__category
[0m11:24:33.702136 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_d365_fo__date
[0m11:24:33.702136 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_d365_fo__item
[0m11:24:33.702136 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_d365_fo__manager
[0m11:24:33.702136 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__category'
[0m11:24:33.703650 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__date'
[0m11:24:33.704669 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__item'
[0m11:24:33.704669 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__manager'
[0m11:24:33.705660 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__category
[0m11:24:33.705660 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_d365_fo__date
[0m11:24:33.706669 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_d365_fo__item
[0m11:24:33.707659 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_d365_fo__manager
[0m11:24:33.713791 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__category"
[0m11:24:33.715791 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__date"
[0m11:24:33.718791 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__item"
[0m11:24:33.720791 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__manager"
[0m11:24:33.721794 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__category
[0m11:24:33.722786 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_d365_fo__date
[0m11:24:33.723782 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__category
[0m11:24:33.723782 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_d365_fo__item
[0m11:24:33.723782 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_d365_fo__manager
[0m11:24:33.724785 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_d365_fo__date
[0m11:24:33.724785 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__store
[0m11:24:33.725793 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_d365_fo__item
[0m11:24:33.726783 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_d365_fo__manager
[0m11:24:33.726783 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_d365_fo__transactions
[0m11:24:33.727784 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__category, now model.epicaldemo.stg_d365_fo__store)
[0m11:24:33.728191 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_inriver__item_attributes
[0m11:24:33.728191 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_salesforce__customer
[0m11:24:33.728191 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__date, now model.epicaldemo.stg_d365_fo__transactions)
[0m11:24:33.728191 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__store
[0m11:24:33.728191 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__item, now model.epicaldemo.stg_inriver__item_attributes)
[0m11:24:33.728191 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__manager, now model.epicaldemo.stg_salesforce__customer)
[0m11:24:33.728191 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_d365_fo__transactions
[0m11:24:33.728191 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__store"
[0m11:24:33.728191 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_inriver__item_attributes
[0m11:24:33.728191 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_salesforce__customer
[0m11:24:33.728191 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__transactions"
[0m11:24:33.728191 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__store
[0m11:24:33.728191 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_inriver__item_attributes"
[0m11:24:33.728191 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_salesforce__customer"
[0m11:24:33.728191 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__store
[0m11:24:33.728191 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_d365_fo__transactions
[0m11:24:33.743817 [debug] [Thread-1 (]: Began running node model.epicaldemo.dim_dates
[0m11:24:33.743817 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_inriver__item_attributes
[0m11:24:33.743817 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_d365_fo__transactions
[0m11:24:33.743817 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_salesforce__customer
[0m11:24:33.743817 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__store, now model.epicaldemo.dim_dates)
[0m11:24:33.743817 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_inriver__item_attributes
[0m11:24:33.743817 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_salesforce__customer
[0m11:24:33.743817 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.dim_dates
[0m11:24:33.743817 [debug] [Thread-2 (]: Began running node model.epicaldemo.dim_items
[0m11:24:33.743817 [debug] [Thread-3 (]: Began running node model.epicaldemo.dim_customers
[0m11:24:33.743817 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.dim_dates"
[0m11:24:33.743817 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__transactions, now model.epicaldemo.dim_items)
[0m11:24:33.743817 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_inriver__item_attributes, now model.epicaldemo.dim_customers)
[0m11:24:33.743817 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.dim_items
[0m11:24:33.743817 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.dim_customers
[0m11:24:33.743817 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.dim_items"
[0m11:24:33.743817 [debug] [Thread-1 (]: Began executing node model.epicaldemo.dim_dates
[0m11:24:33.759442 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.dim_customers"
[0m11:24:33.759442 [debug] [Thread-1 (]: Finished running node model.epicaldemo.dim_dates
[0m11:24:33.761776 [debug] [Thread-2 (]: Began executing node model.epicaldemo.dim_items
[0m11:24:33.762803 [debug] [Thread-2 (]: Finished running node model.epicaldemo.dim_items
[0m11:24:33.763805 [debug] [Thread-3 (]: Began executing node model.epicaldemo.dim_customers
[0m11:24:33.763805 [debug] [Thread-3 (]: Finished running node model.epicaldemo.dim_customers
[0m11:24:33.764803 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:24:33.765803 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m11:24:33.765803 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m11:24:33.810340 [debug] [MainThread]: Connection 'model.epicaldemo.dim_dates' was properly closed.
[0m11:24:33.810340 [debug] [MainThread]: Connection 'model.epicaldemo.dim_items' was properly closed.
[0m11:24:33.810340 [debug] [MainThread]: Connection 'model.epicaldemo.dim_customers' was properly closed.
[0m11:24:33.810340 [debug] [MainThread]: Connection 'model.epicaldemo.stg_salesforce__customer' was properly closed.
[0m11:24:33.810340 [debug] [MainThread]: Command end result
[0m11:24:33.861503 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m11:24:33.877132 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m11:24:33.897197 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m11:24:34.177015 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m11:24:34.177015 [info ] [MainThread]: Building catalog
[0m11:24:34.177015 [debug] [ThreadPool]: Acquiring new snowflake connection 'EPICALDEMO.information_schema'
[0m11:24:34.206888 [debug] [ThreadPool]: Using snowflake connection "EPICALDEMO.information_schema"
[0m11:24:34.207891 [debug] [ThreadPool]: On EPICALDEMO.information_schema: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "EPICALDEMO.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from EPICALDEMO.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__manager' and upper("table_name") = upper('stg_d365_fo__manager')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__transactions' and upper("table_name") = upper('stg_d365_fo__transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__date' and upper("table_name") = upper('stg_d365_fo__date')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'store' and upper("table_name") = upper('store')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'manager' and upper("table_name") = upper('manager')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_salesforce__customer' and upper("table_name") = upper('stg_salesforce__customer')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'category' and upper("table_name") = upper('category')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__store' and upper("table_name") = upper('stg_d365_fo__store')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_inriver__item_attributes' and upper("table_name") = upper('stg_inriver__item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__item' and upper("table_name") = upper('stg_d365_fo__item')

                )
             or 
                (
                    
    "table_schema" ilike 'salesforce' and upper("table_schema") = upper('salesforce')

                    and 
    "table_name" ilike 'customer' and upper("table_name") = upper('customer')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_dates' and upper("table_name") = upper('dim_dates')

                )
             or 
                (
                    
    "table_schema" ilike 'inriver' and upper("table_schema") = upper('inriver')

                    and 
    "table_name" ilike 'item_attributes' and upper("table_name") = upper('item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_items' and upper("table_name") = upper('dim_items')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'item' and upper("table_name") = upper('item')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'date' and upper("table_name") = upper('date')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'transactions' and upper("table_name") = upper('transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__category' and upper("table_name") = upper('stg_d365_fo__category')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_customers' and upper("table_name") = upper('dim_customers')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from EPICALDEMO.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__manager' and upper("table_name") = upper('stg_d365_fo__manager')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__transactions' and upper("table_name") = upper('stg_d365_fo__transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__date' and upper("table_name") = upper('stg_d365_fo__date')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'store' and upper("table_name") = upper('store')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'manager' and upper("table_name") = upper('manager')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_salesforce__customer' and upper("table_name") = upper('stg_salesforce__customer')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'category' and upper("table_name") = upper('category')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__store' and upper("table_name") = upper('stg_d365_fo__store')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_inriver__item_attributes' and upper("table_name") = upper('stg_inriver__item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__item' and upper("table_name") = upper('stg_d365_fo__item')

                )
             or 
                (
                    
    "table_schema" ilike 'salesforce' and upper("table_schema") = upper('salesforce')

                    and 
    "table_name" ilike 'customer' and upper("table_name") = upper('customer')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_dates' and upper("table_name") = upper('dim_dates')

                )
             or 
                (
                    
    "table_schema" ilike 'inriver' and upper("table_schema") = upper('inriver')

                    and 
    "table_name" ilike 'item_attributes' and upper("table_name") = upper('item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_items' and upper("table_name") = upper('dim_items')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'item' and upper("table_name") = upper('item')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'date' and upper("table_name") = upper('date')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'transactions' and upper("table_name") = upper('transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__category' and upper("table_name") = upper('stg_d365_fo__category')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_customers' and upper("table_name") = upper('dim_customers')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m11:24:34.208889 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:24:44.297928 [debug] [ThreadPool]: SQL status: SUCCESS 42 in 10.089 seconds
[0m11:24:44.319451 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\catalog.json
[0m11:24:44.324768 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m11:24:44.341489 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m11:24:44.342240 [info ] [MainThread]: Catalog written to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\catalog.json
[0m11:24:44.343285 [debug] [MainThread]: Command `dbt docs generate` succeeded at 11:24:44.343285 after 16.94 seconds
[0m11:24:44.344290 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m11:24:44.344290 [debug] [MainThread]: Connection 'EPICALDEMO.information_schema' was left open.
[0m11:24:44.345292 [debug] [MainThread]: On EPICALDEMO.information_schema: Close
[0m11:24:44.392256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E84DBDAB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E84F0BA550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E84B714A90>]}
[0m11:24:44.392256 [debug] [MainThread]: Flushing usage events
[0m11:24:44.850508 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:24:50.056175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A411719D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A41170C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A41171CD0>]}


============================== 11:24:50.056175 | 04e57eee-09f9-44f1-8367-bf5d4876d25a ==============================
[0m11:24:50.056175 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:24:50.056175 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:24:50.456231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '04e57eee-09f9-44f1-8367-bf5d4876d25a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A41191F50>]}
[0m11:24:50.502467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '04e57eee-09f9-44f1-8367-bf5d4876d25a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A428B1510>]}
[0m11:26:53.930894 [error] [MainThread]: Encountered an error:

[0m11:26:53.930894 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m11:26:53.946524 [debug] [MainThread]: Command `dbt docs serve` failed at 11:26:53.946524 after 123.95 seconds
[0m11:26:53.948828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A411C8B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A4116B410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A41170C10>]}
[0m11:26:53.949874 [debug] [MainThread]: Flushing usage events
[0m11:26:54.419254 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:38:40.163363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E136C73D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E136C71D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E136C706D0>]}


============================== 12:38:40.174393 | 6c8cce28-9e54-4a29-b170-8830f3824b49 ==============================
[0m12:38:40.174393 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:38:40.175391 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt snapshot -s stores_snapshot', 'send_anonymous_usage_stats': 'True'}
[0m12:38:42.733829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c8cce28-9e54-4a29-b170-8830f3824b49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E137EF1910>]}
[0m12:38:42.784867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c8cce28-9e54-4a29-b170-8830f3824b49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E136CBB750>]}
[0m12:38:42.784867 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m12:38:43.184807 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m12:38:43.381198 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading epicaldemo: stores_snapshot.yml - Runtime Error
    Syntax error near line 3
    ------------------------------
    1  | snapshots:
    2  |   - name: stores_snapshot
    3  |     relation: {{ source('d365_fo', 'store') }}
    4  |     config:
    5  |       schema: broman_analytics
    6  |       database: EPICALDEMO
    
    Raw Error:
    ------------------------------
    while parsing a flow mapping
      in "<unicode string>", line 3, column 16
    did not find expected ',' or '}'
      in "<unicode string>", line 3, column 43
[0m12:38:43.383204 [debug] [MainThread]: Command `dbt snapshot` failed at 12:38:43.383204 after 3.31 seconds
[0m12:38:43.384190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E131072E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E136C70E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E136C72C50>]}
[0m12:38:43.384764 [debug] [MainThread]: Flushing usage events
[0m12:38:43.861284 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:39:14.840707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001203CBB5390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001203CBB55D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001203CD73410>]}


============================== 12:39:14.844211 | 77ee0e0d-6bf5-4dda-8d54-eb174c542dde ==============================
[0m12:39:14.844211 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:39:14.844211 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot -s stores_snapshot', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:39:15.224017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '77ee0e0d-6bf5-4dda-8d54-eb174c542dde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001203CDEA010>]}
[0m12:39:15.273925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '77ee0e0d-6bf5-4dda-8d54-eb174c542dde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001203B581450>]}
[0m12:39:15.273925 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m12:39:15.555955 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m12:39:16.508948 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m12:39:16.509957 [debug] [MainThread]: Partial parsing: added file: epicaldemo://snapshots\stores_snapshot.yml
[0m12:39:16.739337 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m12:39:16.749843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '77ee0e0d-6bf5-4dda-8d54-eb174c542dde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001203EB80350>]}
[0m12:39:16.815851 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m12:39:16.831501 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m12:39:17.046992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '77ee0e0d-6bf5-4dda-8d54-eb174c542dde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001203EF5BE50>]}
[0m12:39:17.046992 [info ] [MainThread]: Found 11 models, 1 snapshot, 8 sources, 476 macros
[0m12:39:17.046992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77ee0e0d-6bf5-4dda-8d54-eb174c542dde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001203EE5C790>]}
[0m12:39:17.055497 [info ] [MainThread]: 
[0m12:39:17.055497 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:39:17.055497 [info ] [MainThread]: 
[0m12:39:17.055497 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:39:17.055497 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m12:39:19.354728 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m12:39:19.354728 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m12:39:19.354728 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:20.100374 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.734 seconds
[0m12:39:20.102373 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_EPICALDEMO, now create_EPICALDEMO_broman_analytics_broman_analytics)
[0m12:39:20.102373 [debug] [ThreadPool]: Creating schema "database: "EPICALDEMO"
schema: "broman_analytics_broman_analytics"
"
[0m12:39:20.105536 [debug] [ThreadPool]: Using snowflake connection "create_EPICALDEMO_broman_analytics_broman_analytics"
[0m12:39:20.105536 [debug] [ThreadPool]: On create_EPICALDEMO_broman_analytics_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "create_EPICALDEMO_broman_analytics_broman_analytics"} */
create schema if not exists EPICALDEMO.broman_analytics_broman_analytics
[0m12:39:20.218106 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.109 seconds
[0m12:39:20.223243 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m12:39:20.224244 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics_broman_analytics'
[0m12:39:20.233242 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m12:39:20.235250 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics_broman_analytics"
[0m12:39:20.236247 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m12:39:20.236247 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m12:39:20.237255 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:20.237255 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:20.509347 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.272 seconds
[0m12:39:20.512483 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m12:39:20.513476 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m12:39:20.615144 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.377 seconds
[0m12:39:20.616144 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics_broman_analytics"
[0m12:39:20.617146 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics_broman_analytics
    limit 10000
    
;
[0m12:39:20.676434 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bcd2ff-0004-ccb2-0000-d2e9000157f2
[0m12:39:20.676434 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m12:39:20.677421 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m12:39:20.678423 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m12:39:20.679423 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.062 seconds
[0m12:39:20.681433 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics_broman_analytics"
[0m12:39:20.681433 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m12:39:20.749349 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.067 seconds
[0m12:39:20.750877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77ee0e0d-6bf5-4dda-8d54-eb174c542dde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001203C6CCA10>]}
[0m12:39:20.755606 [debug] [Thread-1 (]: Began running node snapshot.epicaldemo.stores_snapshot
[0m12:39:20.756645 [info ] [Thread-1 (]: 1 of 1 START snapshot broman_analytics_broman_analytics.stores_snapshot ........ [RUN]
[0m12:39:20.757645 [debug] [Thread-1 (]: Acquiring new snowflake connection 'snapshot.epicaldemo.stores_snapshot'
[0m12:39:20.758645 [debug] [Thread-1 (]: Began compiling node snapshot.epicaldemo.stores_snapshot
[0m12:39:20.764650 [debug] [Thread-1 (]: Began executing node snapshot.epicaldemo.stores_snapshot
[0m12:39:20.823617 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m12:39:20.824622 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id,
        modified as dbt_updated_at,
        modified as dbt_valid_from,
        
  
  coalesce(nullif(modified, modified), date(9999, 12, 31))
  as dbt_valid_to
from (
        select * from EPICALDEMO.d365_fo.store
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m12:39:20.825615 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:39:21.110421 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bcd2ff-0004-ccb2-0000-d2e9000157fe
[0m12:39:21.110421 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000939 (22023): SQL compilation error: error line 13 at position 39
too many arguments for function [DATE(9999, 12, 31)] expected 2, got 3
[0m12:39:21.114421 [debug] [Thread-1 (]: Database Error in snapshot stores_snapshot (snapshots\stores_snapshot.yml)
  000939 (22023): SQL compilation error: error line 13 at position 39
  too many arguments for function [DATE(9999, 12, 31)] expected 2, got 3
[0m12:39:21.122148 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77ee0e0d-6bf5-4dda-8d54-eb174c542dde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001203F26CD50>]}
[0m12:39:21.123182 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting broman_analytics_broman_analytics.stores_snapshot .... [[31mERROR[0m in 0.36s]
[0m12:39:21.124185 [debug] [Thread-1 (]: Finished running node snapshot.epicaldemo.stores_snapshot
[0m12:39:21.125194 [debug] [Thread-7 (]: Marking all children of 'snapshot.epicaldemo.stores_snapshot' to be skipped because of status 'error'.  Reason: Database Error in snapshot stores_snapshot (snapshots\stores_snapshot.yml)
  000939 (22023): SQL compilation error: error line 13 at position 39
  too many arguments for function [DATE(9999, 12, 31)] expected 2, got 3.
[0m12:39:21.127178 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:39:21.127178 [debug] [MainThread]: Connection 'create_EPICALDEMO_broman_analytics_broman_analytics' was left open.
[0m12:39:21.128187 [debug] [MainThread]: On create_EPICALDEMO_broman_analytics_broman_analytics: Close
[0m12:39:21.184969 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m12:39:21.185969 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m12:39:21.239161 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics_broman_analytics' was left open.
[0m12:39:21.239161 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics_broman_analytics: Close
[0m12:39:21.287471 [debug] [MainThread]: Connection 'snapshot.epicaldemo.stores_snapshot' was left open.
[0m12:39:21.287471 [debug] [MainThread]: On snapshot.epicaldemo.stores_snapshot: Close
[0m12:39:21.351011 [info ] [MainThread]: 
[0m12:39:21.351011 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 4.30 seconds (4.30s).
[0m12:39:21.354017 [debug] [MainThread]: Command end result
[0m12:39:21.376780 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m12:39:21.378779 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m12:39:21.384778 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m12:39:21.384778 [info ] [MainThread]: 
[0m12:39:21.385784 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:39:21.386781 [info ] [MainThread]: 
[0m12:39:21.387782 [error] [MainThread]:   Database Error in snapshot stores_snapshot (snapshots\stores_snapshot.yml)
  000939 (22023): SQL compilation error: error line 13 at position 39
  too many arguments for function [DATE(9999, 12, 31)] expected 2, got 3
[0m12:39:21.387782 [info ] [MainThread]: 
[0m12:39:21.388784 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:39:21.389779 [debug] [MainThread]: Command `dbt snapshot` failed at 12:39:21.389779 after 6.61 seconds
[0m12:39:21.390779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012037612E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001203CD67610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001203CD675D0>]}
[0m12:39:21.390779 [debug] [MainThread]: Flushing usage events
[0m12:39:21.775936 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:40:20.101050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025EB1C72990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025EB1CBB490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025EB1CB8A90>]}


============================== 12:40:20.118847 | fa96fd26-1ca6-453e-972e-9fb8487a9e71 ==============================
[0m12:40:20.118847 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:40:20.119887 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt snapshot -s stores_snapshot', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:40:20.499754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fa96fd26-1ca6-453e-972e-9fb8487a9e71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025EB1C72150>]}
[0m12:40:20.551851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fa96fd26-1ca6-453e-972e-9fb8487a9e71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025EB064F9D0>]}
[0m12:40:20.551851 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m12:40:20.864895 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m12:40:21.065746 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:40:21.065746 [debug] [MainThread]: Partial parsing: updated file: epicaldemo://snapshots\stores_snapshot.yml
[0m12:40:21.287717 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m12:40:21.297702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa96fd26-1ca6-453e-972e-9fb8487a9e71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025EB38C9110>]}
[0m12:40:21.362595 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m12:40:21.366609 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m12:40:21.386165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa96fd26-1ca6-453e-972e-9fb8487a9e71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025EB3C5B7D0>]}
[0m12:40:21.387168 [info ] [MainThread]: Found 11 models, 1 snapshot, 8 sources, 476 macros
[0m12:40:21.388165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa96fd26-1ca6-453e-972e-9fb8487a9e71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025EB38D6C50>]}
[0m12:40:21.389171 [info ] [MainThread]: 
[0m12:40:21.390168 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:40:21.391164 [info ] [MainThread]: 
[0m12:40:21.391164 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:40:21.393163 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m12:40:21.467575 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m12:40:21.468333 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m12:40:21.469338 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:40:21.959448 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.491 seconds
[0m12:40:21.965452 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m12:40:21.965452 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics_broman_analytics'
[0m12:40:21.974191 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m12:40:21.977191 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics_broman_analytics"
[0m12:40:21.977191 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m12:40:21.978192 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m12:40:21.978192 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:40:21.979184 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:40:22.239780 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.261 seconds
[0m12:40:22.242780 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m12:40:22.243780 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m12:40:22.318019 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bcd300-0004-ccb2-0000-d2e900015806
[0m12:40:22.318019 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m12:40:22.318019 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m12:40:22.318019 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m12:40:22.381102 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.402 seconds
[0m12:40:22.383115 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics_broman_analytics"
[0m12:40:22.383115 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics_broman_analytics
    limit 10000
    
;
[0m12:40:22.451448 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.069 seconds
[0m12:40:22.451448 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics_broman_analytics"
[0m12:40:22.451448 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m12:40:22.514471 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.060 seconds
[0m12:40:22.516479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa96fd26-1ca6-453e-972e-9fb8487a9e71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025EB3717510>]}
[0m12:40:22.521462 [debug] [Thread-1 (]: Began running node snapshot.epicaldemo.stores_snapshot
[0m12:40:22.522474 [info ] [Thread-1 (]: 1 of 1 START snapshot broman_analytics_broman_analytics.stores_snapshot ........ [RUN]
[0m12:40:22.523463 [debug] [Thread-1 (]: Acquiring new snowflake connection 'snapshot.epicaldemo.stores_snapshot'
[0m12:40:22.523463 [debug] [Thread-1 (]: Began compiling node snapshot.epicaldemo.stores_snapshot
[0m12:40:22.531461 [debug] [Thread-1 (]: Began executing node snapshot.epicaldemo.stores_snapshot
[0m12:40:22.591530 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m12:40:22.591530 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id,
        modified as dbt_updated_at,
        modified as dbt_valid_from,
        
  
  coalesce(nullif(modified, modified), 9999-12-31)
  as dbt_valid_to
from (
        select * from EPICALDEMO.d365_fo.store
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m12:40:22.592514 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:40:22.817718 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bcd300-0004-ccb2-0000-d2e90001580a
[0m12:40:22.817718 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001038 (22023): SQL compilation error:
Can not convert parameter '(9999 - 12) - 31' of type [NUMBER(6,0)] into expected type [DATE]
[0m12:40:22.817718 [debug] [Thread-1 (]: Database Error in snapshot stores_snapshot (snapshots\stores_snapshot.yml)
  001038 (22023): SQL compilation error:
  Can not convert parameter '(9999 - 12) - 31' of type [NUMBER(6,0)] into expected type [DATE]
[0m12:40:22.833354 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa96fd26-1ca6-453e-972e-9fb8487a9e71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025EB2EF0250>]}
[0m12:40:22.833354 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting broman_analytics_broman_analytics.stores_snapshot .... [[31mERROR[0m in 0.29s]
[0m12:40:22.833354 [debug] [Thread-1 (]: Finished running node snapshot.epicaldemo.stores_snapshot
[0m12:40:22.833354 [debug] [Thread-7 (]: Marking all children of 'snapshot.epicaldemo.stores_snapshot' to be skipped because of status 'error'.  Reason: Database Error in snapshot stores_snapshot (snapshots\stores_snapshot.yml)
  001038 (22023): SQL compilation error:
  Can not convert parameter '(9999 - 12) - 31' of type [NUMBER(6,0)] into expected type [DATE].
[0m12:40:22.833354 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:40:22.833354 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m12:40:22.833354 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m12:40:22.884823 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m12:40:22.884823 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m12:40:22.944722 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics_broman_analytics' was left open.
[0m12:40:22.945721 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics_broman_analytics: Close
[0m12:40:23.003429 [debug] [MainThread]: Connection 'snapshot.epicaldemo.stores_snapshot' was left open.
[0m12:40:23.004428 [debug] [MainThread]: On snapshot.epicaldemo.stores_snapshot: Close
[0m12:40:23.056309 [info ] [MainThread]: 
[0m12:40:23.056309 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 1.67 seconds (1.67s).
[0m12:40:23.057310 [debug] [MainThread]: Command end result
[0m12:40:23.079928 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m12:40:23.082927 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m12:40:23.089105 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m12:40:23.089105 [info ] [MainThread]: 
[0m12:40:23.089105 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:40:23.089105 [info ] [MainThread]: 
[0m12:40:23.089105 [error] [MainThread]:   Database Error in snapshot stores_snapshot (snapshots\stores_snapshot.yml)
  001038 (22023): SQL compilation error:
  Can not convert parameter '(9999 - 12) - 31' of type [NUMBER(6,0)] into expected type [DATE]
[0m12:40:23.089105 [info ] [MainThread]: 
[0m12:40:23.089105 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:40:23.089105 [debug] [MainThread]: Command `dbt snapshot` failed at 12:40:23.089105 after 3.04 seconds
[0m12:40:23.089105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025EB1CDE710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025EAC072E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025EB1595290>]}
[0m12:40:23.089105 [debug] [MainThread]: Flushing usage events
[0m12:40:23.537474 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:41:55.848268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A41A72F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A41A73450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A41A73F10>]}


============================== 12:41:55.853089 | 952ce7b6-901e-4ba5-891e-9082c16f6e07 ==============================
[0m12:41:55.853089 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:41:55.854117 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot -s stores_snapshot', 'send_anonymous_usage_stats': 'True'}
[0m12:41:56.235048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '952ce7b6-901e-4ba5-891e-9082c16f6e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A41AE5790>]}
[0m12:41:56.275511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '952ce7b6-901e-4ba5-891e-9082c16f6e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A42C313D0>]}
[0m12:41:56.277513 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m12:41:56.567733 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m12:41:56.752648 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:41:56.752648 [debug] [MainThread]: Partial parsing: updated file: epicaldemo://snapshots\stores_snapshot.yml
[0m12:41:56.967526 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m12:41:56.983952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '952ce7b6-901e-4ba5-891e-9082c16f6e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A43696150>]}
[0m12:41:57.049775 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m12:41:57.053573 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m12:41:57.073561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '952ce7b6-901e-4ba5-891e-9082c16f6e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A43A58210>]}
[0m12:41:57.074565 [info ] [MainThread]: Found 11 models, 1 snapshot, 8 sources, 476 macros
[0m12:41:57.075562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '952ce7b6-901e-4ba5-891e-9082c16f6e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A4377A810>]}
[0m12:41:57.076562 [info ] [MainThread]: 
[0m12:41:57.076562 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:41:57.077574 [info ] [MainThread]: 
[0m12:41:57.078562 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:41:57.079561 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m12:41:57.155005 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m12:41:57.156016 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m12:41:57.156016 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:41:57.689945 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.534 seconds
[0m12:41:57.695945 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m12:41:57.695945 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics_broman_analytics'
[0m12:41:57.706594 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m12:41:57.708589 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics_broman_analytics"
[0m12:41:57.709588 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m12:41:57.709588 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m12:41:57.710589 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:41:57.710589 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:41:58.134677 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.425 seconds
[0m12:41:58.134677 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.425 seconds
[0m12:41:58.134677 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m12:41:58.134677 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics_broman_analytics"
[0m12:41:58.134677 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m12:41:58.134677 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics_broman_analytics
    limit 10000
    
;
[0m12:41:58.201122 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bcd301-0004-ccb2-0000-d2e90001581a
[0m12:41:58.201122 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m12:41:58.201122 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m12:41:58.201122 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m12:41:58.201122 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.071 seconds
[0m12:41:58.201122 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics_broman_analytics"
[0m12:41:58.201122 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m12:41:58.282798 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.069 seconds
[0m12:41:58.286568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '952ce7b6-901e-4ba5-891e-9082c16f6e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A411CCA50>]}
[0m12:41:58.290558 [debug] [Thread-1 (]: Began running node snapshot.epicaldemo.stores_snapshot
[0m12:41:58.291588 [info ] [Thread-1 (]: 1 of 1 START snapshot broman_analytics_broman_analytics.stores_snapshot ........ [RUN]
[0m12:41:58.292558 [debug] [Thread-1 (]: Acquiring new snowflake connection 'snapshot.epicaldemo.stores_snapshot'
[0m12:41:58.292558 [debug] [Thread-1 (]: Began compiling node snapshot.epicaldemo.stores_snapshot
[0m12:41:58.300567 [debug] [Thread-1 (]: Began executing node snapshot.epicaldemo.stores_snapshot
[0m12:41:58.359146 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m12:41:58.360146 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id,
        modified as dbt_updated_at,
        modified as dbt_valid_from,
        
  
  coalesce(nullif(modified, modified), to_date('9999-12-31'))
  as dbt_valid_to
from (
        select * from EPICALDEMO.d365_fo.store
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m12:41:58.360146 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:41:59.018575 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.667 seconds
[0m12:41:59.018575 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m12:41:59.018575 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m12:41:59.085280 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.054 seconds
[0m12:41:59.085280 [warn ] [Thread-1 (]: Data type of snapshot table timestamp columns (TIMESTAMP_NTZ) doesn't match derived column 'updated_at' (DATE). Please update snapshot config 'updated_at'.
[0m12:41:59.085280 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.epicaldemo.stores_snapshot"
[0m12:41:59.085280 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m12:41:59.085280 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
create or replace transient table EPICALDEMO.broman_analytics_broman_analytics.stores_snapshot
    

    
    as (
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id,
        modified as dbt_updated_at,
        modified as dbt_valid_from,
        
  
  coalesce(nullif(modified, modified), to_date('9999-12-31'))
  as dbt_valid_to
from (
        select * from EPICALDEMO.d365_fo.store
    ) sbq



    )
;
[0m12:41:59.799162 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.705 seconds
[0m12:41:59.818392 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '952ce7b6-901e-4ba5-891e-9082c16f6e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A43EF3C50>]}
[0m12:41:59.818392 [info ] [Thread-1 (]: 1 of 1 OK snapshotted broman_analytics_broman_analytics.stores_snapshot ........ [[32mSUCCESS 1[0m in 1.53s]
[0m12:41:59.818392 [debug] [Thread-1 (]: Finished running node snapshot.epicaldemo.stores_snapshot
[0m12:41:59.818392 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:41:59.818392 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m12:41:59.818392 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m12:41:59.874293 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m12:41:59.875294 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m12:41:59.925607 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics_broman_analytics' was left open.
[0m12:41:59.925607 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics_broman_analytics: Close
[0m12:41:59.974461 [debug] [MainThread]: Connection 'snapshot.epicaldemo.stores_snapshot' was left open.
[0m12:41:59.975469 [debug] [MainThread]: On snapshot.epicaldemo.stores_snapshot: Close
[0m12:42:00.031922 [info ] [MainThread]: 
[0m12:42:00.032921 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 2.95 seconds (2.95s).
[0m12:42:00.033923 [debug] [MainThread]: Command end result
[0m12:42:00.052554 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m12:42:00.052554 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m12:42:00.052554 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m12:42:00.052554 [info ] [MainThread]: 
[0m12:42:00.052554 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:42:00.052554 [info ] [MainThread]: 
[0m12:42:00.066461 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:42:00.067484 [debug] [MainThread]: Command `dbt snapshot` succeeded at 12:42:00.067484 after 4.28 seconds
[0m12:42:00.068468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A416B4E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A3BEC1210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A3BE72E10>]}
[0m12:42:00.069469 [debug] [MainThread]: Flushing usage events
[0m12:42:00.466895 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:42:54.944173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFA9073A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFA9071D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFA9073110>]}


============================== 12:42:54.948172 | 3e001dca-ffb7-46b8-86f9-904f7c4fab26 ==============================
[0m12:42:54.948172 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:42:54.949172 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot -s stores_snapshot', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:42:55.335100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e001dca-ffb7-46b8-86f9-904f7c4fab26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFA907BD50>]}
[0m12:42:55.366266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e001dca-ffb7-46b8-86f9-904f7c4fab26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFAA231410>]}
[0m12:42:55.366266 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m12:42:55.668816 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m12:42:55.864696 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:42:55.866135 [debug] [MainThread]: Partial parsing: updated file: epicaldemo://snapshots\stores_snapshot.yml
[0m12:42:56.065895 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m12:42:56.081539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e001dca-ffb7-46b8-86f9-904f7c4fab26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFAABE21D0>]}
[0m12:42:56.150623 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m12:42:56.150623 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m12:42:56.174984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e001dca-ffb7-46b8-86f9-904f7c4fab26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFAB05B650>]}
[0m12:42:56.174984 [info ] [MainThread]: Found 11 models, 1 snapshot, 8 sources, 476 macros
[0m12:42:56.175993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e001dca-ffb7-46b8-86f9-904f7c4fab26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFAACFBF50>]}
[0m12:42:56.176977 [info ] [MainThread]: 
[0m12:42:56.177985 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:42:56.177985 [info ] [MainThread]: 
[0m12:42:56.178976 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:42:56.179977 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m12:42:56.253223 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m12:42:56.254223 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m12:42:56.254223 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:56.748000 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.495 seconds
[0m12:42:56.748000 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_EPICALDEMO, now create_EPICALDEMO_broman_analytics)
[0m12:42:56.748000 [debug] [ThreadPool]: Creating schema "database: "EPICALDEMO"
schema: "broman_analytics"
"
[0m12:42:56.748000 [debug] [ThreadPool]: Using snowflake connection "create_EPICALDEMO_broman_analytics"
[0m12:42:56.748000 [debug] [ThreadPool]: On create_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "create_EPICALDEMO_broman_analytics"} */
create schema if not exists EPICALDEMO.broman_analytics
[0m12:42:56.814678 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.067 seconds
[0m12:42:56.814678 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m12:42:56.837588 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m12:42:56.837588 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m12:42:56.838588 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:57.065666 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.236 seconds
[0m12:42:57.065666 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m12:42:57.065666 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m12:42:57.147973 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.075 seconds
[0m12:42:57.147973 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m12:42:57.147973 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m12:42:57.198858 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.052 seconds
[0m12:42:57.198858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e001dca-ffb7-46b8-86f9-904f7c4fab26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFAACA6210>]}
[0m12:42:57.213861 [debug] [Thread-1 (]: Began running node snapshot.epicaldemo.stores_snapshot
[0m12:42:57.213861 [info ] [Thread-1 (]: 1 of 1 START snapshot broman_analytics.stores_snapshot ......................... [RUN]
[0m12:42:57.213861 [debug] [Thread-1 (]: Acquiring new snowflake connection 'snapshot.epicaldemo.stores_snapshot'
[0m12:42:57.213861 [debug] [Thread-1 (]: Began compiling node snapshot.epicaldemo.stores_snapshot
[0m12:42:57.213861 [debug] [Thread-1 (]: Began executing node snapshot.epicaldemo.stores_snapshot
[0m12:42:57.284262 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m12:42:57.285261 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id,
        modified as dbt_updated_at,
        modified as dbt_valid_from,
        
  
  coalesce(nullif(modified, modified), to_date('9999-12-31'))
  as dbt_valid_to
from (
        select * from EPICALDEMO.d365_fo.store
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m12:42:57.285261 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:42:57.632113 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.360 seconds
[0m12:42:57.647127 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m12:42:57.647127 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m12:42:57.698712 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.048 seconds
[0m12:42:57.698712 [warn ] [Thread-1 (]: Data type of snapshot table timestamp columns (TIMESTAMP_NTZ) doesn't match derived column 'updated_at' (DATE). Please update snapshot config 'updated_at'.
[0m12:42:57.698712 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.epicaldemo.stores_snapshot"
[0m12:42:57.698712 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m12:42:57.698712 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
create or replace transient table EPICALDEMO.broman_analytics.stores_snapshot
    

    
    as (
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id,
        modified as dbt_updated_at,
        modified as dbt_valid_from,
        
  
  coalesce(nullif(modified, modified), to_date('9999-12-31'))
  as dbt_valid_to
from (
        select * from EPICALDEMO.d365_fo.store
    ) sbq



    )
;
[0m12:42:58.365164 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.671 seconds
[0m12:42:58.380796 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e001dca-ffb7-46b8-86f9-904f7c4fab26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFAB8079D0>]}
[0m12:42:58.380796 [info ] [Thread-1 (]: 1 of 1 OK snapshotted broman_analytics.stores_snapshot ......................... [[32mSUCCESS 1[0m in 1.17s]
[0m12:42:58.396478 [debug] [Thread-1 (]: Finished running node snapshot.epicaldemo.stores_snapshot
[0m12:42:58.398637 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:42:58.398637 [debug] [MainThread]: Connection 'create_EPICALDEMO_broman_analytics' was left open.
[0m12:42:58.399685 [debug] [MainThread]: On create_EPICALDEMO_broman_analytics: Close
[0m12:42:58.450376 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m12:42:58.450376 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m12:42:58.514359 [debug] [MainThread]: Connection 'snapshot.epicaldemo.stores_snapshot' was left open.
[0m12:42:58.514359 [debug] [MainThread]: On snapshot.epicaldemo.stores_snapshot: Close
[0m12:42:58.565159 [info ] [MainThread]: 
[0m12:42:58.565159 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 2.39 seconds (2.39s).
[0m12:42:58.565159 [debug] [MainThread]: Command end result
[0m12:42:58.587227 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m12:42:58.587227 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m12:42:58.604637 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m12:42:58.604637 [info ] [MainThread]: 
[0m12:42:58.605648 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:42:58.606638 [info ] [MainThread]: 
[0m12:42:58.606638 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:42:58.607638 [debug] [MainThread]: Command `dbt snapshot` succeeded at 12:42:58.607638 after 3.72 seconds
[0m12:42:58.608637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFA89BA690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFA347CB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFA3472E10>]}
[0m12:42:58.608637 [debug] [MainThread]: Flushing usage events
[0m12:42:59.039754 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:49:57.096701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002233E071190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002233E06BF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002233E071A90>]}


============================== 12:49:57.099703 | aeb5fc17-8eac-480b-9f6f-ff3e015bfd8a ==============================
[0m12:49:57.099703 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:49:57.100703 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m12:49:57.471910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aeb5fc17-8eac-480b-9f6f-ff3e015bfd8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002233F2E7450>]}
[0m12:49:57.523473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aeb5fc17-8eac-480b-9f6f-ff3e015bfd8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002233F3AB4D0>]}
[0m12:49:57.523473 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m12:49:57.824712 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m12:49:57.989899 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:49:57.989899 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:49:58.005524 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m12:49:58.043194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aeb5fc17-8eac-480b-9f6f-ff3e015bfd8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002233FAF3710>]}
[0m12:49:58.077345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aeb5fc17-8eac-480b-9f6f-ff3e015bfd8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002233F3AD010>]}
[0m12:49:58.077345 [info ] [MainThread]: Found 11 models, 1 snapshot, 8 sources, 476 macros
[0m12:49:58.078352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aeb5fc17-8eac-480b-9f6f-ff3e015bfd8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002233FA14950>]}
[0m12:49:58.080341 [info ] [MainThread]: 
[0m12:49:58.081340 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:49:58.081340 [info ] [MainThread]: 
[0m12:49:58.082343 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:49:58.086340 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m12:49:58.175680 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m12:49:58.175680 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m12:49:58.176691 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:49:58.671573 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.495 seconds
[0m12:49:58.674341 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m12:49:58.675338 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m12:49:58.738291 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bcd309-0004-ccf8-0000-d2e90001452e
[0m12:49:58.738291 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m12:49:58.739818 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m12:49:58.739986 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m12:49:58.741013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aeb5fc17-8eac-480b-9f6f-ff3e015bfd8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002233F7E7C50>]}
[0m12:49:58.745012 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__category
[0m12:49:58.745012 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_d365_fo__date
[0m12:49:58.745012 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_d365_fo__item
[0m12:49:58.745012 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_d365_fo__manager
[0m12:49:58.746516 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__category'
[0m12:49:58.746516 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__date'
[0m12:49:58.747530 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__item'
[0m12:49:58.748529 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__manager'
[0m12:49:58.748529 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__category
[0m12:49:58.748529 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_d365_fo__date
[0m12:49:58.749520 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_d365_fo__item
[0m12:49:58.749520 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_d365_fo__manager
[0m12:49:58.755528 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__category"
[0m12:49:58.756363 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__date"
[0m12:49:58.756363 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__item"
[0m12:49:58.756363 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__manager"
[0m12:49:58.756363 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__category
[0m12:49:58.756363 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_d365_fo__date
[0m12:49:58.756363 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__category
[0m12:49:58.756363 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_d365_fo__item
[0m12:49:58.756363 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_d365_fo__manager
[0m12:49:58.756363 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_d365_fo__date
[0m12:49:58.756363 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__transactions
[0m12:49:58.756363 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_d365_fo__item
[0m12:49:58.756363 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_d365_fo__manager
[0m12:49:58.756363 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_inriver__item_attributes
[0m12:49:58.756363 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__category, now model.epicaldemo.stg_d365_fo__transactions)
[0m12:49:58.756363 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_salesforce__customer
[0m12:49:58.756363 [debug] [Thread-4 (]: Began running node snapshot.epicaldemo.stores_snapshot
[0m12:49:58.756363 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__date, now model.epicaldemo.stg_inriver__item_attributes)
[0m12:49:58.771381 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__transactions
[0m12:49:58.771381 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__item, now model.epicaldemo.stg_salesforce__customer)
[0m12:49:58.771381 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__manager, now snapshot.epicaldemo.stores_snapshot)
[0m12:49:58.771381 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_inriver__item_attributes
[0m12:49:58.771381 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__transactions"
[0m12:49:58.771381 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_salesforce__customer
[0m12:49:58.771381 [debug] [Thread-4 (]: Began compiling node snapshot.epicaldemo.stores_snapshot
[0m12:49:58.771381 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_inriver__item_attributes"
[0m12:49:58.771381 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_salesforce__customer"
[0m12:49:58.771381 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__transactions
[0m12:49:58.771381 [debug] [Thread-4 (]: Began executing node snapshot.epicaldemo.stores_snapshot
[0m12:49:58.771381 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__transactions
[0m12:49:58.771381 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_inriver__item_attributes
[0m12:49:58.787020 [debug] [Thread-4 (]: Finished running node snapshot.epicaldemo.stores_snapshot
[0m12:49:58.787020 [debug] [Thread-1 (]: Began running node model.epicaldemo.dim_dates
[0m12:49:58.787020 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_salesforce__customer
[0m12:49:58.787020 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_inriver__item_attributes
[0m12:49:58.789930 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_d365_fo__store
[0m12:49:58.789930 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__transactions, now model.epicaldemo.dim_dates)
[0m12:49:58.790971 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_salesforce__customer
[0m12:49:58.790971 [debug] [Thread-2 (]: Began running node model.epicaldemo.dim_items
[0m12:49:58.791972 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly snapshot.epicaldemo.stores_snapshot, now model.epicaldemo.stg_d365_fo__store)
[0m12:49:58.791972 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.dim_dates
[0m12:49:58.792983 [debug] [Thread-3 (]: Began running node model.epicaldemo.dim_customers
[0m12:49:58.792983 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_inriver__item_attributes, now model.epicaldemo.dim_items)
[0m12:49:58.793972 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_d365_fo__store
[0m12:49:58.795979 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.dim_dates"
[0m12:49:58.796979 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_salesforce__customer, now model.epicaldemo.dim_customers)
[0m12:49:58.796979 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.dim_items
[0m12:49:58.799979 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__store"
[0m12:49:58.799979 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.dim_customers
[0m12:49:58.802980 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.dim_items"
[0m12:49:58.803980 [debug] [Thread-1 (]: Began executing node model.epicaldemo.dim_dates
[0m12:49:58.806532 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.dim_customers"
[0m12:49:58.806532 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_d365_fo__store
[0m12:49:58.807568 [debug] [Thread-1 (]: Finished running node model.epicaldemo.dim_dates
[0m12:49:58.808555 [debug] [Thread-2 (]: Began executing node model.epicaldemo.dim_items
[0m12:49:58.809555 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_d365_fo__store
[0m12:49:58.809555 [debug] [Thread-3 (]: Began executing node model.epicaldemo.dim_customers
[0m12:49:58.810557 [debug] [Thread-2 (]: Finished running node model.epicaldemo.dim_items
[0m12:49:58.811556 [debug] [Thread-3 (]: Finished running node model.epicaldemo.dim_customers
[0m12:49:58.812556 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:49:58.812556 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m12:49:58.813555 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m12:49:58.874044 [debug] [MainThread]: Connection 'model.epicaldemo.dim_dates' was properly closed.
[0m12:49:58.875044 [debug] [MainThread]: Connection 'model.epicaldemo.dim_items' was properly closed.
[0m12:49:58.875044 [debug] [MainThread]: Connection 'model.epicaldemo.dim_customers' was properly closed.
[0m12:49:58.876044 [debug] [MainThread]: Connection 'model.epicaldemo.stg_d365_fo__store' was properly closed.
[0m12:49:58.878050 [debug] [MainThread]: Command end result
[0m12:49:58.940857 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m12:49:58.944856 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m12:49:58.951373 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m12:49:59.222952 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m12:49:59.222952 [info ] [MainThread]: Building catalog
[0m12:49:59.238578 [debug] [ThreadPool]: Acquiring new snowflake connection 'EPICALDEMO.information_schema'
[0m12:49:59.259178 [debug] [ThreadPool]: Using snowflake connection "EPICALDEMO.information_schema"
[0m12:49:59.260172 [debug] [ThreadPool]: On EPICALDEMO.information_schema: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "EPICALDEMO.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from EPICALDEMO.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'salesforce' and upper("table_schema") = upper('salesforce')

                    and 
    "table_name" ilike 'customer' and upper("table_name") = upper('customer')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'date' and upper("table_name") = upper('date')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__manager' and upper("table_name") = upper('stg_d365_fo__manager')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'transactions' and upper("table_name") = upper('transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_items' and upper("table_name") = upper('dim_items')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_salesforce__customer' and upper("table_name") = upper('stg_salesforce__customer')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'category' and upper("table_name") = upper('category')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__store' and upper("table_name") = upper('stg_d365_fo__store')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'item' and upper("table_name") = upper('item')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__item' and upper("table_name") = upper('stg_d365_fo__item')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'store' and upper("table_name") = upper('store')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_dates' and upper("table_name") = upper('dim_dates')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__category' and upper("table_name") = upper('stg_d365_fo__category')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__date' and upper("table_name") = upper('stg_d365_fo__date')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_customers' and upper("table_name") = upper('dim_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stores_snapshot' and upper("table_name") = upper('stores_snapshot')

                )
             or 
                (
                    
    "table_schema" ilike 'inriver' and upper("table_schema") = upper('inriver')

                    and 
    "table_name" ilike 'item_attributes' and upper("table_name") = upper('item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_inriver__item_attributes' and upper("table_name") = upper('stg_inriver__item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'manager' and upper("table_name") = upper('manager')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__transactions' and upper("table_name") = upper('stg_d365_fo__transactions')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from EPICALDEMO.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'salesforce' and upper("table_schema") = upper('salesforce')

                    and 
    "table_name" ilike 'customer' and upper("table_name") = upper('customer')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'date' and upper("table_name") = upper('date')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__manager' and upper("table_name") = upper('stg_d365_fo__manager')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'transactions' and upper("table_name") = upper('transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_items' and upper("table_name") = upper('dim_items')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_salesforce__customer' and upper("table_name") = upper('stg_salesforce__customer')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'category' and upper("table_name") = upper('category')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__store' and upper("table_name") = upper('stg_d365_fo__store')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'item' and upper("table_name") = upper('item')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__item' and upper("table_name") = upper('stg_d365_fo__item')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'store' and upper("table_name") = upper('store')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_dates' and upper("table_name") = upper('dim_dates')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__category' and upper("table_name") = upper('stg_d365_fo__category')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__date' and upper("table_name") = upper('stg_d365_fo__date')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_customers' and upper("table_name") = upper('dim_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stores_snapshot' and upper("table_name") = upper('stores_snapshot')

                )
             or 
                (
                    
    "table_schema" ilike 'inriver' and upper("table_schema") = upper('inriver')

                    and 
    "table_name" ilike 'item_attributes' and upper("table_name") = upper('item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_inriver__item_attributes' and upper("table_name") = upper('stg_inriver__item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'manager' and upper("table_name") = upper('manager')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__transactions' and upper("table_name") = upper('stg_d365_fo__transactions')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m12:49:59.261170 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:50:09.170635 [debug] [ThreadPool]: SQL status: SUCCESS 42 in 9.910 seconds
[0m12:50:09.186123 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\catalog.json
[0m12:50:09.201760 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m12:50:09.201760 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m12:50:09.201760 [info ] [MainThread]: Catalog written to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\catalog.json
[0m12:50:09.201760 [debug] [MainThread]: Command `dbt docs generate` succeeded at 12:50:09.201760 after 12.18 seconds
[0m12:50:09.217392 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m12:50:09.217392 [debug] [MainThread]: Connection 'EPICALDEMO.information_schema' was left open.
[0m12:50:09.217392 [debug] [MainThread]: On EPICALDEMO.information_schema: Close
[0m12:50:09.301179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002233E072D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002233E0726D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002233B114910>]}
[0m12:50:09.302181 [debug] [MainThread]: Flushing usage events
[0m12:50:09.756952 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:50:14.933171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001548A571B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001548A571CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001548A570890>]}


============================== 12:50:14.933171 | b2ccf00e-288f-4a41-b9ac-d97bba69445c ==============================
[0m12:50:14.933171 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:50:14.933171 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:50:15.333603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2ccf00e-288f-4a41-b9ac-d97bba69445c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000154867BEC90>]}
[0m12:50:15.373641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b2ccf00e-288f-4a41-b9ac-d97bba69445c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015488D577D0>]}
[0m12:54:35.687994 [error] [MainThread]: Encountered an error:

[0m12:54:35.722318 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m12:54:35.722318 [debug] [MainThread]: Command `dbt docs serve` failed at 12:54:35.722318 after 260.85 seconds
[0m12:54:35.722318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001548A5D4BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001548A593B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001548A590C10>]}
[0m12:54:35.722318 [debug] [MainThread]: Flushing usage events
[0m12:54:36.136270 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:56:52.818586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297669719D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029766970690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029766970AD0>]}


============================== 12:56:52.830593 | 502cd676-5cf5-42f8-bb85-ebfd796c8df4 ==============================
[0m12:56:52.830593 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:56:52.831585 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m12:56:55.136508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '502cd676-5cf5-42f8-bb85-ebfd796c8df4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002976698D650>]}
[0m12:56:55.164550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '502cd676-5cf5-42f8-bb85-ebfd796c8df4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297669BAE50>]}
[0m12:56:55.185475 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m12:56:55.554073 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m12:56:55.715477 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:56:55.715477 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:56:55.731103 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m12:56:55.768142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '502cd676-5cf5-42f8-bb85-ebfd796c8df4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029768273510>]}
[0m12:56:55.959759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '502cd676-5cf5-42f8-bb85-ebfd796c8df4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002976698F3D0>]}
[0m12:56:55.960758 [info ] [MainThread]: Found 13 models, 1 snapshot, 8 sources, 476 macros
[0m12:56:55.961759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '502cd676-5cf5-42f8-bb85-ebfd796c8df4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297682FAF10>]}
[0m12:56:55.963759 [info ] [MainThread]: 
[0m12:56:55.964759 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:56:55.965408 [info ] [MainThread]: 
[0m12:56:55.965515 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:56:55.970550 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m12:56:58.029709 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m12:56:58.029709 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m12:56:58.029709 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:56:58.691339 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.655 seconds
[0m12:56:58.695339 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m12:56:58.696338 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m12:56:58.840112 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bcd310-0004-ccf8-0000-d2e90001454e
[0m12:56:58.841113 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m12:56:58.842112 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m12:56:58.843116 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m12:56:58.844114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '502cd676-5cf5-42f8-bb85-ebfd796c8df4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297680A7050>]}
[0m12:56:58.848898 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__categories
[0m12:56:58.848898 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_d365_fo__dates
[0m12:56:58.849897 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_d365_fo__items
[0m12:56:58.849897 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_d365_fo__managers
[0m12:56:58.850897 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__categories'
[0m12:56:58.851900 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__dates'
[0m12:56:58.851900 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__items'
[0m12:56:58.852904 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__managers'
[0m12:56:58.853900 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__categories
[0m12:56:58.853900 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_d365_fo__dates
[0m12:56:58.854898 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_d365_fo__items
[0m12:56:58.854898 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_d365_fo__managers
[0m12:56:58.860905 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__categories"
[0m12:56:58.863898 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__dates"
[0m12:56:58.864383 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__items"
[0m12:56:58.864383 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__managers"
[0m12:56:58.864383 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__categories
[0m12:56:58.864383 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_d365_fo__dates
[0m12:56:58.864383 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__categories
[0m12:56:58.864383 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_d365_fo__items
[0m12:56:58.864383 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_d365_fo__managers
[0m12:56:58.864383 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_d365_fo__dates
[0m12:56:58.864383 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__transactions
[0m12:56:58.864383 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_d365_fo__items
[0m12:56:58.864383 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_d365_fo__managers
[0m12:56:58.864383 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_inriver__item_attributes
[0m12:56:58.864383 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__categories, now model.epicaldemo.stg_d365_fo__transactions)
[0m12:56:58.864383 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_salesforce__customers
[0m12:56:58.864383 [debug] [Thread-4 (]: Began running node snapshot.epicaldemo.stores_snapshot
[0m12:56:58.864383 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__dates, now model.epicaldemo.stg_inriver__item_attributes)
[0m12:56:58.864383 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__transactions
[0m12:56:58.864383 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__items, now model.epicaldemo.stg_salesforce__customers)
[0m12:56:58.864383 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__managers, now snapshot.epicaldemo.stores_snapshot)
[0m12:56:58.880012 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_inriver__item_attributes
[0m12:56:58.883233 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__transactions"
[0m12:56:58.884233 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_salesforce__customers
[0m12:56:58.884233 [debug] [Thread-4 (]: Began compiling node snapshot.epicaldemo.stores_snapshot
[0m12:56:58.886233 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_inriver__item_attributes"
[0m12:56:58.889237 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_salesforce__customers"
[0m12:56:58.891237 [debug] [Thread-4 (]: Began executing node snapshot.epicaldemo.stores_snapshot
[0m12:56:58.892237 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__transactions
[0m12:56:58.893237 [debug] [Thread-4 (]: Finished running node snapshot.epicaldemo.stores_snapshot
[0m12:56:58.893237 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_inriver__item_attributes
[0m12:56:58.894236 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__transactions
[0m12:56:58.894236 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_salesforce__customers
[0m12:56:58.894236 [debug] [Thread-4 (]: Began running node model.epicaldemo.dim_dates
[0m12:56:58.895237 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_inriver__item_attributes
[0m12:56:58.896237 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__stores
[0m12:56:58.896237 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_salesforce__customers
[0m12:56:58.897238 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly snapshot.epicaldemo.stores_snapshot, now model.epicaldemo.dim_dates)
[0m12:56:58.897925 [debug] [Thread-2 (]: Began running node model.epicaldemo.dim_items
[0m12:56:58.897925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__transactions, now model.epicaldemo.stg_d365_fo__stores)
[0m12:56:58.898955 [debug] [Thread-3 (]: Began running node model.epicaldemo.dim_customers
[0m12:56:58.898955 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.dim_dates
[0m12:56:58.899955 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_inriver__item_attributes, now model.epicaldemo.dim_items)
[0m12:56:58.899955 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__stores
[0m12:56:58.899955 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_salesforce__customers, now model.epicaldemo.dim_customers)
[0m12:56:58.902459 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.dim_dates"
[0m12:56:58.903464 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.dim_items
[0m12:56:58.905464 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__stores"
[0m12:56:58.906464 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.dim_customers
[0m12:56:58.909464 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.dim_items"
[0m12:56:58.909464 [debug] [Thread-4 (]: Began executing node model.epicaldemo.dim_dates
[0m12:56:58.911464 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.dim_customers"
[0m12:56:58.912480 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__stores
[0m12:56:58.913465 [debug] [Thread-4 (]: Finished running node model.epicaldemo.dim_dates
[0m12:56:58.913465 [debug] [Thread-2 (]: Began executing node model.epicaldemo.dim_items
[0m12:56:58.914327 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__stores
[0m12:56:58.914327 [debug] [Thread-3 (]: Began executing node model.epicaldemo.dim_customers
[0m12:56:58.914327 [debug] [Thread-2 (]: Finished running node model.epicaldemo.dim_items
[0m12:56:58.914327 [debug] [Thread-4 (]: Began running node model.epicaldemo.dim_stores
[0m12:56:58.914327 [debug] [Thread-1 (]: Began running node model.epicaldemo.fact_sales_transactions
[0m12:56:58.914327 [debug] [Thread-3 (]: Finished running node model.epicaldemo.dim_customers
[0m12:56:58.914327 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.dim_dates, now model.epicaldemo.dim_stores)
[0m12:56:58.914327 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__stores, now model.epicaldemo.fact_sales_transactions)
[0m12:56:58.914327 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.dim_stores
[0m12:56:58.914327 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.fact_sales_transactions
[0m12:56:58.914327 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.dim_stores"
[0m12:56:58.914327 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.fact_sales_transactions"
[0m12:56:58.914327 [debug] [Thread-4 (]: Began executing node model.epicaldemo.dim_stores
[0m12:56:58.914327 [debug] [Thread-4 (]: Finished running node model.epicaldemo.dim_stores
[0m12:56:58.914327 [debug] [Thread-1 (]: Began executing node model.epicaldemo.fact_sales_transactions
[0m12:56:58.914327 [debug] [Thread-1 (]: Finished running node model.epicaldemo.fact_sales_transactions
[0m12:56:58.929332 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:56:58.930366 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m12:56:58.930366 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m12:56:58.981026 [debug] [MainThread]: Connection 'model.epicaldemo.fact_sales_transactions' was properly closed.
[0m12:56:58.981026 [debug] [MainThread]: Connection 'model.epicaldemo.dim_items' was properly closed.
[0m12:56:58.981026 [debug] [MainThread]: Connection 'model.epicaldemo.dim_customers' was properly closed.
[0m12:56:58.981026 [debug] [MainThread]: Connection 'model.epicaldemo.dim_stores' was properly closed.
[0m12:56:58.981026 [debug] [MainThread]: Command end result
[0m12:56:59.047608 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m12:56:59.063233 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m12:56:59.063233 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m12:56:59.380863 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m12:56:59.396367 [info ] [MainThread]: Building catalog
[0m12:56:59.402883 [debug] [ThreadPool]: Acquiring new snowflake connection 'EPICALDEMO.information_schema'
[0m12:56:59.423260 [debug] [ThreadPool]: Using snowflake connection "EPICALDEMO.information_schema"
[0m12:56:59.424265 [debug] [ThreadPool]: On EPICALDEMO.information_schema: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "EPICALDEMO.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from EPICALDEMO.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'fact_sales_transactions' and upper("table_name") = upper('fact_sales_transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__stores' and upper("table_name") = upper('stg_d365_fo__stores')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__transactions' and upper("table_name") = upper('stg_d365_fo__transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_customers' and upper("table_name") = upper('dim_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__dates' and upper("table_name") = upper('stg_d365_fo__dates')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_dates' and upper("table_name") = upper('dim_dates')

                )
             or 
                (
                    
    "table_schema" ilike 'salesforce' and upper("table_schema") = upper('salesforce')

                    and 
    "table_name" ilike 'customer' and upper("table_name") = upper('customer')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_stores' and upper("table_name") = upper('dim_stores')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'item' and upper("table_name") = upper('item')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_salesforce__customers' and upper("table_name") = upper('stg_salesforce__customers')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'store' and upper("table_name") = upper('store')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'category' and upper("table_name") = upper('category')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_items' and upper("table_name") = upper('dim_items')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'date' and upper("table_name") = upper('date')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'transactions' and upper("table_name") = upper('transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__items' and upper("table_name") = upper('stg_d365_fo__items')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stores_snapshot' and upper("table_name") = upper('stores_snapshot')

                )
             or 
                (
                    
    "table_schema" ilike 'inriver' and upper("table_schema") = upper('inriver')

                    and 
    "table_name" ilike 'item_attributes' and upper("table_name") = upper('item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__categories' and upper("table_name") = upper('stg_d365_fo__categories')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__managers' and upper("table_name") = upper('stg_d365_fo__managers')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'manager' and upper("table_name") = upper('manager')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_inriver__item_attributes' and upper("table_name") = upper('stg_inriver__item_attributes')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from EPICALDEMO.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'fact_sales_transactions' and upper("table_name") = upper('fact_sales_transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__stores' and upper("table_name") = upper('stg_d365_fo__stores')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__transactions' and upper("table_name") = upper('stg_d365_fo__transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_customers' and upper("table_name") = upper('dim_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__dates' and upper("table_name") = upper('stg_d365_fo__dates')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_dates' and upper("table_name") = upper('dim_dates')

                )
             or 
                (
                    
    "table_schema" ilike 'salesforce' and upper("table_schema") = upper('salesforce')

                    and 
    "table_name" ilike 'customer' and upper("table_name") = upper('customer')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_stores' and upper("table_name") = upper('dim_stores')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'item' and upper("table_name") = upper('item')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_salesforce__customers' and upper("table_name") = upper('stg_salesforce__customers')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'store' and upper("table_name") = upper('store')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'category' and upper("table_name") = upper('category')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_items' and upper("table_name") = upper('dim_items')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'date' and upper("table_name") = upper('date')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'transactions' and upper("table_name") = upper('transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__items' and upper("table_name") = upper('stg_d365_fo__items')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stores_snapshot' and upper("table_name") = upper('stores_snapshot')

                )
             or 
                (
                    
    "table_schema" ilike 'inriver' and upper("table_schema") = upper('inriver')

                    and 
    "table_name" ilike 'item_attributes' and upper("table_name") = upper('item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__categories' and upper("table_name") = upper('stg_d365_fo__categories')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__managers' and upper("table_name") = upper('stg_d365_fo__managers')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'manager' and upper("table_name") = upper('manager')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_inriver__item_attributes' and upper("table_name") = upper('stg_inriver__item_attributes')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m12:56:59.424265 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:09.272958 [debug] [ThreadPool]: SQL status: SUCCESS 42 in 9.849 seconds
[0m12:57:09.293025 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\catalog.json
[0m12:57:09.323037 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m12:57:09.326039 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m12:57:09.327042 [info ] [MainThread]: Catalog written to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\catalog.json
[0m12:57:09.327830 [debug] [MainThread]: Command `dbt docs generate` succeeded at 12:57:09.327830 after 16.57 seconds
[0m12:57:09.328882 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m12:57:09.328882 [debug] [MainThread]: Connection 'EPICALDEMO.information_schema' was left open.
[0m12:57:09.329879 [debug] [MainThread]: On EPICALDEMO.information_schema: Close
[0m12:57:09.389486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297662FA5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297669E6D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029762D14CD0>]}
[0m12:57:09.390484 [debug] [MainThread]: Flushing usage events
[0m12:57:09.847539 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:57:18.435054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A6436BE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A60457A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A64393C90>]}


============================== 12:57:18.438052 | ef170b37-94c4-4918-b839-375b78e357cd ==============================
[0m12:57:18.438052 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:57:18.439044 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt docs serve', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:57:18.832382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef170b37-94c4-4918-b839-375b78e357cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A65A1E2D0>]}
[0m12:57:18.875315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef170b37-94c4-4918-b839-375b78e357cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A6577E790>]}
[0m13:00:36.871968 [error] [MainThread]: Encountered an error:

[0m13:00:36.876066 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m13:00:36.879068 [debug] [MainThread]: Command `dbt docs serve` failed at 13:00:36.879068 after 198.50 seconds
[0m13:00:36.880056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A643BF910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A643BD150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A643BE5D0>]}
[0m13:00:36.881064 [debug] [MainThread]: Flushing usage events
[0m13:00:37.283942 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:00:44.262664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3BEF6E3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3BEF62F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3BEF63410>]}


============================== 23:00:44.267710 | 2026aea0-05d2-4cd6-801d-214936fa7cf4 ==============================
[0m23:00:44.267710 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:00:44.268711 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'c:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'log_path': 'c:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:00:44.366862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2026aea0-05d2-4cd6-801d-214936fa7cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3BF45BB50>]}
[0m23:00:44.466771 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:00:44.468764 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:00:44.470640 [debug] [MainThread]: Command `cli deps` succeeded at 23:00:44.470640 after 0.29 seconds
[0m23:00:44.471049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3BCEAD7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3B9374E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3B9374DD0>]}
[0m23:00:44.472082 [debug] [MainThread]: Flushing usage events
[0m23:00:44.935912 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:01:38.960036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002888188FF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028881873FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028881873350>]}


============================== 23:01:38.960036 | 67a31696-d5f4-43f1-a6a5-2263a3edb3fe ==============================
[0m23:01:38.960036 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:01:38.975661 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:01:41.201599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '67a31696-d5f4-43f1-a6a5-2263a3edb3fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028882E0FF90>]}
[0m23:01:41.248477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '67a31696-d5f4-43f1-a6a5-2263a3edb3fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028882B3E790>]}
[0m23:01:41.248477 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m23:01:41.674151 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:01:42.690895 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:01:42.690895 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:01:42.706528 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m23:01:42.741809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '67a31696-d5f4-43f1-a6a5-2263a3edb3fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028882BA37D0>]}
[0m23:01:42.930252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '67a31696-d5f4-43f1-a6a5-2263a3edb3fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288830C0C50>]}
[0m23:01:42.930252 [info ] [MainThread]: Found 13 models, 1 snapshot, 8 sources, 476 macros
[0m23:01:42.930252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67a31696-d5f4-43f1-a6a5-2263a3edb3fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028880FA17D0>]}
[0m23:01:42.945877 [info ] [MainThread]: 
[0m23:01:42.945877 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:01:42.945877 [info ] [MainThread]: 
[0m23:01:42.945877 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:01:42.945877 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m23:01:45.135928 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m23:01:45.135928 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m23:01:45.135928 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:01:46.376404 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.230 seconds
[0m23:01:46.376404 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m23:01:46.376404 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m23:01:46.533606 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bcebed-0004-cd7b-0000-d2e90001c02a
[0m23:01:46.533606 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m23:01:46.533606 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m23:01:46.533606 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m23:01:46.549232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67a31696-d5f4-43f1-a6a5-2263a3edb3fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028882E580D0>]}
[0m23:01:46.549232 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__categories
[0m23:01:46.549232 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_d365_fo__dates
[0m23:01:46.549232 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_d365_fo__items
[0m23:01:46.549232 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_d365_fo__managers
[0m23:01:46.549232 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__categories'
[0m23:01:46.549232 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__dates'
[0m23:01:46.549232 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__items'
[0m23:01:46.549232 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__managers'
[0m23:01:46.549232 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__categories
[0m23:01:46.549232 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_d365_fo__dates
[0m23:01:46.549232 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_d365_fo__items
[0m23:01:46.549232 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_d365_fo__managers
[0m23:01:46.564858 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__categories"
[0m23:01:46.564858 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__dates"
[0m23:01:46.564858 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__items"
[0m23:01:46.564858 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__managers"
[0m23:01:46.564858 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__categories
[0m23:01:46.564858 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__categories
[0m23:01:46.564858 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__transactions
[0m23:01:46.564858 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_d365_fo__dates
[0m23:01:46.564858 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_d365_fo__managers
[0m23:01:46.580484 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__categories, now model.epicaldemo.stg_d365_fo__transactions)
[0m23:01:46.580484 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_d365_fo__items
[0m23:01:46.580484 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_d365_fo__dates
[0m23:01:46.580484 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_d365_fo__managers
[0m23:01:46.580484 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__transactions
[0m23:01:46.580484 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_d365_fo__items
[0m23:01:46.580484 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_inriver__item_attributes
[0m23:01:46.580484 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_salesforce__customers
[0m23:01:46.580484 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__transactions"
[0m23:01:46.580484 [debug] [Thread-3 (]: Began running node snapshot.epicaldemo.stores_snapshot
[0m23:01:46.580484 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__dates, now model.epicaldemo.stg_inriver__item_attributes)
[0m23:01:46.580484 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__managers, now model.epicaldemo.stg_salesforce__customers)
[0m23:01:46.580484 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__items, now snapshot.epicaldemo.stores_snapshot)
[0m23:01:46.580484 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_inriver__item_attributes
[0m23:01:46.589989 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__transactions
[0m23:01:46.589989 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_salesforce__customers
[0m23:01:46.589989 [debug] [Thread-3 (]: Began compiling node snapshot.epicaldemo.stores_snapshot
[0m23:01:46.589989 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_inriver__item_attributes"
[0m23:01:46.589989 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__transactions
[0m23:01:46.589989 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_salesforce__customers"
[0m23:01:46.596495 [debug] [Thread-3 (]: Began executing node snapshot.epicaldemo.stores_snapshot
[0m23:01:46.596495 [debug] [Thread-1 (]: Began running node model.epicaldemo.dim_dates
[0m23:01:46.596495 [debug] [Thread-3 (]: Finished running node snapshot.epicaldemo.stores_snapshot
[0m23:01:46.596495 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_inriver__item_attributes
[0m23:01:46.596495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__transactions, now model.epicaldemo.dim_dates)
[0m23:01:46.596495 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_salesforce__customers
[0m23:01:46.596495 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_d365_fo__stores
[0m23:01:46.596495 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_inriver__item_attributes
[0m23:01:46.596495 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.dim_dates
[0m23:01:46.596495 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_salesforce__customers
[0m23:01:46.596495 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly snapshot.epicaldemo.stores_snapshot, now model.epicaldemo.stg_d365_fo__stores)
[0m23:01:46.596495 [debug] [Thread-2 (]: Began running node model.epicaldemo.dim_items
[0m23:01:46.596495 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.dim_dates"
[0m23:01:46.596495 [debug] [Thread-4 (]: Began running node model.epicaldemo.dim_customers
[0m23:01:46.596495 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_d365_fo__stores
[0m23:01:46.596495 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_inriver__item_attributes, now model.epicaldemo.dim_items)
[0m23:01:46.596495 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_salesforce__customers, now model.epicaldemo.dim_customers)
[0m23:01:46.596495 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__stores"
[0m23:01:46.612128 [debug] [Thread-1 (]: Began executing node model.epicaldemo.dim_dates
[0m23:01:46.596495 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.dim_items
[0m23:01:46.612128 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.dim_customers
[0m23:01:46.612128 [debug] [Thread-1 (]: Finished running node model.epicaldemo.dim_dates
[0m23:01:46.612128 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.dim_items"
[0m23:01:46.612128 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_d365_fo__stores
[0m23:01:46.612128 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.dim_customers"
[0m23:01:46.612128 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_d365_fo__stores
[0m23:01:46.612128 [debug] [Thread-2 (]: Began executing node model.epicaldemo.dim_items
[0m23:01:46.612128 [debug] [Thread-1 (]: Began running node model.epicaldemo.dim_stores
[0m23:01:46.612128 [debug] [Thread-3 (]: Began running node model.epicaldemo.fact_sales_transactions
[0m23:01:46.612128 [debug] [Thread-2 (]: Finished running node model.epicaldemo.dim_items
[0m23:01:46.612128 [debug] [Thread-4 (]: Began executing node model.epicaldemo.dim_customers
[0m23:01:46.612128 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.dim_dates, now model.epicaldemo.dim_stores)
[0m23:01:46.612128 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__stores, now model.epicaldemo.fact_sales_transactions)
[0m23:01:46.612128 [debug] [Thread-4 (]: Finished running node model.epicaldemo.dim_customers
[0m23:01:46.612128 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.dim_stores
[0m23:01:46.612128 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.fact_sales_transactions
[0m23:01:46.627754 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.dim_stores"
[0m23:01:46.627754 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.fact_sales_transactions"
[0m23:01:46.627754 [debug] [Thread-1 (]: Began executing node model.epicaldemo.dim_stores
[0m23:01:46.627754 [debug] [Thread-1 (]: Finished running node model.epicaldemo.dim_stores
[0m23:01:46.627754 [debug] [Thread-3 (]: Began executing node model.epicaldemo.fact_sales_transactions
[0m23:01:46.627754 [debug] [Thread-3 (]: Finished running node model.epicaldemo.fact_sales_transactions
[0m23:01:46.627754 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:01:46.627754 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m23:01:46.627754 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m23:01:46.691202 [debug] [MainThread]: Connection 'model.epicaldemo.dim_stores' was properly closed.
[0m23:01:46.691202 [debug] [MainThread]: Connection 'model.epicaldemo.dim_items' was properly closed.
[0m23:01:46.691202 [debug] [MainThread]: Connection 'model.epicaldemo.fact_sales_transactions' was properly closed.
[0m23:01:46.691202 [debug] [MainThread]: Connection 'model.epicaldemo.dim_customers' was properly closed.
[0m23:01:46.691202 [debug] [MainThread]: Command end result
[0m23:01:46.751180 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m23:01:46.787336 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m23:01:46.794918 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m23:01:47.054753 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m23:01:47.054753 [info ] [MainThread]: Building catalog
[0m23:01:47.077867 [debug] [ThreadPool]: Acquiring new snowflake connection 'EPICALDEMO.information_schema'
[0m23:01:47.096183 [debug] [ThreadPool]: Using snowflake connection "EPICALDEMO.information_schema"
[0m23:01:47.097935 [debug] [ThreadPool]: On EPICALDEMO.information_schema: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "EPICALDEMO.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from EPICALDEMO.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__items' and upper("table_name") = upper('stg_d365_fo__items')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__transactions' and upper("table_name") = upper('stg_d365_fo__transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'transactions' and upper("table_name") = upper('transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'fact_sales_transactions' and upper("table_name") = upper('fact_sales_transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__stores' and upper("table_name") = upper('stg_d365_fo__stores')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_stores' and upper("table_name") = upper('dim_stores')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_inriver__item_attributes' and upper("table_name") = upper('stg_inriver__item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'inriver' and upper("table_schema") = upper('inriver')

                    and 
    "table_name" ilike 'item_attributes' and upper("table_name") = upper('item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_customers' and upper("table_name") = upper('dim_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'item' and upper("table_name") = upper('item')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'store' and upper("table_name") = upper('store')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'date' and upper("table_name") = upper('date')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__managers' and upper("table_name") = upper('stg_d365_fo__managers')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_items' and upper("table_name") = upper('dim_items')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'category' and upper("table_name") = upper('category')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_salesforce__customers' and upper("table_name") = upper('stg_salesforce__customers')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'manager' and upper("table_name") = upper('manager')

                )
             or 
                (
                    
    "table_schema" ilike 'salesforce' and upper("table_schema") = upper('salesforce')

                    and 
    "table_name" ilike 'customer' and upper("table_name") = upper('customer')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__dates' and upper("table_name") = upper('stg_d365_fo__dates')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stores_snapshot' and upper("table_name") = upper('stores_snapshot')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_dates' and upper("table_name") = upper('dim_dates')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__categories' and upper("table_name") = upper('stg_d365_fo__categories')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from EPICALDEMO.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__items' and upper("table_name") = upper('stg_d365_fo__items')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__transactions' and upper("table_name") = upper('stg_d365_fo__transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'transactions' and upper("table_name") = upper('transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'fact_sales_transactions' and upper("table_name") = upper('fact_sales_transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__stores' and upper("table_name") = upper('stg_d365_fo__stores')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_stores' and upper("table_name") = upper('dim_stores')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_inriver__item_attributes' and upper("table_name") = upper('stg_inriver__item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'inriver' and upper("table_schema") = upper('inriver')

                    and 
    "table_name" ilike 'item_attributes' and upper("table_name") = upper('item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_customers' and upper("table_name") = upper('dim_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'item' and upper("table_name") = upper('item')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'store' and upper("table_name") = upper('store')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'date' and upper("table_name") = upper('date')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__managers' and upper("table_name") = upper('stg_d365_fo__managers')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_items' and upper("table_name") = upper('dim_items')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'category' and upper("table_name") = upper('category')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_salesforce__customers' and upper("table_name") = upper('stg_salesforce__customers')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'manager' and upper("table_name") = upper('manager')

                )
             or 
                (
                    
    "table_schema" ilike 'salesforce' and upper("table_schema") = upper('salesforce')

                    and 
    "table_name" ilike 'customer' and upper("table_name") = upper('customer')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__dates' and upper("table_name") = upper('stg_d365_fo__dates')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stores_snapshot' and upper("table_name") = upper('stores_snapshot')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_dates' and upper("table_name") = upper('dim_dates')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__categories' and upper("table_name") = upper('stg_d365_fo__categories')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m23:01:47.099184 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:01:56.706492 [debug] [ThreadPool]: SQL status: SUCCESS 42 in 9.609 seconds
[0m23:01:56.745419 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\catalog.json
[0m23:01:56.755029 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m23:01:56.768717 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m23:01:56.769628 [info ] [MainThread]: Catalog written to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\catalog.json
[0m23:01:56.770626 [debug] [MainThread]: Command `dbt docs generate` succeeded at 23:01:56.770626 after 17.88 seconds
[0m23:01:56.771635 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m23:01:56.771635 [debug] [MainThread]: Connection 'EPICALDEMO.information_schema' was left open.
[0m23:01:56.771635 [debug] [MainThread]: On EPICALDEMO.information_schema: Close
[0m23:01:56.819185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288818C6510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028880FAB550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002887DC14F90>]}
[0m23:01:56.820183 [debug] [MainThread]: Flushing usage events
[0m23:01:57.205161 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:02:09.356454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC318BE6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC2F480750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC318BFBD0>]}


============================== 23:02:09.356454 | 712f9ed9-c39a-4cc3-b302-c7cdcbb627df ==============================
[0m23:02:09.356454 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:02:09.356454 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs serve', 'send_anonymous_usage_stats': 'True'}
[0m23:02:09.749959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '712f9ed9-c39a-4cc3-b302-c7cdcbb627df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC31027DD0>]}
[0m23:02:09.796837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '712f9ed9-c39a-4cc3-b302-c7cdcbb627df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC32A2D490>]}
[0m23:03:07.845850 [error] [MainThread]: Encountered an error:

[0m23:03:07.845850 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m23:03:07.860413 [debug] [MainThread]: Command `dbt docs serve` failed at 23:03:07.860413 after 58.55 seconds
[0m23:03:07.861419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC31890A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC318BE210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC318BFD90>]}
[0m23:03:07.862939 [debug] [MainThread]: Flushing usage events
[0m23:03:08.325274 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:10:22.705376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A74DF79DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A74DE87E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A74DF6BED0>]}


============================== 23:10:22.705376 | 6ad753aa-7538-42f7-87f1-2dc4d699824a ==============================
[0m23:10:22.705376 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:10:22.705376 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:10:23.137756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ad753aa-7538-42f7-87f1-2dc4d699824a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A74DF7BED0>]}
[0m23:10:23.172683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6ad753aa-7538-42f7-87f1-2dc4d699824a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A74C74F990>]}
[0m23:10:23.188328 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m23:10:23.462139 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:10:23.650212 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:10:23.650212 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:10:23.654861 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m23:10:23.688047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ad753aa-7538-42f7-87f1-2dc4d699824a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A74F3A3A10>]}
[0m23:10:23.705860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ad753aa-7538-42f7-87f1-2dc4d699824a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A74FCB7ED0>]}
[0m23:10:23.705860 [info ] [MainThread]: Found 13 models, 1 snapshot, 8 sources, 476 macros
[0m23:10:23.705860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ad753aa-7538-42f7-87f1-2dc4d699824a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A74F9102D0>]}
[0m23:10:23.705860 [info ] [MainThread]: 
[0m23:10:23.705860 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:10:23.705860 [info ] [MainThread]: 
[0m23:10:23.705860 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:10:23.705860 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m23:10:23.815097 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m23:10:23.816098 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m23:10:23.817098 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:10:24.257286 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.443 seconds
[0m23:10:24.257286 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m23:10:24.257286 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m23:10:24.372414 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bcebf6-0004-cd7b-0000-d2e90001c032
[0m23:10:24.372414 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m23:10:24.372414 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m23:10:24.372414 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m23:10:24.372414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ad753aa-7538-42f7-87f1-2dc4d699824a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A74DFEB010>]}
[0m23:10:24.372414 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__categories
[0m23:10:24.372414 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_d365_fo__dates
[0m23:10:24.372414 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_d365_fo__items
[0m23:10:24.372414 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_d365_fo__managers
[0m23:10:24.372414 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__categories'
[0m23:10:24.372414 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__dates'
[0m23:10:24.372414 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__items'
[0m23:10:24.372414 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__managers'
[0m23:10:24.372414 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__categories
[0m23:10:24.372414 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_d365_fo__dates
[0m23:10:24.372414 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_d365_fo__items
[0m23:10:24.372414 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_d365_fo__managers
[0m23:10:24.388341 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__categories"
[0m23:10:24.388341 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__dates"
[0m23:10:24.388341 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__items"
[0m23:10:24.388341 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__managers"
[0m23:10:24.388341 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__categories
[0m23:10:24.388341 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_d365_fo__dates
[0m23:10:24.388341 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_d365_fo__items
[0m23:10:24.388341 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__categories
[0m23:10:24.388341 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_d365_fo__managers
[0m23:10:24.403968 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_d365_fo__dates
[0m23:10:24.404519 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_d365_fo__items
[0m23:10:24.404782 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__transactions
[0m23:10:24.404782 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_d365_fo__managers
[0m23:10:24.404782 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_inriver__item_attributes
[0m23:10:24.404782 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_salesforce__customers
[0m23:10:24.404782 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__categories, now model.epicaldemo.stg_d365_fo__transactions)
[0m23:10:24.404782 [debug] [Thread-4 (]: Began running node snapshot.epicaldemo.stores_snapshot
[0m23:10:24.404782 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__dates, now model.epicaldemo.stg_inriver__item_attributes)
[0m23:10:24.404782 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__items, now model.epicaldemo.stg_salesforce__customers)
[0m23:10:24.404782 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__transactions
[0m23:10:24.404782 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__managers, now snapshot.epicaldemo.stores_snapshot)
[0m23:10:24.404782 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_inriver__item_attributes
[0m23:10:24.404782 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_salesforce__customers
[0m23:10:24.404782 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__transactions"
[0m23:10:24.404782 [debug] [Thread-4 (]: Began compiling node snapshot.epicaldemo.stores_snapshot
[0m23:10:24.404782 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_inriver__item_attributes"
[0m23:10:24.404782 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_salesforce__customers"
[0m23:10:24.421665 [debug] [Thread-4 (]: Began executing node snapshot.epicaldemo.stores_snapshot
[0m23:10:24.421665 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__transactions
[0m23:10:24.421665 [debug] [Thread-4 (]: Finished running node snapshot.epicaldemo.stores_snapshot
[0m23:10:24.421665 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_inriver__item_attributes
[0m23:10:24.421665 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__transactions
[0m23:10:24.421665 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_salesforce__customers
[0m23:10:24.425175 [debug] [Thread-4 (]: Began running node model.epicaldemo.dim_dates
[0m23:10:24.425175 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_inriver__item_attributes
[0m23:10:24.425175 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__stores
[0m23:10:24.425175 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_salesforce__customers
[0m23:10:24.425175 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly snapshot.epicaldemo.stores_snapshot, now model.epicaldemo.dim_dates)
[0m23:10:24.425175 [debug] [Thread-2 (]: Began running node model.epicaldemo.dim_items
[0m23:10:24.425175 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__transactions, now model.epicaldemo.stg_d365_fo__stores)
[0m23:10:24.425175 [debug] [Thread-3 (]: Began running node model.epicaldemo.dim_customers
[0m23:10:24.425175 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.dim_dates
[0m23:10:24.425175 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_inriver__item_attributes, now model.epicaldemo.dim_items)
[0m23:10:24.425175 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__stores
[0m23:10:24.425175 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_salesforce__customers, now model.epicaldemo.dim_customers)
[0m23:10:24.425175 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.dim_dates"
[0m23:10:24.425175 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.dim_items
[0m23:10:24.425175 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__stores"
[0m23:10:24.425175 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.dim_customers
[0m23:10:24.438247 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.dim_items"
[0m23:10:24.438247 [debug] [Thread-4 (]: Began executing node model.epicaldemo.dim_dates
[0m23:10:24.438247 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.dim_customers"
[0m23:10:24.438247 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__stores
[0m23:10:24.438247 [debug] [Thread-4 (]: Finished running node model.epicaldemo.dim_dates
[0m23:10:24.438247 [debug] [Thread-2 (]: Began executing node model.epicaldemo.dim_items
[0m23:10:24.438247 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__stores
[0m23:10:24.438247 [debug] [Thread-3 (]: Began executing node model.epicaldemo.dim_customers
[0m23:10:24.438247 [debug] [Thread-2 (]: Finished running node model.epicaldemo.dim_items
[0m23:10:24.438247 [debug] [Thread-4 (]: Began running node model.epicaldemo.dim_stores
[0m23:10:24.438247 [debug] [Thread-1 (]: Began running node model.epicaldemo.fact_sales_transactions
[0m23:10:24.438247 [debug] [Thread-3 (]: Finished running node model.epicaldemo.dim_customers
[0m23:10:24.438247 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.dim_dates, now model.epicaldemo.dim_stores)
[0m23:10:24.438247 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__stores, now model.epicaldemo.fact_sales_transactions)
[0m23:10:24.438247 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.dim_stores
[0m23:10:24.438247 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.fact_sales_transactions
[0m23:10:24.438247 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.dim_stores"
[0m23:10:24.454918 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.fact_sales_transactions"
[0m23:10:24.454918 [debug] [Thread-4 (]: Began executing node model.epicaldemo.dim_stores
[0m23:10:24.454918 [debug] [Thread-4 (]: Finished running node model.epicaldemo.dim_stores
[0m23:10:24.454918 [debug] [Thread-1 (]: Began executing node model.epicaldemo.fact_sales_transactions
[0m23:10:24.454918 [debug] [Thread-1 (]: Finished running node model.epicaldemo.fact_sales_transactions
[0m23:10:24.454918 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:10:24.454918 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m23:10:24.454918 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m23:10:24.504853 [debug] [MainThread]: Connection 'model.epicaldemo.fact_sales_transactions' was properly closed.
[0m23:10:24.504853 [debug] [MainThread]: Connection 'model.epicaldemo.dim_items' was properly closed.
[0m23:10:24.504853 [debug] [MainThread]: Connection 'model.epicaldemo.dim_customers' was properly closed.
[0m23:10:24.504853 [debug] [MainThread]: Connection 'model.epicaldemo.dim_stores' was properly closed.
[0m23:10:24.504853 [debug] [MainThread]: Command end result
[0m23:10:24.571493 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m23:10:24.588250 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m23:10:24.588250 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m23:10:24.588250 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m23:10:24.588250 [info ] [MainThread]: Building catalog
[0m23:10:24.604930 [debug] [ThreadPool]: Acquiring new snowflake connection 'EPICALDEMO.information_schema'
[0m23:10:24.627188 [debug] [ThreadPool]: Using snowflake connection "EPICALDEMO.information_schema"
[0m23:10:24.627188 [debug] [ThreadPool]: On EPICALDEMO.information_schema: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "EPICALDEMO.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from EPICALDEMO.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'fact_sales_transactions' and upper("table_name") = upper('fact_sales_transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__dates' and upper("table_name") = upper('stg_d365_fo__dates')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'store' and upper("table_name") = upper('store')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'item' and upper("table_name") = upper('item')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__items' and upper("table_name") = upper('stg_d365_fo__items')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__managers' and upper("table_name") = upper('stg_d365_fo__managers')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__stores' and upper("table_name") = upper('stg_d365_fo__stores')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_stores' and upper("table_name") = upper('dim_stores')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_customers' and upper("table_name") = upper('dim_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_dates' and upper("table_name") = upper('dim_dates')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'manager' and upper("table_name") = upper('manager')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_items' and upper("table_name") = upper('dim_items')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__categories' and upper("table_name") = upper('stg_d365_fo__categories')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_salesforce__customers' and upper("table_name") = upper('stg_salesforce__customers')

                )
             or 
                (
                    
    "table_schema" ilike 'inriver' and upper("table_schema") = upper('inriver')

                    and 
    "table_name" ilike 'item_attributes' and upper("table_name") = upper('item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'category' and upper("table_name") = upper('category')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'date' and upper("table_name") = upper('date')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__transactions' and upper("table_name") = upper('stg_d365_fo__transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_inriver__item_attributes' and upper("table_name") = upper('stg_inriver__item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stores_snapshot' and upper("table_name") = upper('stores_snapshot')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'transactions' and upper("table_name") = upper('transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'salesforce' and upper("table_schema") = upper('salesforce')

                    and 
    "table_name" ilike 'customer' and upper("table_name") = upper('customer')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from EPICALDEMO.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'fact_sales_transactions' and upper("table_name") = upper('fact_sales_transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__dates' and upper("table_name") = upper('stg_d365_fo__dates')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'store' and upper("table_name") = upper('store')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'item' and upper("table_name") = upper('item')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__items' and upper("table_name") = upper('stg_d365_fo__items')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__managers' and upper("table_name") = upper('stg_d365_fo__managers')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__stores' and upper("table_name") = upper('stg_d365_fo__stores')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_stores' and upper("table_name") = upper('dim_stores')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_customers' and upper("table_name") = upper('dim_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_dates' and upper("table_name") = upper('dim_dates')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'manager' and upper("table_name") = upper('manager')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_items' and upper("table_name") = upper('dim_items')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__categories' and upper("table_name") = upper('stg_d365_fo__categories')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_salesforce__customers' and upper("table_name") = upper('stg_salesforce__customers')

                )
             or 
                (
                    
    "table_schema" ilike 'inriver' and upper("table_schema") = upper('inriver')

                    and 
    "table_name" ilike 'item_attributes' and upper("table_name") = upper('item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'category' and upper("table_name") = upper('category')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'date' and upper("table_name") = upper('date')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__transactions' and upper("table_name") = upper('stg_d365_fo__transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_inriver__item_attributes' and upper("table_name") = upper('stg_inriver__item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stores_snapshot' and upper("table_name") = upper('stores_snapshot')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'transactions' and upper("table_name") = upper('transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'salesforce' and upper("table_schema") = upper('salesforce')

                    and 
    "table_name" ilike 'customer' and upper("table_name") = upper('customer')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m23:10:24.627188 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:10:33.802825 [debug] [ThreadPool]: SQL status: SUCCESS 42 in 9.179 seconds
[0m23:10:33.818458 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\catalog.json
[0m23:10:33.850101 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m23:10:33.850101 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m23:10:33.850101 [info ] [MainThread]: Catalog written to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\catalog.json
[0m23:10:33.850101 [debug] [MainThread]: Command `dbt docs generate` succeeded at 23:10:33.850101 after 11.21 seconds
[0m23:10:33.850101 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m23:10:33.850101 [debug] [MainThread]: Connection 'EPICALDEMO.information_schema' was left open.
[0m23:10:33.850101 [debug] [MainThread]: On EPICALDEMO.information_schema: Close
[0m23:10:33.919768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A74D922AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A74B414910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A74FCAFB10>]}
[0m23:10:33.919768 [debug] [MainThread]: Flushing usage events
[0m23:10:34.380719 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:10:38.802362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF2BB6BE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF2BA82950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF2B9B5050>]}


============================== 23:10:38.802362 | bdcaee11-bd5e-428d-8481-dcd554ea2384 ==============================
[0m23:10:38.802362 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:10:38.802362 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt docs serve', 'send_anonymous_usage_stats': 'True'}
[0m23:10:39.223123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bdcaee11-bd5e-428d-8481-dcd554ea2384', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF2BB72850>]}
[0m23:10:39.254780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bdcaee11-bd5e-428d-8481-dcd554ea2384', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF2CF2D6D0>]}
[0m23:15:32.494030 [error] [MainThread]: Encountered an error:

[0m23:15:32.494030 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m23:15:32.494030 [debug] [MainThread]: Command `dbt docs serve` failed at 23:15:32.494030 after 293.74 seconds
[0m23:15:32.494030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF2BBBD150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF2BA82950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF2BB6BC10>]}
[0m23:15:32.494030 [debug] [MainThread]: Flushing usage events
[0m23:15:32.963204 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:15:37.103272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019ACE079450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019ACE078B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019ACE079910>]}


============================== 23:15:37.103272 | 05c6ffc4-ebf6-45dd-a8d0-ec9a1915aa70 ==============================
[0m23:15:37.103272 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:15:37.103272 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:15:37.525995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05c6ffc4-ebf6-45dd-a8d0-ec9a1915aa70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019ACE091410>]}
[0m23:15:37.572871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '05c6ffc4-ebf6-45dd-a8d0-ec9a1915aa70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019ACF22D250>]}
[0m23:17:30.965853 [error] [MainThread]: Encountered an error:

[0m23:17:31.005233 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socketserver.py", line 238, in serve_forever
    self._handle_request_noblock()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socketserver.py", line 317, in _handle_request_noblock
    self.process_request(request, client_address)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socketserver.py", line 348, in process_request
    self.finish_request(request, client_address)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socketserver.py", line 361, in finish_request
    self.RequestHandlerClass(request, client_address, self)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\http\server.py", line 671, in __init__
    super().__init__(*args, **kwargs)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socketserver.py", line 755, in __init__
    self.handle()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\http\server.py", line 436, in handle
    self.handle_one_request()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\http\server.py", line 404, in handle_one_request
    self.raw_requestline = self.rfile.readline(65537)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socket.py", line 706, in readinto
    return self._sock.recv_into(b)
           ^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m23:17:31.007241 [debug] [MainThread]: Command `dbt docs serve` failed at 23:17:31.007241 after 113.97 seconds
[0m23:17:31.008259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019ACE06B450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019ACE070C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019ACE072750>]}
[0m23:17:31.009671 [debug] [MainThread]: Flushing usage events
[0m23:17:31.413759 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:17:48.556870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017122F797D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017122F79850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017122F796D0>]}


============================== 23:17:48.572495 | 70a32e9f-a0c9-4f5d-aa38-91c0b34506e4 ==============================
[0m23:17:48.572495 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:17:48.572495 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt docs serve', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:17:50.768346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '70a32e9f-a0c9-4f5d-aa38-91c0b34506e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171243C5450>]}
[0m23:17:50.815223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '70a32e9f-a0c9-4f5d-aa38-91c0b34506e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171219578D0>]}
[0m23:21:00.538224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A85A96BD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A85A973FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A85A973D50>]}


============================== 23:21:00.552497 | 9ccb5fd2-fe63-4ef6-87c2-911d3d6938c9 ==============================
[0m23:21:00.552497 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:21:00.552497 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:21:01.014401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ccb5fd2-fe63-4ef6-87c2-911d3d6938c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A85C06E790>]}
[0m23:21:01.061278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ccb5fd2-fe63-4ef6-87c2-911d3d6938c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A85BD31F90>]}
[0m23:21:01.068445 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m23:21:01.500049 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:21:01.688336 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:21:01.688336 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:21:01.688336 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m23:21:01.725724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ccb5fd2-fe63-4ef6-87c2-911d3d6938c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A85C0AE110>]}
[0m23:21:01.785421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ccb5fd2-fe63-4ef6-87c2-911d3d6938c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A85C6B7F90>]}
[0m23:21:01.785421 [info ] [MainThread]: Found 13 models, 1 snapshot, 8 sources, 476 macros
[0m23:21:01.785421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ccb5fd2-fe63-4ef6-87c2-911d3d6938c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A85C2FB410>]}
[0m23:21:01.785421 [info ] [MainThread]: 
[0m23:21:01.785421 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:21:01.785421 [info ] [MainThread]: 
[0m23:21:01.785421 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:21:01.801081 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m23:21:04.268858 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m23:21:04.268858 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m23:21:04.268858 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:21:04.833725 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.572 seconds
[0m23:21:04.849364 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m23:21:04.849364 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m23:21:04.990832 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bcec01-0004-cd7b-0000-d2e90001c036
[0m23:21:04.990832 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m23:21:04.990832 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m23:21:04.990832 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m23:21:04.990832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ccb5fd2-fe63-4ef6-87c2-911d3d6938c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A85BDCFA10>]}
[0m23:21:04.990832 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__categories
[0m23:21:04.990832 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_d365_fo__dates
[0m23:21:04.990832 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_d365_fo__items
[0m23:21:04.990832 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_d365_fo__managers
[0m23:21:04.990832 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__categories'
[0m23:21:04.990832 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__dates'
[0m23:21:04.990832 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__items'
[0m23:21:04.990832 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__managers'
[0m23:21:05.006465 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__categories
[0m23:21:05.006465 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_d365_fo__dates
[0m23:21:05.006465 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_d365_fo__items
[0m23:21:05.006465 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_d365_fo__managers
[0m23:21:05.006465 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__categories"
[0m23:21:05.006465 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__dates"
[0m23:21:05.006465 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__items"
[0m23:21:05.006465 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__managers"
[0m23:21:05.006465 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__categories
[0m23:21:05.022089 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_d365_fo__dates
[0m23:21:05.022089 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_d365_fo__items
[0m23:21:05.022089 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__categories
[0m23:21:05.022089 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_d365_fo__managers
[0m23:21:05.022089 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_d365_fo__dates
[0m23:21:05.022089 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_d365_fo__items
[0m23:21:05.022089 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__transactions
[0m23:21:05.022089 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_d365_fo__managers
[0m23:21:05.022089 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_inriver__item_attributes
[0m23:21:05.022089 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_salesforce__customers
[0m23:21:05.022089 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__categories, now model.epicaldemo.stg_d365_fo__transactions)
[0m23:21:05.022089 [debug] [Thread-4 (]: Began running node snapshot.epicaldemo.stores_snapshot
[0m23:21:05.022089 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__dates, now model.epicaldemo.stg_inriver__item_attributes)
[0m23:21:05.022089 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__items, now model.epicaldemo.stg_salesforce__customers)
[0m23:21:05.022089 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__transactions
[0m23:21:05.022089 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__managers, now snapshot.epicaldemo.stores_snapshot)
[0m23:21:05.022089 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_inriver__item_attributes
[0m23:21:05.022089 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_salesforce__customers
[0m23:21:05.022089 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__transactions"
[0m23:21:05.022089 [debug] [Thread-4 (]: Began compiling node snapshot.epicaldemo.stores_snapshot
[0m23:21:05.022089 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_inriver__item_attributes"
[0m23:21:05.037714 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_salesforce__customers"
[0m23:21:05.037714 [debug] [Thread-4 (]: Began executing node snapshot.epicaldemo.stores_snapshot
[0m23:21:05.037714 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__transactions
[0m23:21:05.037714 [debug] [Thread-4 (]: Finished running node snapshot.epicaldemo.stores_snapshot
[0m23:21:05.037714 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_inriver__item_attributes
[0m23:21:05.037714 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_salesforce__customers
[0m23:21:05.037714 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__transactions
[0m23:21:05.037714 [debug] [Thread-4 (]: Began running node model.epicaldemo.dim_dates
[0m23:21:05.037714 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_inriver__item_attributes
[0m23:21:05.037714 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_salesforce__customers
[0m23:21:05.037714 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__stores
[0m23:21:05.037714 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly snapshot.epicaldemo.stores_snapshot, now model.epicaldemo.dim_dates)
[0m23:21:05.037714 [debug] [Thread-2 (]: Began running node model.epicaldemo.dim_items
[0m23:21:05.037714 [debug] [Thread-3 (]: Began running node model.epicaldemo.dim_customers
[0m23:21:05.037714 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__transactions, now model.epicaldemo.stg_d365_fo__stores)
[0m23:21:05.037714 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.dim_dates
[0m23:21:05.037714 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_inriver__item_attributes, now model.epicaldemo.dim_items)
[0m23:21:05.037714 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_salesforce__customers, now model.epicaldemo.dim_customers)
[0m23:21:05.037714 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__stores
[0m23:21:05.053344 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.dim_dates"
[0m23:21:05.053344 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.dim_items
[0m23:21:05.053344 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.dim_customers
[0m23:21:05.053344 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__stores"
[0m23:21:05.053344 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.dim_items"
[0m23:21:05.053344 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.dim_customers"
[0m23:21:05.053344 [debug] [Thread-4 (]: Began executing node model.epicaldemo.dim_dates
[0m23:21:05.053344 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__stores
[0m23:21:05.053344 [debug] [Thread-4 (]: Finished running node model.epicaldemo.dim_dates
[0m23:21:05.053344 [debug] [Thread-2 (]: Began executing node model.epicaldemo.dim_items
[0m23:21:05.053344 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__stores
[0m23:21:05.053344 [debug] [Thread-3 (]: Began executing node model.epicaldemo.dim_customers
[0m23:21:05.053344 [debug] [Thread-2 (]: Finished running node model.epicaldemo.dim_items
[0m23:21:05.053344 [debug] [Thread-4 (]: Began running node model.epicaldemo.dim_stores
[0m23:21:05.053344 [debug] [Thread-1 (]: Began running node model.epicaldemo.fact_sales_transactions
[0m23:21:05.053344 [debug] [Thread-3 (]: Finished running node model.epicaldemo.dim_customers
[0m23:21:05.053344 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.dim_dates, now model.epicaldemo.dim_stores)
[0m23:21:05.068969 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__stores, now model.epicaldemo.fact_sales_transactions)
[0m23:21:05.069669 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.dim_stores
[0m23:21:05.069669 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.fact_sales_transactions
[0m23:21:05.069669 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.dim_stores"
[0m23:21:05.069669 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.fact_sales_transactions"
[0m23:21:05.069669 [debug] [Thread-4 (]: Began executing node model.epicaldemo.dim_stores
[0m23:21:05.069669 [debug] [Thread-4 (]: Finished running node model.epicaldemo.dim_stores
[0m23:21:05.069669 [debug] [Thread-1 (]: Began executing node model.epicaldemo.fact_sales_transactions
[0m23:21:05.069669 [debug] [Thread-1 (]: Finished running node model.epicaldemo.fact_sales_transactions
[0m23:21:05.069669 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:21:05.069669 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m23:21:05.069669 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m23:21:05.162589 [debug] [MainThread]: Connection 'model.epicaldemo.fact_sales_transactions' was properly closed.
[0m23:21:05.162589 [debug] [MainThread]: Connection 'model.epicaldemo.dim_items' was properly closed.
[0m23:21:05.162589 [debug] [MainThread]: Connection 'model.epicaldemo.dim_customers' was properly closed.
[0m23:21:05.162589 [debug] [MainThread]: Connection 'model.epicaldemo.dim_stores' was properly closed.
[0m23:21:05.162589 [debug] [MainThread]: Command end result
[0m23:21:05.225488 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m23:21:05.241125 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m23:21:05.241125 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m23:21:05.256742 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m23:21:05.256742 [info ] [MainThread]: Building catalog
[0m23:21:05.256742 [debug] [ThreadPool]: Acquiring new snowflake connection 'EPICALDEMO.information_schema'
[0m23:21:05.287275 [debug] [ThreadPool]: Using snowflake connection "EPICALDEMO.information_schema"
[0m23:21:05.288781 [debug] [ThreadPool]: On EPICALDEMO.information_schema: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "EPICALDEMO.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from EPICALDEMO.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'salesforce' and upper("table_schema") = upper('salesforce')

                    and 
    "table_name" ilike 'customer' and upper("table_name") = upper('customer')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_dates' and upper("table_name") = upper('dim_dates')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stores_snapshot' and upper("table_name") = upper('stores_snapshot')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_stores' and upper("table_name") = upper('dim_stores')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_salesforce__customers' and upper("table_name") = upper('stg_salesforce__customers')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'date' and upper("table_name") = upper('date')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_inriver__item_attributes' and upper("table_name") = upper('stg_inriver__item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_customers' and upper("table_name") = upper('dim_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'manager' and upper("table_name") = upper('manager')

                )
             or 
                (
                    
    "table_schema" ilike 'inriver' and upper("table_schema") = upper('inriver')

                    and 
    "table_name" ilike 'item_attributes' and upper("table_name") = upper('item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__stores' and upper("table_name") = upper('stg_d365_fo__stores')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__managers' and upper("table_name") = upper('stg_d365_fo__managers')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_items' and upper("table_name") = upper('dim_items')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__transactions' and upper("table_name") = upper('stg_d365_fo__transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'transactions' and upper("table_name") = upper('transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__categories' and upper("table_name") = upper('stg_d365_fo__categories')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'category' and upper("table_name") = upper('category')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'fact_sales_transactions' and upper("table_name") = upper('fact_sales_transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'store' and upper("table_name") = upper('store')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'item' and upper("table_name") = upper('item')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__dates' and upper("table_name") = upper('stg_d365_fo__dates')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__items' and upper("table_name") = upper('stg_d365_fo__items')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from EPICALDEMO.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'salesforce' and upper("table_schema") = upper('salesforce')

                    and 
    "table_name" ilike 'customer' and upper("table_name") = upper('customer')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_dates' and upper("table_name") = upper('dim_dates')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stores_snapshot' and upper("table_name") = upper('stores_snapshot')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_stores' and upper("table_name") = upper('dim_stores')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_salesforce__customers' and upper("table_name") = upper('stg_salesforce__customers')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'date' and upper("table_name") = upper('date')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_inriver__item_attributes' and upper("table_name") = upper('stg_inriver__item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_customers' and upper("table_name") = upper('dim_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'manager' and upper("table_name") = upper('manager')

                )
             or 
                (
                    
    "table_schema" ilike 'inriver' and upper("table_schema") = upper('inriver')

                    and 
    "table_name" ilike 'item_attributes' and upper("table_name") = upper('item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__stores' and upper("table_name") = upper('stg_d365_fo__stores')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__managers' and upper("table_name") = upper('stg_d365_fo__managers')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_items' and upper("table_name") = upper('dim_items')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__transactions' and upper("table_name") = upper('stg_d365_fo__transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'transactions' and upper("table_name") = upper('transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__categories' and upper("table_name") = upper('stg_d365_fo__categories')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'category' and upper("table_name") = upper('category')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'fact_sales_transactions' and upper("table_name") = upper('fact_sales_transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'store' and upper("table_name") = upper('store')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'item' and upper("table_name") = upper('item')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__dates' and upper("table_name") = upper('stg_d365_fo__dates')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__items' and upper("table_name") = upper('stg_d365_fo__items')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m23:21:05.289792 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:21:07.910381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A03C6EF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A03C63410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A03C6F8D0>]}


============================== 23:21:07.913390 | 29a63b99-e15d-46ca-9555-577d9973bbcc ==============================
[0m23:21:07.913390 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:21:07.914382 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'profiles_dir': 'c:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:21:08.014656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29a63b99-e15d-46ca-9555-577d9973bbcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A03CF0250>]}
[0m23:21:08.082383 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:21:08.082383 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:21:08.082383 [debug] [MainThread]: Command `cli deps` succeeded at 23:21:08.082383 after 0.24 seconds
[0m23:21:08.082383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A03C78190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A03CDD650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A03CDFA50>]}
[0m23:21:08.091390 [debug] [MainThread]: Flushing usage events
[0m23:21:08.491851 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:21:14.411538 [debug] [ThreadPool]: SQL status: SUCCESS 42 in 9.129 seconds
[0m23:21:14.427169 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\catalog.json
[0m23:21:14.458427 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m23:21:14.458427 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m23:21:14.458427 [info ] [MainThread]: Catalog written to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\catalog.json
[0m23:21:14.458427 [debug] [MainThread]: Command `dbt docs generate` succeeded at 23:21:14.458427 after 13.99 seconds
[0m23:21:14.458427 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m23:21:14.458427 [debug] [MainThread]: Connection 'EPICALDEMO.information_schema' was left open.
[0m23:21:14.458427 [debug] [MainThread]: On EPICALDEMO.information_schema: Close
[0m23:21:14.547909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8586848D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A85A98D310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A85A9A4F10>]}
[0m23:21:14.547909 [debug] [MainThread]: Flushing usage events
[0m23:21:14.944342 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:21:25.893525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B310173350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3101715D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B310170350>]}


============================== 23:21:25.897010 | e9e89b72-98df-4864-a512-d52e03b916b3 ==============================
[0m23:21:25.897010 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:21:25.902016 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:21:26.354510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9e89b72-98df-4864-a512-d52e03b916b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3115E14D0>]}
[0m23:21:26.392203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e9e89b72-98df-4864-a512-d52e03b916b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B30E94FBD0>]}
[0m23:22:52.050523 [error] [MainThread]: Encountered an error:

[0m23:22:52.050523 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socketserver.py", line 238, in serve_forever
    self._handle_request_noblock()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socketserver.py", line 317, in _handle_request_noblock
    self.process_request(request, client_address)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socketserver.py", line 348, in process_request
    self.finish_request(request, client_address)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socketserver.py", line 361, in finish_request
    self.RequestHandlerClass(request, client_address, self)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\http\server.py", line 671, in __init__
    super().__init__(*args, **kwargs)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socketserver.py", line 755, in __init__
    self.handle()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\http\server.py", line 436, in handle
    self.handle_one_request()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\http\server.py", line 404, in handle_one_request
    self.raw_requestline = self.rfile.readline(65537)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socket.py", line 706, in readinto
    return self._sock.recv_into(b)
           ^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m23:22:52.050523 [debug] [MainThread]: Command `dbt docs serve` failed at 23:22:52.050523 after 86.22 seconds
[0m23:22:52.050523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B31194ABD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B31016B2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B310171F90>]}
[0m23:22:52.050523 [debug] [MainThread]: Flushing usage events
[0m23:22:52.454162 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:25:46.162331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002042527D8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204252A4290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002042526BE50>]}


============================== 23:25:46.177960 | f6011f53-6567-4bbd-9df4-c58d56dd149f ==============================
[0m23:25:46.177960 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:25:46.177960 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:25:46.583158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6011f53-6567-4bbd-9df4-c58d56dd149f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002042641BA10>]}
[0m23:25:46.614353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f6011f53-6567-4bbd-9df4-c58d56dd149f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020426468090>]}
[0m23:26:09.069610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020373BBBD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020373BBBBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020373BB8DD0>]}


============================== 23:26:09.085235 | 183308e7-508d-4fdc-84d3-11829f381df5 ==============================
[0m23:26:09.085235 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:26:09.085235 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:26:09.514074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '183308e7-508d-4fdc-84d3-11829f381df5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020374FEB2D0>]}
[0m23:26:09.554838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '183308e7-508d-4fdc-84d3-11829f381df5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020374F5CE90>]}
[0m23:26:09.554838 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m23:26:09.883306 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:26:10.071589 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:26:10.071589 [debug] [MainThread]: Partial parsing: added file: epicaldemo://models\exposures.yml
[0m23:26:10.181405 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m23:26:10.197031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '183308e7-508d-4fdc-84d3-11829f381df5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020374FF7A10>]}
[0m23:26:10.223920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '183308e7-508d-4fdc-84d3-11829f381df5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020375963FD0>]}
[0m23:26:10.225218 [info ] [MainThread]: Found 13 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m23:26:10.225218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '183308e7-508d-4fdc-84d3-11829f381df5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203754736D0>]}
[0m23:26:10.225218 [info ] [MainThread]: 
[0m23:26:10.225218 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:26:10.240535 [info ] [MainThread]: 
[0m23:26:10.241546 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:26:10.246988 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m23:26:10.340923 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m23:26:10.340923 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m23:26:10.340923 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:26:10.795831 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.458 seconds
[0m23:26:10.795831 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m23:26:10.795831 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m23:26:10.857095 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bcec06-0004-cd7b-0000-d2e90001c03a
[0m23:26:10.857095 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m23:26:10.857095 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m23:26:10.857095 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m23:26:10.857095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '183308e7-508d-4fdc-84d3-11829f381df5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020375534B10>]}
[0m23:26:10.872099 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_d365_fo__dates
[0m23:26:10.872099 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__categories
[0m23:26:10.872099 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_d365_fo__items
[0m23:26:10.872099 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_d365_fo__managers
[0m23:26:10.872099 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__dates'
[0m23:26:10.872099 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__categories'
[0m23:26:10.872099 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__items'
[0m23:26:10.872099 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__managers'
[0m23:26:10.872099 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_d365_fo__dates
[0m23:26:10.872099 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__categories
[0m23:26:10.872099 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_d365_fo__items
[0m23:26:10.872099 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_d365_fo__managers
[0m23:26:10.872099 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__dates"
[0m23:26:10.872099 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__categories"
[0m23:26:10.887737 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__items"
[0m23:26:10.887737 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__managers"
[0m23:26:10.887737 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_d365_fo__dates
[0m23:26:10.887737 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__categories
[0m23:26:10.887737 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_d365_fo__dates
[0m23:26:10.887737 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_d365_fo__items
[0m23:26:10.887737 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__categories
[0m23:26:10.887737 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_d365_fo__managers
[0m23:26:10.887737 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_d365_fo__transactions
[0m23:26:10.887737 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_d365_fo__items
[0m23:26:10.887737 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_inriver__item_attributes
[0m23:26:10.887737 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_d365_fo__managers
[0m23:26:10.887737 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__dates, now model.epicaldemo.stg_d365_fo__transactions)
[0m23:26:10.887737 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_salesforce__customers
[0m23:26:10.887737 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__categories, now model.epicaldemo.stg_inriver__item_attributes)
[0m23:26:10.887737 [debug] [Thread-4 (]: Began running node snapshot.epicaldemo.stores_snapshot
[0m23:26:10.887737 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_d365_fo__transactions
[0m23:26:10.887737 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__items, now model.epicaldemo.stg_salesforce__customers)
[0m23:26:10.887737 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_inriver__item_attributes
[0m23:26:10.887737 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__managers, now snapshot.epicaldemo.stores_snapshot)
[0m23:26:10.903365 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__transactions"
[0m23:26:10.903365 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_salesforce__customers
[0m23:26:10.903365 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_inriver__item_attributes"
[0m23:26:10.903365 [debug] [Thread-4 (]: Began compiling node snapshot.epicaldemo.stores_snapshot
[0m23:26:10.915876 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_salesforce__customers"
[0m23:26:10.915876 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_d365_fo__transactions
[0m23:26:10.919384 [debug] [Thread-4 (]: Began executing node snapshot.epicaldemo.stores_snapshot
[0m23:26:10.919384 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_inriver__item_attributes
[0m23:26:10.919384 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_d365_fo__transactions
[0m23:26:10.919384 [debug] [Thread-4 (]: Finished running node snapshot.epicaldemo.stores_snapshot
[0m23:26:10.919384 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_salesforce__customers
[0m23:26:10.919384 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_inriver__item_attributes
[0m23:26:10.919384 [debug] [Thread-2 (]: Began running node model.epicaldemo.dim_dates
[0m23:26:10.919384 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_d365_fo__stores
[0m23:26:10.919384 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_salesforce__customers
[0m23:26:10.919384 [debug] [Thread-1 (]: Began running node model.epicaldemo.dim_items
[0m23:26:10.919384 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__transactions, now model.epicaldemo.dim_dates)
[0m23:26:10.919384 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly snapshot.epicaldemo.stores_snapshot, now model.epicaldemo.stg_d365_fo__stores)
[0m23:26:10.919384 [debug] [Thread-3 (]: Began running node model.epicaldemo.dim_customers
[0m23:26:10.919384 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_inriver__item_attributes, now model.epicaldemo.dim_items)
[0m23:26:10.919384 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.dim_dates
[0m23:26:10.919384 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_d365_fo__stores
[0m23:26:10.919384 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_salesforce__customers, now model.epicaldemo.dim_customers)
[0m23:26:10.919384 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.dim_items
[0m23:26:10.919384 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.dim_dates"
[0m23:26:10.935020 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__stores"
[0m23:26:10.935020 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.dim_customers
[0m23:26:10.935020 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.dim_items"
[0m23:26:10.935020 [debug] [Thread-2 (]: Began executing node model.epicaldemo.dim_dates
[0m23:26:10.935020 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.dim_customers"
[0m23:26:10.935020 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_d365_fo__stores
[0m23:26:10.935020 [debug] [Thread-2 (]: Finished running node model.epicaldemo.dim_dates
[0m23:26:10.935020 [debug] [Thread-1 (]: Began executing node model.epicaldemo.dim_items
[0m23:26:10.935020 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_d365_fo__stores
[0m23:26:10.935020 [debug] [Thread-3 (]: Began executing node model.epicaldemo.dim_customers
[0m23:26:10.935020 [debug] [Thread-1 (]: Finished running node model.epicaldemo.dim_items
[0m23:26:10.935020 [debug] [Thread-2 (]: Began running node model.epicaldemo.dim_stores
[0m23:26:10.935020 [debug] [Thread-4 (]: Began running node model.epicaldemo.fact_sales_transactions
[0m23:26:10.949146 [debug] [Thread-3 (]: Finished running node model.epicaldemo.dim_customers
[0m23:26:10.950140 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.dim_dates, now model.epicaldemo.dim_stores)
[0m23:26:10.950647 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__stores, now model.epicaldemo.fact_sales_transactions)
[0m23:26:10.950647 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.dim_stores
[0m23:26:10.950647 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.fact_sales_transactions
[0m23:26:10.950647 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.dim_stores"
[0m23:26:10.950647 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.fact_sales_transactions"
[0m23:26:10.950647 [debug] [Thread-2 (]: Began executing node model.epicaldemo.dim_stores
[0m23:26:10.950647 [debug] [Thread-4 (]: Began executing node model.epicaldemo.fact_sales_transactions
[0m23:26:10.950647 [debug] [Thread-2 (]: Finished running node model.epicaldemo.dim_stores
[0m23:26:10.950647 [debug] [Thread-4 (]: Finished running node model.epicaldemo.fact_sales_transactions
[0m23:26:10.950647 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:26:10.950647 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m23:26:10.950647 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m23:26:11.016187 [debug] [MainThread]: Connection 'model.epicaldemo.dim_stores' was properly closed.
[0m23:26:11.016187 [debug] [MainThread]: Connection 'model.epicaldemo.dim_items' was properly closed.
[0m23:26:11.016187 [debug] [MainThread]: Connection 'model.epicaldemo.dim_customers' was properly closed.
[0m23:26:11.016187 [debug] [MainThread]: Connection 'model.epicaldemo.fact_sales_transactions' was properly closed.
[0m23:26:11.016187 [debug] [MainThread]: Command end result
[0m23:26:11.091712 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m23:26:11.107338 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m23:26:11.116348 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m23:26:11.123369 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m23:26:11.123369 [info ] [MainThread]: Building catalog
[0m23:26:11.140988 [debug] [ThreadPool]: Acquiring new snowflake connection 'EPICALDEMO.information_schema'
[0m23:26:11.162600 [debug] [ThreadPool]: Using snowflake connection "EPICALDEMO.information_schema"
[0m23:26:11.162600 [debug] [ThreadPool]: On EPICALDEMO.information_schema: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "EPICALDEMO.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from EPICALDEMO.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__transactions' and upper("table_name") = upper('stg_d365_fo__transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_customers' and upper("table_name") = upper('dim_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stores_snapshot' and upper("table_name") = upper('stores_snapshot')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_items' and upper("table_name") = upper('dim_items')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_salesforce__customers' and upper("table_name") = upper('stg_salesforce__customers')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'item' and upper("table_name") = upper('item')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__stores' and upper("table_name") = upper('stg_d365_fo__stores')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__managers' and upper("table_name") = upper('stg_d365_fo__managers')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_dates' and upper("table_name") = upper('dim_dates')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__categories' and upper("table_name") = upper('stg_d365_fo__categories')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'store' and upper("table_name") = upper('store')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_inriver__item_attributes' and upper("table_name") = upper('stg_inriver__item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'fact_sales_transactions' and upper("table_name") = upper('fact_sales_transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'date' and upper("table_name") = upper('date')

                )
             or 
                (
                    
    "table_schema" ilike 'salesforce' and upper("table_schema") = upper('salesforce')

                    and 
    "table_name" ilike 'customer' and upper("table_name") = upper('customer')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'transactions' and upper("table_name") = upper('transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__items' and upper("table_name") = upper('stg_d365_fo__items')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__dates' and upper("table_name") = upper('stg_d365_fo__dates')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'category' and upper("table_name") = upper('category')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_stores' and upper("table_name") = upper('dim_stores')

                )
             or 
                (
                    
    "table_schema" ilike 'inriver' and upper("table_schema") = upper('inriver')

                    and 
    "table_name" ilike 'item_attributes' and upper("table_name") = upper('item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'manager' and upper("table_name") = upper('manager')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from EPICALDEMO.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__transactions' and upper("table_name") = upper('stg_d365_fo__transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_customers' and upper("table_name") = upper('dim_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stores_snapshot' and upper("table_name") = upper('stores_snapshot')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_items' and upper("table_name") = upper('dim_items')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_salesforce__customers' and upper("table_name") = upper('stg_salesforce__customers')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'item' and upper("table_name") = upper('item')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__stores' and upper("table_name") = upper('stg_d365_fo__stores')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__managers' and upper("table_name") = upper('stg_d365_fo__managers')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_dates' and upper("table_name") = upper('dim_dates')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__categories' and upper("table_name") = upper('stg_d365_fo__categories')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'store' and upper("table_name") = upper('store')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_inriver__item_attributes' and upper("table_name") = upper('stg_inriver__item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'fact_sales_transactions' and upper("table_name") = upper('fact_sales_transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'date' and upper("table_name") = upper('date')

                )
             or 
                (
                    
    "table_schema" ilike 'salesforce' and upper("table_schema") = upper('salesforce')

                    and 
    "table_name" ilike 'customer' and upper("table_name") = upper('customer')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'transactions' and upper("table_name") = upper('transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__items' and upper("table_name") = upper('stg_d365_fo__items')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__dates' and upper("table_name") = upper('stg_d365_fo__dates')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'category' and upper("table_name") = upper('category')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_stores' and upper("table_name") = upper('dim_stores')

                )
             or 
                (
                    
    "table_schema" ilike 'inriver' and upper("table_schema") = upper('inriver')

                    and 
    "table_name" ilike 'item_attributes' and upper("table_name") = upper('item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'manager' and upper("table_name") = upper('manager')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m23:26:11.162600 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:26:15.704552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFBE36EE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFBE363350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFBE363290>]}


============================== 23:26:15.704552 | f9bfc82e-6168-401c-8934-e02e39370c45 ==============================
[0m23:26:15.704552 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:26:15.704552 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'c:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'profiles_dir': 'c:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:26:15.805445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f9bfc82e-6168-401c-8934-e02e39370c45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFBE36E7D0>]}
[0m23:26:15.823204 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:26:15.825208 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:26:15.826210 [debug] [MainThread]: Command `cli deps` succeeded at 23:26:15.826210 after 0.18 seconds
[0m23:26:15.826210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFBE378050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFB8784D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFB8784DD0>]}
[0m23:26:15.827205 [debug] [MainThread]: Flushing usage events
[0m23:26:16.298511 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:26:19.864527 [debug] [ThreadPool]: SQL status: SUCCESS 42 in 8.696 seconds
[0m23:26:19.871127 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\catalog.json
[0m23:26:19.902277 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m23:26:19.902277 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m23:26:19.902277 [info ] [MainThread]: Catalog written to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\catalog.json
[0m23:26:19.902277 [debug] [MainThread]: Command `dbt docs generate` succeeded at 23:26:19.902277 after 10.89 seconds
[0m23:26:19.902277 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m23:26:19.902277 [debug] [MainThread]: Connection 'EPICALDEMO.information_schema' was left open.
[0m23:26:19.902277 [debug] [MainThread]: On EPICALDEMO.information_schema: Close
[0m23:26:19.974061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020373BA4150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020373BA4450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203734AFE90>]}
[0m23:26:19.974061 [debug] [MainThread]: Flushing usage events
[0m23:26:20.418815 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:26:25.482512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258734BFD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002587314F410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025872DBE190>]}


============================== 23:26:25.482512 | fadb23a4-e29c-44a0-82ca-62e78e26eabd ==============================
[0m23:26:25.482512 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:26:25.482512 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:26:25.889419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fadb23a4-e29c-44a0-82ca-62e78e26eabd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258746CA6D0>]}
[0m23:26:25.936687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fadb23a4-e29c-44a0-82ca-62e78e26eabd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002587462D810>]}
[0m23:29:31.363608 [error] [MainThread]: Encountered an error:

[0m23:29:31.377613 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socketserver.py", line 238, in serve_forever
    self._handle_request_noblock()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socketserver.py", line 317, in _handle_request_noblock
    self.process_request(request, client_address)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socketserver.py", line 348, in process_request
    self.finish_request(request, client_address)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socketserver.py", line 361, in finish_request
    self.RequestHandlerClass(request, client_address, self)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\http\server.py", line 671, in __init__
    super().__init__(*args, **kwargs)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socketserver.py", line 755, in __init__
    self.handle()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\http\server.py", line 436, in handle
    self.handle_one_request()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\http\server.py", line 404, in handle_one_request
    self.raw_requestline = self.rfile.readline(65537)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socket.py", line 706, in readinto
    return self._sock.recv_into(b)
           ^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m23:29:31.379107 [debug] [MainThread]: Command `dbt docs serve` failed at 23:29:31.379107 after 185.94 seconds
[0m23:29:31.379107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258734BDC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025874A51250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002587346B0D0>]}
[0m23:29:31.379107 [debug] [MainThread]: Flushing usage events
[0m23:29:31.851947 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:56:36.842571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B30D56D1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B30D56EB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B30D56E310>]}


============================== 09:56:36.847573 | df150892-3afa-4c9d-9703-eacca1c004c7 ==============================
[0m09:56:36.847573 [info ] [MainThread]: Running with dbt=1.9.4
[0m09:56:36.849573 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'c:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'version_check': 'True', 'profiles_dir': 'c:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:56:36.971824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df150892-3afa-4c9d-9703-eacca1c004c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3091C1C50>]}
[0m09:56:37.060062 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m09:56:37.062059 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m09:56:37.064065 [debug] [MainThread]: Command `cli deps` succeeded at 09:56:37.063057 after 0.32 seconds
[0m09:56:37.064065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B30D5DB710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B30D56FFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B30D56E850>]}
[0m09:56:37.065054 [debug] [MainThread]: Flushing usage events
[0m09:56:37.612260 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:19:03.465570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FECFB7DCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FECFB7DD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FECFBBB3D0>]}


============================== 10:19:03.478082 | ddc7865e-6b5d-49ad-abee-8d41ba4a9e5a ==============================
[0m10:19:03.478082 [info ] [MainThread]: Running with dbt=1.9.4
[0m10:19:03.478082 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:19:06.107374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ddc7865e-6b5d-49ad-abee-8d41ba4a9e5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FED0FA3450>]}
[0m10:19:06.149550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ddc7865e-6b5d-49ad-abee-8d41ba4a9e5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FECE54F990>]}
[0m10:19:06.158634 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m10:19:06.574093 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m10:19:07.715252 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:19:07.715252 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:19:07.720755 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m10:19:07.757346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ddc7865e-6b5d-49ad-abee-8d41ba4a9e5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FED150D390>]}
[0m10:19:07.991194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ddc7865e-6b5d-49ad-abee-8d41ba4a9e5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FED14F2290>]}
[0m10:19:07.992192 [info ] [MainThread]: Found 13 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m10:19:07.992192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ddc7865e-6b5d-49ad-abee-8d41ba4a9e5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FED1250410>]}
[0m10:19:07.994192 [info ] [MainThread]: 
[0m10:19:07.995193 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:19:07.995193 [info ] [MainThread]: 
[0m10:19:07.995193 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:19:08.001219 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m10:19:10.695036 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m10:19:10.696026 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m10:19:10.697026 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:19:11.592350 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.896 seconds
[0m10:19:11.596348 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m10:19:11.597343 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m10:19:11.816875 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bcee93-0004-ce00-0000-d2e90002601a
[0m10:19:11.817875 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m10:19:11.817875 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m10:19:11.819379 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m10:19:11.820384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ddc7865e-6b5d-49ad-abee-8d41ba4a9e5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FED12A4310>]}
[0m10:19:11.831470 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__categories
[0m10:19:11.832470 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_d365_fo__dates
[0m10:19:11.833469 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_d365_fo__items
[0m10:19:11.833469 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_d365_fo__managers
[0m10:19:11.835471 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__categories'
[0m10:19:11.837470 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__dates'
[0m10:19:11.838468 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__items'
[0m10:19:11.838468 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__managers'
[0m10:19:11.839471 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__categories
[0m10:19:11.840522 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_d365_fo__dates
[0m10:19:11.841525 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_d365_fo__items
[0m10:19:11.841525 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_d365_fo__managers
[0m10:19:11.853758 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__categories"
[0m10:19:11.858764 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__dates"
[0m10:19:11.862084 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__items"
[0m10:19:11.866083 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__managers"
[0m10:19:11.870600 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__categories
[0m10:19:11.871598 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__categories
[0m10:19:11.872605 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_d365_fo__dates
[0m10:19:11.872605 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_d365_fo__items
[0m10:19:11.873601 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_d365_fo__managers
[0m10:19:11.873601 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__transactions
[0m10:19:11.874606 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_d365_fo__dates
[0m10:19:11.875601 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_d365_fo__items
[0m10:19:11.876598 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_d365_fo__managers
[0m10:19:11.876598 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__categories, now model.epicaldemo.stg_d365_fo__transactions)
[0m10:19:11.876598 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_inriver__item_attributes
[0m10:19:11.877599 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_salesforce__customers
[0m10:19:11.877599 [debug] [Thread-4 (]: Began running node snapshot.epicaldemo.stores_snapshot
[0m10:19:11.878598 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__transactions
[0m10:19:11.878598 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__dates, now model.epicaldemo.stg_inriver__item_attributes)
[0m10:19:11.879598 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__items, now model.epicaldemo.stg_salesforce__customers)
[0m10:19:11.879598 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__managers, now snapshot.epicaldemo.stores_snapshot)
[0m10:19:11.886735 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__transactions"
[0m10:19:11.887734 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_inriver__item_attributes
[0m10:19:11.887734 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_salesforce__customers
[0m10:19:11.888735 [debug] [Thread-4 (]: Began compiling node snapshot.epicaldemo.stores_snapshot
[0m10:19:11.892254 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_inriver__item_attributes"
[0m10:19:11.897253 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_salesforce__customers"
[0m10:19:11.898254 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__transactions
[0m10:19:11.903784 [debug] [Thread-4 (]: Began executing node snapshot.epicaldemo.stores_snapshot
[0m10:19:11.907777 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__transactions
[0m10:19:11.909785 [debug] [Thread-4 (]: Finished running node snapshot.epicaldemo.stores_snapshot
[0m10:19:11.911305 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_inriver__item_attributes
[0m10:19:11.912308 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_salesforce__customers
[0m10:19:11.913307 [debug] [Thread-1 (]: Began running node model.epicaldemo.dim_dates
[0m10:19:11.914584 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_d365_fo__stores
[0m10:19:11.914584 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_inriver__item_attributes
[0m10:19:11.916600 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_salesforce__customers
[0m10:19:11.917599 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__transactions, now model.epicaldemo.dim_dates)
[0m10:19:11.917599 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly snapshot.epicaldemo.stores_snapshot, now model.epicaldemo.stg_d365_fo__stores)
[0m10:19:11.919595 [debug] [Thread-2 (]: Began running node model.epicaldemo.dim_items
[0m10:19:11.920843 [debug] [Thread-3 (]: Began running node model.epicaldemo.dim_customers
[0m10:19:11.920843 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.dim_dates
[0m10:19:11.922839 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_d365_fo__stores
[0m10:19:11.923838 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_inriver__item_attributes, now model.epicaldemo.dim_items)
[0m10:19:11.924838 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_salesforce__customers, now model.epicaldemo.dim_customers)
[0m10:19:11.930359 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.dim_dates"
[0m10:19:11.936371 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__stores"
[0m10:19:11.939358 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.dim_items
[0m10:19:11.940460 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.dim_customers
[0m10:19:11.945463 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.dim_items"
[0m10:19:11.946457 [debug] [Thread-1 (]: Began executing node model.epicaldemo.dim_dates
[0m10:19:11.949459 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.dim_customers"
[0m10:19:11.950505 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_d365_fo__stores
[0m10:19:11.953504 [debug] [Thread-1 (]: Finished running node model.epicaldemo.dim_dates
[0m10:19:11.953504 [debug] [Thread-2 (]: Began executing node model.epicaldemo.dim_items
[0m10:19:11.955524 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_d365_fo__stores
[0m10:19:11.956505 [debug] [Thread-3 (]: Began executing node model.epicaldemo.dim_customers
[0m10:19:11.956505 [debug] [Thread-2 (]: Finished running node model.epicaldemo.dim_items
[0m10:19:11.958506 [debug] [Thread-1 (]: Began running node model.epicaldemo.dim_stores
[0m10:19:11.958506 [debug] [Thread-4 (]: Began running node model.epicaldemo.fact_sales_transactions
[0m10:19:11.959503 [debug] [Thread-3 (]: Finished running node model.epicaldemo.dim_customers
[0m10:19:11.959503 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.dim_dates, now model.epicaldemo.dim_stores)
[0m10:19:11.960977 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__stores, now model.epicaldemo.fact_sales_transactions)
[0m10:19:11.960977 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.dim_stores
[0m10:19:11.961974 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.fact_sales_transactions
[0m10:19:11.964974 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.dim_stores"
[0m10:19:11.970497 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.fact_sales_transactions"
[0m10:19:11.973511 [debug] [Thread-1 (]: Began executing node model.epicaldemo.dim_stores
[0m10:19:11.974495 [debug] [Thread-1 (]: Finished running node model.epicaldemo.dim_stores
[0m10:19:11.974495 [debug] [Thread-4 (]: Began executing node model.epicaldemo.fact_sales_transactions
[0m10:19:11.975506 [debug] [Thread-4 (]: Finished running node model.epicaldemo.fact_sales_transactions
[0m10:19:11.977495 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:19:11.977495 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m10:19:11.977495 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m10:19:12.156490 [debug] [MainThread]: Connection 'model.epicaldemo.dim_stores' was properly closed.
[0m10:19:12.158493 [debug] [MainThread]: Connection 'model.epicaldemo.dim_items' was properly closed.
[0m10:19:12.159489 [debug] [MainThread]: Connection 'model.epicaldemo.dim_customers' was properly closed.
[0m10:19:12.159997 [debug] [MainThread]: Connection 'model.epicaldemo.fact_sales_transactions' was properly closed.
[0m10:19:12.162002 [debug] [MainThread]: Command end result
[0m10:19:12.261365 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m10:19:12.301444 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m10:19:12.310472 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m10:19:12.641062 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m10:19:12.642065 [info ] [MainThread]: Building catalog
[0m10:19:12.657581 [debug] [ThreadPool]: Acquiring new snowflake connection 'EPICALDEMO.information_schema'
[0m10:19:12.683551 [debug] [ThreadPool]: Using snowflake connection "EPICALDEMO.information_schema"
[0m10:19:12.684812 [debug] [ThreadPool]: On EPICALDEMO.information_schema: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "EPICALDEMO.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from EPICALDEMO.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'category' and upper("table_name") = upper('category')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_salesforce__customers' and upper("table_name") = upper('stg_salesforce__customers')

                )
             or 
                (
                    
    "table_schema" ilike 'inriver' and upper("table_schema") = upper('inriver')

                    and 
    "table_name" ilike 'item_attributes' and upper("table_name") = upper('item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_items' and upper("table_name") = upper('dim_items')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'date' and upper("table_name") = upper('date')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__dates' and upper("table_name") = upper('stg_d365_fo__dates')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'store' and upper("table_name") = upper('store')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'manager' and upper("table_name") = upper('manager')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__managers' and upper("table_name") = upper('stg_d365_fo__managers')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_dates' and upper("table_name") = upper('dim_dates')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_inriver__item_attributes' and upper("table_name") = upper('stg_inriver__item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stores_snapshot' and upper("table_name") = upper('stores_snapshot')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_stores' and upper("table_name") = upper('dim_stores')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__transactions' and upper("table_name") = upper('stg_d365_fo__transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__stores' and upper("table_name") = upper('stg_d365_fo__stores')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'item' and upper("table_name") = upper('item')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'fact_sales_transactions' and upper("table_name") = upper('fact_sales_transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__items' and upper("table_name") = upper('stg_d365_fo__items')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'transactions' and upper("table_name") = upper('transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__categories' and upper("table_name") = upper('stg_d365_fo__categories')

                )
             or 
                (
                    
    "table_schema" ilike 'salesforce' and upper("table_schema") = upper('salesforce')

                    and 
    "table_name" ilike 'customer' and upper("table_name") = upper('customer')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_customers' and upper("table_name") = upper('dim_customers')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from EPICALDEMO.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'category' and upper("table_name") = upper('category')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_salesforce__customers' and upper("table_name") = upper('stg_salesforce__customers')

                )
             or 
                (
                    
    "table_schema" ilike 'inriver' and upper("table_schema") = upper('inriver')

                    and 
    "table_name" ilike 'item_attributes' and upper("table_name") = upper('item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_items' and upper("table_name") = upper('dim_items')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'date' and upper("table_name") = upper('date')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__dates' and upper("table_name") = upper('stg_d365_fo__dates')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'store' and upper("table_name") = upper('store')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'manager' and upper("table_name") = upper('manager')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__managers' and upper("table_name") = upper('stg_d365_fo__managers')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_dates' and upper("table_name") = upper('dim_dates')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_inriver__item_attributes' and upper("table_name") = upper('stg_inriver__item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stores_snapshot' and upper("table_name") = upper('stores_snapshot')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_stores' and upper("table_name") = upper('dim_stores')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__transactions' and upper("table_name") = upper('stg_d365_fo__transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__stores' and upper("table_name") = upper('stg_d365_fo__stores')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'item' and upper("table_name") = upper('item')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'fact_sales_transactions' and upper("table_name") = upper('fact_sales_transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__items' and upper("table_name") = upper('stg_d365_fo__items')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'transactions' and upper("table_name") = upper('transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__categories' and upper("table_name") = upper('stg_d365_fo__categories')

                )
             or 
                (
                    
    "table_schema" ilike 'salesforce' and upper("table_schema") = upper('salesforce')

                    and 
    "table_name" ilike 'customer' and upper("table_name") = upper('customer')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_customers' and upper("table_name") = upper('dim_customers')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m10:19:12.687930 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:19:22.463435 [debug] [ThreadPool]: SQL status: SUCCESS 42 in 9.775 seconds
[0m10:19:22.490661 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\catalog.json
[0m10:19:22.517852 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m10:19:22.524393 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m10:19:22.526381 [info ] [MainThread]: Catalog written to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\catalog.json
[0m10:19:22.528382 [debug] [MainThread]: Command `dbt docs generate` succeeded at 10:19:22.528382 after 19.15 seconds
[0m10:19:22.529889 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m10:19:22.529889 [debug] [MainThread]: Connection 'EPICALDEMO.information_schema' was left open.
[0m10:19:22.530896 [debug] [MainThread]: On EPICALDEMO.information_schema: Close
[0m10:19:22.703988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FECF8951D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FECF4A9E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FECD014BD0>]}
[0m10:19:22.704988 [debug] [MainThread]: Flushing usage events
[0m10:19:23.201131 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:19:43.263218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A7CC79D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A7C8B4790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A7CC70390>]}


============================== 10:19:43.266222 | dcb426f7-75c4-4bb7-8aa8-dd3573c0fa0b ==============================
[0m10:19:43.266222 [info ] [MainThread]: Running with dbt=1.9.4
[0m10:19:43.268219 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m10:19:43.678013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dcb426f7-75c4-4bb7-8aa8-dd3573c0fa0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A78DE95D0>]}
[0m10:19:43.721112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dcb426f7-75c4-4bb7-8aa8-dd3573c0fa0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A7B64F9D0>]}
[0m10:19:43.722116 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m10:19:44.077634 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m10:19:44.314134 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:19:44.315133 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:19:44.320653 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m10:19:44.362800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dcb426f7-75c4-4bb7-8aa8-dd3573c0fa0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A7E6ACC90>]}
[0m10:19:44.387822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dcb426f7-75c4-4bb7-8aa8-dd3573c0fa0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A7DFA3AD0>]}
[0m10:19:44.387822 [info ] [MainThread]: Found 13 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m10:19:44.389329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dcb426f7-75c4-4bb7-8aa8-dd3573c0fa0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A7E3E7950>]}
[0m10:19:44.394338 [info ] [MainThread]: 
[0m10:19:44.394338 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:19:44.395337 [info ] [MainThread]: 
[0m10:19:44.397339 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:19:44.405869 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m10:19:44.497994 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m10:19:44.497994 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m10:19:44.497994 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:19:45.295830 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.797 seconds
[0m10:19:45.299336 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m10:19:45.300352 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m10:19:45.420579 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bcee93-0004-cdcc-0000-d2e90002332a
[0m10:19:45.421580 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m10:19:45.421580 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m10:19:45.423087 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m10:19:45.424095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dcb426f7-75c4-4bb7-8aa8-dd3573c0fa0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A7DE3D4D0>]}
[0m10:19:45.428090 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__categories
[0m10:19:45.428090 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_d365_fo__dates
[0m10:19:45.428090 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_d365_fo__items
[0m10:19:45.428090 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_d365_fo__managers
[0m10:19:45.429593 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__categories'
[0m10:19:45.429593 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__dates'
[0m10:19:45.430596 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__items'
[0m10:19:45.431599 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__managers'
[0m10:19:45.431599 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__categories
[0m10:19:45.432598 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_d365_fo__dates
[0m10:19:45.432598 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_d365_fo__items
[0m10:19:45.433596 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_d365_fo__managers
[0m10:19:45.440111 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__categories"
[0m10:19:45.442114 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__dates"
[0m10:19:45.444132 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__items"
[0m10:19:45.447124 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__managers"
[0m10:19:45.448118 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__categories
[0m10:19:45.448118 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_d365_fo__dates
[0m10:19:45.449625 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_d365_fo__items
[0m10:19:45.449625 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__categories
[0m10:19:45.450633 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_d365_fo__dates
[0m10:19:45.451633 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_d365_fo__managers
[0m10:19:45.451633 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_d365_fo__items
[0m10:19:45.452632 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__transactions
[0m10:19:45.452632 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_inriver__item_attributes
[0m10:19:45.453633 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_d365_fo__managers
[0m10:19:45.454643 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_salesforce__customers
[0m10:19:45.454643 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__categories, now model.epicaldemo.stg_d365_fo__transactions)
[0m10:19:45.455632 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__dates, now model.epicaldemo.stg_inriver__item_attributes)
[0m10:19:45.455632 [debug] [Thread-4 (]: Began running node snapshot.epicaldemo.stores_snapshot
[0m10:19:45.456630 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__items, now model.epicaldemo.stg_salesforce__customers)
[0m10:19:45.456630 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__transactions
[0m10:19:45.457633 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_inriver__item_attributes
[0m10:19:45.457633 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__managers, now snapshot.epicaldemo.stores_snapshot)
[0m10:19:45.457633 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_salesforce__customers
[0m10:19:45.462160 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__transactions"
[0m10:19:45.466150 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_inriver__item_attributes"
[0m10:19:45.467149 [debug] [Thread-4 (]: Began compiling node snapshot.epicaldemo.stores_snapshot
[0m10:19:45.469657 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_salesforce__customers"
[0m10:19:45.473664 [debug] [Thread-4 (]: Began executing node snapshot.epicaldemo.stores_snapshot
[0m10:19:45.474662 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__transactions
[0m10:19:45.474662 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_inriver__item_attributes
[0m10:19:45.475663 [debug] [Thread-4 (]: Finished running node snapshot.epicaldemo.stores_snapshot
[0m10:19:45.476662 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_salesforce__customers
[0m10:19:45.477664 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__transactions
[0m10:19:45.477664 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_inriver__item_attributes
[0m10:19:45.478662 [debug] [Thread-4 (]: Began running node model.epicaldemo.dim_dates
[0m10:19:45.479664 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_salesforce__customers
[0m10:19:45.479664 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__stores
[0m10:19:45.480838 [debug] [Thread-2 (]: Began running node model.epicaldemo.dim_items
[0m10:19:45.481838 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly snapshot.epicaldemo.stores_snapshot, now model.epicaldemo.dim_dates)
[0m10:19:45.482842 [debug] [Thread-3 (]: Began running node model.epicaldemo.dim_customers
[0m10:19:45.482842 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__transactions, now model.epicaldemo.stg_d365_fo__stores)
[0m10:19:45.483839 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_inriver__item_attributes, now model.epicaldemo.dim_items)
[0m10:19:45.483839 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.dim_dates
[0m10:19:45.484838 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_salesforce__customers, now model.epicaldemo.dim_customers)
[0m10:19:45.484838 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__stores
[0m10:19:45.485837 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.dim_items
[0m10:19:45.487849 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.dim_dates"
[0m10:19:45.489362 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.dim_customers
[0m10:19:45.492372 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__stores"
[0m10:19:45.494371 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.dim_items"
[0m10:19:45.497384 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.dim_customers"
[0m10:19:45.498372 [debug] [Thread-4 (]: Began executing node model.epicaldemo.dim_dates
[0m10:19:45.499371 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__stores
[0m10:19:45.499876 [debug] [Thread-2 (]: Began executing node model.epicaldemo.dim_items
[0m10:19:45.500880 [debug] [Thread-4 (]: Finished running node model.epicaldemo.dim_dates
[0m10:19:45.500880 [debug] [Thread-3 (]: Began executing node model.epicaldemo.dim_customers
[0m10:19:45.501884 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__stores
[0m10:19:45.501884 [debug] [Thread-2 (]: Finished running node model.epicaldemo.dim_items
[0m10:19:45.502886 [debug] [Thread-3 (]: Finished running node model.epicaldemo.dim_customers
[0m10:19:45.503885 [debug] [Thread-4 (]: Began running node model.epicaldemo.dim_stores
[0m10:19:45.503885 [debug] [Thread-1 (]: Began running node model.epicaldemo.fact_sales_transactions
[0m10:19:45.504888 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.dim_dates, now model.epicaldemo.dim_stores)
[0m10:19:45.505886 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__stores, now model.epicaldemo.fact_sales_transactions)
[0m10:19:45.505886 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.dim_stores
[0m10:19:45.506885 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.fact_sales_transactions
[0m10:19:45.509389 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.dim_stores"
[0m10:19:45.512398 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.fact_sales_transactions"
[0m10:19:45.513397 [debug] [Thread-4 (]: Began executing node model.epicaldemo.dim_stores
[0m10:19:45.514398 [debug] [Thread-4 (]: Finished running node model.epicaldemo.dim_stores
[0m10:19:45.514398 [debug] [Thread-1 (]: Began executing node model.epicaldemo.fact_sales_transactions
[0m10:19:45.515400 [debug] [Thread-1 (]: Finished running node model.epicaldemo.fact_sales_transactions
[0m10:19:45.516398 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:19:45.517398 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m10:19:45.517398 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m10:19:45.683602 [debug] [MainThread]: Connection 'model.epicaldemo.fact_sales_transactions' was properly closed.
[0m10:19:45.684602 [debug] [MainThread]: Connection 'model.epicaldemo.dim_items' was properly closed.
[0m10:19:45.684602 [debug] [MainThread]: Connection 'model.epicaldemo.dim_customers' was properly closed.
[0m10:19:45.684602 [debug] [MainThread]: Connection 'model.epicaldemo.dim_stores' was properly closed.
[0m10:19:45.687604 [debug] [MainThread]: Command end result
[0m10:19:45.762247 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m10:19:45.767246 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m10:19:45.773756 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m10:19:45.776767 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m10:19:45.777768 [info ] [MainThread]: Building catalog
[0m10:19:45.787247 [debug] [ThreadPool]: Acquiring new snowflake connection 'EPICALDEMO.information_schema'
[0m10:19:45.804274 [debug] [ThreadPool]: Using snowflake connection "EPICALDEMO.information_schema"
[0m10:19:45.805274 [debug] [ThreadPool]: On EPICALDEMO.information_schema: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "EPICALDEMO.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from EPICALDEMO.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_salesforce__customers' and upper("table_name") = upper('stg_salesforce__customers')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__items' and upper("table_name") = upper('stg_d365_fo__items')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'item' and upper("table_name") = upper('item')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__managers' and upper("table_name") = upper('stg_d365_fo__managers')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__categories' and upper("table_name") = upper('stg_d365_fo__categories')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_items' and upper("table_name") = upper('dim_items')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_stores' and upper("table_name") = upper('dim_stores')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__stores' and upper("table_name") = upper('stg_d365_fo__stores')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__transactions' and upper("table_name") = upper('stg_d365_fo__transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__dates' and upper("table_name") = upper('stg_d365_fo__dates')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'transactions' and upper("table_name") = upper('transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'store' and upper("table_name") = upper('store')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'date' and upper("table_name") = upper('date')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'fact_sales_transactions' and upper("table_name") = upper('fact_sales_transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'salesforce' and upper("table_schema") = upper('salesforce')

                    and 
    "table_name" ilike 'customer' and upper("table_name") = upper('customer')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_customers' and upper("table_name") = upper('dim_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'manager' and upper("table_name") = upper('manager')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'category' and upper("table_name") = upper('category')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_dates' and upper("table_name") = upper('dim_dates')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_inriver__item_attributes' and upper("table_name") = upper('stg_inriver__item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'inriver' and upper("table_schema") = upper('inriver')

                    and 
    "table_name" ilike 'item_attributes' and upper("table_name") = upper('item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stores_snapshot' and upper("table_name") = upper('stores_snapshot')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from EPICALDEMO.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_salesforce__customers' and upper("table_name") = upper('stg_salesforce__customers')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__items' and upper("table_name") = upper('stg_d365_fo__items')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'item' and upper("table_name") = upper('item')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__managers' and upper("table_name") = upper('stg_d365_fo__managers')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__categories' and upper("table_name") = upper('stg_d365_fo__categories')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_items' and upper("table_name") = upper('dim_items')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_stores' and upper("table_name") = upper('dim_stores')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__stores' and upper("table_name") = upper('stg_d365_fo__stores')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__transactions' and upper("table_name") = upper('stg_d365_fo__transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__dates' and upper("table_name") = upper('stg_d365_fo__dates')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'transactions' and upper("table_name") = upper('transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'store' and upper("table_name") = upper('store')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'date' and upper("table_name") = upper('date')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'fact_sales_transactions' and upper("table_name") = upper('fact_sales_transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'salesforce' and upper("table_schema") = upper('salesforce')

                    and 
    "table_name" ilike 'customer' and upper("table_name") = upper('customer')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_customers' and upper("table_name") = upper('dim_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'manager' and upper("table_name") = upper('manager')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'category' and upper("table_name") = upper('category')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_dates' and upper("table_name") = upper('dim_dates')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_inriver__item_attributes' and upper("table_name") = upper('stg_inriver__item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'inriver' and upper("table_schema") = upper('inriver')

                    and 
    "table_name" ilike 'item_attributes' and upper("table_name") = upper('item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stores_snapshot' and upper("table_name") = upper('stores_snapshot')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m10:19:45.806275 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:20:01.671772 [debug] [ThreadPool]: SQL status: SUCCESS 42 in 15.865 seconds
[0m10:20:01.693822 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\catalog.json
[0m10:20:01.714403 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m10:20:01.717401 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m10:20:01.717401 [info ] [MainThread]: Catalog written to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\catalog.json
[0m10:20:01.719403 [debug] [MainThread]: Command `dbt docs generate` succeeded at 10:20:01.718402 after 18.52 seconds
[0m10:20:01.719403 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m10:20:01.719403 [debug] [MainThread]: Connection 'EPICALDEMO.information_schema' was left open.
[0m10:20:01.720717 [debug] [MainThread]: On EPICALDEMO.information_schema: Close
[0m10:20:01.894542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A7CCBBDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A7CCBB290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A7CCB9E50>]}
[0m10:20:01.895542 [debug] [MainThread]: Flushing usage events
[0m10:20:02.443587 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:20:07.001781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001814E879750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001814E879910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001814E879AD0>]}


============================== 10:20:07.004780 | f908b04f-7f60-4ac1-9c10-9422402c0e6d ==============================
[0m10:20:07.004780 [info ] [MainThread]: Running with dbt=1.9.4
[0m10:20:07.005781 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:20:07.417983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f908b04f-7f60-4ac1-9c10-9422402c0e6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001814FA9B8D0>]}
[0m10:20:07.461636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f908b04f-7f60-4ac1-9c10-9422402c0e6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001814D24FA10>]}
[0m10:22:50.321815 [error] [MainThread]: Encountered an error:

[0m10:22:50.345262 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m10:22:50.348263 [debug] [MainThread]: Command `dbt docs serve` failed at 10:22:50.348263 after 163.41 seconds
[0m10:22:50.348263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001814E54F990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001814E879990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001814E867B90>]}
[0m10:22:50.349769 [debug] [MainThread]: Flushing usage events
[0m10:22:50.942823 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:22:58.701922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025508A72490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025508A93510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025508A70650>]}


============================== 10:22:58.705922 | 8124712d-45f6-4651-9244-9861923a1ea5 ==============================
[0m10:22:58.705922 [info ] [MainThread]: Running with dbt=1.9.4
[0m10:22:58.707913 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:22:59.124241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8124712d-45f6-4651-9244-9861923a1ea5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025509D68BD0>]}
[0m10:22:59.166384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8124712d-45f6-4651-9244-9861923a1ea5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025509C5B4D0>]}
[0m10:22:59.167376 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m10:22:59.478699 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m10:22:59.672369 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:22:59.672369 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:22:59.678364 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m10:22:59.715136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8124712d-45f6-4651-9244-9861923a1ea5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002550A40C410>]}
[0m10:22:59.790456 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m10:22:59.794460 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m10:22:59.834110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8124712d-45f6-4651-9244-9861923a1ea5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002550A50B550>]}
[0m10:22:59.835109 [info ] [MainThread]: Found 13 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m10:22:59.835109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8124712d-45f6-4651-9244-9861923a1ea5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002550A1E7910>]}
[0m10:22:59.837621 [info ] [MainThread]: 
[0m10:22:59.837621 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:22:59.838630 [info ] [MainThread]: 
[0m10:22:59.839631 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:22:59.840137 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m10:22:59.923355 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m10:22:59.923355 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m10:22:59.924355 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:23:00.814579 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.890 seconds
[0m10:23:00.816583 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_EPICALDEMO, now create_EPICALDEMO_broman_analytics)
[0m10:23:00.816583 [debug] [ThreadPool]: Creating schema "database: "EPICALDEMO"
schema: "broman_analytics"
"
[0m10:23:00.820608 [debug] [ThreadPool]: Using snowflake connection "create_EPICALDEMO_broman_analytics"
[0m10:23:00.821608 [debug] [ThreadPool]: On create_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "create_EPICALDEMO_broman_analytics"} */
create schema if not exists EPICALDEMO.broman_analytics
[0m10:23:00.955615 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.133 seconds
[0m10:23:00.960657 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m10:23:00.970169 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m10:23:00.971179 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m10:23:00.971179 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:23:01.913742 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.942 seconds
[0m10:23:01.917742 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m10:23:01.918731 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m10:23:02.056318 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.137 seconds
[0m10:23:02.059335 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m10:23:02.060404 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m10:23:02.191712 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.131 seconds
[0m10:23:02.193711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8124712d-45f6-4651-9244-9861923a1ea5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025507481510>]}
[0m10:23:02.197705 [debug] [Thread-1 (]: Began running node snapshot.epicaldemo.stores_snapshot
[0m10:23:02.197705 [info ] [Thread-1 (]: 1 of 1 START snapshot broman_analytics.stores_snapshot ......................... [RUN]
[0m10:23:02.198706 [debug] [Thread-1 (]: Acquiring new snowflake connection 'snapshot.epicaldemo.stores_snapshot'
[0m10:23:02.199708 [debug] [Thread-1 (]: Began compiling node snapshot.epicaldemo.stores_snapshot
[0m10:23:02.205748 [debug] [Thread-1 (]: Began executing node snapshot.epicaldemo.stores_snapshot
[0m10:23:02.277262 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m10:23:02.278254 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id,
        modified as dbt_updated_at,
        modified as dbt_valid_from,
        
  
  coalesce(nullif(modified, modified), to_date('9999-12-31'))
  as dbt_valid_to
from (
        select * from EPICALDEMO.d365_fo.store
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m10:23:02.278254 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:23:03.181352 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.903 seconds
[0m10:23:03.186359 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m10:23:03.186359 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m10:23:03.298182 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.111 seconds
[0m10:23:03.298182 [warn ] [Thread-1 (]: Data type of snapshot table timestamp columns (TIMESTAMP_NTZ) doesn't match derived column 'updated_at' (DATE). Please update snapshot config 'updated_at'.
[0m10:23:03.299684 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.epicaldemo.stores_snapshot"
[0m10:23:03.301710 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m10:23:03.302706 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
create or replace transient table EPICALDEMO.broman_analytics.stores_snapshot
    

    
    as (
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id,
        modified as dbt_updated_at,
        modified as dbt_valid_from,
        
  
  coalesce(nullif(modified, modified), to_date('9999-12-31'))
  as dbt_valid_to
from (
        select * from EPICALDEMO.d365_fo.store
    ) sbq



    )
;
[0m10:23:04.253327 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.950 seconds
[0m10:23:04.292916 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8124712d-45f6-4651-9244-9861923a1ea5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025509CAA0D0>]}
[0m10:23:04.294909 [info ] [Thread-1 (]: 1 of 1 OK snapshotted broman_analytics.stores_snapshot ......................... [[32mSUCCESS 1[0m in 2.07s]
[0m10:23:04.294909 [debug] [Thread-1 (]: Finished running node snapshot.epicaldemo.stores_snapshot
[0m10:23:04.296909 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:23:04.296909 [debug] [MainThread]: Connection 'create_EPICALDEMO_broman_analytics' was left open.
[0m10:23:04.297918 [debug] [MainThread]: On create_EPICALDEMO_broman_analytics: Close
[0m10:23:04.462746 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m10:23:04.463745 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m10:23:04.625759 [debug] [MainThread]: Connection 'snapshot.epicaldemo.stores_snapshot' was left open.
[0m10:23:04.626756 [debug] [MainThread]: On snapshot.epicaldemo.stores_snapshot: Close
[0m10:23:04.793549 [info ] [MainThread]: 
[0m10:23:04.794561 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 4.95 seconds (4.95s).
[0m10:23:04.795549 [debug] [MainThread]: Command end result
[0m10:23:04.817593 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m10:23:04.820801 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m10:23:04.825802 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m10:23:04.825802 [info ] [MainThread]: 
[0m10:23:04.826802 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:23:04.827802 [info ] [MainThread]: 
[0m10:23:04.827802 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:23:04.829803 [debug] [MainThread]: Command `dbt snapshot` succeeded at 10:23:04.829803 after 6.20 seconds
[0m10:23:04.830828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025502EF3090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025502E72190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025502E72210>]}
[0m10:23:04.830828 [debug] [MainThread]: Flushing usage events
[0m10:23:05.382900 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:23:13.265494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0F0F72690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0F0F71010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0F0F71150>]}


============================== 10:23:13.270002 | d08d1f8f-7d3a-4c02-b86b-0e699ece8687 ==============================
[0m10:23:13.270002 [info ] [MainThread]: Running with dbt=1.9.4
[0m10:23:13.272009 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt build', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:23:13.697086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd08d1f8f-7d3a-4c02-b86b-0e699ece8687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0F261CBD0>]}
[0m10:23:13.738131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd08d1f8f-7d3a-4c02-b86b-0e699ece8687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0EF74FAD0>]}
[0m10:23:13.740644 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m10:23:14.047288 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m10:23:14.240459 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:23:14.240459 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:23:14.245998 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m10:23:14.283097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd08d1f8f-7d3a-4c02-b86b-0e699ece8687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0F29AD250>]}
[0m10:23:14.357300 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m10:23:14.361798 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m10:23:14.439670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd08d1f8f-7d3a-4c02-b86b-0e699ece8687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0F2E57F50>]}
[0m10:23:14.439670 [info ] [MainThread]: Found 13 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m10:23:14.442803 [info ] [MainThread]: 
[0m10:23:14.443788 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:23:14.443788 [info ] [MainThread]: 
[0m10:23:14.445162 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:23:14.449675 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m10:23:14.532415 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m10:23:14.532415 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m10:23:14.533404 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:23:15.441740 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.909 seconds
[0m10:23:15.445246 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m10:23:15.453780 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m10:23:15.454781 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m10:23:15.454781 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:23:16.073756 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.619 seconds
[0m10:23:16.077756 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m10:23:16.077756 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m10:23:16.224346 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.146 seconds
[0m10:23:16.225340 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m10:23:16.226343 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m10:23:16.566638 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.340 seconds
[0m10:23:16.569641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd08d1f8f-7d3a-4c02-b86b-0e699ece8687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0F30B3890>]}
[0m10:23:16.574188 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__categories
[0m10:23:16.574188 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_d365_fo__dates
[0m10:23:16.574188 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_d365_fo__items
[0m10:23:16.575183 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_d365_fo__managers
[0m10:23:16.575183 [info ] [Thread-1 (]: 1 of 14 START sql view model broman_analytics.stg_d365_fo__categories .......... [RUN]
[0m10:23:16.576181 [info ] [Thread-2 (]: 2 of 14 START sql view model broman_analytics.stg_d365_fo__dates ............... [RUN]
[0m10:23:16.577183 [info ] [Thread-3 (]: 3 of 14 START sql view model broman_analytics.stg_d365_fo__items ............... [RUN]
[0m10:23:16.577183 [info ] [Thread-4 (]: 4 of 14 START sql view model broman_analytics.stg_d365_fo__managers ............ [RUN]
[0m10:23:16.578181 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__categories'
[0m10:23:16.578181 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__dates'
[0m10:23:16.579689 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__items'
[0m10:23:16.579689 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__managers'
[0m10:23:16.580697 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__categories
[0m10:23:16.580697 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_d365_fo__dates
[0m10:23:16.580697 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_d365_fo__items
[0m10:23:16.581698 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_d365_fo__managers
[0m10:23:16.587695 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__categories"
[0m10:23:16.591241 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__dates"
[0m10:23:16.593238 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__items"
[0m10:23:16.595234 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__managers"
[0m10:23:16.597226 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__categories
[0m10:23:16.597226 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_d365_fo__dates
[0m10:23:16.597226 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_d365_fo__items
[0m10:23:16.619768 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__categories"
[0m10:23:16.620773 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_d365_fo__managers
[0m10:23:16.622776 [debug] [Thread-2 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__dates"
[0m10:23:16.626776 [debug] [Thread-3 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__items"
[0m10:23:16.629776 [debug] [Thread-4 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__managers"
[0m10:23:16.631286 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__categories"
[0m10:23:16.633295 [debug] [Thread-2 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__dates"
[0m10:23:16.634296 [debug] [Thread-1 (]: On model.epicaldemo.stg_d365_fo__categories: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__categories"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__categories
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.category
),

final AS (
    SELECT
        id AS "category_id"
        ,INITCAP(name) AS "Category"
        ,managerid AS "manager_id"
    FROM source
)

SELECT * FROM final
  );
[0m10:23:16.635331 [debug] [Thread-2 (]: On model.epicaldemo.stg_d365_fo__dates: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__dates"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__dates
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.date
),

final AS (
    SELECT
        id AS date_id
        ,date AS "Date"
        ,year AS "Year"
        ,yearmonth AS "Year Month"
        ,monthnumber AS "Month Number"
        ,quarter AS "Quarter"
        ,quarternumber AS "Quarter Number"
        ,monthname AS "Month"
    FROM source
)

SELECT * FROM final
  );
[0m10:23:16.635331 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:23:16.636291 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:23:16.649847 [debug] [Thread-3 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__items"
[0m10:23:16.650854 [debug] [Thread-3 (]: On model.epicaldemo.stg_d365_fo__items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__items"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__items
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.item
),

final AS (
    SELECT
        id AS "item_id"
        ,name AS "Item"
        ,COALESCE(brand, 'Missing') AS "Brand"
        ,categoryid AS "category_id"
        ,COALESCE(flavor, 'Missing') AS "Flavor"
        ,sku AS "SKU"
    FROM source
)

SELECT * FROM final
  );
[0m10:23:16.650854 [debug] [Thread-4 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__managers"
[0m10:23:16.651857 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:23:16.651857 [debug] [Thread-4 (]: On model.epicaldemo.stg_d365_fo__managers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__managers"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__managers
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.manager
),

final as (
    SELECT
        id AS "manager_id"
        ,firstname || ' ' || lastname AS "Manager"
    FROM source
)

SELECT * FROM final
  );
[0m10:23:16.653853 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:23:17.337948 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.684 seconds
[0m10:23:17.361002 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd08d1f8f-7d3a-4c02-b86b-0e699ece8687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0F31F7CD0>]}
[0m10:23:17.362004 [info ] [Thread-4 (]: 4 of 14 OK created sql view model broman_analytics.stg_d365_fo__managers ....... [[32mSUCCESS 1[0m in 0.78s]
[0m10:23:17.364002 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_d365_fo__managers
[0m10:23:17.364002 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_d365_fo__transactions
[0m10:23:17.366432 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.730 seconds
[0m10:23:17.366432 [info ] [Thread-4 (]: 5 of 14 START sql view model broman_analytics.stg_d365_fo__transactions ........ [RUN]
[0m10:23:17.370564 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd08d1f8f-7d3a-4c02-b86b-0e699ece8687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0F36E8E90>]}
[0m10:23:17.370564 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__managers, now model.epicaldemo.stg_d365_fo__transactions)
[0m10:23:17.373565 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_d365_fo__transactions
[0m10:23:17.372564 [info ] [Thread-1 (]: 1 of 14 OK created sql view model broman_analytics.stg_d365_fo__categories ..... [[32mSUCCESS 1[0m in 0.79s]
[0m10:23:17.377566 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__transactions"
[0m10:23:17.377566 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__categories
[0m10:23:17.379564 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_inriver__item_attributes
[0m10:23:17.380583 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_d365_fo__transactions
[0m10:23:17.379564 [info ] [Thread-1 (]: 6 of 14 START sql view model broman_analytics.stg_inriver__item_attributes ..... [RUN]
[0m10:23:17.386598 [debug] [Thread-4 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__transactions"
[0m10:23:17.387596 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__categories, now model.epicaldemo.stg_inriver__item_attributes)
[0m10:23:17.388589 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_inriver__item_attributes
[0m10:23:17.394110 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_inriver__item_attributes"
[0m10:23:17.396113 [debug] [Thread-4 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__transactions"
[0m10:23:17.397110 [debug] [Thread-4 (]: On model.epicaldemo.stg_d365_fo__transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__transactions"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__transactions
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.transactions
),

final AS (
    SELECT
        -- Identifiers
        CAST(TO_CHAR(date::DATE, 'YYYYMMDD') AS INTEGER) AS "date_id"
        ,sku AS "SKU"
        ,store AS "Store"
        ,customernumber AS "Customer Number"

        -- Metrics
        ,quantity AS "Qty"
        ,unitprice::NUMERIC(10,2) AS "Unit Price"
        ,(quantity * unitprice)::NUMERIC(10,2) AS "Sales Amount"
        ,unitcost::NUMERIC(10,2) AS "Unit Cost"
        ,(quantity * unitcost)::NUMERIC(10,2) AS "Cost"
        ,(quantity * unitprice)::NUMERIC(10,2) - (quantity * unitcost)::NUMERIC(10,2) AS "Margin"
    FROM source
)

SELECT * FROM final
  );
[0m10:23:17.398110 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_inriver__item_attributes
[0m10:23:17.404892 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.stg_inriver__item_attributes"
[0m10:23:17.407894 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.stg_inriver__item_attributes"
[0m10:23:17.409402 [debug] [Thread-1 (]: On model.epicaldemo.stg_inriver__item_attributes: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_inriver__item_attributes"} */
create or replace   view EPICALDEMO.broman_analytics.stg_inriver__item_attributes
  
   as (
    with

source as (
    select
        *
    from EPICALDEMO.inriver.item_attributes
),

final as (
    select
        id AS "item_attributes_id"
        ,sku AS "SKU"
        ,COALESCE(crunch_level, 'Missing') AS "Crunch Level"
        ,COALESCE(snack_time, 'Missing') AS "Snack Time"
    from source
)

select * from final
  );
[0m10:23:17.458544 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.823 seconds
[0m10:23:17.462061 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd08d1f8f-7d3a-4c02-b86b-0e699ece8687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0F32E9BD0>]}
[0m10:23:17.463061 [info ] [Thread-2 (]: 2 of 14 OK created sql view model broman_analytics.stg_d365_fo__dates .......... [[32mSUCCESS 1[0m in 0.88s]
[0m10:23:17.465061 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_d365_fo__dates
[0m10:23:17.466063 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_salesforce__customers
[0m10:23:17.466567 [info ] [Thread-2 (]: 7 of 14 START sql view model broman_analytics.stg_salesforce__customers ........ [RUN]
[0m10:23:17.467576 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__dates, now model.epicaldemo.stg_salesforce__customers)
[0m10:23:17.468581 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_salesforce__customers
[0m10:23:17.473113 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_salesforce__customers"
[0m10:23:17.474113 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_salesforce__customers
[0m10:23:17.478113 [debug] [Thread-2 (]: Writing runtime sql for node "model.epicaldemo.stg_salesforce__customers"
[0m10:23:17.481625 [debug] [Thread-2 (]: Using snowflake connection "model.epicaldemo.stg_salesforce__customers"
[0m10:23:17.482621 [debug] [Thread-2 (]: On model.epicaldemo.stg_salesforce__customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_salesforce__customers"} */
create or replace   view EPICALDEMO.broman_analytics.stg_salesforce__customers
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.salesforce.customer
),

final AS (
    SELECT
        id AS "customer_id"
        ,customernumber AS "Customer Number"
        ,age AS "Customer Age"

        ,CASE
            WHEN age < 20 THEN '< 20'
            WHEN age >= 20 AND age < 30 THEN '20 - 30'
            WHEN age >= 30 AND age < 50 THEN '30 - 50'
            WHEN age >= 50 AND age < 60 THEN '50 - 60'
            ELSE '60+'
         END AS "Customer Age Group"

        ,CASE
            WHEN age < 20 THEN 1
            WHEN age >= 20 AND age < 30 THEN 2
            WHEN age >= 30 AND age < 50 THEN 3
            WHEN age >= 50 AND age < 60 THEN 4
            ELSE 5
         END AS "customer_age_group_sort"

        ,state AS "Customer State"
    FROM source
)

SELECT * FROM final
  );
[0m10:23:17.645773 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.994 seconds
[0m10:23:17.647812 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd08d1f8f-7d3a-4c02-b86b-0e699ece8687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0F372AC90>]}
[0m10:23:17.649317 [info ] [Thread-3 (]: 3 of 14 OK created sql view model broman_analytics.stg_d365_fo__items .......... [[32mSUCCESS 1[0m in 1.07s]
[0m10:23:17.650324 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_d365_fo__items
[0m10:23:17.651322 [debug] [Thread-3 (]: Began running node snapshot.epicaldemo.stores_snapshot
[0m10:23:17.651322 [info ] [Thread-3 (]: 8 of 14 START snapshot broman_analytics.stores_snapshot ........................ [RUN]
[0m10:23:17.652324 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__items, now snapshot.epicaldemo.stores_snapshot)
[0m10:23:17.653324 [debug] [Thread-3 (]: Began compiling node snapshot.epicaldemo.stores_snapshot
[0m10:23:17.656323 [debug] [Thread-3 (]: Began executing node snapshot.epicaldemo.stores_snapshot
[0m10:23:17.695389 [debug] [Thread-3 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m10:23:17.696389 [debug] [Thread-3 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
[0m10:23:17.845244 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.362 seconds
[0m10:23:17.847751 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd08d1f8f-7d3a-4c02-b86b-0e699ece8687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0F370C9D0>]}
[0m10:23:17.849258 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.439 seconds
[0m10:23:17.850261 [info ] [Thread-2 (]: 7 of 14 OK created sql view model broman_analytics.stg_salesforce__customers ... [[32mSUCCESS 1[0m in 0.38s]
[0m10:23:17.852265 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd08d1f8f-7d3a-4c02-b86b-0e699ece8687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0F36148D0>]}
[0m10:23:17.853264 [debug] [Thread-3 (]: SQL status: SUCCESS 11 in 0.157 seconds
[0m10:23:17.854265 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_salesforce__customers
[0m10:23:17.855264 [info ] [Thread-1 (]: 6 of 14 OK created sql view model broman_analytics.stg_inriver__item_attributes  [[32mSUCCESS 1[0m in 0.47s]
[0m10:23:17.905375 [debug] [Thread-3 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m10:23:17.905375 [debug] [Thread-2 (]: Began running node model.epicaldemo.dim_dates
[0m10:23:17.906375 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_inriver__item_attributes
[0m10:23:17.907374 [debug] [Thread-3 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
create or replace temporary table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp"
as (
    
    
    with snapshot_query as (

        select * from EPICALDEMO.d365_fo.store

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            
  
  coalesce(nullif(modified, modified), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            modified as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.modified)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.modified)
        )
    )

    select * from insertions
    union all
    select * from updates

    )
;
[0m10:23:17.907374 [info ] [Thread-2 (]: 9 of 14 START sql table model broman_analytics.dim_dates ....................... [RUN]
[0m10:23:17.908374 [debug] [Thread-1 (]: Began running node model.epicaldemo.dim_customers
[0m10:23:17.909375 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_salesforce__customers, now model.epicaldemo.dim_dates)
[0m10:23:17.910398 [info ] [Thread-1 (]: 10 of 14 START sql table model broman_analytics.dim_customers .................. [RUN]
[0m10:23:17.911397 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.dim_dates
[0m10:23:17.912397 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_inriver__item_attributes, now model.epicaldemo.dim_customers)
[0m10:23:17.915402 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.dim_dates"
[0m10:23:17.916397 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.dim_customers
[0m10:23:17.919398 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.dim_customers"
[0m10:23:17.920486 [debug] [Thread-2 (]: Began executing node model.epicaldemo.dim_dates
[0m10:23:17.937712 [debug] [Thread-2 (]: Writing runtime sql for node "model.epicaldemo.dim_dates"
[0m10:23:17.939216 [debug] [Thread-1 (]: Began executing node model.epicaldemo.dim_customers
[0m10:23:17.942219 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.dim_customers"
[0m10:23:17.944219 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.546 seconds
[0m10:23:17.946219 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd08d1f8f-7d3a-4c02-b86b-0e699ece8687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0F3172150>]}
[0m10:23:17.946219 [debug] [Thread-2 (]: Using snowflake connection "model.epicaldemo.dim_dates"
[0m10:23:17.947252 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.dim_customers"
[0m10:23:17.948253 [info ] [Thread-4 (]: 5 of 14 OK created sql view model broman_analytics.stg_d365_fo__transactions ... [[32mSUCCESS 1[0m in 0.57s]
[0m10:23:17.949253 [debug] [Thread-2 (]: On model.epicaldemo.dim_dates: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_dates"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_dates
    

    
    as (with

dates AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__dates
),

final AS (
    SELECT
        date_id
        ,"Date"
        ,"Year"
        ,"Year Month"
        ,LEFT(date_id::TEXT, 6) AS "Year Month Number"
        ,"Month Number"
        ,"Quarter"
        ,"Quarter Number"
        ,"Month"
        ,LEFT("Month",3) AS "Month Short"
    FROM dates
)

SELECT * FROM final
    )
;
[0m10:23:17.949253 [debug] [Thread-1 (]: On model.epicaldemo.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_customers"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_customers
    

    
    as (WITH

customers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_salesforce__customers
),

final AS (
    SELECT
        customer_id
        ,"Customer Number"
        ,"Customer Age"
        ,"Customer Age Group"
        ,customer_age_group_sort
        ,"Customer State"
    FROM customers
)

SELECT * FROM final
    )
;
[0m10:23:17.950291 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_d365_fo__transactions
[0m10:23:17.953278 [debug] [Thread-4 (]: Began running node model.epicaldemo.dim_items
[0m10:23:17.954278 [info ] [Thread-4 (]: 11 of 14 START sql table model broman_analytics.dim_items ...................... [RUN]
[0m10:23:17.956287 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__transactions, now model.epicaldemo.dim_items)
[0m10:23:17.957277 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.dim_items
[0m10:23:17.961321 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.dim_items"
[0m10:23:17.962331 [debug] [Thread-4 (]: Began executing node model.epicaldemo.dim_items
[0m10:23:17.965323 [debug] [Thread-4 (]: Writing runtime sql for node "model.epicaldemo.dim_items"
[0m10:23:17.970041 [debug] [Thread-4 (]: Using snowflake connection "model.epicaldemo.dim_items"
[0m10:23:17.971060 [debug] [Thread-4 (]: On model.epicaldemo.dim_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_items"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_items
    

    
    as (with

item AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__items
),

item_attributes AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_inriver__item_attributes
),

category AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__categories
),

manager AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__managers
),

unknown AS (
    SELECT
        -1 AS "item_id"
        ,'Unknown' AS "SKU"
        ,'Unknown' AS "Item"
        ,'Missing' AS "Brand"
        ,'Missing' AS "Flavor"
        ,'Missing' AS "Crunch Level"
        ,'Missing' AS "Snack Time"
        ,'Missing' AS "Category"
        ,'Missing' AS "Manager"
),

missing AS (
    SELECT
        -2 AS "item_id"
        ,'Missing' AS "SKU"
        ,'Missing' AS "Item"
        ,'Missing' AS "Brand"
        ,'Missing' AS "Flavor"
        ,'Missing' AS "Crunch Level"
        ,'Missing' AS "Snack Time"
        ,'Missing' AS "Category"
        ,'Missing' AS "Manager"
),

final AS (
    SELECT
        item."item_id"
        ,item."SKU"
        ,item."Item"
        ,item."Brand"
        ,item."Flavor"
        ,COALESCE(item_attributes."Crunch Level", 'Missing') AS "Crunch Level"
        ,COALESCE(item_attributes."Snack Time", 'Missing') AS "Snack Time"
        ,category."Category"
        ,manager."Manager"
    FROM item
    LEFT JOIN item_attributes ON item_attributes."SKU" = item."SKU"
    LEFT JOIN category ON category."category_id" = item."category_id"
    LEFT JOIN manager ON manager."manager_id" = category."manager_id"

    UNION

    SELECT * FROM unknown

    UNION

    SELECT * FROM missing
)

SELECT * FROM final
    )
;
[0m10:23:18.215260 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bcee97-0004-cde8-0000-d2e900021d16
[0m10:23:18.215260 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 15 at position 8
invalid identifier 'CUSTOMER_ID'
[0m10:23:18.219263 [debug] [Thread-1 (]: Database Error in model dim_customers (models\mart\dimensions\dim_customers.sql)
  000904 (42000): SQL compilation error: error line 15 at position 8
  invalid identifier 'CUSTOMER_ID'
  compiled code at target\run\epicaldemo\models\mart\dimensions\dim_customers.sql
[0m10:23:18.219263 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd08d1f8f-7d3a-4c02-b86b-0e699ece8687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0F373B790>]}
[0m10:23:18.220714 [error] [Thread-1 (]: 10 of 14 ERROR creating sql table model broman_analytics.dim_customers ......... [[31mERROR[0m in 0.31s]
[0m10:23:18.221713 [debug] [Thread-1 (]: Finished running node model.epicaldemo.dim_customers
[0m10:23:18.222713 [debug] [Thread-7 (]: Marking all children of 'model.epicaldemo.dim_customers' to be skipped because of status 'error'.  Reason: Database Error in model dim_customers (models\mart\dimensions\dim_customers.sql)
  000904 (42000): SQL compilation error: error line 15 at position 8
  invalid identifier 'CUSTOMER_ID'
  compiled code at target\run\epicaldemo\models\mart\dimensions\dim_customers.sql.
[0m10:23:18.644537 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.736 seconds
[0m10:23:18.648048 [debug] [Thread-3 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m10:23:18.648048 [debug] [Thread-3 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp"
[0m10:23:18.774962 [debug] [Thread-3 (]: SQL status: SUCCESS 13 in 0.125 seconds
[0m10:23:18.777964 [debug] [Thread-3 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m10:23:18.777964 [debug] [Thread-3 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
[0m10:23:18.904467 [debug] [Thread-3 (]: SQL status: SUCCESS 11 in 0.125 seconds
[0m10:23:18.907462 [debug] [Thread-3 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m10:23:18.908462 [debug] [Thread-3 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp"
[0m10:23:19.020394 [debug] [Thread-3 (]: SQL status: SUCCESS 13 in 0.112 seconds
[0m10:23:19.024394 [debug] [Thread-3 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m10:23:19.025394 [debug] [Thread-3 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
[0m10:23:19.148190 [debug] [Thread-3 (]: SQL status: SUCCESS 11 in 0.122 seconds
[0m10:23:19.154728 [debug] [Thread-3 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m10:23:19.154728 [debug] [Thread-3 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp"
[0m10:23:19.192821 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.241 seconds
[0m10:23:19.194821 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd08d1f8f-7d3a-4c02-b86b-0e699ece8687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0F37627D0>]}
[0m10:23:19.195820 [info ] [Thread-2 (]: 9 of 14 OK created sql table model broman_analytics.dim_dates .................. [[32mSUCCESS 1[0m in 1.29s]
[0m10:23:19.196821 [debug] [Thread-2 (]: Finished running node model.epicaldemo.dim_dates
[0m10:23:19.253505 [debug] [Thread-3 (]: SQL status: SUCCESS 13 in 0.098 seconds
[0m10:23:19.272121 [debug] [Thread-3 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m10:23:19.273123 [debug] [Thread-3 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from EPICALDEMO.d365_fo.store

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            
  
  coalesce(nullif(modified, modified), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            modified as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.modified)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.modified)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m10:23:19.479768 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.508 seconds
[0m10:23:19.481821 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd08d1f8f-7d3a-4c02-b86b-0e699ece8687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0F3718AD0>]}
[0m10:23:19.482821 [info ] [Thread-4 (]: 11 of 14 OK created sql table model broman_analytics.dim_items ................. [[32mSUCCESS 1[0m in 1.53s]
[0m10:23:19.483823 [debug] [Thread-4 (]: Finished running node model.epicaldemo.dim_items
[0m10:23:19.736942 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 0.463 seconds
[0m10:23:19.742456 [debug] [Thread-3 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m10:23:19.743448 [debug] [Thread-3 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m10:23:19.836106 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 0.093 seconds
[0m10:23:19.837107 [warn ] [Thread-3 (]: Data type of snapshot table timestamp columns (TIMESTAMP_NTZ) doesn't match derived column 'updated_at' (DATE). Please update snapshot config 'updated_at'.
[0m10:23:19.838109 [debug] [Thread-3 (]: Writing runtime sql for node "snapshot.epicaldemo.stores_snapshot"
[0m10:23:19.839670 [debug] [Thread-3 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m10:23:19.840625 [debug] [Thread-3 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
BEGIN
[0m10:23:19.968130 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.127 seconds
[0m10:23:19.969636 [debug] [Thread-3 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m10:23:19.970641 [debug] [Thread-3 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
merge into "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT" as DBT_INTERNAL_DEST
    using "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
	
	
	and ((DBT_INTERNAL_DEST.dbt_valid_to = to_date('9999-12-31'))
 or DBT_INTERNAL_DEST.dbt_valid_to is null)

     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("ID", "NAME", "LOCATION", "LATITUDE", "LONGITUDE", "ONLINEPRESENCE", "MODIFIED", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("ID", "NAME", "LOCATION", "LATITUDE", "LONGITUDE", "ONLINEPRESENCE", "MODIFIED", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m10:23:20.527626 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 0.557 seconds
[0m10:23:20.528637 [debug] [Thread-3 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m10:23:20.528637 [debug] [Thread-3 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
COMMIT
[0m10:23:20.809655 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.280 seconds
[0m10:23:20.813665 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd08d1f8f-7d3a-4c02-b86b-0e699ece8687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0F37D0B10>]}
[0m10:23:20.815670 [info ] [Thread-3 (]: 8 of 14 OK snapshotted broman_analytics.stores_snapshot ........................ [[32mSUCCESS 0[0m in 3.16s]
[0m10:23:20.816670 [debug] [Thread-3 (]: Finished running node snapshot.epicaldemo.stores_snapshot
[0m10:23:20.817670 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__stores
[0m10:23:20.818668 [info ] [Thread-1 (]: 12 of 14 START sql view model broman_analytics.stg_d365_fo__stores ............. [RUN]
[0m10:23:20.819665 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.dim_customers, now model.epicaldemo.stg_d365_fo__stores)
[0m10:23:20.820235 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__stores
[0m10:23:20.828242 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__stores"
[0m10:23:20.830757 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__stores
[0m10:23:20.835760 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__stores"
[0m10:23:20.837760 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__stores"
[0m10:23:20.837760 [debug] [Thread-1 (]: On model.epicaldemo.stg_d365_fo__stores: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__stores"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__stores
  
   as (
    WITH

stores_snapshots AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stores_snapshot
),

final AS (
    SELECT
        id AS "store_id"
        ,dbt_scd_id

        ,ROW_NUMBER() OVER (ORDER BY id ASC, dbt_valid_from ASC) AS "store_key"

        ,CASE WHEN dbt_valid_to = '9999-12-31' THEN 1 ELSE 0 END AS is_current
        ,name AS "Store"
        ,SPLIT_PART(location, ',', 1) AS "Store State"
        ,SPLIT_PART(location, ',', 2) AS "Store City"
        ,latitude AS "Lat"
        ,longitude AS "Lon"
        ,onlinepresence AS "Online Presence"
        ,modified
        ,CAST(TO_CHAR(dbt_valid_from::DATE, 'YYYYMMDD') AS INTEGER) AS "valid_from"
        ,CAST(TO_CHAR(dbt_valid_to::DATE, 'YYYYMMDD') AS INTEGER) AS "valid_to"
    FROM stores_snapshots
)

SELECT * FROM final
  );
[0m10:23:21.247031 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.408 seconds
[0m10:23:21.250060 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd08d1f8f-7d3a-4c02-b86b-0e699ece8687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0F36D7C50>]}
[0m10:23:21.250060 [info ] [Thread-1 (]: 12 of 14 OK created sql view model broman_analytics.stg_d365_fo__stores ........ [[32mSUCCESS 1[0m in 0.43s]
[0m10:23:21.251069 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__stores
[0m10:23:21.252068 [debug] [Thread-4 (]: Began running node model.epicaldemo.dim_stores
[0m10:23:21.252068 [debug] [Thread-3 (]: Began running node model.epicaldemo.fact_sales_transactions
[0m10:23:21.253069 [info ] [Thread-4 (]: 13 of 14 START sql table model broman_analytics.dim_stores ..................... [RUN]
[0m10:23:21.254069 [info ] [Thread-3 (]: 14 of 14 START sql table model broman_analytics.fact_sales_transactions ........ [RUN]
[0m10:23:21.254069 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.dim_items, now model.epicaldemo.dim_stores)
[0m10:23:21.255069 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly snapshot.epicaldemo.stores_snapshot, now model.epicaldemo.fact_sales_transactions)
[0m10:23:21.255069 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.dim_stores
[0m10:23:21.256067 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.fact_sales_transactions
[0m10:23:21.258067 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.dim_stores"
[0m10:23:21.261588 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.fact_sales_transactions"
[0m10:23:21.263578 [debug] [Thread-4 (]: Began executing node model.epicaldemo.dim_stores
[0m10:23:21.263578 [debug] [Thread-3 (]: Began executing node model.epicaldemo.fact_sales_transactions
[0m10:23:21.266576 [debug] [Thread-4 (]: Writing runtime sql for node "model.epicaldemo.dim_stores"
[0m10:23:21.269574 [debug] [Thread-3 (]: Writing runtime sql for node "model.epicaldemo.fact_sales_transactions"
[0m10:23:21.270793 [debug] [Thread-4 (]: Using snowflake connection "model.epicaldemo.dim_stores"
[0m10:23:21.271792 [debug] [Thread-4 (]: On model.epicaldemo.dim_stores: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_stores"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_stores
    

    
    as (with

store AS (
    select
        *
    from EPICALDEMO.broman_analytics.stg_d365_fo__stores
),

final AS (
    SELECT
        store_key
        ,store_id
        ,current
        ,"Store"
        ,"Store State"
        ,"Store City"
        ,"Lat"
        ,"Lon"
        ,"Online Presence"
        ,modified
        ,valid_from
        ,valid_to
    from store
)

select * from final
    )
;
[0m10:23:21.273789 [debug] [Thread-3 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions"
[0m10:23:21.273789 [debug] [Thread-3 (]: On model.epicaldemo.fact_sales_transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions"} */
create or replace transient table EPICALDEMO.broman_analytics.fact_sales_transactions
    

    
    as (WITH

sales AS (
    select
        *
    from EPICALDEMO.broman_analytics.stg_d365_fo__transactions
),

items AS (
    select
        *
    from EPICALDEMO.broman_analytics.stg_d365_fo__items
),

stores AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__stores
),

customers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_salesforce__customers
),

final AS (
    SELECT
        -- Identifiers
        sales.date_id
        ,sales."SKU"

        ,CASE
            WHEN sales."SKU" IS NULL THEN -2 -- SKU is missing from Source
            WHEN item."item_id" IS NULL THEN -1 -- SKU is not known from Source
            ELSE item."item_id" -- Join item_id from Dim based on SKU
         END AS "item_id"

        ,sales."Store"

        ,CASE
            WHEN sales."Store" IS NULL THEN -2
            WHEN store."store_key" IS NULL THEN -1
            ELSE store."store_key"
         END AS "store_key"

        ,sales."Customer Number"

        ,CASE
            WHEN sales."Customer Number" IS NULL THEN -2
            WHEN customer."customer_id" IS NULL THEN -1
            ELSE customer."customer_id"
         END AS "customer_id"

        -- Metrics
        ,sales."Qty"
        ,sales."Unit Price"
        ,sales."Sales Amount"
        ,sales."Unit Cost"
        ,sales."Cost"
        ,sales."Margin"
    FROM sales
    LEFT JOIN item ON item."SKU" = sales."SKU"
    LEFT JOIN store ON store."Store" = sales."Store" AND sales.date_id >= store.valid_from AND sales.date_id < store.valid_to
    LEFT JOIN customer ON customer."Customer Number" = sales."Customer Number"
)

SELECT * FROM final
    )
;
[0m10:23:21.413449 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01bcee97-0004-ce01-0000-d2e9000242ca
[0m10:23:21.414449 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 17 at position 9 unexpected 'current'.
syntax error line 19 at position 8 unexpected ','.
syntax error line 20 at position 8 unexpected ','.
syntax error line 21 at position 8 unexpected ','.
syntax error line 22 at position 8 unexpected ','.
syntax error line 23 at position 8 unexpected ','.
syntax error line 24 at position 8 unexpected ','.
syntax error line 25 at position 8 unexpected ','.
syntax error line 26 at position 8 unexpected ','.
syntax error line 27 at position 4 unexpected 'from'.
syntax error line 30 at position 0 unexpected 'select'.
[0m10:23:21.417459 [debug] [Thread-4 (]: Database Error in model dim_stores (models\mart\dimensions\dim_stores.sql)
  001003 (42000): SQL compilation error:
  syntax error line 17 at position 9 unexpected 'current'.
  syntax error line 19 at position 8 unexpected ','.
  syntax error line 20 at position 8 unexpected ','.
  syntax error line 21 at position 8 unexpected ','.
  syntax error line 22 at position 8 unexpected ','.
  syntax error line 23 at position 8 unexpected ','.
  syntax error line 24 at position 8 unexpected ','.
  syntax error line 25 at position 8 unexpected ','.
  syntax error line 26 at position 8 unexpected ','.
  syntax error line 27 at position 4 unexpected 'from'.
  syntax error line 30 at position 0 unexpected 'select'.
  compiled code at target\run\epicaldemo\models\mart\dimensions\dim_stores.sql
[0m10:23:21.418460 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd08d1f8f-7d3a-4c02-b86b-0e699ece8687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0F4120AD0>]}
[0m10:23:21.418460 [error] [Thread-4 (]: 13 of 14 ERROR creating sql table model broman_analytics.dim_stores ............ [[31mERROR[0m in 0.16s]
[0m10:23:21.419447 [debug] [Thread-4 (]: Finished running node model.epicaldemo.dim_stores
[0m10:23:21.420502 [debug] [Thread-7 (]: Marking all children of 'model.epicaldemo.dim_stores' to be skipped because of status 'error'.  Reason: Database Error in model dim_stores (models\mart\dimensions\dim_stores.sql)
  001003 (42000): SQL compilation error:
  syntax error line 17 at position 9 unexpected 'current'.
  syntax error line 19 at position 8 unexpected ','.
  syntax error line 20 at position 8 unexpected ','.
  syntax error line 21 at position 8 unexpected ','.
  syntax error line 22 at position 8 unexpected ','.
  syntax error line 23 at position 8 unexpected ','.
  syntax error line 24 at position 8 unexpected ','.
  syntax error line 25 at position 8 unexpected ','.
  syntax error line 26 at position 8 unexpected ','.
  syntax error line 27 at position 4 unexpected 'from'.
  syntax error line 30 at position 0 unexpected 'select'.
  compiled code at target\run\epicaldemo\models\mart\dimensions\dim_stores.sql.
[0m10:23:21.890583 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01bcee97-0004-ce01-0000-d2e9000242ce
[0m10:23:21.891582 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'ITEM' does not exist or not authorized.
[0m10:23:21.894586 [debug] [Thread-3 (]: Database Error in model fact_sales_transactions (models\mart\facts\fact_sales_transactions.sql)
  002003 (42S02): SQL compilation error:
  Object 'ITEM' does not exist or not authorized.
  compiled code at target\run\epicaldemo\models\mart\facts\fact_sales_transactions.sql
[0m10:23:21.895583 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd08d1f8f-7d3a-4c02-b86b-0e699ece8687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0F36D7390>]}
[0m10:23:21.896583 [error] [Thread-3 (]: 14 of 14 ERROR creating sql table model broman_analytics.fact_sales_transactions  [[31mERROR[0m in 0.64s]
[0m10:23:21.897583 [debug] [Thread-3 (]: Finished running node model.epicaldemo.fact_sales_transactions
[0m10:23:21.897583 [debug] [Thread-7 (]: Marking all children of 'model.epicaldemo.fact_sales_transactions' to be skipped because of status 'error'.  Reason: Database Error in model fact_sales_transactions (models\mart\facts\fact_sales_transactions.sql)
  002003 (42S02): SQL compilation error:
  Object 'ITEM' does not exist or not authorized.
  compiled code at target\run\epicaldemo\models\mart\facts\fact_sales_transactions.sql.
[0m10:23:21.899584 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:23:21.899584 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m10:23:21.900630 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m10:23:22.127476 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m10:23:22.128476 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m10:23:22.304164 [debug] [MainThread]: Connection 'model.epicaldemo.stg_d365_fo__stores' was left open.
[0m10:23:22.304164 [debug] [MainThread]: On model.epicaldemo.stg_d365_fo__stores: Close
[0m10:23:22.494360 [debug] [MainThread]: Connection 'model.epicaldemo.dim_dates' was left open.
[0m10:23:22.495359 [debug] [MainThread]: On model.epicaldemo.dim_dates: Close
[0m10:23:22.690507 [debug] [MainThread]: Connection 'model.epicaldemo.fact_sales_transactions' was left open.
[0m10:23:22.690507 [debug] [MainThread]: On model.epicaldemo.fact_sales_transactions: Close
[0m10:23:22.874627 [debug] [MainThread]: Connection 'model.epicaldemo.dim_stores' was left open.
[0m10:23:22.875626 [debug] [MainThread]: On model.epicaldemo.dim_stores: Close
[0m10:23:23.058699 [info ] [MainThread]: 
[0m10:23:23.059698 [info ] [MainThread]: Finished running 1 snapshot, 5 table models, 8 view models in 0 hours 0 minutes and 8.61 seconds (8.61s).
[0m10:23:23.061741 [debug] [MainThread]: Command end result
[0m10:23:23.086775 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m10:23:23.091844 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m10:23:23.101380 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m10:23:23.103367 [info ] [MainThread]: 
[0m10:23:23.104368 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m10:23:23.105365 [info ] [MainThread]: 
[0m10:23:23.106369 [error] [MainThread]:   Database Error in model dim_customers (models\mart\dimensions\dim_customers.sql)
  000904 (42000): SQL compilation error: error line 15 at position 8
  invalid identifier 'CUSTOMER_ID'
  compiled code at target\run\epicaldemo\models\mart\dimensions\dim_customers.sql
[0m10:23:23.107367 [info ] [MainThread]: 
[0m10:23:23.108373 [error] [MainThread]:   Database Error in model dim_stores (models\mart\dimensions\dim_stores.sql)
  001003 (42000): SQL compilation error:
  syntax error line 17 at position 9 unexpected 'current'.
  syntax error line 19 at position 8 unexpected ','.
  syntax error line 20 at position 8 unexpected ','.
  syntax error line 21 at position 8 unexpected ','.
  syntax error line 22 at position 8 unexpected ','.
  syntax error line 23 at position 8 unexpected ','.
  syntax error line 24 at position 8 unexpected ','.
  syntax error line 25 at position 8 unexpected ','.
  syntax error line 26 at position 8 unexpected ','.
  syntax error line 27 at position 4 unexpected 'from'.
  syntax error line 30 at position 0 unexpected 'select'.
  compiled code at target\run\epicaldemo\models\mart\dimensions\dim_stores.sql
[0m10:23:23.109365 [info ] [MainThread]: 
[0m10:23:23.110449 [error] [MainThread]:   Database Error in model fact_sales_transactions (models\mart\facts\fact_sales_transactions.sql)
  002003 (42S02): SQL compilation error:
  Object 'ITEM' does not exist or not authorized.
  compiled code at target\run\epicaldemo\models\mart\facts\fact_sales_transactions.sql
[0m10:23:23.110449 [info ] [MainThread]: 
[0m10:23:23.111447 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=3 SKIP=0 TOTAL=14
[0m10:23:23.112446 [debug] [MainThread]: Command `dbt build` failed at 10:23:23.112446 after 9.91 seconds
[0m10:23:23.113455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0F0DB4DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0F0C99290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0EB893090>]}
[0m10:23:23.113455 [debug] [MainThread]: Flushing usage events
[0m10:23:23.744603 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:29:41.167328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F1FE90C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F1FEBBC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F1FAB5510>]}


============================== 10:29:41.171391 | 257de92d-178b-4033-b47f-7a2b6fb31fe0 ==============================
[0m10:29:41.171391 [info ] [MainThread]: Running with dbt=1.9.4
[0m10:29:41.172390 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m10:29:41.565368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '257de92d-178b-4033-b47f-7a2b6fb31fe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F210C1150>]}
[0m10:29:41.608613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '257de92d-178b-4033-b47f-7a2b6fb31fe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F1E84F910>]}
[0m10:29:41.610818 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m10:29:41.967440 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m10:29:42.159358 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:29:42.160362 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:29:42.165373 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m10:29:42.201492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '257de92d-178b-4033-b47f-7a2b6fb31fe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F21808710>]}
[0m10:29:42.276715 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m10:29:42.292309 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m10:29:42.360585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '257de92d-178b-4033-b47f-7a2b6fb31fe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F21B57E50>]}
[0m10:29:42.361589 [info ] [MainThread]: Found 13 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m10:29:42.363591 [info ] [MainThread]: 
[0m10:29:42.364591 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:29:42.364591 [info ] [MainThread]: 
[0m10:29:42.365581 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:29:42.369592 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m10:29:42.445852 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m10:29:42.446853 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m10:29:42.446853 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:43.246227 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.799 seconds
[0m10:29:43.249741 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m10:29:43.258299 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m10:29:43.259300 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m10:29:43.259300 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:43.927691 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.668 seconds
[0m10:29:43.930721 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m10:29:43.931721 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m10:29:44.094675 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.163 seconds
[0m10:29:44.096677 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m10:29:44.097676 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m10:29:44.221678 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.124 seconds
[0m10:29:44.225678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '257de92d-178b-4033-b47f-7a2b6fb31fe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F21039150>]}
[0m10:29:44.230777 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__categories
[0m10:29:44.230777 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_d365_fo__dates
[0m10:29:44.230777 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_d365_fo__items
[0m10:29:44.231793 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_d365_fo__managers
[0m10:29:44.231793 [info ] [Thread-1 (]: 1 of 14 START sql view model broman_analytics.stg_d365_fo__categories .......... [RUN]
[0m10:29:44.232776 [info ] [Thread-2 (]: 2 of 14 START sql view model broman_analytics.stg_d365_fo__dates ............... [RUN]
[0m10:29:44.232776 [info ] [Thread-3 (]: 3 of 14 START sql view model broman_analytics.stg_d365_fo__items ............... [RUN]
[0m10:29:44.233777 [info ] [Thread-4 (]: 4 of 14 START sql view model broman_analytics.stg_d365_fo__managers ............ [RUN]
[0m10:29:44.234777 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__categories'
[0m10:29:44.234777 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__dates'
[0m10:29:44.235781 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__items'
[0m10:29:44.235781 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__managers'
[0m10:29:44.236778 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__categories
[0m10:29:44.236778 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_d365_fo__dates
[0m10:29:44.237781 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_d365_fo__items
[0m10:29:44.237781 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_d365_fo__managers
[0m10:29:44.245301 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__categories"
[0m10:29:44.248295 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__dates"
[0m10:29:44.251310 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__items"
[0m10:29:44.253828 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__managers"
[0m10:29:44.255830 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__categories
[0m10:29:44.270365 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_d365_fo__dates
[0m10:29:44.285886 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_d365_fo__items
[0m10:29:44.286886 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__categories"
[0m10:29:44.293404 [debug] [Thread-2 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__dates"
[0m10:29:44.294407 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_d365_fo__managers
[0m10:29:44.299395 [debug] [Thread-3 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__items"
[0m10:29:44.300908 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__categories"
[0m10:29:44.303905 [debug] [Thread-4 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__managers"
[0m10:29:44.305907 [debug] [Thread-2 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__dates"
[0m10:29:44.306907 [debug] [Thread-1 (]: On model.epicaldemo.stg_d365_fo__categories: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__categories"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__categories
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.category
),

final AS (
    SELECT
        id AS "category_id"
        ,INITCAP(name) AS "Category"
        ,managerid AS "manager_id"
    FROM source
)

SELECT * FROM final
  );
[0m10:29:44.307905 [debug] [Thread-3 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__items"
[0m10:29:44.307905 [debug] [Thread-2 (]: On model.epicaldemo.stg_d365_fo__dates: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__dates"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__dates
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.date
),

final AS (
    SELECT
        id AS date_id
        ,date AS "Date"
        ,year AS "Year"
        ,yearmonth AS "Year Month"
        ,monthnumber AS "Month Number"
        ,quarter AS "Quarter"
        ,quarternumber AS "Quarter Number"
        ,monthname AS "Month"
    FROM source
)

SELECT * FROM final
  );
[0m10:29:44.309411 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:29:44.310417 [debug] [Thread-4 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__managers"
[0m10:29:44.310417 [debug] [Thread-3 (]: On model.epicaldemo.stg_d365_fo__items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__items"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__items
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.item
),

final AS (
    SELECT
        id AS "item_id"
        ,name AS "Item"
        ,COALESCE(brand, 'Missing') AS "Brand"
        ,categoryid AS "category_id"
        ,COALESCE(flavor, 'Missing') AS "Flavor"
        ,sku AS "SKU"
    FROM source
)

SELECT * FROM final
  );
[0m10:29:44.311423 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:29:44.313432 [debug] [Thread-4 (]: On model.epicaldemo.stg_d365_fo__managers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__managers"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__managers
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.manager
),

final as (
    SELECT
        id AS "manager_id"
        ,firstname || ' ' || lastname AS "Manager"
    FROM source
)

SELECT * FROM final
  );
[0m10:29:44.315424 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:29:44.317417 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:29:44.936694 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.621 seconds
[0m10:29:44.964332 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '257de92d-178b-4033-b47f-7a2b6fb31fe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F210CD5D0>]}
[0m10:29:44.965331 [info ] [Thread-3 (]: 3 of 14 OK created sql view model broman_analytics.stg_d365_fo__items .......... [[32mSUCCESS 1[0m in 0.72s]
[0m10:29:44.966332 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_d365_fo__items
[0m10:29:44.966332 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_d365_fo__transactions
[0m10:29:44.967343 [info ] [Thread-3 (]: 5 of 14 START sql view model broman_analytics.stg_d365_fo__transactions ........ [RUN]
[0m10:29:44.968332 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__items, now model.epicaldemo.stg_d365_fo__transactions)
[0m10:29:44.968332 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_d365_fo__transactions
[0m10:29:44.971388 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__transactions"
[0m10:29:44.972399 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_d365_fo__transactions
[0m10:29:44.975397 [debug] [Thread-3 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__transactions"
[0m10:29:44.977400 [debug] [Thread-3 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__transactions"
[0m10:29:44.977400 [debug] [Thread-3 (]: On model.epicaldemo.stg_d365_fo__transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__transactions"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__transactions
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.transactions
),

final AS (
    SELECT
        -- Identifiers
        CAST(TO_CHAR(date::DATE, 'YYYYMMDD') AS INTEGER) AS "date_id"
        ,sku AS "SKU"
        ,store AS "Store"
        ,customernumber AS "Customer Number"

        -- Metrics
        ,quantity AS "Qty"
        ,unitprice::NUMERIC(10,2) AS "Unit Price"
        ,(quantity * unitprice)::NUMERIC(10,2) AS "Sales Amount"
        ,unitcost::NUMERIC(10,2) AS "Unit Cost"
        ,(quantity * unitcost)::NUMERIC(10,2) AS "Cost"
        ,(quantity * unitprice)::NUMERIC(10,2) - (quantity * unitcost)::NUMERIC(10,2) AS "Margin"
    FROM source
)

SELECT * FROM final
  );
[0m10:29:45.018728 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.710 seconds
[0m10:29:45.022266 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '257de92d-178b-4033-b47f-7a2b6fb31fe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F22314510>]}
[0m10:29:45.023506 [info ] [Thread-1 (]: 1 of 14 OK created sql view model broman_analytics.stg_d365_fo__categories ..... [[32mSUCCESS 1[0m in 0.79s]
[0m10:29:45.024512 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__categories
[0m10:29:45.024512 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_inriver__item_attributes
[0m10:29:45.025512 [info ] [Thread-1 (]: 6 of 14 START sql view model broman_analytics.stg_inriver__item_attributes ..... [RUN]
[0m10:29:45.026515 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__categories, now model.epicaldemo.stg_inriver__item_attributes)
[0m10:29:45.026515 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_inriver__item_attributes
[0m10:29:45.029510 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_inriver__item_attributes"
[0m10:29:45.030031 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_inriver__item_attributes
[0m10:29:45.034571 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.stg_inriver__item_attributes"
[0m10:29:45.035562 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.stg_inriver__item_attributes"
[0m10:29:45.036571 [debug] [Thread-1 (]: On model.epicaldemo.stg_inriver__item_attributes: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_inriver__item_attributes"} */
create or replace   view EPICALDEMO.broman_analytics.stg_inriver__item_attributes
  
   as (
    with

source as (
    select
        *
    from EPICALDEMO.inriver.item_attributes
),

final as (
    select
        id AS "item_attributes_id"
        ,sku AS "SKU"
        ,COALESCE(crunch_level, 'Missing') AS "Crunch Level"
        ,COALESCE(snack_time, 'Missing') AS "Snack Time"
    from source
)

select * from final
  );
[0m10:29:45.088252 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.771 seconds
[0m10:29:45.091761 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '257de92d-178b-4033-b47f-7a2b6fb31fe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F21FD53D0>]}
[0m10:29:45.092760 [info ] [Thread-4 (]: 4 of 14 OK created sql view model broman_analytics.stg_d365_fo__managers ....... [[32mSUCCESS 1[0m in 0.85s]
[0m10:29:45.093762 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_d365_fo__managers
[0m10:29:45.093762 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_salesforce__customers
[0m10:29:45.094760 [info ] [Thread-4 (]: 7 of 14 START sql view model broman_analytics.stg_salesforce__customers ........ [RUN]
[0m10:29:45.094760 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__managers, now model.epicaldemo.stg_salesforce__customers)
[0m10:29:45.095762 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_salesforce__customers
[0m10:29:45.099270 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_salesforce__customers"
[0m10:29:45.100276 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_salesforce__customers
[0m10:29:45.104283 [debug] [Thread-4 (]: Writing runtime sql for node "model.epicaldemo.stg_salesforce__customers"
[0m10:29:45.105275 [debug] [Thread-4 (]: Using snowflake connection "model.epicaldemo.stg_salesforce__customers"
[0m10:29:45.106288 [debug] [Thread-4 (]: On model.epicaldemo.stg_salesforce__customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_salesforce__customers"} */
create or replace   view EPICALDEMO.broman_analytics.stg_salesforce__customers
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.salesforce.customer
),

final AS (
    SELECT
        id AS "customer_id"
        ,customernumber AS "Customer Number"
        ,age AS "Customer Age"

        ,CASE
            WHEN age < 20 THEN '< 20'
            WHEN age >= 20 AND age < 30 THEN '20 - 30'
            WHEN age >= 30 AND age < 50 THEN '30 - 50'
            WHEN age >= 50 AND age < 60 THEN '50 - 60'
            ELSE '60+'
         END AS "Customer Age Group"

        ,CASE
            WHEN age < 20 THEN 1
            WHEN age >= 20 AND age < 30 THEN 2
            WHEN age >= 30 AND age < 50 THEN 3
            WHEN age >= 50 AND age < 60 THEN 4
            ELSE 5
         END AS "customer_age_group_sort"

        ,state AS "Customer State"
    FROM source
)

SELECT * FROM final
  );
[0m10:29:45.255112 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.944 seconds
[0m10:29:45.257108 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '257de92d-178b-4033-b47f-7a2b6fb31fe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F22342750>]}
[0m10:29:45.258107 [info ] [Thread-2 (]: 2 of 14 OK created sql view model broman_analytics.stg_d365_fo__dates .......... [[32mSUCCESS 1[0m in 1.02s]
[0m10:29:45.258107 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_d365_fo__dates
[0m10:29:45.259624 [debug] [Thread-2 (]: Began running node snapshot.epicaldemo.stores_snapshot
[0m10:29:45.260632 [info ] [Thread-2 (]: 8 of 14 START snapshot broman_analytics.stores_snapshot ........................ [RUN]
[0m10:29:45.260632 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__dates, now snapshot.epicaldemo.stores_snapshot)
[0m10:29:45.261634 [debug] [Thread-2 (]: Began compiling node snapshot.epicaldemo.stores_snapshot
[0m10:29:45.263642 [debug] [Thread-2 (]: Began executing node snapshot.epicaldemo.stores_snapshot
[0m10:29:45.300269 [debug] [Thread-2 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m10:29:45.301269 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.324 seconds
[0m10:29:45.302271 [debug] [Thread-2 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
[0m10:29:45.305278 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '257de92d-178b-4033-b47f-7a2b6fb31fe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F21EE45D0>]}
[0m10:29:45.307270 [info ] [Thread-3 (]: 5 of 14 OK created sql view model broman_analytics.stg_d365_fo__transactions ... [[32mSUCCESS 1[0m in 0.34s]
[0m10:29:45.308269 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_d365_fo__transactions
[0m10:29:45.309269 [debug] [Thread-3 (]: Began running node model.epicaldemo.dim_dates
[0m10:29:45.310314 [info ] [Thread-3 (]: 9 of 14 START sql table model broman_analytics.dim_dates ....................... [RUN]
[0m10:29:45.311312 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__transactions, now model.epicaldemo.dim_dates)
[0m10:29:45.312314 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.dim_dates
[0m10:29:45.314314 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.dim_dates"
[0m10:29:45.315312 [debug] [Thread-3 (]: Began executing node model.epicaldemo.dim_dates
[0m10:29:45.338455 [debug] [Thread-3 (]: Writing runtime sql for node "model.epicaldemo.dim_dates"
[0m10:29:45.339954 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.303 seconds
[0m10:29:45.342964 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '257de92d-178b-4033-b47f-7a2b6fb31fe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F22314510>]}
[0m10:29:45.344963 [debug] [Thread-3 (]: Using snowflake connection "model.epicaldemo.dim_dates"
[0m10:29:45.343963 [info ] [Thread-1 (]: 6 of 14 OK created sql view model broman_analytics.stg_inriver__item_attributes  [[32mSUCCESS 1[0m in 0.32s]
[0m10:29:45.344963 [debug] [Thread-3 (]: On model.epicaldemo.dim_dates: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_dates"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_dates
    

    
    as (with

dates AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__dates
),

final AS (
    SELECT
        date_id
        ,"Date"
        ,"Year"
        ,"Year Month"
        ,LEFT(date_id::TEXT, 6) AS "Year Month Number"
        ,"Month Number"
        ,"Quarter"
        ,"Quarter Number"
        ,"Month"
        ,LEFT("Month",3) AS "Month Short"
    FROM dates
)

SELECT * FROM final
    )
;
[0m10:29:45.345962 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_inriver__item_attributes
[0m10:29:45.346961 [debug] [Thread-1 (]: Began running node model.epicaldemo.dim_items
[0m10:29:45.347963 [info ] [Thread-1 (]: 10 of 14 START sql table model broman_analytics.dim_items ...................... [RUN]
[0m10:29:45.349469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_inriver__item_attributes, now model.epicaldemo.dim_items)
[0m10:29:45.350476 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.dim_items
[0m10:29:45.355683 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.dim_items"
[0m10:29:45.356684 [debug] [Thread-1 (]: Began executing node model.epicaldemo.dim_items
[0m10:29:45.359684 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.dim_items"
[0m10:29:45.362726 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.dim_items"
[0m10:29:45.363719 [debug] [Thread-1 (]: On model.epicaldemo.dim_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_items"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_items
    

    
    as (with

item AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__items
),

item_attributes AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_inriver__item_attributes
),

category AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__categories
),

manager AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__managers
),

unknown AS (
    SELECT
        -1 AS "item_id"
        ,'Unknown' AS "SKU"
        ,'Unknown' AS "Item"
        ,'Missing' AS "Brand"
        ,'Missing' AS "Flavor"
        ,'Missing' AS "Crunch Level"
        ,'Missing' AS "Snack Time"
        ,'Missing' AS "Category"
        ,'Missing' AS "Manager"
),

missing AS (
    SELECT
        -2 AS "item_id"
        ,'Missing' AS "SKU"
        ,'Missing' AS "Item"
        ,'Missing' AS "Brand"
        ,'Missing' AS "Flavor"
        ,'Missing' AS "Crunch Level"
        ,'Missing' AS "Snack Time"
        ,'Missing' AS "Category"
        ,'Missing' AS "Manager"
),

final AS (
    SELECT
        item."item_id"
        ,item."SKU"
        ,item."Item"
        ,item."Brand"
        ,item."Flavor"
        ,COALESCE(item_attributes."Crunch Level", 'Missing') AS "Crunch Level"
        ,COALESCE(item_attributes."Snack Time", 'Missing') AS "Snack Time"
        ,category."Category"
        ,manager."Manager"
    FROM item
    LEFT JOIN item_attributes ON item_attributes."SKU" = item."SKU"
    LEFT JOIN category ON category."category_id" = item."category_id"
    LEFT JOIN manager ON manager."manager_id" = category."manager_id"

    UNION

    SELECT * FROM unknown

    UNION

    SELECT * FROM missing
)

SELECT * FROM final
    )
;
[0m10:29:45.391858 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.285 seconds
[0m10:29:45.393856 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '257de92d-178b-4033-b47f-7a2b6fb31fe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F223D4CD0>]}
[0m10:29:45.394855 [info ] [Thread-4 (]: 7 of 14 OK created sql view model broman_analytics.stg_salesforce__customers ... [[32mSUCCESS 1[0m in 0.30s]
[0m10:29:45.395845 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_salesforce__customers
[0m10:29:45.396845 [debug] [Thread-4 (]: Began running node model.epicaldemo.dim_customers
[0m10:29:45.396845 [info ] [Thread-4 (]: 11 of 14 START sql table model broman_analytics.dim_customers .................. [RUN]
[0m10:29:45.397846 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_salesforce__customers, now model.epicaldemo.dim_customers)
[0m10:29:45.397846 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.dim_customers
[0m10:29:45.402356 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.dim_customers"
[0m10:29:45.403357 [debug] [Thread-4 (]: Began executing node model.epicaldemo.dim_customers
[0m10:29:45.406367 [debug] [Thread-4 (]: Writing runtime sql for node "model.epicaldemo.dim_customers"
[0m10:29:45.407359 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.102 seconds
[0m10:29:45.451269 [debug] [Thread-2 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m10:29:45.452258 [debug] [Thread-4 (]: Using snowflake connection "model.epicaldemo.dim_customers"
[0m10:29:45.452258 [debug] [Thread-2 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
create or replace temporary table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp"
as (
    
    
    with snapshot_query as (

        select * from EPICALDEMO.d365_fo.store

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            
  
  coalesce(nullif(modified, modified), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            modified as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.modified)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.modified)
        )
    )

    select * from insertions
    union all
    select * from updates

    )
;
[0m10:29:45.452258 [debug] [Thread-4 (]: On model.epicaldemo.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_customers"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_customers
    

    
    as (WITH

customers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_salesforce__customers
),

final AS (
    SELECT
        "customer_id"
        ,"Customer Number"
        ,"Customer Age"
        ,"Customer Age Group"
        ,"customer_age_group_sort"
        ,"Customer State"
    FROM customers
)

SELECT * FROM final
    )
;
[0m10:29:46.006455 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.553 seconds
[0m10:29:46.009451 [debug] [Thread-2 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m10:29:46.009972 [debug] [Thread-2 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp"
[0m10:29:46.129249 [debug] [Thread-2 (]: SQL status: SUCCESS 13 in 0.119 seconds
[0m10:29:46.132253 [debug] [Thread-2 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m10:29:46.133253 [debug] [Thread-2 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
[0m10:29:46.169442 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.715 seconds
[0m10:29:46.171458 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '257de92d-178b-4033-b47f-7a2b6fb31fe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F22204750>]}
[0m10:29:46.172447 [info ] [Thread-4 (]: 11 of 14 OK created sql table model broman_analytics.dim_customers ............. [[32mSUCCESS 1[0m in 0.77s]
[0m10:29:46.172447 [debug] [Thread-4 (]: Finished running node model.epicaldemo.dim_customers
[0m10:29:46.233421 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.099 seconds
[0m10:29:46.237422 [debug] [Thread-2 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m10:29:46.237422 [debug] [Thread-2 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp"
[0m10:29:46.254169 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.908 seconds
[0m10:29:46.256181 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '257de92d-178b-4033-b47f-7a2b6fb31fe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F21F74310>]}
[0m10:29:46.257182 [info ] [Thread-3 (]: 9 of 14 OK created sql table model broman_analytics.dim_dates .................. [[32mSUCCESS 1[0m in 0.94s]
[0m10:29:46.258174 [debug] [Thread-3 (]: Finished running node model.epicaldemo.dim_dates
[0m10:29:46.363371 [debug] [Thread-2 (]: SQL status: SUCCESS 13 in 0.125 seconds
[0m10:29:46.366370 [debug] [Thread-2 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m10:29:46.367370 [debug] [Thread-2 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
[0m10:29:46.464451 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.097 seconds
[0m10:29:46.472485 [debug] [Thread-2 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m10:29:46.473485 [debug] [Thread-2 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp"
[0m10:29:46.578305 [debug] [Thread-2 (]: SQL status: SUCCESS 13 in 0.104 seconds
[0m10:29:46.596333 [debug] [Thread-2 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m10:29:46.597336 [debug] [Thread-2 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from EPICALDEMO.d365_fo.store

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            
  
  coalesce(nullif(modified, modified), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            modified as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.modified)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.modified)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m10:29:46.785675 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.422 seconds
[0m10:29:46.788698 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '257de92d-178b-4033-b47f-7a2b6fb31fe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F22C68490>]}
[0m10:29:46.788698 [info ] [Thread-1 (]: 10 of 14 OK created sql table model broman_analytics.dim_items ................. [[32mSUCCESS 1[0m in 1.44s]
[0m10:29:46.790179 [debug] [Thread-1 (]: Finished running node model.epicaldemo.dim_items
[0m10:29:46.792182 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.194 seconds
[0m10:29:46.796192 [debug] [Thread-2 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m10:29:46.797182 [debug] [Thread-2 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m10:29:46.890824 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.094 seconds
[0m10:29:46.891832 [warn ] [Thread-2 (]: Data type of snapshot table timestamp columns (TIMESTAMP_NTZ) doesn't match derived column 'updated_at' (DATE). Please update snapshot config 'updated_at'.
[0m10:29:46.892824 [debug] [Thread-2 (]: Writing runtime sql for node "snapshot.epicaldemo.stores_snapshot"
[0m10:29:46.894828 [debug] [Thread-2 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m10:29:46.894828 [debug] [Thread-2 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
BEGIN
[0m10:29:47.000303 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.104 seconds
[0m10:29:47.001302 [debug] [Thread-2 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m10:29:47.001302 [debug] [Thread-2 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
merge into "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT" as DBT_INTERNAL_DEST
    using "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
	
	
	and ((DBT_INTERNAL_DEST.dbt_valid_to = to_date('9999-12-31'))
 or DBT_INTERNAL_DEST.dbt_valid_to is null)

     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("ID", "NAME", "LOCATION", "LATITUDE", "LONGITUDE", "ONLINEPRESENCE", "MODIFIED", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("ID", "NAME", "LOCATION", "LATITUDE", "LONGITUDE", "ONLINEPRESENCE", "MODIFIED", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m10:29:47.681513 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.679 seconds
[0m10:29:47.681513 [debug] [Thread-2 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m10:29:47.682510 [debug] [Thread-2 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
COMMIT
[0m10:29:48.000705 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.318 seconds
[0m10:29:48.005707 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '257de92d-178b-4033-b47f-7a2b6fb31fe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F222C4090>]}
[0m10:29:48.006707 [info ] [Thread-2 (]: 8 of 14 OK snapshotted broman_analytics.stores_snapshot ........................ [[32mSUCCESS 0[0m in 2.75s]
[0m10:29:48.007707 [debug] [Thread-2 (]: Finished running node snapshot.epicaldemo.stores_snapshot
[0m10:29:48.009713 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_d365_fo__stores
[0m10:29:48.009713 [info ] [Thread-4 (]: 12 of 14 START sql view model broman_analytics.stg_d365_fo__stores ............. [RUN]
[0m10:29:48.010757 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.dim_customers, now model.epicaldemo.stg_d365_fo__stores)
[0m10:29:48.010757 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_d365_fo__stores
[0m10:29:48.014756 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__stores"
[0m10:29:48.014756 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_d365_fo__stores
[0m10:29:48.017760 [debug] [Thread-4 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__stores"
[0m10:29:48.020273 [debug] [Thread-4 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__stores"
[0m10:29:48.020273 [debug] [Thread-4 (]: On model.epicaldemo.stg_d365_fo__stores: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__stores"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__stores
  
   as (
    WITH

stores_snapshots AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stores_snapshot
),

final AS (
    SELECT
        id AS "store_id"
        ,dbt_scd_id

        ,ROW_NUMBER() OVER (ORDER BY id ASC, dbt_valid_from ASC) AS "store_key"

        ,CASE WHEN dbt_valid_to = '9999-12-31' THEN 1 ELSE 0 END AS is_current
        ,name AS "Store"
        ,SPLIT_PART(location, ',', 1) AS "Store State"
        ,SPLIT_PART(location, ',', 2) AS "Store City"
        ,latitude AS "Lat"
        ,longitude AS "Lon"
        ,onlinepresence AS "Online Presence"
        ,modified
        ,CAST(TO_CHAR(dbt_valid_from::DATE, 'YYYYMMDD') AS INTEGER) AS "valid_from"
        ,CAST(TO_CHAR(dbt_valid_to::DATE, 'YYYYMMDD') AS INTEGER) AS "valid_to"
    FROM stores_snapshots
)

SELECT * FROM final
  );
[0m10:29:48.272109 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.251 seconds
[0m10:29:48.275096 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '257de92d-178b-4033-b47f-7a2b6fb31fe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F22C58E10>]}
[0m10:29:48.276095 [info ] [Thread-4 (]: 12 of 14 OK created sql view model broman_analytics.stg_d365_fo__stores ........ [[32mSUCCESS 1[0m in 0.26s]
[0m10:29:48.277097 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_d365_fo__stores
[0m10:29:48.278094 [debug] [Thread-1 (]: Began running node model.epicaldemo.dim_stores
[0m10:29:48.278094 [debug] [Thread-2 (]: Began running node model.epicaldemo.fact_sales_transactions
[0m10:29:48.278094 [info ] [Thread-1 (]: 13 of 14 START sql table model broman_analytics.dim_stores ..................... [RUN]
[0m10:29:48.279600 [info ] [Thread-2 (]: 14 of 14 START sql table model broman_analytics.fact_sales_transactions ........ [RUN]
[0m10:29:48.279600 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.dim_items, now model.epicaldemo.dim_stores)
[0m10:29:48.280604 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly snapshot.epicaldemo.stores_snapshot, now model.epicaldemo.fact_sales_transactions)
[0m10:29:48.281612 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.dim_stores
[0m10:29:48.281612 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.fact_sales_transactions
[0m10:29:48.285620 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.dim_stores"
[0m10:29:48.289619 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.fact_sales_transactions"
[0m10:29:48.290652 [debug] [Thread-1 (]: Began executing node model.epicaldemo.dim_stores
[0m10:29:48.291652 [debug] [Thread-2 (]: Began executing node model.epicaldemo.fact_sales_transactions
[0m10:29:48.293662 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.dim_stores"
[0m10:29:48.296655 [debug] [Thread-2 (]: Writing runtime sql for node "model.epicaldemo.fact_sales_transactions"
[0m10:29:48.298653 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.dim_stores"
[0m10:29:48.298653 [debug] [Thread-1 (]: On model.epicaldemo.dim_stores: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_stores"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_stores
    

    
    as (with

store AS (
    select
        *
    from EPICALDEMO.broman_analytics.stg_d365_fo__stores
),

final AS (
    SELECT
        "store_key"
        ,"store_id"
        ,"current"
        ,"Store"
        ,"Store State"
        ,"Store City"
        ,"Lat"
        ,"Lon"
        ,"Online Presence"
        ,"modified"
        ,"valid_from"
        ,"valid_to"
    from store
)

select * from final
    )
;
[0m10:29:48.300698 [debug] [Thread-2 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions"
[0m10:29:48.301697 [debug] [Thread-2 (]: On model.epicaldemo.fact_sales_transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions"} */
create or replace transient table EPICALDEMO.broman_analytics.fact_sales_transactions
    

    
    as (WITH

sales AS (
    select
        *
    from EPICALDEMO.broman_analytics.stg_d365_fo__transactions
),

items AS (
    select
        *
    from EPICALDEMO.broman_analytics.stg_d365_fo__items
),

stores AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__stores
),

customers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_salesforce__customers
),

final AS (
    SELECT
        -- Identifiers
        sales.date_id
        ,sales."SKU"

        ,CASE
            WHEN sales."SKU" IS NULL THEN -2 -- SKU is missing from Source
            WHEN item."item_id" IS NULL THEN -1 -- SKU is not known from Source
            ELSE item."item_id" -- Join item_id from Dim based on SKU
         END AS "item_id"

        ,sales."Store"

        ,CASE
            WHEN sales."Store" IS NULL THEN -2
            WHEN store."store_key" IS NULL THEN -1
            ELSE store."store_key"
         END AS "store_key"

        ,sales."Customer Number"

        ,CASE
            WHEN sales."Customer Number" IS NULL THEN -2
            WHEN customer."customer_id" IS NULL THEN -1
            ELSE customer."customer_id"
         END AS "customer_id"

        -- Metrics
        ,sales."Qty"
        ,sales."Unit Price"
        ,sales."Sales Amount"
        ,sales."Unit Cost"
        ,sales."Cost"
        ,sales."Margin"
    FROM sales
    LEFT JOIN item ON item."SKU" = sales."SKU"
    LEFT JOIN store ON store."Store" = sales."Store" AND sales.date_id >= store.valid_from AND sales.date_id < store.valid_to
    LEFT JOIN customer ON customer."Customer Number" = sales."Customer Number"
)

SELECT * FROM final
    )
;
[0m10:29:48.609635 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bcee9d-0004-cdcc-0000-d2e900023402
[0m10:29:48.610642 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01bcee9d-0004-ce00-0000-d2e9000260f2
[0m10:29:48.610642 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 17 at position 9
invalid identifier '"current"'
[0m10:29:48.611642 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'ITEM' does not exist or not authorized.
[0m10:29:48.615642 [debug] [Thread-1 (]: Database Error in model dim_stores (models\mart\dimensions\dim_stores.sql)
  000904 (42000): SQL compilation error: error line 17 at position 9
  invalid identifier '"current"'
  compiled code at target\run\epicaldemo\models\mart\dimensions\dim_stores.sql
[0m10:29:48.616651 [debug] [Thread-2 (]: Database Error in model fact_sales_transactions (models\mart\facts\fact_sales_transactions.sql)
  002003 (42S02): SQL compilation error:
  Object 'ITEM' does not exist or not authorized.
  compiled code at target\run\epicaldemo\models\mart\facts\fact_sales_transactions.sql
[0m10:29:48.617644 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '257de92d-178b-4033-b47f-7a2b6fb31fe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F223D5E90>]}
[0m10:29:48.618642 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '257de92d-178b-4033-b47f-7a2b6fb31fe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F22CA1D90>]}
[0m10:29:48.618642 [error] [Thread-1 (]: 13 of 14 ERROR creating sql table model broman_analytics.dim_stores ............ [[31mERROR[0m in 0.34s]
[0m10:29:48.619641 [error] [Thread-2 (]: 14 of 14 ERROR creating sql table model broman_analytics.fact_sales_transactions  [[31mERROR[0m in 0.34s]
[0m10:29:48.620747 [debug] [Thread-1 (]: Finished running node model.epicaldemo.dim_stores
[0m10:29:48.620747 [debug] [Thread-2 (]: Finished running node model.epicaldemo.fact_sales_transactions
[0m10:29:48.621748 [debug] [Thread-7 (]: Marking all children of 'model.epicaldemo.dim_stores' to be skipped because of status 'error'.  Reason: Database Error in model dim_stores (models\mart\dimensions\dim_stores.sql)
  000904 (42000): SQL compilation error: error line 17 at position 9
  invalid identifier '"current"'
  compiled code at target\run\epicaldemo\models\mart\dimensions\dim_stores.sql.
[0m10:29:48.622747 [debug] [Thread-7 (]: Marking all children of 'model.epicaldemo.fact_sales_transactions' to be skipped because of status 'error'.  Reason: Database Error in model fact_sales_transactions (models\mart\facts\fact_sales_transactions.sql)
  002003 (42S02): SQL compilation error:
  Object 'ITEM' does not exist or not authorized.
  compiled code at target\run\epicaldemo\models\mart\facts\fact_sales_transactions.sql.
[0m10:29:48.623747 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:29:48.624757 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m10:29:48.624757 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m10:29:48.789761 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m10:29:48.789761 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m10:29:48.940376 [debug] [MainThread]: Connection 'model.epicaldemo.dim_stores' was left open.
[0m10:29:48.941376 [debug] [MainThread]: On model.epicaldemo.dim_stores: Close
[0m10:29:49.096577 [debug] [MainThread]: Connection 'model.epicaldemo.fact_sales_transactions' was left open.
[0m10:29:49.096577 [debug] [MainThread]: On model.epicaldemo.fact_sales_transactions: Close
[0m10:29:49.258139 [debug] [MainThread]: Connection 'model.epicaldemo.dim_dates' was left open.
[0m10:29:49.258139 [debug] [MainThread]: On model.epicaldemo.dim_dates: Close
[0m10:29:49.415461 [debug] [MainThread]: Connection 'model.epicaldemo.stg_d365_fo__stores' was left open.
[0m10:29:49.415461 [debug] [MainThread]: On model.epicaldemo.stg_d365_fo__stores: Close
[0m10:29:49.574571 [info ] [MainThread]: 
[0m10:29:49.574571 [info ] [MainThread]: Finished running 1 snapshot, 5 table models, 8 view models in 0 hours 0 minutes and 7.21 seconds (7.21s).
[0m10:29:49.577564 [debug] [MainThread]: Command end result
[0m10:29:49.611918 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m10:29:49.615915 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m10:29:49.623428 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m10:29:49.625428 [info ] [MainThread]: 
[0m10:29:49.626430 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m10:29:49.626430 [info ] [MainThread]: 
[0m10:29:49.627432 [error] [MainThread]:   Database Error in model dim_stores (models\mart\dimensions\dim_stores.sql)
  000904 (42000): SQL compilation error: error line 17 at position 9
  invalid identifier '"current"'
  compiled code at target\run\epicaldemo\models\mart\dimensions\dim_stores.sql
[0m10:29:49.627432 [info ] [MainThread]: 
[0m10:29:49.628428 [error] [MainThread]:   Database Error in model fact_sales_transactions (models\mart\facts\fact_sales_transactions.sql)
  002003 (42S02): SQL compilation error:
  Object 'ITEM' does not exist or not authorized.
  compiled code at target\run\epicaldemo\models\mart\facts\fact_sales_transactions.sql
[0m10:29:49.629430 [info ] [MainThread]: 
[0m10:29:49.629430 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=2 SKIP=0 TOTAL=14
[0m10:29:49.630888 [debug] [MainThread]: Command `dbt build` failed at 10:29:49.630888 after 8.53 seconds
[0m10:29:49.631886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F1DC55010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F1F795390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F1A2F3090>]}
[0m10:29:49.631886 [debug] [MainThread]: Flushing usage events
[0m10:29:50.326496 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:32:26.402352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CB2271010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CB2270F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CB22737D0>]}


============================== 10:32:26.416369 | 576deb05-7d17-4923-a3dd-59c018320546 ==============================
[0m10:32:26.416369 [info ] [MainThread]: Running with dbt=1.9.4
[0m10:32:26.417368 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt build', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:32:26.814501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '576deb05-7d17-4923-a3dd-59c018320546', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CB349BBD0>]}
[0m10:32:26.858099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '576deb05-7d17-4923-a3dd-59c018320546', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CB0C4F990>]}
[0m10:32:26.860609 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m10:32:27.219352 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m10:32:27.410499 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:32:27.411512 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:32:27.416503 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m10:32:27.455062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '576deb05-7d17-4923-a3dd-59c018320546', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CB3CAD010>]}
[0m10:32:27.529265 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m10:32:27.545326 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m10:32:27.620439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '576deb05-7d17-4923-a3dd-59c018320546', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CB3F57D90>]}
[0m10:32:27.621437 [info ] [MainThread]: Found 13 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m10:32:27.624436 [info ] [MainThread]: 
[0m10:32:27.624436 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:32:27.625436 [info ] [MainThread]: 
[0m10:32:27.626436 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:32:27.630448 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m10:32:27.710387 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m10:32:27.710387 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m10:32:27.711387 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:32:28.668564 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.957 seconds
[0m10:32:28.672080 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m10:32:28.682595 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m10:32:28.683597 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m10:32:28.684593 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:32:29.203465 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.519 seconds
[0m10:32:29.207473 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m10:32:29.208468 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m10:32:29.386412 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.177 seconds
[0m10:32:29.388414 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m10:32:29.389410 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m10:32:29.519634 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.130 seconds
[0m10:32:29.523648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '576deb05-7d17-4923-a3dd-59c018320546', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CB425FED0>]}
[0m10:32:29.529639 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__categories
[0m10:32:29.529639 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_d365_fo__dates
[0m10:32:29.530674 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_d365_fo__items
[0m10:32:29.530674 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_d365_fo__managers
[0m10:32:29.531672 [info ] [Thread-1 (]: 1 of 14 START sql view model broman_analytics.stg_d365_fo__categories .......... [RUN]
[0m10:32:29.531672 [info ] [Thread-2 (]: 2 of 14 START sql view model broman_analytics.stg_d365_fo__dates ............... [RUN]
[0m10:32:29.532673 [info ] [Thread-3 (]: 3 of 14 START sql view model broman_analytics.stg_d365_fo__items ............... [RUN]
[0m10:32:29.532673 [info ] [Thread-4 (]: 4 of 14 START sql view model broman_analytics.stg_d365_fo__managers ............ [RUN]
[0m10:32:29.533672 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__categories'
[0m10:32:29.534673 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__dates'
[0m10:32:29.534673 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__items'
[0m10:32:29.535672 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__managers'
[0m10:32:29.536672 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__categories
[0m10:32:29.536672 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_d365_fo__dates
[0m10:32:29.537672 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_d365_fo__items
[0m10:32:29.537672 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_d365_fo__managers
[0m10:32:29.545204 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__categories"
[0m10:32:29.547203 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__dates"
[0m10:32:29.550227 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__items"
[0m10:32:29.554237 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__managers"
[0m10:32:29.556232 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__categories
[0m10:32:29.574595 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_d365_fo__dates
[0m10:32:29.575594 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_d365_fo__items
[0m10:32:29.583647 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__categories"
[0m10:32:29.584642 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_d365_fo__managers
[0m10:32:29.588639 [debug] [Thread-2 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__dates"
[0m10:32:29.593793 [debug] [Thread-3 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__items"
[0m10:32:29.597780 [debug] [Thread-4 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__managers"
[0m10:32:29.600306 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__categories"
[0m10:32:29.602316 [debug] [Thread-1 (]: On model.epicaldemo.stg_d365_fo__categories: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__categories"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__categories
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.category
),

final AS (
    SELECT
        id AS "category_id"
        ,INITCAP(name) AS "Category"
        ,managerid AS "manager_id"
    FROM source
)

SELECT * FROM final
  );
[0m10:32:29.603314 [debug] [Thread-2 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__dates"
[0m10:32:29.603314 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:32:29.604314 [debug] [Thread-3 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__items"
[0m10:32:29.605313 [debug] [Thread-4 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__managers"
[0m10:32:29.606324 [debug] [Thread-2 (]: On model.epicaldemo.stg_d365_fo__dates: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__dates"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__dates
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.date
),

final AS (
    SELECT
        id AS date_id
        ,date AS "Date"
        ,year AS "Year"
        ,yearmonth AS "Year Month"
        ,monthnumber AS "Month Number"
        ,quarter AS "Quarter"
        ,quarternumber AS "Quarter Number"
        ,monthname AS "Month"
    FROM source
)

SELECT * FROM final
  );
[0m10:32:29.609818 [debug] [Thread-3 (]: On model.epicaldemo.stg_d365_fo__items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__items"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__items
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.item
),

final AS (
    SELECT
        id AS "item_id"
        ,name AS "Item"
        ,COALESCE(brand, 'Missing') AS "Brand"
        ,categoryid AS "category_id"
        ,COALESCE(flavor, 'Missing') AS "Flavor"
        ,sku AS "SKU"
    FROM source
)

SELECT * FROM final
  );
[0m10:32:29.612827 [debug] [Thread-4 (]: On model.epicaldemo.stg_d365_fo__managers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__managers"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__managers
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.manager
),

final as (
    SELECT
        id AS "manager_id"
        ,firstname || ' ' || lastname AS "Manager"
    FROM source
)

SELECT * FROM final
  );
[0m10:32:29.615832 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:32:29.616829 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:32:29.617828 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:32:30.317270 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.713 seconds
[0m10:32:30.343416 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '576deb05-7d17-4923-a3dd-59c018320546', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CB46B9390>]}
[0m10:32:30.344414 [info ] [Thread-1 (]: 1 of 14 OK created sql view model broman_analytics.stg_d365_fo__categories ..... [[32mSUCCESS 1[0m in 0.80s]
[0m10:32:30.345414 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__categories
[0m10:32:30.346414 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__transactions
[0m10:32:30.346414 [info ] [Thread-1 (]: 5 of 14 START sql view model broman_analytics.stg_d365_fo__transactions ........ [RUN]
[0m10:32:30.347417 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__categories, now model.epicaldemo.stg_d365_fo__transactions)
[0m10:32:30.347417 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__transactions
[0m10:32:30.351452 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__transactions"
[0m10:32:30.352453 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__transactions
[0m10:32:30.354470 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__transactions"
[0m10:32:30.356454 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__transactions"
[0m10:32:30.356454 [debug] [Thread-1 (]: On model.epicaldemo.stg_d365_fo__transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__transactions"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__transactions
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.transactions
),

final AS (
    SELECT
        -- Identifiers
        CAST(TO_CHAR(date::DATE, 'YYYYMMDD') AS INTEGER) AS "date_id"
        ,sku AS "SKU"
        ,store AS "Store"
        ,customernumber AS "Customer Number"

        -- Metrics
        ,quantity AS "Qty"
        ,unitprice::NUMERIC(10,2) AS "Unit Price"
        ,(quantity * unitprice)::NUMERIC(10,2) AS "Sales Amount"
        ,unitcost::NUMERIC(10,2) AS "Unit Cost"
        ,(quantity * unitcost)::NUMERIC(10,2) AS "Cost"
        ,(quantity * unitprice)::NUMERIC(10,2) - (quantity * unitcost)::NUMERIC(10,2) AS "Margin"
    FROM source
)

SELECT * FROM final
  );
[0m10:32:30.380550 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.766 seconds
[0m10:32:30.382550 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '576deb05-7d17-4923-a3dd-59c018320546', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CB4A17A50>]}
[0m10:32:30.383551 [info ] [Thread-2 (]: 2 of 14 OK created sql view model broman_analytics.stg_d365_fo__dates .......... [[32mSUCCESS 1[0m in 0.85s]
[0m10:32:30.384564 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_d365_fo__dates
[0m10:32:30.385553 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_inriver__item_attributes
[0m10:32:30.386556 [info ] [Thread-2 (]: 6 of 14 START sql view model broman_analytics.stg_inriver__item_attributes ..... [RUN]
[0m10:32:30.387557 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__dates, now model.epicaldemo.stg_inriver__item_attributes)
[0m10:32:30.388559 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_inriver__item_attributes
[0m10:32:30.392592 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_inriver__item_attributes"
[0m10:32:30.393592 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_inriver__item_attributes
[0m10:32:30.397587 [debug] [Thread-2 (]: Writing runtime sql for node "model.epicaldemo.stg_inriver__item_attributes"
[0m10:32:30.398587 [debug] [Thread-2 (]: Using snowflake connection "model.epicaldemo.stg_inriver__item_attributes"
[0m10:32:30.399589 [debug] [Thread-2 (]: On model.epicaldemo.stg_inriver__item_attributes: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_inriver__item_attributes"} */
create or replace   view EPICALDEMO.broman_analytics.stg_inriver__item_attributes
  
   as (
    with

source as (
    select
        *
    from EPICALDEMO.inriver.item_attributes
),

final as (
    select
        id AS "item_attributes_id"
        ,sku AS "SKU"
        ,COALESCE(crunch_level, 'Missing') AS "Crunch Level"
        ,COALESCE(snack_time, 'Missing') AS "Snack Time"
    from source
)

select * from final
  );
[0m10:32:30.567086 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.949 seconds
[0m10:32:30.568090 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '576deb05-7d17-4923-a3dd-59c018320546', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CB3F84750>]}
[0m10:32:30.569602 [info ] [Thread-4 (]: 4 of 14 OK created sql view model broman_analytics.stg_d365_fo__managers ....... [[32mSUCCESS 1[0m in 1.03s]
[0m10:32:30.570610 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_d365_fo__managers
[0m10:32:30.571609 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_salesforce__customers
[0m10:32:30.571609 [info ] [Thread-4 (]: 7 of 14 START sql view model broman_analytics.stg_salesforce__customers ........ [RUN]
[0m10:32:30.572610 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__managers, now model.epicaldemo.stg_salesforce__customers)
[0m10:32:30.572610 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_salesforce__customers
[0m10:32:30.576608 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_salesforce__customers"
[0m10:32:30.578610 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_salesforce__customers
[0m10:32:30.580653 [debug] [Thread-4 (]: Writing runtime sql for node "model.epicaldemo.stg_salesforce__customers"
[0m10:32:30.582652 [debug] [Thread-4 (]: Using snowflake connection "model.epicaldemo.stg_salesforce__customers"
[0m10:32:30.583651 [debug] [Thread-4 (]: On model.epicaldemo.stg_salesforce__customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_salesforce__customers"} */
create or replace   view EPICALDEMO.broman_analytics.stg_salesforce__customers
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.salesforce.customer
),

final AS (
    SELECT
        id AS "customer_id"
        ,customernumber AS "Customer Number"
        ,age AS "Customer Age"

        ,CASE
            WHEN age < 20 THEN '< 20'
            WHEN age >= 20 AND age < 30 THEN '20 - 30'
            WHEN age >= 30 AND age < 50 THEN '30 - 50'
            WHEN age >= 50 AND age < 60 THEN '50 - 60'
            ELSE '60+'
         END AS "Customer Age Group"

        ,CASE
            WHEN age < 20 THEN 1
            WHEN age >= 20 AND age < 30 THEN 2
            WHEN age >= 30 AND age < 50 THEN 3
            WHEN age >= 50 AND age < 60 THEN 4
            ELSE 5
         END AS "customer_age_group_sort"

        ,state AS "Customer State"
    FROM source
)

SELECT * FROM final
  );
[0m10:32:30.664660 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.264 seconds
[0m10:32:30.666643 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '576deb05-7d17-4923-a3dd-59c018320546', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CB46EDD10>]}
[0m10:32:30.667644 [info ] [Thread-2 (]: 6 of 14 OK created sql view model broman_analytics.stg_inriver__item_attributes  [[32mSUCCESS 1[0m in 0.28s]
[0m10:32:30.668643 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_inriver__item_attributes
[0m10:32:30.668643 [debug] [Thread-2 (]: Began running node snapshot.epicaldemo.stores_snapshot
[0m10:32:30.669643 [info ] [Thread-2 (]: 8 of 14 START snapshot broman_analytics.stores_snapshot ........................ [RUN]
[0m10:32:30.669643 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_inriver__item_attributes, now snapshot.epicaldemo.stores_snapshot)
[0m10:32:30.669643 [debug] [Thread-2 (]: Began compiling node snapshot.epicaldemo.stores_snapshot
[0m10:32:30.673052 [debug] [Thread-2 (]: Began executing node snapshot.epicaldemo.stores_snapshot
[0m10:32:30.709233 [debug] [Thread-2 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m10:32:30.710276 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.093 seconds
[0m10:32:30.711239 [debug] [Thread-2 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
[0m10:32:30.713245 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '576deb05-7d17-4923-a3dd-59c018320546', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CB46B9590>]}
[0m10:32:30.714239 [info ] [Thread-3 (]: 3 of 14 OK created sql view model broman_analytics.stg_d365_fo__items .......... [[32mSUCCESS 1[0m in 1.18s]
[0m10:32:30.716237 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_d365_fo__items
[0m10:32:30.717237 [debug] [Thread-3 (]: Began running node model.epicaldemo.dim_dates
[0m10:32:30.718237 [info ] [Thread-3 (]: 9 of 14 START sql table model broman_analytics.dim_dates ....................... [RUN]
[0m10:32:30.718237 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__items, now model.epicaldemo.dim_dates)
[0m10:32:30.719238 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.dim_dates
[0m10:32:30.723560 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.dim_dates"
[0m10:32:30.724551 [debug] [Thread-3 (]: Began executing node model.epicaldemo.dim_dates
[0m10:32:30.745625 [debug] [Thread-3 (]: Writing runtime sql for node "model.epicaldemo.dim_dates"
[0m10:32:30.747623 [debug] [Thread-3 (]: Using snowflake connection "model.epicaldemo.dim_dates"
[0m10:32:30.748618 [debug] [Thread-3 (]: On model.epicaldemo.dim_dates: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_dates"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_dates
    

    
    as (with

dates AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__dates
),

final AS (
    SELECT
        date_id
        ,"Date"
        ,"Year"
        ,"Year Month"
        ,LEFT(date_id::TEXT, 6) AS "Year Month Number"
        ,"Month Number"
        ,"Quarter"
        ,"Quarter Number"
        ,"Month"
        ,LEFT("Month",3) AS "Month Short"
    FROM dates
)

SELECT * FROM final
    )
;
[0m10:32:30.856880 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.143 seconds
[0m10:32:30.892003 [debug] [Thread-2 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m10:32:30.893997 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.537 seconds
[0m10:32:30.893997 [debug] [Thread-2 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
create or replace temporary table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp"
as (
    
    
    with snapshot_query as (

        select * from EPICALDEMO.d365_fo.store

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            
  
  coalesce(nullif(modified, modified), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            modified as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.modified)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.modified)
        )
    )

    select * from insertions
    union all
    select * from updates

    )
;
[0m10:32:30.896010 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '576deb05-7d17-4923-a3dd-59c018320546', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CB461D990>]}
[0m10:32:30.897003 [info ] [Thread-1 (]: 5 of 14 OK created sql view model broman_analytics.stg_d365_fo__transactions ... [[32mSUCCESS 1[0m in 0.55s]
[0m10:32:30.897996 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__transactions
[0m10:32:30.899516 [debug] [Thread-1 (]: Began running node model.epicaldemo.dim_items
[0m10:32:30.900526 [info ] [Thread-1 (]: 10 of 14 START sql table model broman_analytics.dim_items ...................... [RUN]
[0m10:32:30.900526 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__transactions, now model.epicaldemo.dim_items)
[0m10:32:30.901528 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.dim_items
[0m10:32:30.904533 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.dim_items"
[0m10:32:30.905525 [debug] [Thread-1 (]: Began executing node model.epicaldemo.dim_items
[0m10:32:30.908526 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.dim_items"
[0m10:32:30.911046 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.dim_items"
[0m10:32:30.911046 [debug] [Thread-1 (]: On model.epicaldemo.dim_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_items"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_items
    

    
    as (with

item AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__items
),

item_attributes AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_inriver__item_attributes
),

category AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__categories
),

manager AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__managers
),

unknown AS (
    SELECT
        -1 AS "item_id"
        ,'Unknown' AS "SKU"
        ,'Unknown' AS "Item"
        ,'Missing' AS "Brand"
        ,'Missing' AS "Flavor"
        ,'Missing' AS "Crunch Level"
        ,'Missing' AS "Snack Time"
        ,'Missing' AS "Category"
        ,'Missing' AS "Manager"
),

missing AS (
    SELECT
        -2 AS "item_id"
        ,'Missing' AS "SKU"
        ,'Missing' AS "Item"
        ,'Missing' AS "Brand"
        ,'Missing' AS "Flavor"
        ,'Missing' AS "Crunch Level"
        ,'Missing' AS "Snack Time"
        ,'Missing' AS "Category"
        ,'Missing' AS "Manager"
),

final AS (
    SELECT
        item."item_id"
        ,item."SKU"
        ,item."Item"
        ,item."Brand"
        ,item."Flavor"
        ,COALESCE(item_attributes."Crunch Level", 'Missing') AS "Crunch Level"
        ,COALESCE(item_attributes."Snack Time", 'Missing') AS "Snack Time"
        ,category."Category"
        ,manager."Manager"
    FROM item
    LEFT JOIN item_attributes ON item_attributes."SKU" = item."SKU"
    LEFT JOIN category ON category."category_id" = item."category_id"
    LEFT JOIN manager ON manager."manager_id" = category."manager_id"

    UNION

    SELECT * FROM unknown

    UNION

    SELECT * FROM missing
)

SELECT * FROM final
    )
;
[0m10:32:30.929562 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.346 seconds
[0m10:32:30.931607 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '576deb05-7d17-4923-a3dd-59c018320546', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CB46E2D90>]}
[0m10:32:30.932599 [info ] [Thread-4 (]: 7 of 14 OK created sql view model broman_analytics.stg_salesforce__customers ... [[32mSUCCESS 1[0m in 0.36s]
[0m10:32:30.933599 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_salesforce__customers
[0m10:32:30.934600 [debug] [Thread-4 (]: Began running node model.epicaldemo.dim_customers
[0m10:32:30.934600 [info ] [Thread-4 (]: 11 of 14 START sql table model broman_analytics.dim_customers .................. [RUN]
[0m10:32:30.935599 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_salesforce__customers, now model.epicaldemo.dim_customers)
[0m10:32:30.936598 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.dim_customers
[0m10:32:30.939607 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.dim_customers"
[0m10:32:30.940659 [debug] [Thread-4 (]: Began executing node model.epicaldemo.dim_customers
[0m10:32:30.943652 [debug] [Thread-4 (]: Writing runtime sql for node "model.epicaldemo.dim_customers"
[0m10:32:30.944651 [debug] [Thread-4 (]: Using snowflake connection "model.epicaldemo.dim_customers"
[0m10:32:30.945660 [debug] [Thread-4 (]: On model.epicaldemo.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_customers"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_customers
    

    
    as (WITH

customers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_salesforce__customers
),

final AS (
    SELECT
        "customer_id"
        ,"Customer Number"
        ,"Customer Age"
        ,"Customer Age Group"
        ,"customer_age_group_sort"
        ,"Customer State"
    FROM customers
)

SELECT * FROM final
    )
;
[0m10:32:31.589226 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.692 seconds
[0m10:32:31.592750 [debug] [Thread-2 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m10:32:31.592750 [debug] [Thread-2 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp"
[0m10:32:31.597741 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.849 seconds
[0m10:32:31.600262 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '576deb05-7d17-4923-a3dd-59c018320546', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CB39F9810>]}
[0m10:32:31.601250 [info ] [Thread-3 (]: 9 of 14 OK created sql table model broman_analytics.dim_dates .................. [[32mSUCCESS 1[0m in 0.88s]
[0m10:32:31.602253 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.656 seconds
[0m10:32:31.603263 [debug] [Thread-3 (]: Finished running node model.epicaldemo.dim_dates
[0m10:32:31.605251 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '576deb05-7d17-4923-a3dd-59c018320546', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CB4A9AD50>]}
[0m10:32:31.606251 [info ] [Thread-4 (]: 11 of 14 OK created sql table model broman_analytics.dim_customers ............. [[32mSUCCESS 1[0m in 0.67s]
[0m10:32:31.606251 [debug] [Thread-4 (]: Finished running node model.epicaldemo.dim_customers
[0m10:32:31.709237 [debug] [Thread-2 (]: SQL status: SUCCESS 13 in 0.116 seconds
[0m10:32:31.713251 [debug] [Thread-2 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m10:32:31.713251 [debug] [Thread-2 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
[0m10:32:31.815430 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.102 seconds
[0m10:32:31.819439 [debug] [Thread-2 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m10:32:31.819439 [debug] [Thread-2 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp"
[0m10:32:31.912327 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.000 seconds
[0m10:32:31.914327 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '576deb05-7d17-4923-a3dd-59c018320546', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CB460BC50>]}
[0m10:32:31.915327 [info ] [Thread-1 (]: 10 of 14 OK created sql table model broman_analytics.dim_items ................. [[32mSUCCESS 1[0m in 1.01s]
[0m10:32:31.916328 [debug] [Thread-1 (]: Finished running node model.epicaldemo.dim_items
[0m10:32:31.984597 [debug] [Thread-2 (]: SQL status: SUCCESS 13 in 0.164 seconds
[0m10:32:31.987596 [debug] [Thread-2 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m10:32:31.988596 [debug] [Thread-2 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
[0m10:32:32.098309 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.109 seconds
[0m10:32:32.104353 [debug] [Thread-2 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m10:32:32.104353 [debug] [Thread-2 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp"
[0m10:32:32.202665 [debug] [Thread-2 (]: SQL status: SUCCESS 13 in 0.098 seconds
[0m10:32:32.221745 [debug] [Thread-2 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m10:32:32.222741 [debug] [Thread-2 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from EPICALDEMO.d365_fo.store

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            
  
  coalesce(nullif(modified, modified), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            modified as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.modified)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.modified)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m10:32:32.658065 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.435 seconds
[0m10:32:32.664587 [debug] [Thread-2 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m10:32:32.664587 [debug] [Thread-2 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m10:32:32.796894 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.131 seconds
[0m10:32:32.797891 [warn ] [Thread-2 (]: Data type of snapshot table timestamp columns (TIMESTAMP_NTZ) doesn't match derived column 'updated_at' (DATE). Please update snapshot config 'updated_at'.
[0m10:32:32.797891 [debug] [Thread-2 (]: Writing runtime sql for node "snapshot.epicaldemo.stores_snapshot"
[0m10:32:32.800402 [debug] [Thread-2 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m10:32:32.800402 [debug] [Thread-2 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
BEGIN
[0m10:32:32.955555 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.155 seconds
[0m10:32:32.956568 [debug] [Thread-2 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m10:32:32.957563 [debug] [Thread-2 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
merge into "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT" as DBT_INTERNAL_DEST
    using "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
	
	
	and ((DBT_INTERNAL_DEST.dbt_valid_to = to_date('9999-12-31'))
 or DBT_INTERNAL_DEST.dbt_valid_to is null)

     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("ID", "NAME", "LOCATION", "LATITUDE", "LONGITUDE", "ONLINEPRESENCE", "MODIFIED", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("ID", "NAME", "LOCATION", "LATITUDE", "LONGITUDE", "ONLINEPRESENCE", "MODIFIED", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m10:32:33.516232 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.559 seconds
[0m10:32:33.517240 [debug] [Thread-2 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m10:32:33.518231 [debug] [Thread-2 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
COMMIT
[0m10:32:33.964623 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.447 seconds
[0m10:32:33.968622 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '576deb05-7d17-4923-a3dd-59c018320546', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CB46E7990>]}
[0m10:32:33.969635 [info ] [Thread-2 (]: 8 of 14 OK snapshotted broman_analytics.stores_snapshot ........................ [[32mSUCCESS 0[0m in 3.30s]
[0m10:32:33.970692 [debug] [Thread-2 (]: Finished running node snapshot.epicaldemo.stores_snapshot
[0m10:32:33.971692 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_d365_fo__stores
[0m10:32:33.971692 [info ] [Thread-3 (]: 12 of 14 START sql view model broman_analytics.stg_d365_fo__stores ............. [RUN]
[0m10:32:33.972691 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.dim_dates, now model.epicaldemo.stg_d365_fo__stores)
[0m10:32:33.972691 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_d365_fo__stores
[0m10:32:33.975701 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__stores"
[0m10:32:33.976693 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_d365_fo__stores
[0m10:32:33.978692 [debug] [Thread-3 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__stores"
[0m10:32:33.979693 [debug] [Thread-3 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__stores"
[0m10:32:33.981199 [debug] [Thread-3 (]: On model.epicaldemo.stg_d365_fo__stores: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__stores"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__stores
  
   as (
    WITH

stores_snapshots AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stores_snapshot
),

final AS (
    SELECT
        id AS "store_id"
        ,dbt_scd_id

        ,ROW_NUMBER() OVER (ORDER BY id ASC, dbt_valid_from ASC) AS "store_key"

        ,CASE WHEN dbt_valid_to = '9999-12-31' THEN 1 ELSE 0 END AS is_current
        ,name AS "Store"
        ,SPLIT_PART(location, ',', 1) AS "Store State"
        ,SPLIT_PART(location, ',', 2) AS "Store City"
        ,latitude AS "Lat"
        ,longitude AS "Lon"
        ,onlinepresence AS "Online Presence"
        ,modified
        ,CAST(TO_CHAR(dbt_valid_from::DATE, 'YYYYMMDD') AS INTEGER) AS "valid_from"
        ,CAST(TO_CHAR(dbt_valid_to::DATE, 'YYYYMMDD') AS INTEGER) AS "valid_to"
    FROM stores_snapshots
)

SELECT * FROM final
  );
[0m10:32:34.298169 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.317 seconds
[0m10:32:34.300708 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '576deb05-7d17-4923-a3dd-59c018320546', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CB4B32D50>]}
[0m10:32:34.301690 [info ] [Thread-3 (]: 12 of 14 OK created sql view model broman_analytics.stg_d365_fo__stores ........ [[32mSUCCESS 1[0m in 0.33s]
[0m10:32:34.302704 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_d365_fo__stores
[0m10:32:34.303691 [debug] [Thread-1 (]: Began running node model.epicaldemo.dim_stores
[0m10:32:34.303691 [debug] [Thread-2 (]: Began running node model.epicaldemo.fact_sales_transactions
[0m10:32:34.304694 [info ] [Thread-1 (]: 13 of 14 START sql table model broman_analytics.dim_stores ..................... [RUN]
[0m10:32:34.304694 [info ] [Thread-2 (]: 14 of 14 START sql table model broman_analytics.fact_sales_transactions ........ [RUN]
[0m10:32:34.305692 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.dim_items, now model.epicaldemo.dim_stores)
[0m10:32:34.305692 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly snapshot.epicaldemo.stores_snapshot, now model.epicaldemo.fact_sales_transactions)
[0m10:32:34.306691 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.dim_stores
[0m10:32:34.306691 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.fact_sales_transactions
[0m10:32:34.309699 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.dim_stores"
[0m10:32:34.312239 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.fact_sales_transactions"
[0m10:32:34.313231 [debug] [Thread-1 (]: Began executing node model.epicaldemo.dim_stores
[0m10:32:34.314231 [debug] [Thread-2 (]: Began executing node model.epicaldemo.fact_sales_transactions
[0m10:32:34.316231 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.dim_stores"
[0m10:32:34.319230 [debug] [Thread-2 (]: Writing runtime sql for node "model.epicaldemo.fact_sales_transactions"
[0m10:32:34.321736 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.dim_stores"
[0m10:32:34.322739 [debug] [Thread-2 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions"
[0m10:32:34.323741 [debug] [Thread-1 (]: On model.epicaldemo.dim_stores: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_stores"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_stores
    

    
    as (with

store AS (
    select
        *
    from EPICALDEMO.broman_analytics.stg_d365_fo__stores
),

final AS (
    SELECT
        "store_key"
        ,"store_id"
        ,IS_CURRENT
        ,"Store"
        ,"Store State"
        ,"Store City"
        ,"Lat"
        ,"Lon"
        ,"Online Presence"
        ,MODIFIED
        ,"valid_from"
        ,"valid_to"
    from store
)

select * from final
    )
;
[0m10:32:34.324740 [debug] [Thread-2 (]: On model.epicaldemo.fact_sales_transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions"} */
create or replace transient table EPICALDEMO.broman_analytics.fact_sales_transactions
    

    
    as (WITH

sales AS (
    select
        *
    from EPICALDEMO.broman_analytics.stg_d365_fo__transactions
),

items AS (
    select
        *
    from EPICALDEMO.broman_analytics.stg_d365_fo__items
),

stores AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__stores
),

customers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_salesforce__customers
),

final AS (
    SELECT
        -- Identifiers
        sales."date_id"
        ,sales."SKU"

        ,CASE
            WHEN sales."SKU" IS NULL THEN -2 -- SKU is missing from Source
            WHEN item."item_id" IS NULL THEN -1 -- SKU is not known from Source
            ELSE item."item_id" -- Join item_id from Dim based on SKU
         END AS "item_id"

        ,sales."Store"

        ,CASE
            WHEN sales."Store" IS NULL THEN -2
            WHEN store."store_key" IS NULL THEN -1
            ELSE store."store_key"
         END AS "store_key"

        ,sales."Customer Number"

        ,CASE
            WHEN sales."Customer Number" IS NULL THEN -2
            WHEN customer."customer_id" IS NULL THEN -1
            ELSE customer."customer_id"
         END AS "customer_id"

        -- Metrics
        ,sales."Qty"
        ,sales."Unit Price"
        ,sales."Sales Amount"
        ,sales."Unit Cost"
        ,sales."Cost"
        ,sales."Margin"
    FROM sales
    LEFT JOIN item ON item."SKU" = sales."SKU"
    LEFT JOIN store ON store."Store" = sales."Store" AND sales."date_id" >= store."valid_from" AND sales."date_id" < store."valid_to"
    LEFT JOIN customer ON customer."Customer Number" = sales."Customer Number"
)

SELECT * FROM final
    )
;
[0m10:32:34.626637 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01bceea0-0004-ce01-0000-d2e90002439e
[0m10:32:34.626637 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'ITEM' does not exist or not authorized.
[0m10:32:34.629638 [debug] [Thread-2 (]: Database Error in model fact_sales_transactions (models\mart\facts\fact_sales_transactions.sql)
  002003 (42S02): SQL compilation error:
  Object 'ITEM' does not exist or not authorized.
  compiled code at target\run\epicaldemo\models\mart\facts\fact_sales_transactions.sql
[0m10:32:34.630674 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '576deb05-7d17-4923-a3dd-59c018320546', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CB4A8C850>]}
[0m10:32:34.631674 [error] [Thread-2 (]: 14 of 14 ERROR creating sql table model broman_analytics.fact_sales_transactions  [[31mERROR[0m in 0.32s]
[0m10:32:34.631674 [debug] [Thread-2 (]: Finished running node model.epicaldemo.fact_sales_transactions
[0m10:32:34.632674 [debug] [Thread-7 (]: Marking all children of 'model.epicaldemo.fact_sales_transactions' to be skipped because of status 'error'.  Reason: Database Error in model fact_sales_transactions (models\mart\facts\fact_sales_transactions.sql)
  002003 (42S02): SQL compilation error:
  Object 'ITEM' does not exist or not authorized.
  compiled code at target\run\epicaldemo\models\mart\facts\fact_sales_transactions.sql.
[0m10:32:35.022284 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.698 seconds
[0m10:32:35.024295 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '576deb05-7d17-4923-a3dd-59c018320546', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CB4B24B50>]}
[0m10:32:35.025293 [info ] [Thread-1 (]: 13 of 14 OK created sql table model broman_analytics.dim_stores ................ [[32mSUCCESS 1[0m in 0.72s]
[0m10:32:35.026286 [debug] [Thread-1 (]: Finished running node model.epicaldemo.dim_stores
[0m10:32:35.028286 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:32:35.028286 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m10:32:35.029284 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m10:32:35.204688 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m10:32:35.205688 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m10:32:35.360655 [debug] [MainThread]: Connection 'model.epicaldemo.dim_stores' was left open.
[0m10:32:35.360655 [debug] [MainThread]: On model.epicaldemo.dim_stores: Close
[0m10:32:35.526202 [debug] [MainThread]: Connection 'model.epicaldemo.fact_sales_transactions' was left open.
[0m10:32:35.527204 [debug] [MainThread]: On model.epicaldemo.fact_sales_transactions: Close
[0m10:32:35.695534 [debug] [MainThread]: Connection 'model.epicaldemo.stg_d365_fo__stores' was left open.
[0m10:32:35.695534 [debug] [MainThread]: On model.epicaldemo.stg_d365_fo__stores: Close
[0m10:32:35.849422 [debug] [MainThread]: Connection 'model.epicaldemo.dim_customers' was left open.
[0m10:32:35.850576 [debug] [MainThread]: On model.epicaldemo.dim_customers: Close
[0m10:32:36.000565 [info ] [MainThread]: 
[0m10:32:36.001565 [info ] [MainThread]: Finished running 1 snapshot, 5 table models, 8 view models in 0 hours 0 minutes and 8.37 seconds (8.37s).
[0m10:32:36.004565 [debug] [MainThread]: Command end result
[0m10:32:36.027593 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m10:32:36.031674 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m10:32:36.040195 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m10:32:36.040195 [info ] [MainThread]: 
[0m10:32:36.041198 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:32:36.042196 [info ] [MainThread]: 
[0m10:32:36.042196 [error] [MainThread]:   Database Error in model fact_sales_transactions (models\mart\facts\fact_sales_transactions.sql)
  002003 (42S02): SQL compilation error:
  Object 'ITEM' does not exist or not authorized.
  compiled code at target\run\epicaldemo\models\mart\facts\fact_sales_transactions.sql
[0m10:32:36.043199 [info ] [MainThread]: 
[0m10:32:36.044198 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=1 SKIP=0 TOTAL=14
[0m10:32:36.045196 [debug] [MainThread]: Command `dbt build` failed at 10:32:36.045196 after 9.71 seconds
[0m10:32:36.045196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CB22C6190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CAC6F3090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CB1BBE550>]}
[0m10:32:36.046197 [debug] [MainThread]: Flushing usage events
[0m10:32:36.684659 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:34:04.712121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C81D670490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C81D66BC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C81D6714D0>]}


============================== 10:34:04.716122 | 8a8aa3d4-120d-4e9b-b088-5fbb71a4089d ==============================
[0m10:34:04.716122 [info ] [MainThread]: Running with dbt=1.9.4
[0m10:34:04.717129 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m10:34:05.117681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a8aa3d4-120d-4e9b-b088-5fbb71a4089d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C81B1E89D0>]}
[0m10:34:05.159319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a8aa3d4-120d-4e9b-b088-5fbb71a4089d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C81E831810>]}
[0m10:34:05.161339 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m10:34:05.463107 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m10:34:05.664199 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:34:05.665195 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:34:05.670724 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m10:34:05.707476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a8aa3d4-120d-4e9b-b088-5fbb71a4089d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C81F0DD9D0>]}
[0m10:34:05.783527 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m10:34:05.787523 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m10:34:05.819657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a8aa3d4-120d-4e9b-b088-5fbb71a4089d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C81F357B50>]}
[0m10:34:05.819657 [info ] [MainThread]: Found 13 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m10:34:05.822806 [info ] [MainThread]: 
[0m10:34:05.823797 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:34:05.823797 [info ] [MainThread]: 
[0m10:34:05.824805 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:34:05.829302 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m10:34:05.906578 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m10:34:05.907576 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m10:34:05.907576 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:34:06.624074 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.716 seconds
[0m10:34:06.627065 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m10:34:06.636581 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m10:34:06.636581 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m10:34:06.637581 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:34:07.095526 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.458 seconds
[0m10:34:07.099537 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m10:34:07.100542 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m10:34:07.247820 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 0.148 seconds
[0m10:34:07.250350 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m10:34:07.251340 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m10:34:07.402478 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.151 seconds
[0m10:34:07.405474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a8aa3d4-120d-4e9b-b088-5fbb71a4089d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C81F34ECD0>]}
[0m10:34:07.409467 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__categories
[0m10:34:07.410517 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_d365_fo__dates
[0m10:34:07.410517 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_d365_fo__items
[0m10:34:07.411518 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_d365_fo__managers
[0m10:34:07.411518 [info ] [Thread-1 (]: 1 of 14 START sql view model broman_analytics.stg_d365_fo__categories .......... [RUN]
[0m10:34:07.412520 [info ] [Thread-2 (]: 2 of 14 START sql view model broman_analytics.stg_d365_fo__dates ............... [RUN]
[0m10:34:07.413524 [info ] [Thread-3 (]: 3 of 14 START sql view model broman_analytics.stg_d365_fo__items ............... [RUN]
[0m10:34:07.413524 [info ] [Thread-4 (]: 4 of 14 START sql view model broman_analytics.stg_d365_fo__managers ............ [RUN]
[0m10:34:07.414523 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__categories'
[0m10:34:07.415517 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__dates'
[0m10:34:07.416519 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__items'
[0m10:34:07.416519 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__managers'
[0m10:34:07.417517 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__categories
[0m10:34:07.417517 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_d365_fo__dates
[0m10:34:07.418522 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_d365_fo__items
[0m10:34:07.418522 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_d365_fo__managers
[0m10:34:07.427059 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__categories"
[0m10:34:07.429618 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__dates"
[0m10:34:07.433572 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__items"
[0m10:34:07.436570 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__managers"
[0m10:34:07.438570 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__categories
[0m10:34:07.438570 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_d365_fo__dates
[0m10:34:07.439570 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_d365_fo__items
[0m10:34:07.473310 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__categories"
[0m10:34:07.481369 [debug] [Thread-2 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__dates"
[0m10:34:07.482368 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_d365_fo__managers
[0m10:34:07.485795 [debug] [Thread-3 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__items"
[0m10:34:07.490309 [debug] [Thread-4 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__managers"
[0m10:34:07.491315 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__categories"
[0m10:34:07.492307 [debug] [Thread-2 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__dates"
[0m10:34:07.493321 [debug] [Thread-1 (]: On model.epicaldemo.stg_d365_fo__categories: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__categories"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__categories
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.category
),

final AS (
    SELECT
        id AS "category_id"
        ,INITCAP(name) AS "Category"
        ,managerid AS "manager_id"
    FROM source
)

SELECT * FROM final
  );
[0m10:34:07.494310 [debug] [Thread-3 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__items"
[0m10:34:07.494310 [debug] [Thread-2 (]: On model.epicaldemo.stg_d365_fo__dates: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__dates"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__dates
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.date
),

final AS (
    SELECT
        id AS date_id
        ,date AS "Date"
        ,year AS "Year"
        ,yearmonth AS "Year Month"
        ,monthnumber AS "Month Number"
        ,quarter AS "Quarter"
        ,quarternumber AS "Quarter Number"
        ,monthname AS "Month"
    FROM source
)

SELECT * FROM final
  );
[0m10:34:07.495311 [debug] [Thread-4 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__managers"
[0m10:34:07.495311 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:34:07.496309 [debug] [Thread-3 (]: On model.epicaldemo.stg_d365_fo__items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__items"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__items
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.item
),

final AS (
    SELECT
        id AS "item_id"
        ,name AS "Item"
        ,COALESCE(brand, 'Missing') AS "Brand"
        ,categoryid AS "category_id"
        ,COALESCE(flavor, 'Missing') AS "Flavor"
        ,sku AS "SKU"
    FROM source
)

SELECT * FROM final
  );
[0m10:34:07.496309 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:34:07.497314 [debug] [Thread-4 (]: On model.epicaldemo.stg_d365_fo__managers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__managers"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__managers
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.manager
),

final as (
    SELECT
        id AS "manager_id"
        ,firstname || ' ' || lastname AS "Manager"
    FROM source
)

SELECT * FROM final
  );
[0m10:34:07.499947 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:34:07.502964 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:34:08.286379 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.790 seconds
[0m10:34:08.306948 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a8aa3d4-120d-4e9b-b088-5fbb71a4089d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C81FAE42D0>]}
[0m10:34:08.307949 [info ] [Thread-1 (]: 1 of 14 OK created sql view model broman_analytics.stg_d365_fo__categories ..... [[32mSUCCESS 1[0m in 0.89s]
[0m10:34:08.309458 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__categories
[0m10:34:08.310464 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__transactions
[0m10:34:08.310464 [info ] [Thread-1 (]: 5 of 14 START sql view model broman_analytics.stg_d365_fo__transactions ........ [RUN]
[0m10:34:08.311464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__categories, now model.epicaldemo.stg_d365_fo__transactions)
[0m10:34:08.312469 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__transactions
[0m10:34:08.315467 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__transactions"
[0m10:34:08.316467 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__transactions
[0m10:34:08.318468 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__transactions"
[0m10:34:08.321996 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__transactions"
[0m10:34:08.322995 [debug] [Thread-1 (]: On model.epicaldemo.stg_d365_fo__transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__transactions"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__transactions
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.transactions
),

final AS (
    SELECT
        -- Identifiers
        CAST(TO_CHAR(date::DATE, 'YYYYMMDD') AS INTEGER) AS "date_id"
        ,sku AS "SKU"
        ,store AS "Store"
        ,customernumber AS "Customer Number"

        -- Metrics
        ,quantity AS "Qty"
        ,unitprice::NUMERIC(10,2) AS "Unit Price"
        ,(quantity * unitprice)::NUMERIC(10,2) AS "Sales Amount"
        ,unitcost::NUMERIC(10,2) AS "Unit Cost"
        ,(quantity * unitcost)::NUMERIC(10,2) AS "Cost"
        ,(quantity * unitprice)::NUMERIC(10,2) - (quantity * unitcost)::NUMERIC(10,2) AS "Margin"
    FROM source
)

SELECT * FROM final
  );
[0m10:34:08.344026 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.842 seconds
[0m10:34:08.348029 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a8aa3d4-120d-4e9b-b088-5fbb71a4089d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C81F7D5E50>]}
[0m10:34:08.348029 [info ] [Thread-4 (]: 4 of 14 OK created sql view model broman_analytics.stg_d365_fo__managers ....... [[32mSUCCESS 1[0m in 0.93s]
[0m10:34:08.349537 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_d365_fo__managers
[0m10:34:08.350551 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_inriver__item_attributes
[0m10:34:08.352547 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.856 seconds
[0m10:34:08.351549 [info ] [Thread-4 (]: 6 of 14 START sql view model broman_analytics.stg_inriver__item_attributes ..... [RUN]
[0m10:34:08.356555 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a8aa3d4-120d-4e9b-b088-5fbb71a4089d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C81F776B50>]}
[0m10:34:08.357545 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__managers, now model.epicaldemo.stg_inriver__item_attributes)
[0m10:34:08.358543 [info ] [Thread-2 (]: 2 of 14 OK created sql view model broman_analytics.stg_d365_fo__dates .......... [[32mSUCCESS 1[0m in 0.94s]
[0m10:34:08.358543 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_inriver__item_attributes
[0m10:34:08.359549 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_d365_fo__dates
[0m10:34:08.365650 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_inriver__item_attributes"
[0m10:34:08.366640 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_salesforce__customers
[0m10:34:08.369645 [info ] [Thread-2 (]: 7 of 14 START sql view model broman_analytics.stg_salesforce__customers ........ [RUN]
[0m10:34:08.370156 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_inriver__item_attributes
[0m10:34:08.371165 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__dates, now model.epicaldemo.stg_salesforce__customers)
[0m10:34:08.376170 [debug] [Thread-4 (]: Writing runtime sql for node "model.epicaldemo.stg_inriver__item_attributes"
[0m10:34:08.378219 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_salesforce__customers
[0m10:34:08.390262 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_salesforce__customers"
[0m10:34:08.394650 [debug] [Thread-4 (]: Using snowflake connection "model.epicaldemo.stg_inriver__item_attributes"
[0m10:34:08.398178 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.899 seconds
[0m10:34:08.400774 [debug] [Thread-4 (]: On model.epicaldemo.stg_inriver__item_attributes: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_inriver__item_attributes"} */
create or replace   view EPICALDEMO.broman_analytics.stg_inriver__item_attributes
  
   as (
    with

source as (
    select
        *
    from EPICALDEMO.inriver.item_attributes
),

final as (
    select
        id AS "item_attributes_id"
        ,sku AS "SKU"
        ,COALESCE(crunch_level, 'Missing') AS "Crunch Level"
        ,COALESCE(snack_time, 'Missing') AS "Snack Time"
    from source
)

select * from final
  );
[0m10:34:08.409406 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a8aa3d4-120d-4e9b-b088-5fbb71a4089d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C81F777790>]}
[0m10:34:08.411418 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_salesforce__customers
[0m10:34:08.418430 [info ] [Thread-3 (]: 3 of 14 OK created sql view model broman_analytics.stg_d365_fo__items .......... [[32mSUCCESS 1[0m in 0.99s]
[0m10:34:08.429463 [debug] [Thread-2 (]: Writing runtime sql for node "model.epicaldemo.stg_salesforce__customers"
[0m10:34:08.431978 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_d365_fo__items
[0m10:34:08.434976 [debug] [Thread-3 (]: Began running node snapshot.epicaldemo.stores_snapshot
[0m10:34:08.441515 [debug] [Thread-2 (]: Using snowflake connection "model.epicaldemo.stg_salesforce__customers"
[0m10:34:08.437989 [info ] [Thread-3 (]: 8 of 14 START snapshot broman_analytics.stores_snapshot ........................ [RUN]
[0m10:34:08.442513 [debug] [Thread-2 (]: On model.epicaldemo.stg_salesforce__customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_salesforce__customers"} */
create or replace   view EPICALDEMO.broman_analytics.stg_salesforce__customers
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.salesforce.customer
),

final AS (
    SELECT
        id AS "customer_id"
        ,customernumber AS "Customer Number"
        ,age AS "Customer Age"

        ,CASE
            WHEN age < 20 THEN '< 20'
            WHEN age >= 20 AND age < 30 THEN '20 - 30'
            WHEN age >= 30 AND age < 50 THEN '30 - 50'
            WHEN age >= 50 AND age < 60 THEN '50 - 60'
            ELSE '60+'
         END AS "Customer Age Group"

        ,CASE
            WHEN age < 20 THEN 1
            WHEN age >= 20 AND age < 30 THEN 2
            WHEN age >= 30 AND age < 50 THEN 3
            WHEN age >= 50 AND age < 60 THEN 4
            ELSE 5
         END AS "customer_age_group_sort"

        ,state AS "Customer State"
    FROM source
)

SELECT * FROM final
  );
[0m10:34:08.443514 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__items, now snapshot.epicaldemo.stores_snapshot)
[0m10:34:08.444517 [debug] [Thread-3 (]: Began compiling node snapshot.epicaldemo.stores_snapshot
[0m10:34:08.454044 [debug] [Thread-3 (]: Began executing node snapshot.epicaldemo.stores_snapshot
[0m10:34:08.511723 [debug] [Thread-3 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m10:34:08.515705 [debug] [Thread-3 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
[0m10:34:08.616228 [debug] [Thread-3 (]: SQL status: SUCCESS 11 in 0.100 seconds
[0m10:34:08.656289 [debug] [Thread-3 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m10:34:08.658300 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.335 seconds
[0m10:34:08.659288 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.245 seconds
[0m10:34:08.659833 [debug] [Thread-3 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
create or replace temporary table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp"
as (
    
    
    with snapshot_query as (

        select * from EPICALDEMO.d365_fo.store

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            
  
  coalesce(nullif(modified, modified), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            modified as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.modified)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.modified)
        )
    )

    select * from insertions
    union all
    select * from updates

    )
;
[0m10:34:08.661840 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a8aa3d4-120d-4e9b-b088-5fbb71a4089d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C81D75C790>]}
[0m10:34:08.663837 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a8aa3d4-120d-4e9b-b088-5fbb71a4089d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C81FA15DD0>]}
[0m10:34:08.664837 [info ] [Thread-1 (]: 5 of 14 OK created sql view model broman_analytics.stg_d365_fo__transactions ... [[32mSUCCESS 1[0m in 0.35s]
[0m10:34:08.665838 [info ] [Thread-4 (]: 6 of 14 OK created sql view model broman_analytics.stg_inriver__item_attributes  [[32mSUCCESS 1[0m in 0.31s]
[0m10:34:08.666837 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__transactions
[0m10:34:08.667837 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_inriver__item_attributes
[0m10:34:08.669341 [debug] [Thread-1 (]: Began running node model.epicaldemo.dim_dates
[0m10:34:08.670347 [debug] [Thread-4 (]: Began running node model.epicaldemo.dim_items
[0m10:34:08.671344 [info ] [Thread-1 (]: 9 of 14 START sql table model broman_analytics.dim_dates ....................... [RUN]
[0m10:34:08.671344 [info ] [Thread-4 (]: 10 of 14 START sql table model broman_analytics.dim_items ...................... [RUN]
[0m10:34:08.672349 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__transactions, now model.epicaldemo.dim_dates)
[0m10:34:08.673350 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_inriver__item_attributes, now model.epicaldemo.dim_items)
[0m10:34:08.673350 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.dim_dates
[0m10:34:08.674347 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.dim_items
[0m10:34:08.677348 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.dim_dates"
[0m10:34:08.681859 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.dim_items"
[0m10:34:08.683862 [debug] [Thread-1 (]: Began executing node model.epicaldemo.dim_dates
[0m10:34:08.683862 [debug] [Thread-4 (]: Began executing node model.epicaldemo.dim_items
[0m10:34:08.701662 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.dim_dates"
[0m10:34:08.704658 [debug] [Thread-4 (]: Writing runtime sql for node "model.epicaldemo.dim_items"
[0m10:34:08.706651 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.dim_dates"
[0m10:34:08.708648 [debug] [Thread-4 (]: Using snowflake connection "model.epicaldemo.dim_items"
[0m10:34:08.709648 [debug] [Thread-1 (]: On model.epicaldemo.dim_dates: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_dates"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_dates
    

    
    as (with

dates AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__dates
),

final AS (
    SELECT
        date_id
        ,"Date"
        ,"Year"
        ,"Year Month"
        ,LEFT(date_id::TEXT, 6) AS "Year Month Number"
        ,"Month Number"
        ,"Quarter"
        ,"Quarter Number"
        ,"Month"
        ,LEFT("Month",3) AS "Month Short"
    FROM dates
)

SELECT * FROM final
    )
;
[0m10:34:08.710153 [debug] [Thread-4 (]: On model.epicaldemo.dim_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_items"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_items
    

    
    as (with

item AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__items
),

item_attributes AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_inriver__item_attributes
),

category AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__categories
),

manager AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__managers
),

unknown AS (
    SELECT
        -1 AS "item_id"
        ,'Unknown' AS "SKU"
        ,'Unknown' AS "Item"
        ,'Missing' AS "Brand"
        ,'Missing' AS "Flavor"
        ,'Missing' AS "Crunch Level"
        ,'Missing' AS "Snack Time"
        ,'Missing' AS "Category"
        ,'Missing' AS "Manager"
),

missing AS (
    SELECT
        -2 AS "item_id"
        ,'Missing' AS "SKU"
        ,'Missing' AS "Item"
        ,'Missing' AS "Brand"
        ,'Missing' AS "Flavor"
        ,'Missing' AS "Crunch Level"
        ,'Missing' AS "Snack Time"
        ,'Missing' AS "Category"
        ,'Missing' AS "Manager"
),

final AS (
    SELECT
        item."item_id"
        ,item."SKU"
        ,item."Item"
        ,item."Brand"
        ,item."Flavor"
        ,COALESCE(item_attributes."Crunch Level", 'Missing') AS "Crunch Level"
        ,COALESCE(item_attributes."Snack Time", 'Missing') AS "Snack Time"
        ,category."Category"
        ,manager."Manager"
    FROM item
    LEFT JOIN item_attributes ON item_attributes."SKU" = item."SKU"
    LEFT JOIN category ON category."category_id" = item."category_id"
    LEFT JOIN manager ON manager."manager_id" = category."manager_id"

    UNION

    SELECT * FROM unknown

    UNION

    SELECT * FROM missing
)

SELECT * FROM final
    )
;
[0m10:34:08.843727 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.400 seconds
[0m10:34:08.845727 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a8aa3d4-120d-4e9b-b088-5fbb71a4089d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C81FBC13D0>]}
[0m10:34:08.846727 [info ] [Thread-2 (]: 7 of 14 OK created sql view model broman_analytics.stg_salesforce__customers ... [[32mSUCCESS 1[0m in 0.47s]
[0m10:34:08.847728 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_salesforce__customers
[0m10:34:08.849235 [debug] [Thread-2 (]: Began running node model.epicaldemo.dim_customers
[0m10:34:08.850247 [info ] [Thread-2 (]: 11 of 14 START sql table model broman_analytics.dim_customers .................. [RUN]
[0m10:34:08.850247 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_salesforce__customers, now model.epicaldemo.dim_customers)
[0m10:34:08.851243 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.dim_customers
[0m10:34:08.854242 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.dim_customers"
[0m10:34:08.855304 [debug] [Thread-2 (]: Began executing node model.epicaldemo.dim_customers
[0m10:34:08.858240 [debug] [Thread-2 (]: Writing runtime sql for node "model.epicaldemo.dim_customers"
[0m10:34:08.859243 [debug] [Thread-2 (]: Using snowflake connection "model.epicaldemo.dim_customers"
[0m10:34:08.859243 [debug] [Thread-2 (]: On model.epicaldemo.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_customers"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_customers
    

    
    as (WITH

customers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_salesforce__customers
),

final AS (
    SELECT
        "customer_id"
        ,"Customer Number"
        ,"Customer Age"
        ,"Customer Age Group"
        ,"customer_age_group_sort"
        ,"Customer State"
    FROM customers
)

SELECT * FROM final
    )
;
[0m10:34:09.331344 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.667 seconds
[0m10:34:09.334347 [debug] [Thread-3 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m10:34:09.334347 [debug] [Thread-3 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp"
[0m10:34:09.443237 [debug] [Thread-3 (]: SQL status: SUCCESS 13 in 0.108 seconds
[0m10:34:09.447236 [debug] [Thread-3 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m10:34:09.447236 [debug] [Thread-3 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
[0m10:34:09.502368 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.791 seconds
[0m10:34:09.504357 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a8aa3d4-120d-4e9b-b088-5fbb71a4089d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C81FB4B850>]}
[0m10:34:09.505358 [info ] [Thread-1 (]: 9 of 14 OK created sql table model broman_analytics.dim_dates .................. [[32mSUCCESS 1[0m in 0.83s]
[0m10:34:09.506358 [debug] [Thread-1 (]: Finished running node model.epicaldemo.dim_dates
[0m10:34:09.515395 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.655 seconds
[0m10:34:09.517394 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a8aa3d4-120d-4e9b-b088-5fbb71a4089d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C81FB34950>]}
[0m10:34:09.518402 [info ] [Thread-2 (]: 11 of 14 OK created sql table model broman_analytics.dim_customers ............. [[32mSUCCESS 1[0m in 0.67s]
[0m10:34:09.519397 [debug] [Thread-2 (]: Finished running node model.epicaldemo.dim_customers
[0m10:34:09.545537 [debug] [Thread-3 (]: SQL status: SUCCESS 11 in 0.097 seconds
[0m10:34:09.549535 [debug] [Thread-3 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m10:34:09.550633 [debug] [Thread-3 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp"
[0m10:34:09.667915 [debug] [Thread-3 (]: SQL status: SUCCESS 13 in 0.117 seconds
[0m10:34:09.671434 [debug] [Thread-3 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m10:34:09.672433 [debug] [Thread-3 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
[0m10:34:09.681962 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.971 seconds
[0m10:34:09.683966 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a8aa3d4-120d-4e9b-b088-5fbb71a4089d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C81FBC00D0>]}
[0m10:34:09.684967 [info ] [Thread-4 (]: 10 of 14 OK created sql table model broman_analytics.dim_items ................. [[32mSUCCESS 1[0m in 1.01s]
[0m10:34:09.685960 [debug] [Thread-4 (]: Finished running node model.epicaldemo.dim_items
[0m10:34:09.766735 [debug] [Thread-3 (]: SQL status: SUCCESS 11 in 0.094 seconds
[0m10:34:09.774247 [debug] [Thread-3 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m10:34:09.774247 [debug] [Thread-3 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp"
[0m10:34:09.873337 [debug] [Thread-3 (]: SQL status: SUCCESS 13 in 0.098 seconds
[0m10:34:09.895398 [debug] [Thread-3 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m10:34:09.896398 [debug] [Thread-3 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from EPICALDEMO.d365_fo.store

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            
  
  coalesce(nullif(modified, modified), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            modified as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.modified)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.modified)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m10:34:10.101538 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 0.205 seconds
[0m10:34:10.106537 [debug] [Thread-3 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m10:34:10.106537 [debug] [Thread-3 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m10:34:10.200226 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 0.093 seconds
[0m10:34:10.200226 [warn ] [Thread-3 (]: Data type of snapshot table timestamp columns (TIMESTAMP_NTZ) doesn't match derived column 'updated_at' (DATE). Please update snapshot config 'updated_at'.
[0m10:34:10.202226 [debug] [Thread-3 (]: Writing runtime sql for node "snapshot.epicaldemo.stores_snapshot"
[0m10:34:10.204229 [debug] [Thread-3 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m10:34:10.205230 [debug] [Thread-3 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
BEGIN
[0m10:34:10.329556 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.124 seconds
[0m10:34:10.330597 [debug] [Thread-3 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m10:34:10.331597 [debug] [Thread-3 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
merge into "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT" as DBT_INTERNAL_DEST
    using "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
	
	
	and ((DBT_INTERNAL_DEST.dbt_valid_to = to_date('9999-12-31'))
 or DBT_INTERNAL_DEST.dbt_valid_to is null)

     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("ID", "NAME", "LOCATION", "LATITUDE", "LONGITUDE", "ONLINEPRESENCE", "MODIFIED", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("ID", "NAME", "LOCATION", "LATITUDE", "LONGITUDE", "ONLINEPRESENCE", "MODIFIED", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m10:34:11.039464 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 0.708 seconds
[0m10:34:11.040473 [debug] [Thread-3 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m10:34:11.040473 [debug] [Thread-3 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
COMMIT
[0m10:34:11.235534 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.194 seconds
[0m10:34:11.247568 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a8aa3d4-120d-4e9b-b088-5fbb71a4089d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C81FABBCD0>]}
[0m10:34:11.248566 [info ] [Thread-3 (]: 8 of 14 OK snapshotted broman_analytics.stores_snapshot ........................ [[32mSUCCESS 0[0m in 2.80s]
[0m10:34:11.249556 [debug] [Thread-3 (]: Finished running node snapshot.epicaldemo.stores_snapshot
[0m10:34:11.250626 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__stores
[0m10:34:11.250626 [info ] [Thread-1 (]: 12 of 14 START sql view model broman_analytics.stg_d365_fo__stores ............. [RUN]
[0m10:34:11.251630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.dim_dates, now model.epicaldemo.stg_d365_fo__stores)
[0m10:34:11.252628 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__stores
[0m10:34:11.254628 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__stores"
[0m10:34:11.255629 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__stores
[0m10:34:11.258628 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__stores"
[0m10:34:11.260135 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__stores"
[0m10:34:11.260135 [debug] [Thread-1 (]: On model.epicaldemo.stg_d365_fo__stores: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__stores"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__stores
  
   as (
    WITH

stores_snapshots AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stores_snapshot
),

final AS (
    SELECT
        id AS "store_id"
        ,dbt_scd_id

        ,ROW_NUMBER() OVER (ORDER BY id ASC, dbt_valid_from ASC) AS "store_key"

        ,CASE WHEN dbt_valid_to = '9999-12-31' THEN 1 ELSE 0 END AS is_current
        ,name AS "Store"
        ,SPLIT_PART(location, ',', 1) AS "Store State"
        ,SPLIT_PART(location, ',', 2) AS "Store City"
        ,latitude AS "Lat"
        ,longitude AS "Lon"
        ,onlinepresence AS "Online Presence"
        ,modified
        ,CAST(TO_CHAR(dbt_valid_from::DATE, 'YYYYMMDD') AS INTEGER) AS "valid_from"
        ,CAST(TO_CHAR(dbt_valid_to::DATE, 'YYYYMMDD') AS INTEGER) AS "valid_to"
    FROM stores_snapshots
)

SELECT * FROM final
  );
[0m10:34:11.633688 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.373 seconds
[0m10:34:11.635696 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a8aa3d4-120d-4e9b-b088-5fbb71a4089d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C820442F10>]}
[0m10:34:11.636688 [info ] [Thread-1 (]: 12 of 14 OK created sql view model broman_analytics.stg_d365_fo__stores ........ [[32mSUCCESS 1[0m in 0.38s]
[0m10:34:11.637693 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__stores
[0m10:34:11.638689 [debug] [Thread-4 (]: Began running node model.epicaldemo.dim_stores
[0m10:34:11.639696 [debug] [Thread-3 (]: Began running node model.epicaldemo.fact_sales_transactions
[0m10:34:11.639696 [info ] [Thread-4 (]: 13 of 14 START sql table model broman_analytics.dim_stores ..................... [RUN]
[0m10:34:11.641093 [info ] [Thread-3 (]: 14 of 14 START sql table model broman_analytics.fact_sales_transactions ........ [RUN]
[0m10:34:11.641093 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.dim_items, now model.epicaldemo.dim_stores)
[0m10:34:11.642091 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly snapshot.epicaldemo.stores_snapshot, now model.epicaldemo.fact_sales_transactions)
[0m10:34:11.642091 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.dim_stores
[0m10:34:11.643090 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.fact_sales_transactions
[0m10:34:11.645090 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.dim_stores"
[0m10:34:11.648089 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.fact_sales_transactions"
[0m10:34:11.649596 [debug] [Thread-4 (]: Began executing node model.epicaldemo.dim_stores
[0m10:34:11.649596 [debug] [Thread-3 (]: Began executing node model.epicaldemo.fact_sales_transactions
[0m10:34:11.652602 [debug] [Thread-4 (]: Writing runtime sql for node "model.epicaldemo.dim_stores"
[0m10:34:11.654601 [debug] [Thread-3 (]: Writing runtime sql for node "model.epicaldemo.fact_sales_transactions"
[0m10:34:11.656602 [debug] [Thread-4 (]: Using snowflake connection "model.epicaldemo.dim_stores"
[0m10:34:11.656602 [debug] [Thread-4 (]: On model.epicaldemo.dim_stores: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_stores"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_stores
    

    
    as (with

store AS (
    select
        *
    from EPICALDEMO.broman_analytics.stg_d365_fo__stores
),

final AS (
    SELECT
        "store_key"
        ,"store_id"
        ,IS_CURRENT
        ,"Store"
        ,"Store State"
        ,"Store City"
        ,"Lat"
        ,"Lon"
        ,"Online Presence"
        ,MODIFIED
        ,"valid_from"
        ,"valid_to"
    from store
)

select * from final
    )
;
[0m10:34:11.658602 [debug] [Thread-3 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions"
[0m10:34:11.660122 [debug] [Thread-3 (]: On model.epicaldemo.fact_sales_transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions"} */
create or replace transient table EPICALDEMO.broman_analytics.fact_sales_transactions
    

    
    as (WITH

sales AS (
    select
        *
    from EPICALDEMO.broman_analytics.stg_d365_fo__transactions
),

items AS (
    select
        *
    from EPICALDEMO.broman_analytics.stg_d365_fo__items
),

stores AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__stores
),

customers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_salesforce__customers
),

final AS (
    SELECT
        -- Identifiers
        sales."date_id"
        ,sales."SKU"

        ,CASE
            WHEN sales."SKU" IS NULL THEN -2 -- SKU is missing from Source
            WHEN items."item_id" IS NULL THEN -1 -- SKU is not known from Source
            ELSE items."item_id" -- Join item_id from Dim based on SKU
         END AS "item_id"

        ,sales."Store"

        ,CASE
            WHEN sales."Store" IS NULL THEN -2
            WHEN stores."store_key" IS NULL THEN -1
            ELSE stores."store_key"
         END AS "store_key"

        ,sales."Customer Number"

        ,CASE
            WHEN sales."Customer Number" IS NULL THEN -2
            WHEN customers."customer_id" IS NULL THEN -1
            ELSE customers."customer_id"
         END AS "customer_id"

        -- Metrics
        ,sales."Qty"
        ,sales."Unit Price"
        ,sales."Sales Amount"
        ,sales."Unit Cost"
        ,sales."Cost"
        ,sales."Margin"
    FROM sales
    LEFT JOIN items ON items."SKU" = sales."SKU"
    LEFT JOIN stores ON stores."Store" = sales."Store" AND sales."date_id" >= stores."valid_from" AND sales."date_id" < stores."valid_to"
    LEFT JOIN customers ON customers."Customer Number" = sales."Customer Number"
)

SELECT * FROM final
    )
;
[0m10:34:12.339452 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.681 seconds
[0m10:34:12.342485 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a8aa3d4-120d-4e9b-b088-5fbb71a4089d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C82043AE50>]}
[0m10:34:12.342485 [info ] [Thread-4 (]: 13 of 14 OK created sql table model broman_analytics.dim_stores ................ [[32mSUCCESS 1[0m in 0.70s]
[0m10:34:12.343485 [debug] [Thread-4 (]: Finished running node model.epicaldemo.dim_stores
[0m10:34:12.834457 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.173 seconds
[0m10:34:12.836454 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a8aa3d4-120d-4e9b-b088-5fbb71a4089d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C81FA14790>]}
[0m10:34:12.837447 [info ] [Thread-3 (]: 14 of 14 OK created sql table model broman_analytics.fact_sales_transactions ... [[32mSUCCESS 1[0m in 1.19s]
[0m10:34:12.837447 [debug] [Thread-3 (]: Finished running node model.epicaldemo.fact_sales_transactions
[0m10:34:12.839447 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:34:12.839447 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m10:34:12.840520 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m10:34:13.008362 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m10:34:13.009361 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m10:34:13.170574 [debug] [MainThread]: Connection 'model.epicaldemo.stg_d365_fo__stores' was left open.
[0m10:34:13.171572 [debug] [MainThread]: On model.epicaldemo.stg_d365_fo__stores: Close
[0m10:34:13.463368 [debug] [MainThread]: Connection 'model.epicaldemo.dim_customers' was left open.
[0m10:34:13.464367 [debug] [MainThread]: On model.epicaldemo.dim_customers: Close
[0m10:34:13.621150 [debug] [MainThread]: Connection 'model.epicaldemo.fact_sales_transactions' was left open.
[0m10:34:13.622164 [debug] [MainThread]: On model.epicaldemo.fact_sales_transactions: Close
[0m10:34:13.782382 [debug] [MainThread]: Connection 'model.epicaldemo.dim_stores' was left open.
[0m10:34:13.783377 [debug] [MainThread]: On model.epicaldemo.dim_stores: Close
[0m10:34:13.932597 [info ] [MainThread]: 
[0m10:34:13.933593 [info ] [MainThread]: Finished running 1 snapshot, 5 table models, 8 view models in 0 hours 0 minutes and 8.11 seconds (8.11s).
[0m10:34:13.936597 [debug] [MainThread]: Command end result
[0m10:34:13.958669 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m10:34:13.961729 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m10:34:13.967724 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m10:34:13.969305 [info ] [MainThread]: 
[0m10:34:13.970234 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:34:13.970234 [info ] [MainThread]: 
[0m10:34:13.971233 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m10:34:13.972234 [debug] [MainThread]: Command `dbt build` succeeded at 10:34:13.972234 after 9.32 seconds
[0m10:34:13.973246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C81B2ED010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C817AF3010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C817A72190>]}
[0m10:34:13.973246 [debug] [MainThread]: Flushing usage events
[0m10:34:14.620293 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:43:15.015539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295E18B4910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295E1C73C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295E1C733D0>]}


============================== 10:43:15.028048 | 9e9310f2-89e6-4f36-9e75-046aea4dbe13 ==============================
[0m10:43:15.028048 [info ] [MainThread]: Running with dbt=1.9.4
[0m10:43:15.028048 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:43:17.687328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e9310f2-89e6-4f36-9e75-046aea4dbe13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295E2EC98D0>]}
[0m10:43:17.740301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9e9310f2-89e6-4f36-9e75-046aea4dbe13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295E064FA10>]}
[0m10:43:17.749827 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m10:43:18.175279 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m10:43:18.364885 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:43:18.365886 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:43:18.371393 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m10:43:18.409995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9e9310f2-89e6-4f36-9e75-046aea4dbe13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295E36D8D10>]}
[0m10:43:18.484140 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m10:43:18.501170 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m10:43:18.715610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9e9310f2-89e6-4f36-9e75-046aea4dbe13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295E3608550>]}
[0m10:43:18.716598 [info ] [MainThread]: Found 13 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m10:43:18.716598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e9310f2-89e6-4f36-9e75-046aea4dbe13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295E13A1690>]}
[0m10:43:18.719105 [info ] [MainThread]: 
[0m10:43:18.719105 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:43:18.720110 [info ] [MainThread]: 
[0m10:43:18.721110 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:43:18.725108 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m10:43:21.415878 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m10:43:21.416887 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m10:43:21.416887 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:43:22.432446 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.015 seconds
[0m10:43:22.435447 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m10:43:22.444946 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m10:43:22.444946 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m10:43:22.445946 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:43:23.069108 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.623 seconds
[0m10:43:23.073194 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m10:43:23.073194 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m10:43:23.249203 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.175 seconds
[0m10:43:23.251207 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m10:43:23.252207 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m10:43:23.362359 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.109 seconds
[0m10:43:23.365361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e9310f2-89e6-4f36-9e75-046aea4dbe13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295E2E1BF50>]}
[0m10:43:23.370430 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__categories
[0m10:43:23.370430 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_d365_fo__dates
[0m10:43:23.371439 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_d365_fo__items
[0m10:43:23.371439 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_d365_fo__managers
[0m10:43:23.372437 [info ] [Thread-1 (]: 1 of 13 START sql view model broman_analytics.stg_d365_fo__categories .......... [RUN]
[0m10:43:23.372437 [info ] [Thread-2 (]: 2 of 13 START sql view model broman_analytics.stg_d365_fo__dates ............... [RUN]
[0m10:43:23.373428 [info ] [Thread-3 (]: 3 of 13 START sql view model broman_analytics.stg_d365_fo__items ............... [RUN]
[0m10:43:23.374429 [info ] [Thread-4 (]: 4 of 13 START sql view model broman_analytics.stg_d365_fo__managers ............ [RUN]
[0m10:43:23.374429 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__categories'
[0m10:43:23.375429 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__dates'
[0m10:43:23.375429 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__items'
[0m10:43:23.376430 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__managers'
[0m10:43:23.376430 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__categories
[0m10:43:23.377428 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_d365_fo__dates
[0m10:43:23.377428 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_d365_fo__items
[0m10:43:23.378429 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_d365_fo__managers
[0m10:43:23.384813 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__categories"
[0m10:43:23.386813 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__dates"
[0m10:43:23.391336 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__items"
[0m10:43:23.394333 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__managers"
[0m10:43:23.395324 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__categories
[0m10:43:23.396325 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_d365_fo__dates
[0m10:43:23.403843 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_d365_fo__items
[0m10:43:23.424867 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__categories"
[0m10:43:23.425877 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_d365_fo__managers
[0m10:43:23.427868 [debug] [Thread-2 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__dates"
[0m10:43:23.432378 [debug] [Thread-3 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__items"
[0m10:43:23.437378 [debug] [Thread-4 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__managers"
[0m10:43:23.438378 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__categories"
[0m10:43:23.439377 [debug] [Thread-2 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__dates"
[0m10:43:23.440816 [debug] [Thread-3 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__items"
[0m10:43:23.440816 [debug] [Thread-1 (]: On model.epicaldemo.stg_d365_fo__categories: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__categories"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__categories
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.category
),

final AS (
    SELECT
        id AS "category_id"
        ,INITCAP(name) AS "Category"
        ,managerid AS "manager_id"
    FROM source
)

SELECT * FROM final
  );
[0m10:43:23.441816 [debug] [Thread-4 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__managers"
[0m10:43:23.442815 [debug] [Thread-2 (]: On model.epicaldemo.stg_d365_fo__dates: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__dates"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__dates
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.date
),

final AS (
    SELECT
        id AS date_id
        ,date AS "Date"
        ,year AS "Year"
        ,yearmonth AS "Year Month"
        ,monthnumber AS "Month Number"
        ,quarter AS "Quarter"
        ,quarternumber AS "Quarter Number"
        ,monthname AS "Month"
    FROM source
)

SELECT * FROM final
  );
[0m10:43:23.442815 [debug] [Thread-3 (]: On model.epicaldemo.stg_d365_fo__items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__items"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__items
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.item
),

final AS (
    SELECT
        id AS "item_id"
        ,name AS "Item"
        ,COALESCE(brand, 'Missing') AS "Brand"
        ,categoryid AS "category_id"
        ,COALESCE(flavor, 'Missing') AS "Flavor"
        ,sku AS "SKU"
    FROM source
)

SELECT * FROM final
  );
[0m10:43:23.443815 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:43:23.443815 [debug] [Thread-4 (]: On model.epicaldemo.stg_d365_fo__managers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__managers"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__managers
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.manager
),

final as (
    SELECT
        id AS "manager_id"
        ,firstname || ' ' || lastname AS "Manager"
    FROM source
)

SELECT * FROM final
  );
[0m10:43:23.444815 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:43:23.444815 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:43:23.446816 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:43:24.048216 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.601 seconds
[0m10:43:24.077374 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e9310f2-89e6-4f36-9e75-046aea4dbe13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295E388F110>]}
[0m10:43:24.078374 [info ] [Thread-4 (]: 4 of 13 OK created sql view model broman_analytics.stg_d365_fo__managers ....... [[32mSUCCESS 1[0m in 0.69s]
[0m10:43:24.079373 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_d365_fo__managers
[0m10:43:24.080412 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_d365_fo__stores
[0m10:43:24.080412 [info ] [Thread-4 (]: 5 of 13 START sql view model broman_analytics.stg_d365_fo__stores .............. [RUN]
[0m10:43:24.081412 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__managers, now model.epicaldemo.stg_d365_fo__stores)
[0m10:43:24.082415 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_d365_fo__stores
[0m10:43:24.085417 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__stores"
[0m10:43:24.086418 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_d365_fo__stores
[0m10:43:24.091462 [debug] [Thread-4 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__stores"
[0m10:43:24.092463 [debug] [Thread-4 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__stores"
[0m10:43:24.093467 [debug] [Thread-4 (]: On model.epicaldemo.stg_d365_fo__stores: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__stores"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__stores
  
   as (
    WITH

stores_snapshots AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stores_snapshot
),

final AS (
    SELECT
        id AS "store_id"
        ,dbt_scd_id

        ,ROW_NUMBER() OVER (ORDER BY id ASC, dbt_valid_from ASC) AS "store_key"

        ,CASE WHEN dbt_valid_to = '9999-12-31' THEN 1 ELSE 0 END AS is_current
        ,name AS "Store"
        ,SPLIT_PART(location, ',', 1) AS "Store State"
        ,SPLIT_PART(location, ',', 2) AS "Store City"
        ,latitude AS "Lat"
        ,longitude AS "Lon"
        ,onlinepresence AS "Online Presence"
        ,modified
        ,CAST(TO_CHAR(dbt_valid_from::DATE, 'YYYYMMDD') AS INTEGER) AS "valid_from"
        ,CAST(TO_CHAR(dbt_valid_to::DATE, 'YYYYMMDD') AS INTEGER) AS "valid_to"
    FROM stores_snapshots
)

SELECT * FROM final
  );
[0m10:43:24.108491 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.663 seconds
[0m10:43:24.109490 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e9310f2-89e6-4f36-9e75-046aea4dbe13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295E426A9D0>]}
[0m10:43:24.111035 [info ] [Thread-2 (]: 2 of 13 OK created sql view model broman_analytics.stg_d365_fo__dates .......... [[32mSUCCESS 1[0m in 0.73s]
[0m10:43:24.112040 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_d365_fo__dates
[0m10:43:24.113040 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_d365_fo__transactions
[0m10:43:24.113040 [info ] [Thread-2 (]: 6 of 13 START sql view model broman_analytics.stg_d365_fo__transactions ........ [RUN]
[0m10:43:24.114039 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__dates, now model.epicaldemo.stg_d365_fo__transactions)
[0m10:43:24.115039 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_d365_fo__transactions
[0m10:43:24.118041 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__transactions"
[0m10:43:24.120568 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_d365_fo__transactions
[0m10:43:24.125568 [debug] [Thread-2 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__transactions"
[0m10:43:24.127567 [debug] [Thread-2 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__transactions"
[0m10:43:24.127567 [debug] [Thread-2 (]: On model.epicaldemo.stg_d365_fo__transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__transactions"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__transactions
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.transactions
),

final AS (
    SELECT
        -- Identifiers
        CAST(TO_CHAR(date::DATE, 'YYYYMMDD') AS INTEGER) AS "date_id"
        ,sku AS "SKU"
        ,store AS "Store"
        ,customernumber AS "Customer Number"

        -- Metrics
        ,quantity AS "Qty"
        ,unitprice::NUMERIC(10,2) AS "Unit Price"
        ,(quantity * unitprice)::NUMERIC(10,2) AS "Sales Amount"
        ,unitcost::NUMERIC(10,2) AS "Unit Cost"
        ,(quantity * unitcost)::NUMERIC(10,2) AS "Cost"
        ,(quantity * unitprice)::NUMERIC(10,2) - (quantity * unitcost)::NUMERIC(10,2) AS "Margin"
    FROM source
)

SELECT * FROM final
  );
[0m10:43:24.198372 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.755 seconds
[0m10:43:24.200883 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e9310f2-89e6-4f36-9e75-046aea4dbe13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295E4215310>]}
[0m10:43:24.201882 [info ] [Thread-1 (]: 1 of 13 OK created sql view model broman_analytics.stg_d365_fo__categories ..... [[32mSUCCESS 1[0m in 0.83s]
[0m10:43:24.202882 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__categories
[0m10:43:24.203882 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_inriver__item_attributes
[0m10:43:24.203882 [info ] [Thread-1 (]: 7 of 13 START sql view model broman_analytics.stg_inriver__item_attributes ..... [RUN]
[0m10:43:24.204881 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__categories, now model.epicaldemo.stg_inriver__item_attributes)
[0m10:43:24.205881 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_inriver__item_attributes
[0m10:43:24.209388 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_inriver__item_attributes"
[0m10:43:24.210915 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.766 seconds
[0m10:43:24.213925 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e9310f2-89e6-4f36-9e75-046aea4dbe13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295E3D09B90>]}
[0m10:43:24.215922 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_inriver__item_attributes
[0m10:43:24.214919 [info ] [Thread-3 (]: 3 of 13 OK created sql view model broman_analytics.stg_d365_fo__items .......... [[32mSUCCESS 1[0m in 0.84s]
[0m10:43:24.217920 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.stg_inriver__item_attributes"
[0m10:43:24.219423 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_d365_fo__items
[0m10:43:24.220429 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_salesforce__customers
[0m10:43:24.223429 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.stg_inriver__item_attributes"
[0m10:43:24.221427 [info ] [Thread-3 (]: 8 of 13 START sql view model broman_analytics.stg_salesforce__customers ........ [RUN]
[0m10:43:24.223429 [debug] [Thread-1 (]: On model.epicaldemo.stg_inriver__item_attributes: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_inriver__item_attributes"} */
create or replace   view EPICALDEMO.broman_analytics.stg_inriver__item_attributes
  
   as (
    with

source as (
    select
        *
    from EPICALDEMO.inriver.item_attributes
),

final as (
    select
        id AS "item_attributes_id"
        ,sku AS "SKU"
        ,COALESCE(crunch_level, 'Missing') AS "Crunch Level"
        ,COALESCE(snack_time, 'Missing') AS "Snack Time"
    from source
)

select * from final
  );
[0m10:43:24.224429 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__items, now model.epicaldemo.stg_salesforce__customers)
[0m10:43:24.225427 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_salesforce__customers
[0m10:43:24.229429 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_salesforce__customers"
[0m10:43:24.231831 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_salesforce__customers
[0m10:43:24.236826 [debug] [Thread-3 (]: Writing runtime sql for node "model.epicaldemo.stg_salesforce__customers"
[0m10:43:24.239877 [debug] [Thread-3 (]: Using snowflake connection "model.epicaldemo.stg_salesforce__customers"
[0m10:43:24.240883 [debug] [Thread-3 (]: On model.epicaldemo.stg_salesforce__customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_salesforce__customers"} */
create or replace   view EPICALDEMO.broman_analytics.stg_salesforce__customers
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.salesforce.customer
),

final AS (
    SELECT
        CAST(id AS INTEGER) AS "customer_id"
        ,customernumber AS "Customer Number"
        ,age AS "Customer Age"

        ,CASE
            WHEN age < 20 THEN '< 20'
            WHEN age >= 20 AND age < 30 THEN '20 - 30'
            WHEN age >= 30 AND age < 50 THEN '30 - 50'
            WHEN age >= 50 AND age < 60 THEN '50 - 60'
            ELSE '60+'
         END AS "Customer Age Group"

        ,CASE
            WHEN age < 20 THEN 1
            WHEN age >= 20 AND age < 30 THEN 2
            WHEN age >= 30 AND age < 50 THEN 3
            WHEN age >= 50 AND age < 60 THEN 4
            ELSE 5
         END AS "customer_age_group_sort"

        ,state AS "Customer State"
    FROM source
)

SELECT * FROM final
  );
[0m10:43:24.391139 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.298 seconds
[0m10:43:24.394148 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e9310f2-89e6-4f36-9e75-046aea4dbe13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295E42688D0>]}
[0m10:43:24.394148 [info ] [Thread-4 (]: 5 of 13 OK created sql view model broman_analytics.stg_d365_fo__stores ......... [[32mSUCCESS 1[0m in 0.31s]
[0m10:43:24.395140 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_d365_fo__stores
[0m10:43:24.396141 [debug] [Thread-4 (]: Began running node model.epicaldemo.dim_dates
[0m10:43:24.397139 [info ] [Thread-4 (]: 9 of 13 START sql table model broman_analytics.dim_dates ....................... [RUN]
[0m10:43:24.397139 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__stores, now model.epicaldemo.dim_dates)
[0m10:43:24.398139 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.dim_dates
[0m10:43:24.400652 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.dim_dates"
[0m10:43:24.401660 [debug] [Thread-4 (]: Began executing node model.epicaldemo.dim_dates
[0m10:43:24.421248 [debug] [Thread-4 (]: Writing runtime sql for node "model.epicaldemo.dim_dates"
[0m10:43:24.424248 [debug] [Thread-4 (]: Using snowflake connection "model.epicaldemo.dim_dates"
[0m10:43:24.424248 [debug] [Thread-4 (]: On model.epicaldemo.dim_dates: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_dates"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_dates
    

    
    as (with

dates AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__dates
),

final AS (
    SELECT
        date_id
        ,"Date"
        ,"Year"
        ,"Year Month"
        ,LEFT(date_id::TEXT, 6) AS "Year Month Number"
        ,"Month Number"
        ,"Quarter"
        ,"Quarter Number"
        ,"Month"
        ,LEFT("Month",3) AS "Month Short"
    FROM dates
)

SELECT * FROM final
    )
;
[0m10:43:24.472587 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.247 seconds
[0m10:43:24.474587 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e9310f2-89e6-4f36-9e75-046aea4dbe13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295E4247510>]}
[0m10:43:24.475587 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.234 seconds
[0m10:43:24.476587 [info ] [Thread-1 (]: 7 of 13 OK created sql view model broman_analytics.stg_inriver__item_attributes  [[32mSUCCESS 1[0m in 0.27s]
[0m10:43:24.477588 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e9310f2-89e6-4f36-9e75-046aea4dbe13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295E422DB50>]}
[0m10:43:24.479091 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_inriver__item_attributes
[0m10:43:24.479091 [info ] [Thread-3 (]: 8 of 13 OK created sql view model broman_analytics.stg_salesforce__customers ... [[32mSUCCESS 1[0m in 0.25s]
[0m10:43:24.480095 [debug] [Thread-1 (]: Began running node model.epicaldemo.dim_stores
[0m10:43:24.481586 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_salesforce__customers
[0m10:43:24.481586 [info ] [Thread-1 (]: 10 of 13 START sql table model broman_analytics.dim_stores ..................... [RUN]
[0m10:43:24.482593 [debug] [Thread-3 (]: Began running node model.epicaldemo.dim_items
[0m10:43:24.482593 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_inriver__item_attributes, now model.epicaldemo.dim_stores)
[0m10:43:24.483593 [info ] [Thread-3 (]: 11 of 13 START sql table model broman_analytics.dim_items ...................... [RUN]
[0m10:43:24.484593 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.dim_stores
[0m10:43:24.484593 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_salesforce__customers, now model.epicaldemo.dim_items)
[0m10:43:24.490110 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.dim_stores"
[0m10:43:24.491109 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.dim_items
[0m10:43:24.494109 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.dim_items"
[0m10:43:24.495108 [debug] [Thread-1 (]: Began executing node model.epicaldemo.dim_stores
[0m10:43:24.498116 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.dim_stores"
[0m10:43:24.499110 [debug] [Thread-3 (]: Began executing node model.epicaldemo.dim_items
[0m10:43:24.502130 [debug] [Thread-3 (]: Writing runtime sql for node "model.epicaldemo.dim_items"
[0m10:43:24.504132 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.dim_stores"
[0m10:43:24.505130 [debug] [Thread-1 (]: On model.epicaldemo.dim_stores: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_stores"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_stores
    

    
    as (with

store AS (
    select
        *
    from EPICALDEMO.broman_analytics.stg_d365_fo__stores
),

final AS (
    SELECT
        "store_key"
        ,"store_id"
        ,IS_CURRENT
        ,"Store"
        ,"Store State"
        ,"Store City"
        ,"Lat"
        ,"Lon"
        ,"Online Presence"
        ,MODIFIED
        ,"valid_from"
        ,"valid_to"
    from store
)

select * from final
    )
;
[0m10:43:24.507131 [debug] [Thread-3 (]: Using snowflake connection "model.epicaldemo.dim_items"
[0m10:43:24.507131 [debug] [Thread-3 (]: On model.epicaldemo.dim_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_items"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_items
    

    
    as (with

item AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__items
),

item_attributes AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_inriver__item_attributes
),

category AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__categories
),

manager AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__managers
),

unknown AS (
    SELECT
        -1 AS "item_id"
        ,'Unknown' AS "SKU"
        ,'Unknown' AS "Item"
        ,'Missing' AS "Brand"
        ,'Missing' AS "Flavor"
        ,'Missing' AS "Crunch Level"
        ,'Missing' AS "Snack Time"
        ,'Missing' AS "Category"
        ,'Missing' AS "Manager"
),

missing AS (
    SELECT
        -2 AS "item_id"
        ,'Missing' AS "SKU"
        ,'Missing' AS "Item"
        ,'Missing' AS "Brand"
        ,'Missing' AS "Flavor"
        ,'Missing' AS "Crunch Level"
        ,'Missing' AS "Snack Time"
        ,'Missing' AS "Category"
        ,'Missing' AS "Manager"
),

final AS (
    SELECT
        item."item_id"
        ,item."SKU"
        ,item."Item"
        ,item."Brand"
        ,item."Flavor"
        ,COALESCE(item_attributes."Crunch Level", 'Missing') AS "Crunch Level"
        ,COALESCE(item_attributes."Snack Time", 'Missing') AS "Snack Time"
        ,category."Category"
        ,manager."Manager"
    FROM item
    LEFT JOIN item_attributes ON item_attributes."SKU" = item."SKU"
    LEFT JOIN category ON category."category_id" = item."category_id"
    LEFT JOIN manager ON manager."manager_id" = category."manager_id"

    UNION

    SELECT * FROM unknown

    UNION

    SELECT * FROM missing
)

SELECT * FROM final
    )
;
[0m10:43:24.724337 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.595 seconds
[0m10:43:24.726338 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e9310f2-89e6-4f36-9e75-046aea4dbe13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295E4268FD0>]}
[0m10:43:24.727339 [info ] [Thread-2 (]: 6 of 13 OK created sql view model broman_analytics.stg_d365_fo__transactions ... [[32mSUCCESS 1[0m in 0.61s]
[0m10:43:24.728340 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_d365_fo__transactions
[0m10:43:24.728340 [debug] [Thread-2 (]: Began running node model.epicaldemo.dim_customers
[0m10:43:24.729343 [info ] [Thread-2 (]: 12 of 13 START sql table model broman_analytics.dim_customers .................. [RUN]
[0m10:43:24.729849 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__transactions, now model.epicaldemo.dim_customers)
[0m10:43:24.730856 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.dim_customers
[0m10:43:24.733864 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.dim_customers"
[0m10:43:24.734862 [debug] [Thread-2 (]: Began executing node model.epicaldemo.dim_customers
[0m10:43:24.736854 [debug] [Thread-2 (]: Writing runtime sql for node "model.epicaldemo.dim_customers"
[0m10:43:24.737854 [debug] [Thread-2 (]: Using snowflake connection "model.epicaldemo.dim_customers"
[0m10:43:24.739357 [debug] [Thread-2 (]: On model.epicaldemo.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_customers"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_customers
    

    
    as (WITH

customers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_salesforce__customers
),

final AS (
    SELECT
        "customer_id"
        ,"Customer Number"
        ,"Customer Age"
        ,"Customer Age Group"
        ,"customer_age_group_sort"
        ,"Customer State"
    FROM customers
)

SELECT * FROM final
    )
;
[0m10:43:25.081329 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.576 seconds
[0m10:43:25.084332 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e9310f2-89e6-4f36-9e75-046aea4dbe13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295E3D153D0>]}
[0m10:43:25.085330 [info ] [Thread-1 (]: 10 of 13 OK created sql table model broman_analytics.dim_stores ................ [[32mSUCCESS 1[0m in 0.60s]
[0m10:43:25.085330 [debug] [Thread-1 (]: Finished running node model.epicaldemo.dim_stores
[0m10:43:25.086332 [debug] [Thread-1 (]: Began running node model.epicaldemo.fact_sales_transactions
[0m10:43:25.087328 [info ] [Thread-1 (]: 13 of 13 START sql table model broman_analytics.fact_sales_transactions ........ [RUN]
[0m10:43:25.087328 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.dim_stores, now model.epicaldemo.fact_sales_transactions)
[0m10:43:25.088327 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.fact_sales_transactions
[0m10:43:25.090848 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.fact_sales_transactions"
[0m10:43:25.091848 [debug] [Thread-1 (]: Began executing node model.epicaldemo.fact_sales_transactions
[0m10:43:25.094847 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.fact_sales_transactions"
[0m10:43:25.096845 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions"
[0m10:43:25.096845 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions"} */
create or replace transient table EPICALDEMO.broman_analytics.fact_sales_transactions
    

    
    as (WITH

sales AS (
    select
        *
    from EPICALDEMO.broman_analytics.stg_d365_fo__transactions
),

items AS (
    select
        *
    from EPICALDEMO.broman_analytics.stg_d365_fo__items
),

stores AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__stores
),

customers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_salesforce__customers
),

final AS (
    SELECT
        -- Identifiers
        sales."date_id"
        ,sales."SKU"

        ,CASE
            WHEN sales."SKU" IS NULL THEN -2 -- SKU is missing from Source
            WHEN items."item_id" IS NULL THEN -1 -- SKU is not known from Source
            ELSE items."item_id" -- Join item_id from Dim based on SKU
         END AS "item_id"

        ,sales."Store"

        ,CASE
            WHEN sales."Store" IS NULL THEN -2
            WHEN stores."store_key" IS NULL THEN -1
            ELSE stores."store_key"
         END AS "store_key"

        ,sales."Customer Number"

        ,CASE
            WHEN sales."Customer Number" IS NULL THEN -2
            WHEN customers."customer_id" IS NULL THEN -1
            ELSE customers."customer_id"
         END AS "customer_id"

        -- Metrics
        ,sales."Qty"
        ,sales."Unit Price"
        ,sales."Sales Amount"
        ,sales."Unit Cost"
        ,sales."Cost"
        ,sales."Margin"
    FROM sales
    LEFT JOIN items ON items."SKU" = sales."SKU"
    LEFT JOIN stores ON stores."Store" = sales."Store" AND sales."date_id" >= stores."valid_from" AND sales."date_id" < stores."valid_to"
    LEFT JOIN customers ON customers."Customer Number" = sales."Customer Number"
)

SELECT * FROM final
    )
;
[0m10:43:25.280135 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.541 seconds
[0m10:43:25.282129 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e9310f2-89e6-4f36-9e75-046aea4dbe13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295E42BAE90>]}
[0m10:43:25.283123 [info ] [Thread-2 (]: 12 of 13 OK created sql table model broman_analytics.dim_customers ............. [[32mSUCCESS 1[0m in 0.55s]
[0m10:43:25.284122 [debug] [Thread-2 (]: Finished running node model.epicaldemo.dim_customers
[0m10:43:25.627017 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.202 seconds
[0m10:43:25.629665 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e9310f2-89e6-4f36-9e75-046aea4dbe13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295E3D08A10>]}
[0m10:43:25.630715 [info ] [Thread-4 (]: 9 of 13 OK created sql table model broman_analytics.dim_dates .................. [[32mSUCCESS 1[0m in 1.23s]
[0m10:43:25.631700 [debug] [Thread-4 (]: Finished running node model.epicaldemo.dim_dates
[0m10:43:25.961158 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.453 seconds
[0m10:43:25.963158 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e9310f2-89e6-4f36-9e75-046aea4dbe13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295E42EDD90>]}
[0m10:43:25.964158 [info ] [Thread-3 (]: 11 of 13 OK created sql table model broman_analytics.dim_items ................. [[32mSUCCESS 1[0m in 1.48s]
[0m10:43:25.965158 [debug] [Thread-3 (]: Finished running node model.epicaldemo.dim_items
[0m10:43:26.560099 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.462 seconds
[0m10:43:26.562099 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e9310f2-89e6-4f36-9e75-046aea4dbe13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295E4292250>]}
[0m10:43:26.563100 [info ] [Thread-1 (]: 13 of 13 OK created sql table model broman_analytics.fact_sales_transactions ... [[32mSUCCESS 1[0m in 1.47s]
[0m10:43:26.563100 [debug] [Thread-1 (]: Finished running node model.epicaldemo.fact_sales_transactions
[0m10:43:26.565101 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:43:26.565101 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m10:43:26.566099 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m10:43:26.743335 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m10:43:26.743335 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m10:43:26.912645 [debug] [MainThread]: Connection 'model.epicaldemo.fact_sales_transactions' was left open.
[0m10:43:26.913642 [debug] [MainThread]: On model.epicaldemo.fact_sales_transactions: Close
[0m10:43:27.085123 [debug] [MainThread]: Connection 'model.epicaldemo.dim_customers' was left open.
[0m10:43:27.086122 [debug] [MainThread]: On model.epicaldemo.dim_customers: Close
[0m10:43:27.251525 [debug] [MainThread]: Connection 'model.epicaldemo.dim_items' was left open.
[0m10:43:27.252524 [debug] [MainThread]: On model.epicaldemo.dim_items: Close
[0m10:43:27.429445 [debug] [MainThread]: Connection 'model.epicaldemo.dim_dates' was left open.
[0m10:43:27.429445 [debug] [MainThread]: On model.epicaldemo.dim_dates: Close
[0m10:43:27.586102 [info ] [MainThread]: 
[0m10:43:27.587089 [info ] [MainThread]: Finished running 5 table models, 8 view models in 0 hours 0 minutes and 8.86 seconds (8.86s).
[0m10:43:27.589590 [debug] [MainThread]: Command end result
[0m10:43:27.612702 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m10:43:27.617712 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m10:43:27.627228 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m10:43:27.627228 [info ] [MainThread]: 
[0m10:43:27.628227 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:43:27.629227 [info ] [MainThread]: 
[0m10:43:27.630302 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 TOTAL=13
[0m10:43:27.632303 [debug] [MainThread]: Command `dbt run` succeeded at 10:43:27.631302 after 12.70 seconds
[0m10:43:27.632303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295E1C907D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295DC0F3010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295DC0F3090>]}
[0m10:43:27.633301 [debug] [MainThread]: Flushing usage events
[0m10:43:28.315875 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:52:59.381089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F73BF77390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F73ACA9CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F73BF75390>]}


============================== 10:52:59.385178 | f6dd02bb-52d9-45a6-bb74-2e0252ce5a65 ==============================
[0m10:52:59.385178 [info ] [MainThread]: Running with dbt=1.9.4
[0m10:52:59.387090 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -s +dim_customers', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:52:59.804394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6dd02bb-52d9-45a6-bb74-2e0252ce5a65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F73BFBB750>]}
[0m10:52:59.846631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f6dd02bb-52d9-45a6-bb74-2e0252ce5a65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F73801D050>]}
[0m10:52:59.849137 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m10:53:00.163977 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m10:53:00.353683 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:53:00.353683 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:53:00.359250 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m10:53:00.399307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6dd02bb-52d9-45a6-bb74-2e0252ce5a65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F73D9D9C10>]}
[0m10:53:00.479131 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m10:53:00.484641 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m10:53:00.506176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6dd02bb-52d9-45a6-bb74-2e0252ce5a65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F73D873650>]}
[0m10:53:00.507168 [info ] [MainThread]: Found 13 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m10:53:00.508166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6dd02bb-52d9-45a6-bb74-2e0252ce5a65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F73A74C550>]}
[0m10:53:00.509687 [info ] [MainThread]: 
[0m10:53:00.510695 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:53:00.510695 [info ] [MainThread]: 
[0m10:53:00.511695 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:53:00.515706 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m10:53:00.602463 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m10:53:00.602463 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m10:53:00.603454 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:53:01.414106 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.811 seconds
[0m10:53:01.417115 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m10:53:01.427176 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m10:53:01.428178 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m10:53:01.428178 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:53:01.956434 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.528 seconds
[0m10:53:01.960478 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m10:53:01.962488 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m10:53:02.104979 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.142 seconds
[0m10:53:02.107980 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m10:53:02.107980 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m10:53:02.234315 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.126 seconds
[0m10:53:02.238314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6dd02bb-52d9-45a6-bb74-2e0252ce5a65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F73B8CCA50>]}
[0m10:53:02.244531 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_salesforce__customers
[0m10:53:02.245521 [info ] [Thread-1 (]: 1 of 2 START sql view model broman_analytics.stg_salesforce__customers ......... [RUN]
[0m10:53:02.247519 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_salesforce__customers'
[0m10:53:02.247519 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_salesforce__customers
[0m10:53:02.255041 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_salesforce__customers"
[0m10:53:02.257036 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_salesforce__customers
[0m10:53:02.300243 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.stg_salesforce__customers"
[0m10:53:02.302243 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.stg_salesforce__customers"
[0m10:53:02.304252 [debug] [Thread-1 (]: On model.epicaldemo.stg_salesforce__customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_salesforce__customers"} */
create or replace   view EPICALDEMO.broman_analytics.stg_salesforce__customers
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.salesforce.customer
),

final AS (
    SELECT
        id::INT AS "customer_id"
        ,customernumber AS "Customer Number"
        ,age AS "Customer Age"

        ,CASE
            WHEN age < 20 THEN '< 20'
            WHEN age >= 20 AND age < 30 THEN '20 - 30'
            WHEN age >= 30 AND age < 50 THEN '30 - 50'
            WHEN age >= 50 AND age < 60 THEN '50 - 60'
            ELSE '60+'
         END AS "Customer Age Group"

        ,CASE
            WHEN age < 20 THEN 1
            WHEN age >= 20 AND age < 30 THEN 2
            WHEN age >= 30 AND age < 50 THEN 3
            WHEN age >= 50 AND age < 60 THEN 4
            ELSE 5
         END AS "customer_age_group_sort"

        ,state AS "Customer State"
    FROM source
)

SELECT * FROM final
  );
[0m10:53:02.305250 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:53:03.057490 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.752 seconds
[0m10:53:03.076028 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6dd02bb-52d9-45a6-bb74-2e0252ce5a65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F73D3CD650>]}
[0m10:53:03.077038 [info ] [Thread-1 (]: 1 of 2 OK created sql view model broman_analytics.stg_salesforce__customers .... [[32mSUCCESS 1[0m in 0.83s]
[0m10:53:03.078032 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_salesforce__customers
[0m10:53:03.079030 [debug] [Thread-3 (]: Began running node model.epicaldemo.dim_customers
[0m10:53:03.080065 [info ] [Thread-3 (]: 2 of 2 START sql table model broman_analytics.dim_customers .................... [RUN]
[0m10:53:03.081065 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.epicaldemo.dim_customers'
[0m10:53:03.081065 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.dim_customers
[0m10:53:03.084065 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.dim_customers"
[0m10:53:03.085063 [debug] [Thread-3 (]: Began executing node model.epicaldemo.dim_customers
[0m10:53:03.106184 [debug] [Thread-3 (]: Writing runtime sql for node "model.epicaldemo.dim_customers"
[0m10:53:03.109186 [debug] [Thread-3 (]: Using snowflake connection "model.epicaldemo.dim_customers"
[0m10:53:03.109690 [debug] [Thread-3 (]: On model.epicaldemo.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_customers"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_customers
    

    
    as (WITH

customers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_salesforce__customers
),

final AS (
    SELECT
        "customer_id"
        ,"Customer Number"
        ,"Customer Age"
        ,"Customer Age Group"
        ,"customer_age_group_sort"
        ,"Customer State"
    FROM customers
)

SELECT * FROM final
    )
;
[0m10:53:03.110698 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:53:04.398060 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.288 seconds
[0m10:53:04.401606 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6dd02bb-52d9-45a6-bb74-2e0252ce5a65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F73E190B90>]}
[0m10:53:04.402588 [info ] [Thread-3 (]: 2 of 2 OK created sql table model broman_analytics.dim_customers ............... [[32mSUCCESS 1[0m in 1.32s]
[0m10:53:04.403585 [debug] [Thread-3 (]: Finished running node model.epicaldemo.dim_customers
[0m10:53:04.405584 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:53:04.406588 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m10:53:04.406588 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m10:53:04.567160 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m10:53:04.568157 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m10:53:04.725237 [debug] [MainThread]: Connection 'model.epicaldemo.stg_salesforce__customers' was left open.
[0m10:53:04.726240 [debug] [MainThread]: On model.epicaldemo.stg_salesforce__customers: Close
[0m10:53:04.887502 [debug] [MainThread]: Connection 'model.epicaldemo.dim_customers' was left open.
[0m10:53:04.889017 [debug] [MainThread]: On model.epicaldemo.dim_customers: Close
[0m10:53:05.049456 [info ] [MainThread]: 
[0m10:53:05.049456 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 4.54 seconds (4.54s).
[0m10:53:05.051480 [debug] [MainThread]: Command end result
[0m10:53:05.073495 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m10:53:05.076492 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m10:53:05.082006 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m10:53:05.082006 [info ] [MainThread]: 
[0m10:53:05.083006 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:53:05.084005 [info ] [MainThread]: 
[0m10:53:05.084005 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m10:53:05.086007 [debug] [MainThread]: Command `dbt run` succeeded at 10:53:05.086007 after 5.78 seconds
[0m10:53:05.086007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F73BFD8590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F73681CB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F736812E10>]}
[0m10:53:05.087008 [debug] [MainThread]: Flushing usage events
[0m10:53:05.610163 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:57:25.828906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A24B271390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A24AF878D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A24B273B10>]}


============================== 10:57:25.842025 | 816e436d-659c-45d3-9767-3018561891e3 ==============================
[0m10:57:25.842025 [info ] [MainThread]: Running with dbt=1.9.4
[0m10:57:25.843016 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m10:57:28.905376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '816e436d-659c-45d3-9767-3018561891e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A24C47F2D0>]}
[0m10:57:28.950148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '816e436d-659c-45d3-9767-3018561891e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A24C431190>]}
[0m10:57:28.959652 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m10:57:29.399367 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m10:57:30.708206 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:57:30.708206 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:57:30.714723 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m10:57:30.759058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '816e436d-659c-45d3-9767-3018561891e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A24CC08210>]}
[0m10:57:30.841347 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m10:57:30.859359 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m10:57:31.064042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '816e436d-659c-45d3-9767-3018561891e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A24C50B350>]}
[0m10:57:31.065044 [info ] [MainThread]: Found 13 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m10:57:31.065044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '816e436d-659c-45d3-9767-3018561891e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A24CCB6350>]}
[0m10:57:31.067042 [info ] [MainThread]: 
[0m10:57:31.068042 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:57:31.068042 [info ] [MainThread]: 
[0m10:57:31.069043 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:57:31.073082 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m10:57:33.413418 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m10:57:33.414418 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m10:57:33.414418 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:57:34.340054 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.925 seconds
[0m10:57:34.343055 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m10:57:34.352571 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m10:57:34.353572 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m10:57:34.354574 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:57:34.846956 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.493 seconds
[0m10:57:34.851489 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m10:57:34.852480 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m10:57:34.997024 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.145 seconds
[0m10:57:35.000540 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m10:57:35.000540 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m10:57:35.097132 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.096 seconds
[0m10:57:35.100678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '816e436d-659c-45d3-9767-3018561891e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A24C9D9790>]}
[0m10:57:35.105670 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__categories
[0m10:57:35.105670 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_d365_fo__dates
[0m10:57:35.106693 [info ] [Thread-1 (]: 1 of 13 START sql view model broman_analytics.stg_d365_fo__categories .......... [RUN]
[0m10:57:35.106693 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_d365_fo__items
[0m10:57:35.107670 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_d365_fo__managers
[0m10:57:35.107670 [info ] [Thread-2 (]: 2 of 13 START sql view model broman_analytics.stg_d365_fo__dates ............... [RUN]
[0m10:57:35.107670 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__categories'
[0m10:57:35.109174 [info ] [Thread-3 (]: 3 of 13 START sql view model broman_analytics.stg_d365_fo__items ............... [RUN]
[0m10:57:35.110181 [info ] [Thread-4 (]: 4 of 13 START sql view model broman_analytics.stg_d365_fo__managers ............ [RUN]
[0m10:57:35.110181 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__dates'
[0m10:57:35.111182 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__categories
[0m10:57:35.111182 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__items'
[0m10:57:35.112180 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__managers'
[0m10:57:35.112180 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_d365_fo__dates
[0m10:57:35.118183 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__categories"
[0m10:57:35.119184 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_d365_fo__items
[0m10:57:35.119710 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_d365_fo__managers
[0m10:57:35.122728 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__dates"
[0m10:57:35.126731 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__items"
[0m10:57:35.129224 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__managers"
[0m10:57:35.130240 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__categories
[0m10:57:35.160389 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__categories"
[0m10:57:35.161395 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_d365_fo__managers
[0m10:57:35.162394 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_d365_fo__dates
[0m10:57:35.162394 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_d365_fo__items
[0m10:57:35.167397 [debug] [Thread-4 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__managers"
[0m10:57:35.171919 [debug] [Thread-2 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__dates"
[0m10:57:35.172907 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__categories"
[0m10:57:35.174908 [debug] [Thread-3 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__items"
[0m10:57:35.176912 [debug] [Thread-1 (]: On model.epicaldemo.stg_d365_fo__categories: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__categories"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__categories
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.category
),

final AS (
    SELECT
        id AS "category_id"
        ,INITCAP(name) AS "Category"
        ,managerid AS "manager_id"
    FROM source
)

SELECT * FROM final
  );
[0m10:57:35.177908 [debug] [Thread-4 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__managers"
[0m10:57:35.177908 [debug] [Thread-2 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__dates"
[0m10:57:35.178909 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:57:35.179413 [debug] [Thread-3 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__items"
[0m10:57:35.180423 [debug] [Thread-4 (]: On model.epicaldemo.stg_d365_fo__managers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__managers"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__managers
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.manager
),

final as (
    SELECT
        id AS "manager_id"
        ,firstname || ' ' || lastname AS "Manager"
    FROM source
)

SELECT * FROM final
  );
[0m10:57:35.180423 [debug] [Thread-2 (]: On model.epicaldemo.stg_d365_fo__dates: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__dates"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__dates
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.date
),

final AS (
    SELECT
        id AS date_id
        ,date AS "Date"
        ,year AS "Year"
        ,yearmonth AS "Year Month"
        ,monthnumber AS "Month Number"
        ,quarter AS "Quarter"
        ,quarternumber AS "Quarter Number"
        ,monthname AS "Month"
    FROM source
)

SELECT * FROM final
  );
[0m10:57:35.183431 [debug] [Thread-3 (]: On model.epicaldemo.stg_d365_fo__items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__items"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__items
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.item
),

final AS (
    SELECT
        id AS "item_id"
        ,name AS "Item"
        ,COALESCE(brand, 'Missing') AS "Brand"
        ,categoryid AS "category_id"
        ,COALESCE(flavor, 'Missing') AS "Flavor"
        ,sku AS "SKU"
    FROM source
)

SELECT * FROM final
  );
[0m10:57:35.184428 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:57:35.184428 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:57:35.185429 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:57:35.924147 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.745 seconds
[0m10:57:35.951256 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '816e436d-659c-45d3-9767-3018561891e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A24CE8C9D0>]}
[0m10:57:35.952256 [info ] [Thread-1 (]: 1 of 13 OK created sql view model broman_analytics.stg_d365_fo__categories ..... [[32mSUCCESS 1[0m in 0.84s]
[0m10:57:35.953258 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__categories
[0m10:57:35.954266 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__stores
[0m10:57:35.954266 [info ] [Thread-1 (]: 5 of 13 START sql view model broman_analytics.stg_d365_fo__stores .............. [RUN]
[0m10:57:35.955259 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__categories, now model.epicaldemo.stg_d365_fo__stores)
[0m10:57:35.955259 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__stores
[0m10:57:35.957256 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.773 seconds
[0m10:57:35.959768 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__stores"
[0m10:57:35.961773 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '816e436d-659c-45d3-9767-3018561891e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A24CE8C290>]}
[0m10:57:35.962774 [info ] [Thread-4 (]: 4 of 13 OK created sql view model broman_analytics.stg_d365_fo__managers ....... [[32mSUCCESS 1[0m in 0.85s]
[0m10:57:35.963774 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__stores
[0m10:57:35.963774 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_d365_fo__managers
[0m10:57:35.965773 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.781 seconds
[0m10:57:35.970288 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__stores"
[0m10:57:35.971287 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.786 seconds
[0m10:57:35.972298 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_d365_fo__transactions
[0m10:57:35.974288 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '816e436d-659c-45d3-9767-3018561891e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A24D6FB110>]}
[0m10:57:35.976287 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '816e436d-659c-45d3-9767-3018561891e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A24D717A90>]}
[0m10:57:35.978289 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__stores"
[0m10:57:35.977296 [info ] [Thread-4 (]: 6 of 13 START sql view model broman_analytics.stg_d365_fo__transactions ........ [RUN]
[0m10:57:35.979286 [info ] [Thread-2 (]: 2 of 13 OK created sql view model broman_analytics.stg_d365_fo__dates .......... [[32mSUCCESS 1[0m in 0.86s]
[0m10:57:35.980322 [info ] [Thread-3 (]: 3 of 13 OK created sql view model broman_analytics.stg_d365_fo__items .......... [[32mSUCCESS 1[0m in 0.87s]
[0m10:57:35.981323 [debug] [Thread-1 (]: On model.epicaldemo.stg_d365_fo__stores: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__stores"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__stores
  
   as (
    WITH

stores_snapshots AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stores_snapshot
),

final AS (
    SELECT
        id AS "store_id"
        ,dbt_scd_id

        ,ROW_NUMBER() OVER (ORDER BY id ASC, dbt_valid_from ASC) AS "store_key"

        ,CASE WHEN dbt_valid_to = '9999-12-31' THEN 1 ELSE 0 END AS is_current
        ,name AS "Store"
        ,SPLIT_PART(location, ',', 1) AS "Store State"
        ,SPLIT_PART(location, ',', 2) AS "Store City"
        ,latitude AS "Lat"
        ,longitude AS "Lon"
        ,onlinepresence AS "Online Presence"
        ,modified
        ,CAST(TO_CHAR(dbt_valid_from::DATE, 'YYYYMMDD') AS INTEGER) AS "valid_from"
        ,CAST(TO_CHAR(dbt_valid_to::DATE, 'YYYYMMDD') AS INTEGER) AS "valid_to"
    FROM stores_snapshots
)

SELECT * FROM final
  );
[0m10:57:35.983332 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__managers, now model.epicaldemo.stg_d365_fo__transactions)
[0m10:57:35.984329 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_d365_fo__dates
[0m10:57:35.985329 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_d365_fo__items
[0m10:57:35.987330 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_d365_fo__transactions
[0m10:57:35.988602 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_inriver__item_attributes
[0m10:57:35.989112 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_salesforce__customers
[0m10:57:35.995583 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__transactions"
[0m10:57:35.997583 [info ] [Thread-2 (]: 7 of 13 START sql view model broman_analytics.stg_inriver__item_attributes ..... [RUN]
[0m10:57:36.000098 [info ] [Thread-3 (]: 8 of 13 START sql view model broman_analytics.stg_salesforce__customers ........ [RUN]
[0m10:57:36.003387 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__dates, now model.epicaldemo.stg_inriver__item_attributes)
[0m10:57:36.003387 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__items, now model.epicaldemo.stg_salesforce__customers)
[0m10:57:36.004387 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_d365_fo__transactions
[0m10:57:36.005394 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_inriver__item_attributes
[0m10:57:36.005394 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_salesforce__customers
[0m10:57:36.010898 [debug] [Thread-4 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__transactions"
[0m10:57:36.016905 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_inriver__item_attributes"
[0m10:57:36.023008 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_salesforce__customers"
[0m10:57:36.026006 [debug] [Thread-4 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__transactions"
[0m10:57:36.026006 [debug] [Thread-4 (]: On model.epicaldemo.stg_d365_fo__transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__transactions"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__transactions
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.transactions
),

final AS (
    SELECT
        -- Identifiers
        CAST(TO_CHAR(date::DATE, 'YYYYMMDD') AS INTEGER) AS "date_id"
        ,sku AS "SKU"
        ,store AS "Store"
        ,customernumber AS "Customer Number"

        -- Metrics
        ,quantity AS "Qty"
        ,unitprice::NUMERIC(10,2) AS "Unit Price"
        ,(quantity * unitprice)::NUMERIC(10,2) AS "Sales Amount"
        ,unitcost::NUMERIC(10,2) AS "Unit Cost"
        ,(quantity * unitcost)::NUMERIC(10,2) AS "Cost"
        ,(quantity * unitprice)::NUMERIC(10,2) - (quantity * unitcost)::NUMERIC(10,2) AS "Margin"
    FROM source
)

SELECT * FROM final
  );
[0m10:57:36.027476 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_inriver__item_attributes
[0m10:57:36.027476 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_salesforce__customers
[0m10:57:36.032305 [debug] [Thread-2 (]: Writing runtime sql for node "model.epicaldemo.stg_inriver__item_attributes"
[0m10:57:36.039367 [debug] [Thread-3 (]: Writing runtime sql for node "model.epicaldemo.stg_salesforce__customers"
[0m10:57:36.049926 [debug] [Thread-3 (]: Using snowflake connection "model.epicaldemo.stg_salesforce__customers"
[0m10:57:36.050927 [debug] [Thread-3 (]: On model.epicaldemo.stg_salesforce__customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_salesforce__customers"} */
create or replace   view EPICALDEMO.broman_analytics.stg_salesforce__customers
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.salesforce.customer
),

final AS (
    SELECT
        id::INT AS "customer_id"
        ,customernumber AS "Customer Number"
        ,age AS "Customer Age"

        ,CASE
            WHEN age < 20 THEN '< 20'
            WHEN age >= 20 AND age < 30 THEN '20 - 30'
            WHEN age >= 30 AND age < 50 THEN '30 - 50'
            WHEN age >= 50 AND age < 60 THEN '50 - 60'
            ELSE '60+'
         END AS "Customer Age Group"

        ,CASE
            WHEN age < 20 THEN 1
            WHEN age >= 20 AND age < 30 THEN 2
            WHEN age >= 30 AND age < 50 THEN 3
            WHEN age >= 50 AND age < 60 THEN 4
            ELSE 5
         END AS "customer_age_group_sort"

        ,state AS "Customer State"
    FROM source
)

SELECT * FROM final
  );
[0m10:57:36.053461 [debug] [Thread-2 (]: Using snowflake connection "model.epicaldemo.stg_inriver__item_attributes"
[0m10:57:36.056462 [debug] [Thread-2 (]: On model.epicaldemo.stg_inriver__item_attributes: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_inriver__item_attributes"} */
create or replace   view EPICALDEMO.broman_analytics.stg_inriver__item_attributes
  
   as (
    with

source as (
    select
        *
    from EPICALDEMO.inriver.item_attributes
),

final as (
    select
        id AS "item_attributes_id"
        ,sku AS "SKU"
        ,COALESCE(crunch_level, 'Missing') AS "Crunch Level"
        ,COALESCE(snack_time, 'Missing') AS "Snack Time"
    from source
)

select * from final
  );
[0m10:57:36.252034 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.198 seconds
[0m10:57:36.255032 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '816e436d-659c-45d3-9767-3018561891e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A24D6CDD10>]}
[0m10:57:36.255032 [info ] [Thread-3 (]: 8 of 13 OK created sql view model broman_analytics.stg_salesforce__customers ... [[32mSUCCESS 1[0m in 0.25s]
[0m10:57:36.256032 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_salesforce__customers
[0m10:57:36.257034 [debug] [Thread-3 (]: Began running node model.epicaldemo.dim_dates
[0m10:57:36.257034 [info ] [Thread-3 (]: 9 of 13 START sql table model broman_analytics.dim_dates ....................... [RUN]
[0m10:57:36.258032 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_salesforce__customers, now model.epicaldemo.dim_dates)
[0m10:57:36.258032 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.dim_dates
[0m10:57:36.261104 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.dim_dates"
[0m10:57:36.262100 [debug] [Thread-3 (]: Began executing node model.epicaldemo.dim_dates
[0m10:57:36.284166 [debug] [Thread-3 (]: Writing runtime sql for node "model.epicaldemo.dim_dates"
[0m10:57:36.286167 [debug] [Thread-3 (]: Using snowflake connection "model.epicaldemo.dim_dates"
[0m10:57:36.286167 [debug] [Thread-3 (]: On model.epicaldemo.dim_dates: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_dates"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_dates
    

    
    as (with

dates AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__dates
),

final AS (
    SELECT
        date_id
        ,"Date"
        ,"Year"
        ,"Year Month"
        ,LEFT(date_id::TEXT, 6) AS "Year Month Number"
        ,"Month Number"
        ,"Quarter"
        ,"Quarter Number"
        ,"Month"
        ,LEFT("Month",3) AS "Month Short"
    FROM dates
)

SELECT * FROM final
    )
;
[0m10:57:36.356427 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.370 seconds
[0m10:57:36.358931 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '816e436d-659c-45d3-9767-3018561891e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A24D7D0CD0>]}
[0m10:57:36.359936 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.302 seconds
[0m10:57:36.359936 [info ] [Thread-1 (]: 5 of 13 OK created sql view model broman_analytics.stg_d365_fo__stores ......... [[32mSUCCESS 1[0m in 0.40s]
[0m10:57:36.361936 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '816e436d-659c-45d3-9767-3018561891e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A24D7D8850>]}
[0m10:57:36.362934 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__stores
[0m10:57:36.363936 [info ] [Thread-2 (]: 7 of 13 OK created sql view model broman_analytics.stg_inriver__item_attributes  [[32mSUCCESS 1[0m in 0.36s]
[0m10:57:36.363936 [debug] [Thread-1 (]: Began running node model.epicaldemo.dim_customers
[0m10:57:36.364936 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_inriver__item_attributes
[0m10:57:36.365946 [info ] [Thread-1 (]: 10 of 13 START sql table model broman_analytics.dim_customers .................. [RUN]
[0m10:57:36.365946 [debug] [Thread-2 (]: Began running node model.epicaldemo.dim_stores
[0m10:57:36.366938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__stores, now model.epicaldemo.dim_customers)
[0m10:57:36.366938 [info ] [Thread-2 (]: 11 of 13 START sql table model broman_analytics.dim_stores ..................... [RUN]
[0m10:57:36.367937 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.dim_customers
[0m10:57:36.367937 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_inriver__item_attributes, now model.epicaldemo.dim_stores)
[0m10:57:36.372285 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.dim_customers"
[0m10:57:36.373285 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.dim_stores
[0m10:57:36.376285 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.dim_stores"
[0m10:57:36.377285 [debug] [Thread-1 (]: Began executing node model.epicaldemo.dim_customers
[0m10:57:36.379790 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.dim_customers"
[0m10:57:36.380794 [debug] [Thread-2 (]: Began executing node model.epicaldemo.dim_stores
[0m10:57:36.381795 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.353 seconds
[0m10:57:36.384795 [debug] [Thread-2 (]: Writing runtime sql for node "model.epicaldemo.dim_stores"
[0m10:57:36.385794 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.dim_customers"
[0m10:57:36.387798 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '816e436d-659c-45d3-9767-3018561891e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A24D169350>]}
[0m10:57:36.389303 [debug] [Thread-1 (]: On model.epicaldemo.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_customers"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_customers
    

    
    as (WITH

customers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_salesforce__customers
),

final AS (
    SELECT
        "customer_id"
        ,"Customer Number"
        ,"Customer Age"
        ,"Customer Age Group"
        ,"customer_age_group_sort"
        ,"Customer State"
    FROM customers
)

SELECT * FROM final
    )
;
[0m10:57:36.389303 [debug] [Thread-2 (]: Using snowflake connection "model.epicaldemo.dim_stores"
[0m10:57:36.390312 [info ] [Thread-4 (]: 6 of 13 OK created sql view model broman_analytics.stg_d365_fo__transactions ... [[32mSUCCESS 1[0m in 0.41s]
[0m10:57:36.391317 [debug] [Thread-2 (]: On model.epicaldemo.dim_stores: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_stores"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_stores
    

    
    as (with

store AS (
    select
        *
    from EPICALDEMO.broman_analytics.stg_d365_fo__stores
),

final AS (
    SELECT
        "store_key"
        ,"store_id"
        ,IS_CURRENT
        ,"Store"
        ,"Store State"
        ,"Store City"
        ,"Lat"
        ,"Lon"
        ,"Online Presence"
        ,MODIFIED
        ,"valid_from"
        ,"valid_to"
    from store
)

select * from final
    )
;
[0m10:57:36.392307 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_d365_fo__transactions
[0m10:57:36.394307 [debug] [Thread-4 (]: Began running node model.epicaldemo.dim_items
[0m10:57:36.395309 [info ] [Thread-4 (]: 12 of 13 START sql table model broman_analytics.dim_items ...................... [RUN]
[0m10:57:36.396311 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__transactions, now model.epicaldemo.dim_items)
[0m10:57:36.397309 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.dim_items
[0m10:57:36.400826 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.dim_items"
[0m10:57:36.402823 [debug] [Thread-4 (]: Began executing node model.epicaldemo.dim_items
[0m10:57:36.405822 [debug] [Thread-4 (]: Writing runtime sql for node "model.epicaldemo.dim_items"
[0m10:57:36.407822 [debug] [Thread-4 (]: Using snowflake connection "model.epicaldemo.dim_items"
[0m10:57:36.409327 [debug] [Thread-4 (]: On model.epicaldemo.dim_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_items"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_items
    

    
    as (with

item AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__items
),

item_attributes AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_inriver__item_attributes
),

category AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__categories
),

manager AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__managers
),

unknown AS (
    SELECT
        -1 AS "item_id"
        ,'Unknown' AS "SKU"
        ,'Unknown' AS "Item"
        ,'Missing' AS "Brand"
        ,'Missing' AS "Flavor"
        ,'Missing' AS "Crunch Level"
        ,'Missing' AS "Snack Time"
        ,'Missing' AS "Category"
        ,'Missing' AS "Manager"
),

missing AS (
    SELECT
        -2 AS "item_id"
        ,'Missing' AS "SKU"
        ,'Missing' AS "Item"
        ,'Missing' AS "Brand"
        ,'Missing' AS "Flavor"
        ,'Missing' AS "Crunch Level"
        ,'Missing' AS "Snack Time"
        ,'Missing' AS "Category"
        ,'Missing' AS "Manager"
),

final AS (
    SELECT
        item."item_id"
        ,item."SKU"
        ,item."Item"
        ,item."Brand"
        ,item."Flavor"
        ,COALESCE(item_attributes."Crunch Level", 'Missing') AS "Crunch Level"
        ,COALESCE(item_attributes."Snack Time", 'Missing') AS "Snack Time"
        ,category."Category"
        ,manager."Manager"
    FROM item
    LEFT JOIN item_attributes ON item_attributes."SKU" = item."SKU"
    LEFT JOIN category ON category."category_id" = item."category_id"
    LEFT JOIN manager ON manager."manager_id" = category."manager_id"

    UNION

    SELECT * FROM unknown

    UNION

    SELECT * FROM missing
)

SELECT * FROM final
    )
;
[0m10:57:36.980024 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.693 seconds
[0m10:57:36.982024 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '816e436d-659c-45d3-9767-3018561891e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A24CE1B790>]}
[0m10:57:36.983025 [info ] [Thread-3 (]: 9 of 13 OK created sql table model broman_analytics.dim_dates .................. [[32mSUCCESS 1[0m in 0.72s]
[0m10:57:36.984032 [debug] [Thread-3 (]: Finished running node model.epicaldemo.dim_dates
[0m10:57:36.985025 [debug] [Thread-3 (]: Began running node model.epicaldemo.fact_sales_transactions
[0m10:57:36.985025 [info ] [Thread-3 (]: 13 of 13 START sql table model broman_analytics.fact_sales_transactions ........ [RUN]
[0m10:57:36.986024 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.dim_dates, now model.epicaldemo.fact_sales_transactions)
[0m10:57:36.986024 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.fact_sales_transactions
[0m10:57:36.989024 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.fact_sales_transactions"
[0m10:57:36.991052 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.597 seconds
[0m10:57:36.991052 [debug] [Thread-3 (]: Began executing node model.epicaldemo.fact_sales_transactions
[0m10:57:36.993052 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '816e436d-659c-45d3-9767-3018561891e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A24D79ADD0>]}
[0m10:57:36.995052 [debug] [Thread-3 (]: Writing runtime sql for node "model.epicaldemo.fact_sales_transactions"
[0m10:57:36.996052 [info ] [Thread-2 (]: 11 of 13 OK created sql table model broman_analytics.dim_stores ................ [[32mSUCCESS 1[0m in 0.63s]
[0m10:57:36.997052 [debug] [Thread-2 (]: Finished running node model.epicaldemo.dim_stores
[0m10:57:37.000083 [debug] [Thread-3 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions"
[0m10:57:37.000083 [debug] [Thread-3 (]: On model.epicaldemo.fact_sales_transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions"} */
create or replace transient table EPICALDEMO.broman_analytics.fact_sales_transactions
    

    
    as (WITH

sales AS (
    select
        *
    from EPICALDEMO.broman_analytics.stg_d365_fo__transactions
),

items AS (
    select
        *
    from EPICALDEMO.broman_analytics.stg_d365_fo__items
),

stores AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__stores
),

customers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_salesforce__customers
),

final AS (
    SELECT
        -- Identifiers
        sales."date_id"
        ,sales."SKU"

        ,CASE
            WHEN sales."SKU" IS NULL THEN -2 -- SKU is missing from Source
            WHEN items."item_id" IS NULL THEN -1 -- SKU is not known from Source
            ELSE items."item_id" -- Join item_id from Dim based on SKU
         END AS "item_id"

        ,sales."Store"

        ,CASE
            WHEN sales."Store" IS NULL THEN -2
            WHEN stores."store_key" IS NULL THEN -1
            ELSE stores."store_key"
         END AS "store_key"

        ,sales."Customer Number"

        ,CASE
            WHEN sales."Customer Number" IS NULL THEN -2
            WHEN customers."customer_id" IS NULL THEN -1
            ELSE customers."customer_id"
         END AS "customer_id"

        -- Metrics
        ,sales."Qty"
        ,sales."Unit Price"
        ,sales."Sales Amount"
        ,sales."Unit Cost"
        ,sales."Cost"
        ,sales."Margin"
    FROM sales
    LEFT JOIN items ON items."SKU" = sales."SKU"
    LEFT JOIN stores ON stores."Store" = sales."Store" AND sales."date_id" >= stores."valid_from" AND sales."date_id" < stores."valid_to"
    LEFT JOIN customers ON customers."Customer Number" = sales."Customer Number"
)

SELECT * FROM final
    )
;
[0m10:57:37.141214 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.750 seconds
[0m10:57:37.143225 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '816e436d-659c-45d3-9767-3018561891e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A24D7E92D0>]}
[0m10:57:37.144213 [info ] [Thread-1 (]: 10 of 13 OK created sql table model broman_analytics.dim_customers ............. [[32mSUCCESS 1[0m in 0.78s]
[0m10:57:37.145212 [debug] [Thread-1 (]: Finished running node model.epicaldemo.dim_customers
[0m10:57:38.036182 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.627 seconds
[0m10:57:38.039199 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '816e436d-659c-45d3-9767-3018561891e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A24D6D5910>]}
[0m10:57:38.040205 [info ] [Thread-4 (]: 12 of 13 OK created sql table model broman_analytics.dim_items ................. [[32mSUCCESS 1[0m in 1.64s]
[0m10:57:38.040205 [debug] [Thread-4 (]: Finished running node model.epicaldemo.dim_items
[0m10:57:38.330400 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.330 seconds
[0m10:57:38.332407 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '816e436d-659c-45d3-9767-3018561891e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A24D7A6D10>]}
[0m10:57:38.333407 [info ] [Thread-3 (]: 13 of 13 OK created sql table model broman_analytics.fact_sales_transactions ... [[32mSUCCESS 1[0m in 1.35s]
[0m10:57:38.334399 [debug] [Thread-3 (]: Finished running node model.epicaldemo.fact_sales_transactions
[0m10:57:38.336398 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:57:38.336398 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m10:57:38.336398 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m10:57:38.502311 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m10:57:38.503319 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m10:57:38.663965 [debug] [MainThread]: Connection 'model.epicaldemo.dim_customers' was left open.
[0m10:57:38.664964 [debug] [MainThread]: On model.epicaldemo.dim_customers: Close
[0m10:57:38.815999 [debug] [MainThread]: Connection 'model.epicaldemo.dim_stores' was left open.
[0m10:57:38.817007 [debug] [MainThread]: On model.epicaldemo.dim_stores: Close
[0m10:57:38.976947 [debug] [MainThread]: Connection 'model.epicaldemo.fact_sales_transactions' was left open.
[0m10:57:38.976947 [debug] [MainThread]: On model.epicaldemo.fact_sales_transactions: Close
[0m10:57:39.131951 [debug] [MainThread]: Connection 'model.epicaldemo.dim_items' was left open.
[0m10:57:39.132951 [debug] [MainThread]: On model.epicaldemo.dim_items: Close
[0m10:57:39.293969 [info ] [MainThread]: 
[0m10:57:39.294968 [info ] [MainThread]: Finished running 5 table models, 8 view models in 0 hours 0 minutes and 8.22 seconds (8.22s).
[0m10:57:39.296967 [debug] [MainThread]: Command end result
[0m10:57:39.321165 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m10:57:39.324177 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m10:57:39.330681 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m10:57:39.331683 [info ] [MainThread]: 
[0m10:57:39.331683 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:57:39.332682 [info ] [MainThread]: 
[0m10:57:39.333684 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 TOTAL=13
[0m10:57:39.334684 [debug] [MainThread]: Command `dbt run` succeeded at 10:57:39.334684 after 13.60 seconds
[0m10:57:39.334684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2456F3090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A24AEB4D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A24AEB4990>]}
[0m10:57:39.335683 [debug] [MainThread]: Flushing usage events
[0m10:57:40.011317 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:10:18.549971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000262FB572E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000262FB571D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000262FB573550>]}


============================== 11:10:18.553980 | 9226fb30-5270-4d1e-87e7-bf4eda423808 ==============================
[0m11:10:18.553980 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:10:18.554980 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -s fact_sales_transactions', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:10:18.972102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9226fb30-5270-4d1e-87e7-bf4eda423808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000262FA23FCD0>]}
[0m11:10:19.014228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9226fb30-5270-4d1e-87e7-bf4eda423808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000262FC931610>]}
[0m11:10:19.016234 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m11:10:19.322079 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:10:19.550179 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:10:19.551181 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:10:19.557180 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m11:10:19.614087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9226fb30-5270-4d1e-87e7-bf4eda423808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000262FCEDB490>]}
[0m11:10:19.703669 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m11:10:19.707669 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m11:10:19.730853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9226fb30-5270-4d1e-87e7-bf4eda423808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000262F92D9C10>]}
[0m11:10:19.732858 [info ] [MainThread]: Found 13 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m11:10:19.732858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9226fb30-5270-4d1e-87e7-bf4eda423808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000262FCFDF590>]}
[0m11:10:19.735867 [info ] [MainThread]: 
[0m11:10:19.736858 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:10:19.737861 [info ] [MainThread]: 
[0m11:10:19.737861 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:10:19.739996 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m11:10:19.860354 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m11:10:19.861354 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m11:10:19.861354 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:10:20.675837 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.814 seconds
[0m11:10:20.681364 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m11:10:20.689893 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m11:10:20.690892 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m11:10:20.690892 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:10:21.323270 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.632 seconds
[0m11:10:21.328264 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m11:10:21.329261 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m11:10:21.461962 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.131 seconds
[0m11:10:21.463955 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m11:10:21.463955 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m11:10:21.576005 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.111 seconds
[0m11:10:21.580526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9226fb30-5270-4d1e-87e7-bf4eda423808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000262FCFDF590>]}
[0m11:10:21.584513 [debug] [Thread-1 (]: Began running node model.epicaldemo.fact_sales_transactions
[0m11:10:21.585512 [info ] [Thread-1 (]: 1 of 1 START sql table model broman_analytics.fact_sales_transactions .......... [RUN]
[0m11:10:21.585512 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.fact_sales_transactions'
[0m11:10:21.586513 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.fact_sales_transactions
[0m11:10:21.594036 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.fact_sales_transactions"
[0m11:10:21.596036 [debug] [Thread-1 (]: Began executing node model.epicaldemo.fact_sales_transactions
[0m11:10:21.637200 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.fact_sales_transactions"
[0m11:10:21.641719 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions"
[0m11:10:21.642719 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions"} */
create or replace transient table EPICALDEMO.broman_analytics.fact_sales_transactions
    

    
    as (WITH

sales AS (
    select
        *
    from EPICALDEMO.broman_analytics.stg_d365_fo__transactions
),

items AS (
    select
        *
    from EPICALDEMO.broman_analytics.stg_d365_fo__items
),

stores AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__stores
),

customers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_salesforce__customers
),

final AS (
    SELECT
        -- Identifiers
        sales."date_id"

        ,CASE
            WHEN sales."SKU" IS NULL THEN -2 -- SKU is missing from Source
            WHEN items."item_id" IS NULL THEN -1 -- SKU is not known from Source
            ELSE items."item_id" -- Join item_id from Dim based on SKU
         END AS "item_id"

        ,CASE
            WHEN sales."Store" IS NULL THEN -2
            WHEN stores."store_key" IS NULL THEN -1
            ELSE stores."store_key"
         END AS "store_key"

        ,CASE
            WHEN sales."Customer Number" IS NULL THEN -2
            WHEN customers."customer_id" IS NULL THEN -1
            ELSE customers."customer_id"
         END AS "customer_id"

        -- Metrics
        ,sales."Qty"
        ,sales."Unit Price"
        ,sales."Sales Amount"
        ,sales."Unit Cost"
        ,sales."Cost"
        ,sales."Margin"
    FROM sales
    LEFT JOIN items ON items."SKU" = sales."SKU"
    LEFT JOIN stores ON stores."Store" = sales."Store" AND sales."date_id" >= stores."valid_from" AND sales."date_id" < stores."valid_to"
    LEFT JOIN customers ON customers."Customer Number" = sales."Customer Number"
)

SELECT * FROM final
    )
;
[0m11:10:21.644227 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:10:23.393018 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.749 seconds
[0m11:10:23.414057 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9226fb30-5270-4d1e-87e7-bf4eda423808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000262FD386250>]}
[0m11:10:23.415057 [info ] [Thread-1 (]: 1 of 1 OK created sql table model broman_analytics.fact_sales_transactions ..... [[32mSUCCESS 1[0m in 1.83s]
[0m11:10:23.416058 [debug] [Thread-1 (]: Finished running node model.epicaldemo.fact_sales_transactions
[0m11:10:23.418057 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:10:23.419058 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m11:10:23.419058 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m11:10:23.584103 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m11:10:23.585111 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m11:10:23.741188 [debug] [MainThread]: Connection 'model.epicaldemo.fact_sales_transactions' was left open.
[0m11:10:23.742186 [debug] [MainThread]: On model.epicaldemo.fact_sales_transactions: Close
[0m11:10:23.907472 [info ] [MainThread]: 
[0m11:10:23.908977 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.17 seconds (4.17s).
[0m11:10:23.909981 [debug] [MainThread]: Command end result
[0m11:10:23.932042 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m11:10:23.936038 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m11:10:23.944070 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m11:10:23.945592 [info ] [MainThread]: 
[0m11:10:23.946594 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:10:23.947593 [info ] [MainThread]: 
[0m11:10:23.947593 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:10:23.950106 [debug] [MainThread]: Command `dbt run` succeeded at 11:10:23.950106 after 5.47 seconds
[0m11:10:23.951106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000262FB597710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000262FB5DFE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000262FB495A50>]}
[0m11:10:23.952109 [debug] [MainThread]: Flushing usage events
[0m11:10:24.499879 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:16:01.320103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5F3B708D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5F3B73F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5F3B710D0>]}


============================== 11:16:01.331639 | 61699c78-990d-4cc3-9427-b3be510bf577 ==============================
[0m11:16:01.331639 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:16:01.332638 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -s stg_d365_fo__categories', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:16:04.036824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61699c78-990d-4cc3-9427-b3be510bf577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5F521E150>]}
[0m11:16:04.089538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '61699c78-990d-4cc3-9427-b3be510bf577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5F254F910>]}
[0m11:16:04.099060 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m11:16:04.497889 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:16:04.693140 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:16:04.694129 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:16:04.699137 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m11:16:04.737018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '61699c78-990d-4cc3-9427-b3be510bf577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5F5508490>]}
[0m11:16:04.811236 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m11:16:04.826766 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m11:16:05.040116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '61699c78-990d-4cc3-9427-b3be510bf577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5F54F6D10>]}
[0m11:16:05.041122 [info ] [MainThread]: Found 13 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m11:16:05.042119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61699c78-990d-4cc3-9427-b3be510bf577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5F55097D0>]}
[0m11:16:05.044130 [info ] [MainThread]: 
[0m11:16:05.045120 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:16:05.045120 [info ] [MainThread]: 
[0m11:16:05.046120 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:16:05.047120 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m11:16:07.654947 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m11:16:07.654947 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m11:16:07.655948 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:16:08.522961 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.867 seconds
[0m11:16:08.528962 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m11:16:08.537986 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m11:16:08.537986 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m11:16:08.538987 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:16:09.213246 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.674 seconds
[0m11:16:09.217244 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m11:16:09.219753 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m11:16:09.353978 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.134 seconds
[0m11:16:09.355978 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m11:16:09.355978 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m11:16:09.466080 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.109 seconds
[0m11:16:09.469585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61699c78-990d-4cc3-9427-b3be510bf577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5F5C3B990>]}
[0m11:16:09.473589 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__categories
[0m11:16:09.474590 [info ] [Thread-1 (]: 1 of 1 START sql view model broman_analytics.stg_d365_fo__categories ........... [RUN]
[0m11:16:09.475590 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__categories'
[0m11:16:09.475590 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__categories
[0m11:16:09.482098 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__categories"
[0m11:16:09.483099 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__categories
[0m11:16:09.509634 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__categories"
[0m11:16:09.511642 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__categories"
[0m11:16:09.512643 [debug] [Thread-1 (]: On model.epicaldemo.stg_d365_fo__categories: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__categories"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__categories
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.category
),

final AS (
    SELECT
        id AS category_id
        ,INITCAP(name) AS Category
        ,managerid AS manager_id
    FROM source
)

SELECT * FROM final
  );
[0m11:16:09.512643 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:16:10.144026 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.631 seconds
[0m11:16:10.171128 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61699c78-990d-4cc3-9427-b3be510bf577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5F5CA2390>]}
[0m11:16:10.172126 [info ] [Thread-1 (]: 1 of 1 OK created sql view model broman_analytics.stg_d365_fo__categories ...... [[32mSUCCESS 1[0m in 0.69s]
[0m11:16:10.173117 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__categories
[0m11:16:10.175117 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:16:10.175117 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m11:16:10.176116 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m11:16:10.334219 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m11:16:10.334219 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m11:16:10.486082 [debug] [MainThread]: Connection 'model.epicaldemo.stg_d365_fo__categories' was left open.
[0m11:16:10.486082 [debug] [MainThread]: On model.epicaldemo.stg_d365_fo__categories: Close
[0m11:16:10.637225 [info ] [MainThread]: 
[0m11:16:10.638731 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.59 seconds (5.59s).
[0m11:16:10.639735 [debug] [MainThread]: Command end result
[0m11:16:10.661581 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m11:16:10.664570 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m11:16:10.674097 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m11:16:10.675094 [info ] [MainThread]: 
[0m11:16:10.675094 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:16:10.676095 [info ] [MainThread]: 
[0m11:16:10.677095 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:16:10.678096 [debug] [MainThread]: Command `dbt run` succeeded at 11:16:10.678096 after 9.43 seconds
[0m11:16:10.678096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5F3BD1ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5EE41CB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5EE412E10>]}
[0m11:16:10.679095 [debug] [MainThread]: Flushing usage events
[0m11:16:11.204864 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:17:20.044894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C07B73B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C07B70ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C07B72DD0>]}


============================== 11:17:20.058984 | 56d30490-6ad7-410d-bbaa-32ab48d1a9b7 ==============================
[0m11:17:20.058984 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:17:20.059490 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -s stg_d365_fo__items', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:17:20.507410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56d30490-6ad7-410d-bbaa-32ab48d1a9b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C07B8D150>]}
[0m11:17:20.552500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '56d30490-6ad7-410d-bbaa-32ab48d1a9b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C0634F990>]}
[0m11:17:20.553492 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m11:17:20.893853 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:17:21.113079 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:17:21.114071 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:17:21.120602 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m11:17:21.158956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56d30490-6ad7-410d-bbaa-32ab48d1a9b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C094DACD0>]}
[0m11:17:21.234712 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m11:17:21.237711 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m11:17:21.257743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56d30490-6ad7-410d-bbaa-32ab48d1a9b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C099054D0>]}
[0m11:17:21.257743 [info ] [MainThread]: Found 13 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m11:17:21.258759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56d30490-6ad7-410d-bbaa-32ab48d1a9b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C0605F550>]}
[0m11:17:21.262049 [info ] [MainThread]: 
[0m11:17:21.262049 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:17:21.263050 [info ] [MainThread]: 
[0m11:17:21.264050 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:17:21.265274 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m11:17:21.362494 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m11:17:21.362494 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m11:17:21.363492 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:17:22.117386 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.754 seconds
[0m11:17:22.122900 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m11:17:22.132957 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m11:17:22.132957 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m11:17:22.133955 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:17:22.764184 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.630 seconds
[0m11:17:22.768181 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m11:17:22.769175 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m11:17:22.913113 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.144 seconds
[0m11:17:22.915113 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m11:17:22.916112 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m11:17:23.022823 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.106 seconds
[0m11:17:23.025824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56d30490-6ad7-410d-bbaa-32ab48d1a9b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C059A8250>]}
[0m11:17:23.029988 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__items
[0m11:17:23.030997 [info ] [Thread-1 (]: 1 of 1 START sql view model broman_analytics.stg_d365_fo__items ................ [RUN]
[0m11:17:23.031986 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__items'
[0m11:17:23.031986 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__items
[0m11:17:23.038997 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__items"
[0m11:17:23.039505 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__items
[0m11:17:23.064540 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__items"
[0m11:17:23.066539 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__items"
[0m11:17:23.067540 [debug] [Thread-1 (]: On model.epicaldemo.stg_d365_fo__items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__items"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__items
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.item
),

final AS (
    SELECT
        id AS item_id
        ,name AS Item
        ,COALESCE(brand, 'Missing') AS Brand
        ,categoryid AS category_id
        ,COALESCE(flavor, 'Missing') AS Flavor
        ,sku AS SKU
    FROM source
)

SELECT * FROM final
  );
[0m11:17:23.067540 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:17:23.725911 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.658 seconds
[0m11:17:23.746945 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56d30490-6ad7-410d-bbaa-32ab48d1a9b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C09990310>]}
[0m11:17:23.748949 [info ] [Thread-1 (]: 1 of 1 OK created sql view model broman_analytics.stg_d365_fo__items ........... [[32mSUCCESS 1[0m in 0.71s]
[0m11:17:23.750467 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__items
[0m11:17:23.753478 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:17:23.753478 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m11:17:23.754474 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m11:17:23.923749 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m11:17:23.923749 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m11:17:24.090069 [debug] [MainThread]: Connection 'model.epicaldemo.stg_d365_fo__items' was left open.
[0m11:17:24.091077 [debug] [MainThread]: On model.epicaldemo.stg_d365_fo__items: Close
[0m11:17:24.248894 [info ] [MainThread]: 
[0m11:17:24.249902 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.99 seconds (2.99s).
[0m11:17:24.250903 [debug] [MainThread]: Command end result
[0m11:17:24.271962 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m11:17:24.274954 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m11:17:24.282015 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m11:17:24.283014 [info ] [MainThread]: 
[0m11:17:24.284029 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:17:24.284029 [info ] [MainThread]: 
[0m11:17:24.285012 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:17:24.286014 [debug] [MainThread]: Command `dbt run` succeeded at 11:17:24.286014 after 4.31 seconds
[0m11:17:24.287020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C079B5210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C079B4E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C02461250>]}
[0m11:17:24.287020 [debug] [MainThread]: Flushing usage events
[0m11:17:24.889551 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:22:01.607104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D00E73F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D00E71FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D00E70410>]}


============================== 11:22:01.612635 | cf88ddb6-f7f3-4f9e-b66a-f5ab8140de40 ==============================
[0m11:22:01.612635 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:22:01.613634 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s stg_d365_fo__items', 'send_anonymous_usage_stats': 'True'}
[0m11:22:02.066358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf88ddb6-f7f3-4f9e-b66a-f5ab8140de40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D01FFDD10>]}
[0m11:22:02.110692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf88ddb6-f7f3-4f9e-b66a-f5ab8140de40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D02031510>]}
[0m11:22:02.113684 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m11:22:02.420167 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:22:02.617071 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:22:02.618063 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:22:02.623292 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m11:22:02.660633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf88ddb6-f7f3-4f9e-b66a-f5ab8140de40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D0290AF10>]}
[0m11:22:02.734403 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m11:22:02.738899 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m11:22:02.769017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf88ddb6-f7f3-4f9e-b66a-f5ab8140de40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D029FC150>]}
[0m11:22:02.770139 [info ] [MainThread]: Found 13 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m11:22:02.771139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf88ddb6-f7f3-4f9e-b66a-f5ab8140de40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D028B7D50>]}
[0m11:22:02.772139 [info ] [MainThread]: 
[0m11:22:02.773140 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:22:02.773140 [info ] [MainThread]: 
[0m11:22:02.774139 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:22:02.775149 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m11:22:02.857081 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m11:22:02.858081 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m11:22:02.859083 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:22:03.602192 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.743 seconds
[0m11:22:03.608685 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m11:22:03.617702 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m11:22:03.618701 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m11:22:03.619209 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:22:04.277464 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.658 seconds
[0m11:22:04.281974 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m11:22:04.281974 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m11:22:04.412949 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.130 seconds
[0m11:22:04.415939 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m11:22:04.415939 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m11:22:04.537585 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.121 seconds
[0m11:22:04.542105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf88ddb6-f7f3-4f9e-b66a-f5ab8140de40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D02166BD0>]}
[0m11:22:04.548097 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__items
[0m11:22:04.548097 [info ] [Thread-1 (]: 1 of 1 START sql view model broman_analytics.stg_d365_fo__items ................ [RUN]
[0m11:22:04.549950 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__items'
[0m11:22:04.549950 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__items
[0m11:22:04.557954 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__items"
[0m11:22:04.558954 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__items
[0m11:22:04.585541 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__items"
[0m11:22:04.587531 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__items"
[0m11:22:04.587531 [debug] [Thread-1 (]: On model.epicaldemo.stg_d365_fo__items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__items"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__items
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.item
),

final AS (
    SELECT
        id AS item_id
        ,name AS Item
        ,COALESCE(brand, 'Missing') AS Brand
        ,categoryid AS category_id
        ,COALESCE(flavor, 'Missing') AS Flavor
        ,sku AS SKU
    FROM source
)

SELECT * FROM final
  );
[0m11:22:04.589140 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:22:05.342064 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.753 seconds
[0m11:22:05.362106 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf88ddb6-f7f3-4f9e-b66a-f5ab8140de40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D020CD550>]}
[0m11:22:05.363106 [info ] [Thread-1 (]: 1 of 1 OK created sql view model broman_analytics.stg_d365_fo__items ........... [[32mSUCCESS 1[0m in 0.81s]
[0m11:22:05.364106 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__items
[0m11:22:05.366109 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:22:05.366109 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m11:22:05.367107 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m11:22:05.525792 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m11:22:05.525792 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m11:22:05.791583 [debug] [MainThread]: Connection 'model.epicaldemo.stg_d365_fo__items' was left open.
[0m11:22:05.792591 [debug] [MainThread]: On model.epicaldemo.stg_d365_fo__items: Close
[0m11:22:05.949771 [info ] [MainThread]: 
[0m11:22:05.950774 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.18 seconds (3.18s).
[0m11:22:05.951772 [debug] [MainThread]: Command end result
[0m11:22:05.971941 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m11:22:05.974941 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m11:22:05.983429 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m11:22:05.983429 [info ] [MainThread]: 
[0m11:22:05.984426 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:22:05.985425 [info ] [MainThread]: 
[0m11:22:05.986436 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:22:05.987426 [debug] [MainThread]: Command `dbt run` succeeded at 11:22:05.987426 after 4.44 seconds
[0m11:22:05.987426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D00EDBED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D00795150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015D00B95A50>]}
[0m11:22:05.987426 [debug] [MainThread]: Flushing usage events
[0m11:22:06.528923 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:22:56.694900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D2F4BB690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D2F4BA450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D2F4B9A10>]}


============================== 11:22:56.710043 | cb1ab394-ead6-4d60-afe5-2214c5e203cc ==============================
[0m11:22:56.710043 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:22:56.711042 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -s stg_d365_fo__items', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:22:57.124989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb1ab394-ead6-4d60-afe5-2214c5e203cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D2F4E9190>]}
[0m11:22:57.167169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb1ab394-ead6-4d60-afe5-2214c5e203cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D30631650>]}
[0m11:22:57.169679 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m11:22:57.484937 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:22:57.682437 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:22:57.683437 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:22:57.688936 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m11:22:57.738753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb1ab394-ead6-4d60-afe5-2214c5e203cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D30EDA590>]}
[0m11:22:57.826079 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m11:22:57.830600 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m11:22:57.850141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb1ab394-ead6-4d60-afe5-2214c5e203cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D30BC1E90>]}
[0m11:22:57.851141 [info ] [MainThread]: Found 13 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m11:22:57.852139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb1ab394-ead6-4d60-afe5-2214c5e203cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D30EEA310>]}
[0m11:22:57.854139 [info ] [MainThread]: 
[0m11:22:57.854139 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:22:57.855139 [info ] [MainThread]: 
[0m11:22:57.855139 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:22:57.857139 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m11:22:57.935793 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m11:22:57.935793 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m11:22:57.936793 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:22:58.745000 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.808 seconds
[0m11:22:58.750540 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m11:22:58.760064 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m11:22:58.760064 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m11:22:58.760064 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:22:59.451130 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.691 seconds
[0m11:22:59.455128 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m11:22:59.456127 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m11:22:59.597772 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.141 seconds
[0m11:22:59.599802 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m11:22:59.600793 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m11:22:59.714691 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.113 seconds
[0m11:22:59.717687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb1ab394-ead6-4d60-afe5-2214c5e203cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D30BEE5D0>]}
[0m11:22:59.722201 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__items
[0m11:22:59.722201 [info ] [Thread-1 (]: 1 of 1 START sql view model broman_analytics.stg_d365_fo__items ................ [RUN]
[0m11:22:59.723197 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__items'
[0m11:22:59.724190 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__items
[0m11:22:59.730729 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__items"
[0m11:22:59.731720 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__items
[0m11:22:59.756776 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__items"
[0m11:22:59.759274 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__items"
[0m11:22:59.759274 [debug] [Thread-1 (]: On model.epicaldemo.stg_d365_fo__items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__items"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__items
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.item
),

final AS (
    SELECT
        id AS item_id
        ,name AS "Item"
        ,COALESCE(brand, 'Missing') AS "Brand"
        ,categoryid AS category_id
        ,COALESCE(flavor, 'Missing') AS "Flavor"
        ,sku AS "SKU"
    FROM source
)

SELECT * FROM final
  );
[0m11:22:59.760282 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:23:00.412941 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.653 seconds
[0m11:23:00.433496 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb1ab394-ead6-4d60-afe5-2214c5e203cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D313EE750>]}
[0m11:23:00.434492 [info ] [Thread-1 (]: 1 of 1 OK created sql view model broman_analytics.stg_d365_fo__items ........... [[32mSUCCESS 1[0m in 0.71s]
[0m11:23:00.436484 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__items
[0m11:23:00.438999 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:23:00.440010 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m11:23:00.440010 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m11:23:00.600989 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m11:23:00.600989 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m11:23:00.764319 [debug] [MainThread]: Connection 'model.epicaldemo.stg_d365_fo__items' was left open.
[0m11:23:00.765335 [debug] [MainThread]: On model.epicaldemo.stg_d365_fo__items: Close
[0m11:23:00.919793 [info ] [MainThread]: 
[0m11:23:00.920804 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.06 seconds (3.06s).
[0m11:23:00.921786 [debug] [MainThread]: Command end result
[0m11:23:00.946007 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m11:23:00.952560 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m11:23:00.966564 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m11:23:00.969165 [info ] [MainThread]: 
[0m11:23:00.974113 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:23:00.976263 [info ] [MainThread]: 
[0m11:23:00.978669 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:23:00.983681 [debug] [MainThread]: Command `dbt run` succeeded at 11:23:00.981677 after 4.35 seconds
[0m11:23:00.987681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D2F4D9D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D2987CB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D2F0B4C90>]}
[0m11:23:00.992216 [debug] [MainThread]: Flushing usage events
[0m11:23:01.546650 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:24:37.677708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002168C473190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002168C471DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002168C473550>]}


============================== 11:24:37.681741 | 2d3c798a-f0d9-49e3-89c9-ec3fbc850ef5 ==============================
[0m11:24:37.681741 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:24:37.682741 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s +dim_items', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:24:38.079523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d3c798a-f0d9-49e3-89c9-ec3fbc850ef5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002168D721D50>]}
[0m11:24:38.122712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d3c798a-f0d9-49e3-89c9-ec3fbc850ef5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002168D631790>]}
[0m11:24:38.124713 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m11:24:38.429679 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:24:38.619214 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:24:38.620222 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:24:38.626221 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m11:24:38.664727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d3c798a-f0d9-49e3-89c9-ec3fbc850ef5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002168DF09110>]}
[0m11:24:38.741663 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m11:24:38.745664 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m11:24:38.765709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d3c798a-f0d9-49e3-89c9-ec3fbc850ef5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002168DB73450>]}
[0m11:24:38.766710 [info ] [MainThread]: Found 13 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m11:24:38.767712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d3c798a-f0d9-49e3-89c9-ec3fbc850ef5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002168D6AAC50>]}
[0m11:24:38.770751 [info ] [MainThread]: 
[0m11:24:38.770751 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:24:38.771737 [info ] [MainThread]: 
[0m11:24:38.772738 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:24:38.776735 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m11:24:38.854268 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m11:24:38.855267 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m11:24:38.855267 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:24:39.626004 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.770 seconds
[0m11:24:39.629002 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m11:24:39.638016 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m11:24:39.639015 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m11:24:39.639536 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:24:40.301877 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.662 seconds
[0m11:24:40.305875 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m11:24:40.306868 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m11:24:40.440741 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.134 seconds
[0m11:24:40.442740 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m11:24:40.443739 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m11:24:40.579275 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.136 seconds
[0m11:24:40.584289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d3c798a-f0d9-49e3-89c9-ec3fbc850ef5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002168C4809D0>]}
[0m11:24:40.589806 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__categories
[0m11:24:40.589806 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_d365_fo__items
[0m11:24:40.589806 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_d365_fo__managers
[0m11:24:40.590828 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_inriver__item_attributes
[0m11:24:40.590828 [info ] [Thread-1 (]: 1 of 5 START sql view model broman_analytics.stg_d365_fo__categories ........... [RUN]
[0m11:24:40.591810 [info ] [Thread-2 (]: 2 of 5 START sql view model broman_analytics.stg_d365_fo__items ................ [RUN]
[0m11:24:40.592805 [info ] [Thread-3 (]: 3 of 5 START sql view model broman_analytics.stg_d365_fo__managers ............. [RUN]
[0m11:24:40.592805 [info ] [Thread-4 (]: 4 of 5 START sql view model broman_analytics.stg_inriver__item_attributes ...... [RUN]
[0m11:24:40.593805 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__categories'
[0m11:24:40.594812 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__items'
[0m11:24:40.594812 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__managers'
[0m11:24:40.595806 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_inriver__item_attributes'
[0m11:24:40.596808 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__categories
[0m11:24:40.596808 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_d365_fo__items
[0m11:24:40.597806 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_d365_fo__managers
[0m11:24:40.597806 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_inriver__item_attributes
[0m11:24:40.604327 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__categories"
[0m11:24:40.607331 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__items"
[0m11:24:40.611855 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__managers"
[0m11:24:40.615844 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_inriver__item_attributes"
[0m11:24:40.617831 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__categories
[0m11:24:40.618837 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_d365_fo__items
[0m11:24:40.619859 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_d365_fo__managers
[0m11:24:40.642935 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_inriver__item_attributes
[0m11:24:40.666979 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__categories"
[0m11:24:40.670491 [debug] [Thread-2 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__items"
[0m11:24:40.675487 [debug] [Thread-3 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__managers"
[0m11:24:40.682007 [debug] [Thread-4 (]: Writing runtime sql for node "model.epicaldemo.stg_inriver__item_attributes"
[0m11:24:40.686005 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__categories"
[0m11:24:40.688029 [debug] [Thread-3 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__managers"
[0m11:24:40.689011 [debug] [Thread-1 (]: On model.epicaldemo.stg_d365_fo__categories: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__categories"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__categories
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.category
),

final AS (
    SELECT
        id AS category_id
        ,INITCAP(name) AS "Category"
        ,managerid AS manager_id
    FROM source
)

SELECT * FROM final
  );
[0m11:24:40.690072 [debug] [Thread-4 (]: Using snowflake connection "model.epicaldemo.stg_inriver__item_attributes"
[0m11:24:40.691069 [debug] [Thread-2 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__items"
[0m11:24:40.692070 [debug] [Thread-3 (]: On model.epicaldemo.stg_d365_fo__managers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__managers"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__managers
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.manager
),

final as (
    SELECT
        id AS "manager_id"
        ,firstname || ' ' || lastname AS "Manager"
    FROM source
)

SELECT * FROM final
  );
[0m11:24:40.692070 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:24:40.693070 [debug] [Thread-4 (]: On model.epicaldemo.stg_inriver__item_attributes: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_inriver__item_attributes"} */
create or replace   view EPICALDEMO.broman_analytics.stg_inriver__item_attributes
  
   as (
    with

source as (
    select
        *
    from EPICALDEMO.inriver.item_attributes
),

final as (
    select
        id AS "item_attributes_id"
        ,sku AS "SKU"
        ,COALESCE(crunch_level, 'Missing') AS "Crunch Level"
        ,COALESCE(snack_time, 'Missing') AS "Snack Time"
    from source
)

select * from final
  );
[0m11:24:40.694083 [debug] [Thread-2 (]: On model.epicaldemo.stg_d365_fo__items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__items"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__items
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.item
),

final AS (
    SELECT
        id AS item_id
        ,name AS "Item"
        ,COALESCE(brand, 'Missing') AS "Brand"
        ,categoryid AS category_id
        ,COALESCE(flavor, 'Missing') AS "Flavor"
        ,sku AS "SKU"
    FROM source
)

SELECT * FROM final
  );
[0m11:24:40.694083 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:24:40.697068 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:24:40.698086 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:24:41.409713 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.715 seconds
[0m11:24:41.430787 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d3c798a-f0d9-49e3-89c9-ec3fbc850ef5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002168D67F210>]}
[0m11:24:41.431785 [info ] [Thread-3 (]: 3 of 5 OK created sql view model broman_analytics.stg_d365_fo__managers ........ [[32mSUCCESS 1[0m in 0.83s]
[0m11:24:41.432788 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_d365_fo__managers
[0m11:24:41.457159 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.760 seconds
[0m11:24:41.460670 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d3c798a-f0d9-49e3-89c9-ec3fbc850ef5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002168E47AC90>]}
[0m11:24:41.461669 [info ] [Thread-2 (]: 2 of 5 OK created sql view model broman_analytics.stg_d365_fo__items ........... [[32mSUCCESS 1[0m in 0.87s]
[0m11:24:41.462675 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_d365_fo__items
[0m11:24:41.550140 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.853 seconds
[0m11:24:41.553139 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d3c798a-f0d9-49e3-89c9-ec3fbc850ef5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002168E5FA250>]}
[0m11:24:41.553139 [info ] [Thread-4 (]: 4 of 5 OK created sql view model broman_analytics.stg_inriver__item_attributes . [[32mSUCCESS 1[0m in 0.96s]
[0m11:24:41.555158 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.862 seconds
[0m11:24:41.555158 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_inriver__item_attributes
[0m11:24:41.557150 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d3c798a-f0d9-49e3-89c9-ec3fbc850ef5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002168E08FCD0>]}
[0m11:24:41.558656 [info ] [Thread-1 (]: 1 of 5 OK created sql view model broman_analytics.stg_d365_fo__categories ...... [[32mSUCCESS 1[0m in 0.96s]
[0m11:24:41.569709 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__categories
[0m11:24:41.571710 [debug] [Thread-3 (]: Began running node model.epicaldemo.dim_items
[0m11:24:41.572708 [info ] [Thread-3 (]: 5 of 5 START sql table model broman_analytics.dim_items ........................ [RUN]
[0m11:24:41.573706 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__managers, now model.epicaldemo.dim_items)
[0m11:24:41.574706 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.dim_items
[0m11:24:41.578706 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.dim_items"
[0m11:24:41.579812 [debug] [Thread-3 (]: Began executing node model.epicaldemo.dim_items
[0m11:24:41.603041 [debug] [Thread-3 (]: Writing runtime sql for node "model.epicaldemo.dim_items"
[0m11:24:41.606038 [debug] [Thread-3 (]: Using snowflake connection "model.epicaldemo.dim_items"
[0m11:24:41.607038 [debug] [Thread-3 (]: On model.epicaldemo.dim_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_items"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_items
    

    
    as (with

items AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__items
),

item_attributes AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_inriver__item_attributes
),

categories AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__categories
),

managers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__managers
),

unknown AS (
    SELECT
        -1 AS item_id
        ,'Unknown' AS "SKU"
        ,'Unknown' AS "Item"
        ,'Missing' AS "Brand"
        ,'Missing' AS "Flavor"
        ,'Missing' AS "Crunch Level"
        ,'Missing' AS "Snack Time"
        ,'Missing' AS "Category"
        ,'Missing' AS "Manager"
),

missing AS (
    SELECT
        -2 AS item_id
        ,'Missing' AS "SKU"
        ,'Missing' AS "Item"
        ,'Missing' AS "Brand"
        ,'Missing' AS "Flavor"
        ,'Missing' AS "Crunch Level"
        ,'Missing' AS "Snack Time"
        ,'Missing' AS "Category"
        ,'Missing' AS "Manager"
),

final AS (
    SELECT
        items.item_id
        ,items."SKU"
        ,items."Item"
        ,items."Brand"
        ,items."Flavor"
        ,COALESCE(item_attributes."Crunch Level", 'Missing') AS "Crunch Level"
        ,COALESCE(item_attributes."Snack Time", 'Missing') AS "Snack Time"
        ,categories."Category"
        ,managers."Manager"
    FROM items
    LEFT JOIN item_attributes ON item_attributes."SKU" = items."SKU"
    LEFT JOIN categories ON categories."category_id" = items."category_id"
    LEFT JOIN managers ON managers."manager_id" = categories."manager_id"

    UNION

    SELECT * FROM unknown

    UNION

    SELECT * FROM missing
)

SELECT * FROM final
    )
;
[0m11:24:41.966423 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01bceed4-0004-ce00-0000-d2e9000267be
[0m11:24:41.966423 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 70 at position 28
invalid identifier 'CATEGORIES."category_id"'
[0m11:24:41.969927 [debug] [Thread-3 (]: Database Error in model dim_items (models\mart\dimensions\dim_items.sql)
  000904 (42000): SQL compilation error: error line 70 at position 28
  invalid identifier 'CATEGORIES."category_id"'
  compiled code at target\run\epicaldemo\models\mart\dimensions\dim_items.sql
[0m11:24:41.970924 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d3c798a-f0d9-49e3-89c9-ec3fbc850ef5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002168E362850>]}
[0m11:24:41.971926 [error] [Thread-3 (]: 5 of 5 ERROR creating sql table model broman_analytics.dim_items ............... [[31mERROR[0m in 0.40s]
[0m11:24:41.972926 [debug] [Thread-3 (]: Finished running node model.epicaldemo.dim_items
[0m11:24:41.972926 [debug] [Thread-7 (]: Marking all children of 'model.epicaldemo.dim_items' to be skipped because of status 'error'.  Reason: Database Error in model dim_items (models\mart\dimensions\dim_items.sql)
  000904 (42000): SQL compilation error: error line 70 at position 28
  invalid identifier 'CATEGORIES."category_id"'
  compiled code at target\run\epicaldemo\models\mart\dimensions\dim_items.sql.
[0m11:24:41.974927 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:24:41.974927 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m11:24:41.975929 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m11:24:42.141616 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m11:24:42.142615 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m11:24:42.305965 [debug] [MainThread]: Connection 'model.epicaldemo.stg_d365_fo__categories' was left open.
[0m11:24:42.305965 [debug] [MainThread]: On model.epicaldemo.stg_d365_fo__categories: Close
[0m11:24:42.465735 [debug] [MainThread]: Connection 'model.epicaldemo.stg_d365_fo__items' was left open.
[0m11:24:42.466734 [debug] [MainThread]: On model.epicaldemo.stg_d365_fo__items: Close
[0m11:24:42.618062 [debug] [MainThread]: Connection 'model.epicaldemo.dim_items' was left open.
[0m11:24:42.619061 [debug] [MainThread]: On model.epicaldemo.dim_items: Close
[0m11:24:42.788877 [debug] [MainThread]: Connection 'model.epicaldemo.stg_inriver__item_attributes' was left open.
[0m11:24:42.788877 [debug] [MainThread]: On model.epicaldemo.stg_inriver__item_attributes: Close
[0m11:24:42.946768 [info ] [MainThread]: 
[0m11:24:42.947756 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0 hours 0 minutes and 4.18 seconds (4.18s).
[0m11:24:42.949991 [debug] [MainThread]: Command end result
[0m11:24:42.972035 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m11:24:42.976030 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m11:24:42.981257 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m11:24:42.982259 [info ] [MainThread]: 
[0m11:24:42.983257 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:24:42.984259 [info ] [MainThread]: 
[0m11:24:42.985258 [error] [MainThread]:   Database Error in model dim_items (models\mart\dimensions\dim_items.sql)
  000904 (42000): SQL compilation error: error line 70 at position 28
  invalid identifier 'CATEGORIES."category_id"'
  compiled code at target\run\epicaldemo\models\mart\dimensions\dim_items.sql
[0m11:24:42.985258 [info ] [MainThread]: 
[0m11:24:42.986257 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m11:24:42.987258 [debug] [MainThread]: Command `dbt run` failed at 11:24:42.987258 after 5.37 seconds
[0m11:24:42.987258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021686872E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002168C46B950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002168C46B710>]}
[0m11:24:42.987258 [debug] [MainThread]: Flushing usage events
[0m11:24:43.631879 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:25:35.750596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DC3E73850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DC3E72C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DC3E73E10>]}


============================== 11:25:35.755594 | 4174d628-c2d0-4cf3-bf65-53092ee1ab95 ==============================
[0m11:25:35.755594 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:25:35.756596 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -s +dim_items', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:25:36.166391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4174d628-c2d0-4cf3-bf65-53092ee1ab95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DC3F5B750>]}
[0m11:25:36.209122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4174d628-c2d0-4cf3-bf65-53092ee1ab95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DC3E7F750>]}
[0m11:25:36.211127 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m11:25:36.520986 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:25:36.714795 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:25:36.714795 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:25:36.720322 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m11:25:36.757934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4174d628-c2d0-4cf3-bf65-53092ee1ab95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DC519B2D0>]}
[0m11:25:36.834796 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m11:25:36.838786 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m11:25:36.858777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4174d628-c2d0-4cf3-bf65-53092ee1ab95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DC56BC810>]}
[0m11:25:36.859284 [info ] [MainThread]: Found 13 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m11:25:36.860289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4174d628-c2d0-4cf3-bf65-53092ee1ab95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DC42A29D0>]}
[0m11:25:36.862302 [info ] [MainThread]: 
[0m11:25:36.863290 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:25:36.864290 [info ] [MainThread]: 
[0m11:25:36.864290 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:25:36.868802 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m11:25:36.953086 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m11:25:36.954098 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m11:25:36.954098 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:25:37.745254 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.791 seconds
[0m11:25:37.747260 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m11:25:37.756788 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m11:25:37.757789 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m11:25:37.757789 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:25:38.246148 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.488 seconds
[0m11:25:38.249977 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m11:25:38.250966 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m11:25:38.380878 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.130 seconds
[0m11:25:38.382877 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m11:25:38.382877 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m11:25:38.492802 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.109 seconds
[0m11:25:38.495803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4174d628-c2d0-4cf3-bf65-53092ee1ab95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DC51A9B50>]}
[0m11:25:38.500292 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__categories
[0m11:25:38.500292 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_d365_fo__items
[0m11:25:38.501302 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_d365_fo__managers
[0m11:25:38.501302 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_inriver__item_attributes
[0m11:25:38.502301 [info ] [Thread-1 (]: 1 of 5 START sql view model broman_analytics.stg_d365_fo__categories ........... [RUN]
[0m11:25:38.502301 [info ] [Thread-2 (]: 2 of 5 START sql view model broman_analytics.stg_d365_fo__items ................ [RUN]
[0m11:25:38.503292 [info ] [Thread-3 (]: 3 of 5 START sql view model broman_analytics.stg_d365_fo__managers ............. [RUN]
[0m11:25:38.503292 [info ] [Thread-4 (]: 4 of 5 START sql view model broman_analytics.stg_inriver__item_attributes ...... [RUN]
[0m11:25:38.504292 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__categories'
[0m11:25:38.505291 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__items'
[0m11:25:38.505291 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__managers'
[0m11:25:38.506291 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_inriver__item_attributes'
[0m11:25:38.506291 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__categories
[0m11:25:38.507291 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_d365_fo__items
[0m11:25:38.507291 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_d365_fo__managers
[0m11:25:38.507291 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_inriver__item_attributes
[0m11:25:38.513809 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__categories"
[0m11:25:38.516809 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__items"
[0m11:25:38.520008 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__managers"
[0m11:25:38.523007 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_inriver__item_attributes"
[0m11:25:38.524008 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__categories
[0m11:25:38.525009 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_d365_fo__items
[0m11:25:38.526013 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_d365_fo__managers
[0m11:25:38.547432 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_inriver__item_attributes
[0m11:25:38.550952 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__categories"
[0m11:25:38.553944 [debug] [Thread-2 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__items"
[0m11:25:38.557169 [debug] [Thread-3 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__managers"
[0m11:25:38.559676 [debug] [Thread-4 (]: Writing runtime sql for node "model.epicaldemo.stg_inriver__item_attributes"
[0m11:25:38.561678 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__categories"
[0m11:25:38.562677 [debug] [Thread-2 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__items"
[0m11:25:38.563683 [debug] [Thread-3 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__managers"
[0m11:25:38.563683 [debug] [Thread-1 (]: On model.epicaldemo.stg_d365_fo__categories: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__categories"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__categories
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.category
),

final AS (
    SELECT
        id AS category_id
        ,INITCAP(name) AS "Category"
        ,managerid AS manager_id
    FROM source
)

SELECT * FROM final
  );
[0m11:25:38.564682 [debug] [Thread-4 (]: Using snowflake connection "model.epicaldemo.stg_inriver__item_attributes"
[0m11:25:38.565679 [debug] [Thread-2 (]: On model.epicaldemo.stg_d365_fo__items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__items"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__items
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.item
),

final AS (
    SELECT
        id AS item_id
        ,name AS "Item"
        ,COALESCE(brand, 'Missing') AS "Brand"
        ,categoryid AS category_id
        ,COALESCE(flavor, 'Missing') AS "Flavor"
        ,sku AS "SKU"
    FROM source
)

SELECT * FROM final
  );
[0m11:25:38.565679 [debug] [Thread-3 (]: On model.epicaldemo.stg_d365_fo__managers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__managers"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__managers
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.manager
),

final as (
    SELECT
        id AS manager_id
        ,firstname || ' ' || lastname AS "Manager"
    FROM source
)

SELECT * FROM final
  );
[0m11:25:38.566677 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:25:38.566677 [debug] [Thread-4 (]: On model.epicaldemo.stg_inriver__item_attributes: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_inriver__item_attributes"} */
create or replace   view EPICALDEMO.broman_analytics.stg_inriver__item_attributes
  
   as (
    with

source as (
    select
        *
    from EPICALDEMO.inriver.item_attributes
),

final as (
    select
        id AS "item_attributes_id"
        ,sku AS "SKU"
        ,COALESCE(crunch_level, 'Missing') AS "Crunch Level"
        ,COALESCE(snack_time, 'Missing') AS "Snack Time"
    from source
)

select * from final
  );
[0m11:25:38.567687 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:25:38.567687 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:25:38.570722 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:25:39.321017 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.754 seconds
[0m11:25:39.341068 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.773 seconds
[0m11:25:39.342073 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.774 seconds
[0m11:25:39.344060 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4174d628-c2d0-4cf3-bf65-53092ee1ab95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DC5F81CD0>]}
[0m11:25:39.344060 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4174d628-c2d0-4cf3-bf65-53092ee1ab95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DC5F8A910>]}
[0m11:25:39.345060 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4174d628-c2d0-4cf3-bf65-53092ee1ab95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DC621D090>]}
[0m11:25:39.346564 [info ] [Thread-1 (]: 1 of 5 OK created sql view model broman_analytics.stg_d365_fo__categories ...... [[32mSUCCESS 1[0m in 0.83s]
[0m11:25:39.347569 [info ] [Thread-3 (]: 3 of 5 OK created sql view model broman_analytics.stg_d365_fo__managers ........ [[32mSUCCESS 1[0m in 0.84s]
[0m11:25:39.347569 [info ] [Thread-2 (]: 2 of 5 OK created sql view model broman_analytics.stg_d365_fo__items ........... [[32mSUCCESS 1[0m in 0.84s]
[0m11:25:39.349073 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__categories
[0m11:25:39.350078 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_d365_fo__managers
[0m11:25:39.350078 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_d365_fo__items
[0m11:25:39.399820 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.829 seconds
[0m11:25:39.401819 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4174d628-c2d0-4cf3-bf65-53092ee1ab95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DC5F7CCD0>]}
[0m11:25:39.402819 [info ] [Thread-4 (]: 4 of 5 OK created sql view model broman_analytics.stg_inriver__item_attributes . [[32mSUCCESS 1[0m in 0.90s]
[0m11:25:39.402819 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_inriver__item_attributes
[0m11:25:39.403819 [debug] [Thread-1 (]: Began running node model.epicaldemo.dim_items
[0m11:25:39.404818 [info ] [Thread-1 (]: 5 of 5 START sql table model broman_analytics.dim_items ........................ [RUN]
[0m11:25:39.404818 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__categories, now model.epicaldemo.dim_items)
[0m11:25:39.405818 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.dim_items
[0m11:25:39.409325 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.dim_items"
[0m11:25:39.410338 [debug] [Thread-1 (]: Began executing node model.epicaldemo.dim_items
[0m11:25:39.432031 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.dim_items"
[0m11:25:39.435029 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.dim_items"
[0m11:25:39.436029 [debug] [Thread-1 (]: On model.epicaldemo.dim_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_items"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_items
    

    
    as (with

items AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__items
),

item_attributes AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_inriver__item_attributes
),

categories AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__categories
),

managers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__managers
),

unknown AS (
    SELECT
        -1 AS item_id
        ,'Unknown' AS "SKU"
        ,'Unknown' AS "Item"
        ,'Missing' AS "Brand"
        ,'Missing' AS "Flavor"
        ,'Missing' AS "Crunch Level"
        ,'Missing' AS "Snack Time"
        ,'Missing' AS "Category"
        ,'Missing' AS "Manager"
),

missing AS (
    SELECT
        -2 AS item_id
        ,'Missing' AS "SKU"
        ,'Missing' AS "Item"
        ,'Missing' AS "Brand"
        ,'Missing' AS "Flavor"
        ,'Missing' AS "Crunch Level"
        ,'Missing' AS "Snack Time"
        ,'Missing' AS "Category"
        ,'Missing' AS "Manager"
),

final AS (
    SELECT
        items.item_id
        ,items."SKU"
        ,items."Item"
        ,items."Brand"
        ,items."Flavor"
        ,COALESCE(item_attributes."Crunch Level", 'Missing') AS "Crunch Level"
        ,COALESCE(item_attributes."Snack Time", 'Missing') AS "Snack Time"
        ,categories."Category"
        ,managers."Manager"
    FROM items
    LEFT JOIN item_attributes ON item_attributes."SKU" = items."SKU"
    LEFT JOIN categories ON categories.category_id = items.category_id
    LEFT JOIN managers ON managers.manager_id = categories.manager_id

    UNION

    SELECT * FROM unknown

    UNION

    SELECT * FROM missing
)

SELECT * FROM final
    )
;
[0m11:25:40.442774 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.006 seconds
[0m11:25:40.444773 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4174d628-c2d0-4cf3-bf65-53092ee1ab95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DC62B3510>]}
[0m11:25:40.445766 [info ] [Thread-1 (]: 5 of 5 OK created sql table model broman_analytics.dim_items ................... [[32mSUCCESS 1[0m in 1.04s]
[0m11:25:40.446765 [debug] [Thread-1 (]: Finished running node model.epicaldemo.dim_items
[0m11:25:40.447766 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:25:40.448714 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m11:25:40.448714 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m11:25:40.614942 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m11:25:40.615949 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m11:25:40.772877 [debug] [MainThread]: Connection 'model.epicaldemo.dim_items' was left open.
[0m11:25:40.773878 [debug] [MainThread]: On model.epicaldemo.dim_items: Close
[0m11:25:40.928842 [debug] [MainThread]: Connection 'model.epicaldemo.stg_d365_fo__items' was left open.
[0m11:25:40.929851 [debug] [MainThread]: On model.epicaldemo.stg_d365_fo__items: Close
[0m11:25:41.088994 [debug] [MainThread]: Connection 'model.epicaldemo.stg_d365_fo__managers' was left open.
[0m11:25:41.089513 [debug] [MainThread]: On model.epicaldemo.stg_d365_fo__managers: Close
[0m11:25:41.245722 [debug] [MainThread]: Connection 'model.epicaldemo.stg_inriver__item_attributes' was left open.
[0m11:25:41.246734 [debug] [MainThread]: On model.epicaldemo.stg_inriver__item_attributes: Close
[0m11:25:41.398831 [info ] [MainThread]: 
[0m11:25:41.398831 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0 hours 0 minutes and 4.53 seconds (4.53s).
[0m11:25:41.400153 [debug] [MainThread]: Command end result
[0m11:25:41.420213 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m11:25:41.423214 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m11:25:41.428717 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m11:25:41.429726 [info ] [MainThread]: 
[0m11:25:41.430723 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:25:41.431729 [info ] [MainThread]: 
[0m11:25:41.432731 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m11:25:41.433728 [debug] [MainThread]: Command `dbt run` succeeded at 11:25:41.433728 after 5.75 seconds
[0m11:25:41.433728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DC3EB7710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DC5452D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DC3ED5CD0>]}
[0m11:25:41.434728 [debug] [MainThread]: Flushing usage events
[0m11:25:42.074695 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:31:37.812576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001519BF73050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001519BF71290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001519BF73490>]}


============================== 11:31:37.834629 | 5868d9d1-ffcb-47f9-a420-1729172eca97 ==============================
[0m11:31:37.834629 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:31:37.835628 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:31:40.416877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5868d9d1-ffcb-47f9-a420-1729172eca97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001519BF7B750>]}
[0m11:31:40.462027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5868d9d1-ffcb-47f9-a420-1729172eca97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001519D431690>]}
[0m11:31:40.470551 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m11:31:40.874707 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:31:41.063866 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:31:41.064865 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:31:41.071907 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m11:31:41.109577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5868d9d1-ffcb-47f9-a420-1729172eca97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001519DCDCED0>]}
[0m11:31:41.184862 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m11:31:41.200922 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m11:31:41.457926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5868d9d1-ffcb-47f9-a420-1729172eca97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001519DF57F10>]}
[0m11:31:41.458927 [info ] [MainThread]: Found 13 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m11:31:41.461952 [info ] [MainThread]: 
[0m11:31:41.461952 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:31:41.462952 [info ] [MainThread]: 
[0m11:31:41.462952 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:31:41.467952 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m11:31:44.200918 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m11:31:44.201917 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m11:31:44.201917 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:31:45.073001 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.871 seconds
[0m11:31:45.075988 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m11:31:45.085027 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m11:31:45.086018 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m11:31:45.087019 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:31:45.729471 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.643 seconds
[0m11:31:45.732483 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m11:31:45.733484 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m11:31:45.895415 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.162 seconds
[0m11:31:45.897416 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m11:31:45.897416 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m11:31:46.012961 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.114 seconds
[0m11:31:46.015955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5868d9d1-ffcb-47f9-a420-1729172eca97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001519D439210>]}
[0m11:31:46.021455 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__categories
[0m11:31:46.021455 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_d365_fo__dates
[0m11:31:46.021455 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_d365_fo__items
[0m11:31:46.022474 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_d365_fo__managers
[0m11:31:46.022474 [info ] [Thread-1 (]: 1 of 14 START sql view model broman_analytics.stg_d365_fo__categories .......... [RUN]
[0m11:31:46.023457 [info ] [Thread-2 (]: 2 of 14 START sql view model broman_analytics.stg_d365_fo__dates ............... [RUN]
[0m11:31:46.023457 [info ] [Thread-3 (]: 3 of 14 START sql view model broman_analytics.stg_d365_fo__items ............... [RUN]
[0m11:31:46.024455 [info ] [Thread-4 (]: 4 of 14 START sql view model broman_analytics.stg_d365_fo__managers ............ [RUN]
[0m11:31:46.024455 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__categories'
[0m11:31:46.025470 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__dates'
[0m11:31:46.026456 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__items'
[0m11:31:46.026456 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__managers'
[0m11:31:46.027457 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__categories
[0m11:31:46.027457 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_d365_fo__dates
[0m11:31:46.027457 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_d365_fo__items
[0m11:31:46.028963 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_d365_fo__managers
[0m11:31:46.034971 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__categories"
[0m11:31:46.037968 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__dates"
[0m11:31:46.040322 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__items"
[0m11:31:46.043331 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__managers"
[0m11:31:46.044323 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__categories
[0m11:31:46.045321 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_d365_fo__dates
[0m11:31:46.045321 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_d365_fo__items
[0m11:31:46.069378 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__categories"
[0m11:31:46.070385 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_d365_fo__managers
[0m11:31:46.074476 [debug] [Thread-2 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__dates"
[0m11:31:46.077390 [debug] [Thread-3 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__items"
[0m11:31:46.080904 [debug] [Thread-4 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__managers"
[0m11:31:46.081900 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__categories"
[0m11:31:46.083900 [debug] [Thread-2 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__dates"
[0m11:31:46.084900 [debug] [Thread-1 (]: On model.epicaldemo.stg_d365_fo__categories: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__categories"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__categories
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.category
),

final AS (
    SELECT
        id AS "category_id"
        ,INITCAP(name) AS "Category"
        ,managerid AS "manager_id"
    FROM source
)

SELECT * FROM final
  );
[0m11:31:46.085899 [debug] [Thread-3 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__items"
[0m11:31:46.085899 [debug] [Thread-4 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__managers"
[0m11:31:46.086911 [debug] [Thread-2 (]: On model.epicaldemo.stg_d365_fo__dates: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__dates"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__dates
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.date
),

final AS (
    SELECT
        id AS "date_id"
        ,date AS "Date"
        ,year AS "Year"
        ,yearmonth AS "Year Month"
        ,monthnumber AS "Month Number"
        ,quarter AS "Quarter"
        ,quarternumber AS "Quarter Number"
        ,monthname AS "Month"
    FROM source
)

SELECT * FROM final
  );
[0m11:31:46.086911 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:31:46.087899 [debug] [Thread-3 (]: On model.epicaldemo.stg_d365_fo__items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__items"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__items
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.item
),

final AS (
    SELECT
        id AS "item_id"
        ,name AS "Item"
        ,COALESCE(brand, 'Missing') AS "Brand"
        ,categoryid AS "category_id"
        ,COALESCE(flavor, 'Missing') AS "Flavor"
        ,sku AS "SKU"
    FROM source
)

SELECT * FROM final
  );
[0m11:31:46.087899 [debug] [Thread-4 (]: On model.epicaldemo.stg_d365_fo__managers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__managers"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__managers
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.manager
),

final as (
    SELECT
        id AS "manager_id"
        ,firstname || ' ' || lastname AS "Manager"
    FROM source
)

SELECT * FROM final
  );
[0m11:31:46.088901 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:31:46.090430 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:31:46.091425 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:31:46.657270 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.570 seconds
[0m11:31:46.677837 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.588 seconds
[0m11:31:46.686892 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5868d9d1-ffcb-47f9-a420-1729172eca97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001519D4C96D0>]}
[0m11:31:46.687879 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5868d9d1-ffcb-47f9-a420-1729172eca97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001519E621510>]}
[0m11:31:46.687879 [info ] [Thread-1 (]: 1 of 14 OK created sql view model broman_analytics.stg_d365_fo__categories ..... [[32mSUCCESS 1[0m in 0.65s]
[0m11:31:46.689912 [info ] [Thread-3 (]: 3 of 14 OK created sql view model broman_analytics.stg_d365_fo__items .......... [[32mSUCCESS 1[0m in 0.66s]
[0m11:31:46.689912 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__categories
[0m11:31:46.690927 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_d365_fo__items
[0m11:31:46.691934 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__transactions
[0m11:31:46.691934 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_inriver__item_attributes
[0m11:31:46.692934 [info ] [Thread-1 (]: 5 of 14 START sql view model broman_analytics.stg_d365_fo__transactions ........ [RUN]
[0m11:31:46.692934 [info ] [Thread-3 (]: 6 of 14 START sql view model broman_analytics.stg_inriver__item_attributes ..... [RUN]
[0m11:31:46.693933 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__categories, now model.epicaldemo.stg_d365_fo__transactions)
[0m11:31:46.694937 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__items, now model.epicaldemo.stg_inriver__item_attributes)
[0m11:31:46.694937 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__transactions
[0m11:31:46.695933 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_inriver__item_attributes
[0m11:31:46.698933 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__transactions"
[0m11:31:46.701445 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_inriver__item_attributes"
[0m11:31:46.703450 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__transactions
[0m11:31:46.704446 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_inriver__item_attributes
[0m11:31:46.707445 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__transactions"
[0m11:31:46.709976 [debug] [Thread-3 (]: Writing runtime sql for node "model.epicaldemo.stg_inriver__item_attributes"
[0m11:31:46.710980 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__transactions"
[0m11:31:46.711977 [debug] [Thread-3 (]: Using snowflake connection "model.epicaldemo.stg_inriver__item_attributes"
[0m11:31:46.711977 [debug] [Thread-1 (]: On model.epicaldemo.stg_d365_fo__transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__transactions"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__transactions
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.transactions
),

final AS (
    SELECT
        -- Identifiers
        CAST(TO_CHAR(date::DATE, 'YYYYMMDD') AS INTEGER) AS "date_id"
        ,sku AS "SKU"
        ,store AS "Store"
        ,customernumber AS "Customer Number"

        -- Metrics
        ,quantity AS "Qty"
        ,unitprice::NUMERIC(10,2) AS "Unit Price"
        ,(quantity * unitprice)::NUMERIC(10,2) AS "Sales Amount"
        ,unitcost::NUMERIC(10,2) AS "Unit Cost"
        ,(quantity * unitcost)::NUMERIC(10,2) AS "Cost"
        ,(quantity * unitprice)::NUMERIC(10,2) - (quantity * unitcost)::NUMERIC(10,2) AS "Margin"
    FROM source
)

SELECT * FROM final
  );
[0m11:31:46.712974 [debug] [Thread-3 (]: On model.epicaldemo.stg_inriver__item_attributes: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_inriver__item_attributes"} */
create or replace   view EPICALDEMO.broman_analytics.stg_inriver__item_attributes
  
   as (
    with

source as (
    select
        *
    from EPICALDEMO.inriver.item_attributes
),

final as (
    select
        id AS "item_attributes_id"
        ,sku AS "SKU"
        ,COALESCE(crunch_level, 'Missing') AS "Crunch Level"
        ,COALESCE(snack_time, 'Missing') AS "Snack Time"
    from source
)

select * from final
  );
[0m11:31:46.730540 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.642 seconds
[0m11:31:46.732542 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5868d9d1-ffcb-47f9-a420-1729172eca97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001519E2DE850>]}
[0m11:31:46.733542 [info ] [Thread-2 (]: 2 of 14 OK created sql view model broman_analytics.stg_d365_fo__dates .......... [[32mSUCCESS 1[0m in 0.71s]
[0m11:31:46.735540 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_d365_fo__dates
[0m11:31:46.735540 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_salesforce__customers
[0m11:31:46.736544 [info ] [Thread-2 (]: 7 of 14 START sql view model broman_analytics.stg_salesforce__customers ........ [RUN]
[0m11:31:46.737540 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__dates, now model.epicaldemo.stg_salesforce__customers)
[0m11:31:46.738537 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_salesforce__customers
[0m11:31:46.742560 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_salesforce__customers"
[0m11:31:46.743559 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_salesforce__customers
[0m11:31:46.745559 [debug] [Thread-2 (]: Writing runtime sql for node "model.epicaldemo.stg_salesforce__customers"
[0m11:31:46.747560 [debug] [Thread-2 (]: Using snowflake connection "model.epicaldemo.stg_salesforce__customers"
[0m11:31:46.748565 [debug] [Thread-2 (]: On model.epicaldemo.stg_salesforce__customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_salesforce__customers"} */
create or replace   view EPICALDEMO.broman_analytics.stg_salesforce__customers
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.salesforce.customer
),

final AS (
    SELECT
        id AS "customer_id"
        ,customernumber AS "Customer Number"
        ,age AS "Customer Age"

        ,CASE
            WHEN age < 20 THEN '< 20'
            WHEN age >= 20 AND age < 30 THEN '20 - 30'
            WHEN age >= 30 AND age < 50 THEN '30 - 50'
            WHEN age >= 50 AND age < 60 THEN '50 - 60'
            ELSE '60+'
         END AS "Customer Age Group"

        ,CASE
            WHEN age < 20 THEN 1
            WHEN age >= 20 AND age < 30 THEN 2
            WHEN age >= 30 AND age < 50 THEN 3
            WHEN age >= 50 AND age < 60 THEN 4
            ELSE 5
         END AS "customer_age_group_sort"

        ,state AS "Customer State"
    FROM source
)

SELECT * FROM final
  );
[0m11:31:46.869780 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.778 seconds
[0m11:31:46.871790 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5868d9d1-ffcb-47f9-a420-1729172eca97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001519E3DA990>]}
[0m11:31:46.877781 [info ] [Thread-4 (]: 4 of 14 OK created sql view model broman_analytics.stg_d365_fo__managers ....... [[32mSUCCESS 1[0m in 0.85s]
[0m11:31:46.878781 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_d365_fo__managers
[0m11:31:46.878781 [debug] [Thread-4 (]: Began running node snapshot.epicaldemo.stores_snapshot
[0m11:31:46.880263 [info ] [Thread-4 (]: 8 of 14 START snapshot broman_analytics.stores_snapshot ........................ [RUN]
[0m11:31:46.880263 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__managers, now snapshot.epicaldemo.stores_snapshot)
[0m11:31:46.881265 [debug] [Thread-4 (]: Began compiling node snapshot.epicaldemo.stores_snapshot
[0m11:31:46.884271 [debug] [Thread-4 (]: Began executing node snapshot.epicaldemo.stores_snapshot
[0m11:31:46.920050 [debug] [Thread-4 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m11:31:46.922052 [debug] [Thread-4 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
[0m11:31:46.956687 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.242 seconds
[0m11:31:46.959205 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5868d9d1-ffcb-47f9-a420-1729172eca97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001519E6D7F50>]}
[0m11:31:46.959205 [info ] [Thread-3 (]: 6 of 14 OK created sql view model broman_analytics.stg_inriver__item_attributes  [[32mSUCCESS 1[0m in 0.26s]
[0m11:31:46.960225 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_inriver__item_attributes
[0m11:31:46.961213 [debug] [Thread-3 (]: Began running node model.epicaldemo.dim_dates
[0m11:31:46.961213 [info ] [Thread-3 (]: 9 of 14 START sql table model broman_analytics.dim_dates ....................... [RUN]
[0m11:31:46.962672 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_inriver__item_attributes, now model.epicaldemo.dim_dates)
[0m11:31:46.962672 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.dim_dates
[0m11:31:46.965685 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.dim_dates"
[0m11:31:46.966685 [debug] [Thread-3 (]: Began executing node model.epicaldemo.dim_dates
[0m11:31:46.990339 [debug] [Thread-3 (]: Writing runtime sql for node "model.epicaldemo.dim_dates"
[0m11:31:46.994153 [debug] [Thread-3 (]: Using snowflake connection "model.epicaldemo.dim_dates"
[0m11:31:46.995151 [debug] [Thread-3 (]: On model.epicaldemo.dim_dates: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_dates"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_dates
    

    
    as (with

dates AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__dates
),

final AS (
    SELECT
        "date_id"
        ,"Date"
        ,"Year"
        ,"Year Month"
        ,LEFT(date_id::TEXT, 6) AS "Year Month Number"
        ,"Month Number"
        ,"Quarter"
        ,"Quarter Number"
        ,"Month"
        ,LEFT("Month",3) AS "Month Short"
    FROM dates
)

SELECT * FROM final
    )
;
[0m11:31:47.022839 [debug] [Thread-4 (]: SQL status: SUCCESS 11 in 0.101 seconds
[0m11:31:47.064466 [debug] [Thread-4 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m11:31:47.065457 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.316 seconds
[0m11:31:47.066458 [debug] [Thread-4 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
create or replace temporary table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp"
as (
    
    
    with snapshot_query as (

        select * from EPICALDEMO.d365_fo.store

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            
  
  coalesce(nullif(modified, modified), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            modified as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.modified)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.modified)
        )
    )

    select * from insertions
    union all
    select * from updates

    )
;
[0m11:31:47.067460 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5868d9d1-ffcb-47f9-a420-1729172eca97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001519DF6D350>]}
[0m11:31:47.068967 [info ] [Thread-2 (]: 7 of 14 OK created sql view model broman_analytics.stg_salesforce__customers ... [[32mSUCCESS 1[0m in 0.33s]
[0m11:31:47.070973 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_salesforce__customers
[0m11:31:47.071973 [debug] [Thread-2 (]: Began running node model.epicaldemo.dim_items
[0m11:31:47.071973 [info ] [Thread-2 (]: 10 of 14 START sql table model broman_analytics.dim_items ...................... [RUN]
[0m11:31:47.072974 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_salesforce__customers, now model.epicaldemo.dim_items)
[0m11:31:47.073974 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.dim_items
[0m11:31:47.076976 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.dim_items"
[0m11:31:47.077972 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.364 seconds
[0m11:31:47.080260 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5868d9d1-ffcb-47f9-a420-1729172eca97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001519E740490>]}
[0m11:31:47.081259 [debug] [Thread-2 (]: Began executing node model.epicaldemo.dim_items
[0m11:31:47.081259 [info ] [Thread-1 (]: 5 of 14 OK created sql view model broman_analytics.stg_d365_fo__transactions ... [[32mSUCCESS 1[0m in 0.39s]
[0m11:31:47.085261 [debug] [Thread-2 (]: Writing runtime sql for node "model.epicaldemo.dim_items"
[0m11:31:47.085261 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__transactions
[0m11:31:47.086274 [debug] [Thread-1 (]: Began running node model.epicaldemo.dim_customers
[0m11:31:47.088770 [debug] [Thread-2 (]: Using snowflake connection "model.epicaldemo.dim_items"
[0m11:31:47.087261 [info ] [Thread-1 (]: 11 of 14 START sql table model broman_analytics.dim_customers .................. [RUN]
[0m11:31:47.089777 [debug] [Thread-2 (]: On model.epicaldemo.dim_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_items"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_items
    

    
    as (with

items AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__items
),

item_attributes AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_inriver__item_attributes
),

categories AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__categories
),

managers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__managers
),

unknown AS (
    SELECT
        -1 AS "item_id"
        ,'Unknown' AS "SKU"
        ,'Unknown' AS "Item"
        ,'Missing' AS "Brand"
        ,'Missing' AS "Flavor"
        ,'Missing' AS "Crunch Level"
        ,'Missing' AS "Snack Time"
        ,'Missing' AS "Category"
        ,'Missing' AS "Manager"
),

missing AS (
    SELECT
        -2 AS "item_id"
        ,'Missing' AS "SKU"
        ,'Missing' AS "Item"
        ,'Missing' AS "Brand"
        ,'Missing' AS "Flavor"
        ,'Missing' AS "Crunch Level"
        ,'Missing' AS "Snack Time"
        ,'Missing' AS "Category"
        ,'Missing' AS "Manager"
),

final AS (
    SELECT
        items."item_id"
        ,items."SKU"
        ,items."Item"
        ,items."Brand"
        ,items."Flavor"
        ,COALESCE(item_attributes."Crunch Level", 'Missing') AS "Crunch Level"
        ,COALESCE(item_attributes."Snack Time", 'Missing') AS "Snack Time"
        ,categories."Category"
        ,managers."Manager"
    FROM items
    LEFT JOIN item_attributes ON item_attributes."SKU" = items."SKU"
    LEFT JOIN categories ON categories."category_id" = items."category_id"
    LEFT JOIN managers ON managers."manager_id" = categories."manager_id"

    UNION

    SELECT * FROM unknown

    UNION

    SELECT * FROM missing
)

SELECT * FROM final
    )
;
[0m11:31:47.089777 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__transactions, now model.epicaldemo.dim_customers)
[0m11:31:47.090776 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.dim_customers
[0m11:31:47.093777 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.dim_customers"
[0m11:31:47.094777 [debug] [Thread-1 (]: Began executing node model.epicaldemo.dim_customers
[0m11:31:47.098790 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.dim_customers"
[0m11:31:47.099824 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.dim_customers"
[0m11:31:47.100829 [debug] [Thread-1 (]: On model.epicaldemo.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_customers"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_customers
    

    
    as (WITH

customers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_salesforce__customers
),

final AS (
    SELECT
        "customer_id"
        ,"Customer Number"
        ,"Customer Age"
        ,"Customer Age Group"
        ,"customer_age_group_sort"
        ,"Customer State"
    FROM customers
)

SELECT * FROM final
    )
;
[0m11:31:47.268793 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01bceedb-0004-ce01-0000-d2e900024afa
[0m11:31:47.268793 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 19 at position 14
invalid identifier 'DATE_ID'
[0m11:31:47.272810 [debug] [Thread-3 (]: Database Error in model dim_dates (models\mart\dimensions\dim_dates.sql)
  000904 (42000): SQL compilation error: error line 19 at position 14
  invalid identifier 'DATE_ID'
  compiled code at target\run\epicaldemo\models\mart\dimensions\dim_dates.sql
[0m11:31:47.272810 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5868d9d1-ffcb-47f9-a420-1729172eca97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001519E29F750>]}
[0m11:31:47.273807 [error] [Thread-3 (]: 9 of 14 ERROR creating sql table model broman_analytics.dim_dates .............. [[31mERROR[0m in 0.31s]
[0m11:31:47.274802 [debug] [Thread-3 (]: Finished running node model.epicaldemo.dim_dates
[0m11:31:47.275801 [debug] [Thread-7 (]: Marking all children of 'model.epicaldemo.dim_dates' to be skipped because of status 'error'.  Reason: Database Error in model dim_dates (models\mart\dimensions\dim_dates.sql)
  000904 (42000): SQL compilation error: error line 19 at position 14
  invalid identifier 'DATE_ID'
  compiled code at target\run\epicaldemo\models\mart\dimensions\dim_dates.sql.
[0m11:31:47.614920 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.547 seconds
[0m11:31:47.617924 [debug] [Thread-4 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m11:31:47.618923 [debug] [Thread-4 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp"
[0m11:31:47.727955 [debug] [Thread-4 (]: SQL status: SUCCESS 13 in 0.108 seconds
[0m11:31:47.731504 [debug] [Thread-4 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m11:31:47.731504 [debug] [Thread-4 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
[0m11:31:47.828982 [debug] [Thread-4 (]: SQL status: SUCCESS 11 in 0.097 seconds
[0m11:31:47.832518 [debug] [Thread-4 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m11:31:47.832518 [debug] [Thread-4 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp"
[0m11:31:47.837511 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.736 seconds
[0m11:31:47.839016 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5868d9d1-ffcb-47f9-a420-1729172eca97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001519E7C9050>]}
[0m11:31:47.840021 [info ] [Thread-1 (]: 11 of 14 OK created sql table model broman_analytics.dim_customers ............. [[32mSUCCESS 1[0m in 0.75s]
[0m11:31:47.841029 [debug] [Thread-1 (]: Finished running node model.epicaldemo.dim_customers
[0m11:31:47.917245 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.827 seconds
[0m11:31:47.919763 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5868d9d1-ffcb-47f9-a420-1729172eca97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001519E6AF610>]}
[0m11:31:47.920754 [info ] [Thread-2 (]: 10 of 14 OK created sql table model broman_analytics.dim_items ................. [[32mSUCCESS 1[0m in 0.85s]
[0m11:31:47.921755 [debug] [Thread-2 (]: Finished running node model.epicaldemo.dim_items
[0m11:31:47.963380 [debug] [Thread-4 (]: SQL status: SUCCESS 13 in 0.130 seconds
[0m11:31:47.967391 [debug] [Thread-4 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m11:31:47.968897 [debug] [Thread-4 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
[0m11:31:48.063702 [debug] [Thread-4 (]: SQL status: SUCCESS 11 in 0.094 seconds
[0m11:31:48.069224 [debug] [Thread-4 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m11:31:48.070243 [debug] [Thread-4 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp"
[0m11:31:48.169083 [debug] [Thread-4 (]: SQL status: SUCCESS 13 in 0.098 seconds
[0m11:31:48.186619 [debug] [Thread-4 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m11:31:48.186619 [debug] [Thread-4 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from EPICALDEMO.d365_fo.store

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            
  
  coalesce(nullif(modified, modified), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            modified as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.modified)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.modified)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m11:31:48.363840 [debug] [Thread-4 (]: SQL status: SUCCESS 0 in 0.176 seconds
[0m11:31:48.368827 [debug] [Thread-4 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m11:31:48.369346 [debug] [Thread-4 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m11:31:48.477759 [debug] [Thread-4 (]: SQL status: SUCCESS 0 in 0.108 seconds
[0m11:31:48.478769 [warn ] [Thread-4 (]: Data type of snapshot table timestamp columns (TIMESTAMP_NTZ) doesn't match derived column 'updated_at' (DATE). Please update snapshot config 'updated_at'.
[0m11:31:48.478769 [debug] [Thread-4 (]: Writing runtime sql for node "snapshot.epicaldemo.stores_snapshot"
[0m11:31:48.481071 [debug] [Thread-4 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m11:31:48.481071 [debug] [Thread-4 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
BEGIN
[0m11:31:48.595941 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.114 seconds
[0m11:31:48.595941 [debug] [Thread-4 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m11:31:48.596950 [debug] [Thread-4 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
merge into "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT" as DBT_INTERNAL_DEST
    using "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
	
	
	and ((DBT_INTERNAL_DEST.dbt_valid_to = to_date('9999-12-31'))
 or DBT_INTERNAL_DEST.dbt_valid_to is null)

     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("ID", "NAME", "LOCATION", "LATITUDE", "LONGITUDE", "ONLINEPRESENCE", "MODIFIED", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("ID", "NAME", "LOCATION", "LATITUDE", "LONGITUDE", "ONLINEPRESENCE", "MODIFIED", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m11:31:49.141074 [debug] [Thread-4 (]: SQL status: SUCCESS 0 in 0.543 seconds
[0m11:31:49.142070 [debug] [Thread-4 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m11:31:49.142070 [debug] [Thread-4 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
COMMIT
[0m11:31:49.381199 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.239 seconds
[0m11:31:49.385195 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5868d9d1-ffcb-47f9-a420-1729172eca97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001519E266190>]}
[0m11:31:49.386188 [info ] [Thread-4 (]: 8 of 14 OK snapshotted broman_analytics.stores_snapshot ........................ [[32mSUCCESS 0[0m in 2.50s]
[0m11:31:49.387187 [debug] [Thread-4 (]: Finished running node snapshot.epicaldemo.stores_snapshot
[0m11:31:49.387187 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_d365_fo__stores
[0m11:31:49.388690 [info ] [Thread-3 (]: 12 of 14 START sql view model broman_analytics.stg_d365_fo__stores ............. [RUN]
[0m11:31:49.388690 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.dim_dates, now model.epicaldemo.stg_d365_fo__stores)
[0m11:31:49.388690 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_d365_fo__stores
[0m11:31:49.391703 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__stores"
[0m11:31:49.392698 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_d365_fo__stores
[0m11:31:49.395698 [debug] [Thread-3 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__stores"
[0m11:31:49.396695 [debug] [Thread-3 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__stores"
[0m11:31:49.397695 [debug] [Thread-3 (]: On model.epicaldemo.stg_d365_fo__stores: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__stores"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__stores
  
   as (
    WITH

stores_snapshots AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stores_snapshot
),

final AS (
    SELECT
        id AS "store_id"
        ,dbt_scd_id AS "dbt_scd_id"

        ,ROW_NUMBER() OVER (ORDER BY id ASC, dbt_valid_from ASC) AS "store_key"

        ,CASE WHEN dbt_valid_to = '9999-12-31' THEN 1 ELSE 0 END AS "is_current"
        ,name AS "Store"
        ,SPLIT_PART(location, ',', 1) AS "Store State"
        ,SPLIT_PART(location, ',', 2) AS "Store City"
        ,latitude AS "Lat"
        ,longitude AS "Lon"
        ,onlinepresence AS "Online Presence"
        ,modified AS "modified"
        ,CAST(TO_CHAR(dbt_valid_from::DATE, 'YYYYMMDD') AS INTEGER) AS "valid_from"
        ,CAST(TO_CHAR(dbt_valid_to::DATE, 'YYYYMMDD') AS INTEGER) AS "valid_to"
    FROM stores_snapshots
)

SELECT * FROM final
  );
[0m11:31:49.695981 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.298 seconds
[0m11:31:49.697970 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5868d9d1-ffcb-47f9-a420-1729172eca97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001519E733250>]}
[0m11:31:49.698970 [info ] [Thread-3 (]: 12 of 14 OK created sql view model broman_analytics.stg_d365_fo__stores ........ [[32mSUCCESS 1[0m in 0.31s]
[0m11:31:49.699493 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_d365_fo__stores
[0m11:31:49.700502 [debug] [Thread-2 (]: Began running node model.epicaldemo.dim_stores
[0m11:31:49.700502 [debug] [Thread-4 (]: Began running node model.epicaldemo.fact_sales_transactions
[0m11:31:49.701501 [info ] [Thread-2 (]: 13 of 14 START sql table model broman_analytics.dim_stores ..................... [RUN]
[0m11:31:49.702501 [info ] [Thread-4 (]: 14 of 14 START sql table model broman_analytics.fact_sales_transactions ........ [RUN]
[0m11:31:49.702501 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.dim_items, now model.epicaldemo.dim_stores)
[0m11:31:49.703501 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly snapshot.epicaldemo.stores_snapshot, now model.epicaldemo.fact_sales_transactions)
[0m11:31:49.703501 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.dim_stores
[0m11:31:49.703501 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.fact_sales_transactions
[0m11:31:49.706510 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.dim_stores"
[0m11:31:49.710044 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.fact_sales_transactions"
[0m11:31:49.711034 [debug] [Thread-2 (]: Began executing node model.epicaldemo.dim_stores
[0m11:31:49.713046 [debug] [Thread-2 (]: Writing runtime sql for node "model.epicaldemo.dim_stores"
[0m11:31:49.713046 [debug] [Thread-4 (]: Began executing node model.epicaldemo.fact_sales_transactions
[0m11:31:49.716035 [debug] [Thread-4 (]: Writing runtime sql for node "model.epicaldemo.fact_sales_transactions"
[0m11:31:49.717035 [debug] [Thread-2 (]: Using snowflake connection "model.epicaldemo.dim_stores"
[0m11:31:49.717035 [debug] [Thread-2 (]: On model.epicaldemo.dim_stores: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_stores"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_stores
    

    
    as (with

store AS (
    select
        *
    from EPICALDEMO.broman_analytics.stg_d365_fo__stores
),

final AS (
    SELECT
        "store_key"
        ,"store_id"
        ,IS_CURRENT
        ,"Store"
        ,"Store State"
        ,"Store City"
        ,"Lat"
        ,"Lon"
        ,"Online Presence"
        ,MODIFIED
        ,"valid_from"
        ,"valid_to"
    from store
)

select * from final
    )
;
[0m11:31:49.719547 [debug] [Thread-4 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions"
[0m11:31:49.720546 [debug] [Thread-4 (]: On model.epicaldemo.fact_sales_transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions"} */
create or replace transient table EPICALDEMO.broman_analytics.fact_sales_transactions
    

    
    as (WITH

sales AS (
    select
        *
    from EPICALDEMO.broman_analytics.stg_d365_fo__transactions
),

items AS (
    select
        *
    from EPICALDEMO.broman_analytics.stg_d365_fo__items
),

stores AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__stores
),

customers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_salesforce__customers
),

final AS (
    SELECT
        -- Identifiers
        sales."date_id"

        ,CASE
            WHEN sales."SKU" IS NULL THEN -2 -- SKU is missing from Source
            WHEN items."item_id" IS NULL THEN -1 -- SKU is not known from Source
            ELSE items."item_id" -- Join item_id from Dim based on SKU
         END AS "item_id"

        ,CASE
            WHEN sales."Store" IS NULL THEN -2
            WHEN stores."store_key" IS NULL THEN -1
            ELSE stores."store_key"
         END AS "store_key"

        ,CASE
            WHEN sales."Customer Number" IS NULL THEN -2
            WHEN customers."customer_id" IS NULL THEN -1
            ELSE customers."customer_id"
         END AS "customer_id"

        -- Metrics
        ,sales."Qty"
        ,sales."Unit Price"
        ,sales."Sales Amount"
        ,sales."Unit Cost"
        ,sales."Cost"
        ,sales."Margin"
    FROM sales
    LEFT JOIN items ON items."SKU" = sales."SKU"
    LEFT JOIN stores ON stores."Store" = sales."Store" AND sales."date_id" >= stores."valid_from" AND sales."date_id" < stores."valid_to"
    LEFT JOIN customers ON customers."Customer Number" = sales."Customer Number"
)

SELECT * FROM final
    )
;
[0m11:31:49.870429 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01bceedb-0004-ce00-0000-d2e9000268c2
[0m11:31:49.871510 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 17 at position 9
invalid identifier 'IS_CURRENT'
[0m11:31:49.874523 [debug] [Thread-2 (]: Database Error in model dim_stores (models\mart\dimensions\dim_stores.sql)
  000904 (42000): SQL compilation error: error line 17 at position 9
  invalid identifier 'IS_CURRENT'
  compiled code at target\run\epicaldemo\models\mart\dimensions\dim_stores.sql
[0m11:31:49.874523 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5868d9d1-ffcb-47f9-a420-1729172eca97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001519E7A8450>]}
[0m11:31:49.875514 [error] [Thread-2 (]: 13 of 14 ERROR creating sql table model broman_analytics.dim_stores ............ [[31mERROR[0m in 0.17s]
[0m11:31:49.876518 [debug] [Thread-2 (]: Finished running node model.epicaldemo.dim_stores
[0m11:31:49.877525 [debug] [Thread-7 (]: Marking all children of 'model.epicaldemo.dim_stores' to be skipped because of status 'error'.  Reason: Database Error in model dim_stores (models\mart\dimensions\dim_stores.sql)
  000904 (42000): SQL compilation error: error line 17 at position 9
  invalid identifier 'IS_CURRENT'
  compiled code at target\run\epicaldemo\models\mart\dimensions\dim_stores.sql.
[0m11:31:51.203066 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.482 seconds
[0m11:31:51.206078 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5868d9d1-ffcb-47f9-a420-1729172eca97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001519E7454D0>]}
[0m11:31:51.207066 [info ] [Thread-4 (]: 14 of 14 OK created sql table model broman_analytics.fact_sales_transactions ... [[32mSUCCESS 1[0m in 1.50s]
[0m11:31:51.208570 [debug] [Thread-4 (]: Finished running node model.epicaldemo.fact_sales_transactions
[0m11:31:51.210578 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:31:51.210578 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m11:31:51.210578 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m11:31:51.367293 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m11:31:51.367293 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m11:31:51.534068 [debug] [MainThread]: Connection 'model.epicaldemo.dim_customers' was left open.
[0m11:31:51.535067 [debug] [MainThread]: On model.epicaldemo.dim_customers: Close
[0m11:31:51.692955 [debug] [MainThread]: Connection 'model.epicaldemo.dim_stores' was left open.
[0m11:31:51.692955 [debug] [MainThread]: On model.epicaldemo.dim_stores: Close
[0m11:31:51.847330 [debug] [MainThread]: Connection 'model.epicaldemo.stg_d365_fo__stores' was left open.
[0m11:31:51.850188 [debug] [MainThread]: On model.epicaldemo.stg_d365_fo__stores: Close
[0m11:31:52.005128 [debug] [MainThread]: Connection 'model.epicaldemo.fact_sales_transactions' was left open.
[0m11:31:52.005128 [debug] [MainThread]: On model.epicaldemo.fact_sales_transactions: Close
[0m11:31:52.158653 [info ] [MainThread]: 
[0m11:31:52.158653 [info ] [MainThread]: Finished running 1 snapshot, 5 table models, 8 view models in 0 hours 0 minutes and 10.70 seconds (10.70s).
[0m11:31:52.161659 [debug] [MainThread]: Command end result
[0m11:31:52.188702 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m11:31:52.192217 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m11:31:52.200741 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m11:31:52.201747 [info ] [MainThread]: 
[0m11:31:52.202753 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m11:31:52.203747 [info ] [MainThread]: 
[0m11:31:52.204753 [error] [MainThread]:   Database Error in model dim_dates (models\mart\dimensions\dim_dates.sql)
  000904 (42000): SQL compilation error: error line 19 at position 14
  invalid identifier 'DATE_ID'
  compiled code at target\run\epicaldemo\models\mart\dimensions\dim_dates.sql
[0m11:31:52.204753 [info ] [MainThread]: 
[0m11:31:52.205757 [error] [MainThread]:   Database Error in model dim_stores (models\mart\dimensions\dim_stores.sql)
  000904 (42000): SQL compilation error: error line 17 at position 9
  invalid identifier 'IS_CURRENT'
  compiled code at target\run\epicaldemo\models\mart\dimensions\dim_stores.sql
[0m11:31:52.205757 [info ] [MainThread]: 
[0m11:31:52.206746 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=2 SKIP=0 TOTAL=14
[0m11:31:52.207746 [debug] [MainThread]: Command `dbt build` failed at 11:31:52.207746 after 14.47 seconds
[0m11:31:52.208751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001519BFB9410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001519BF93F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001519BF93FD0>]}
[0m11:31:52.208751 [debug] [MainThread]: Flushing usage events
[0m11:31:52.882995 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:32:52.574206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002883CF73A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002883CCBE410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002883CF738D0>]}


============================== 11:32:52.578710 | 677c6e3f-9f06-4d48-b990-15c9fadd42be ==============================
[0m11:32:52.578710 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:32:52.579715 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m11:32:53.024768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '677c6e3f-9f06-4d48-b990-15c9fadd42be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002883E31BFD0>]}
[0m11:32:53.069928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '677c6e3f-9f06-4d48-b990-15c9fadd42be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002883E331650>]}
[0m11:32:53.071937 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m11:32:53.396547 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:32:53.595679 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:32:53.596678 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:32:53.602228 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m11:32:53.642327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '677c6e3f-9f06-4d48-b990-15c9fadd42be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002883E908810>]}
[0m11:32:53.718580 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m11:32:53.722584 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m11:32:53.750765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '677c6e3f-9f06-4d48-b990-15c9fadd42be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002883EE53F90>]}
[0m11:32:53.751768 [info ] [MainThread]: Found 13 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m11:32:53.753765 [info ] [MainThread]: 
[0m11:32:53.754777 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:32:53.755766 [info ] [MainThread]: 
[0m11:32:53.755766 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:32:53.760288 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m11:32:53.841704 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m11:32:53.841704 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m11:32:53.842716 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:32:54.645077 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.802 seconds
[0m11:32:54.647087 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m11:32:54.657598 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m11:32:54.657598 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m11:32:54.658607 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:32:55.378546 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.720 seconds
[0m11:32:55.385082 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m11:32:55.386079 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m11:32:55.545956 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.159 seconds
[0m11:32:55.547959 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m11:32:55.549455 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m11:32:55.670012 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.119 seconds
[0m11:32:55.674020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '677c6e3f-9f06-4d48-b990-15c9fadd42be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002883E872D10>]}
[0m11:32:55.679530 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__categories
[0m11:32:55.680035 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_d365_fo__dates
[0m11:32:55.680035 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_d365_fo__items
[0m11:32:55.681040 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_d365_fo__managers
[0m11:32:55.681040 [info ] [Thread-1 (]: 1 of 14 START sql view model broman_analytics.stg_d365_fo__categories .......... [RUN]
[0m11:32:55.682040 [info ] [Thread-2 (]: 2 of 14 START sql view model broman_analytics.stg_d365_fo__dates ............... [RUN]
[0m11:32:55.683040 [info ] [Thread-3 (]: 3 of 14 START sql view model broman_analytics.stg_d365_fo__items ............... [RUN]
[0m11:32:55.683040 [info ] [Thread-4 (]: 4 of 14 START sql view model broman_analytics.stg_d365_fo__managers ............ [RUN]
[0m11:32:55.684040 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__categories'
[0m11:32:55.684040 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__dates'
[0m11:32:55.685043 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__items'
[0m11:32:55.685043 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__managers'
[0m11:32:55.686050 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__categories
[0m11:32:55.686050 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_d365_fo__dates
[0m11:32:55.687042 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_d365_fo__items
[0m11:32:55.687042 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_d365_fo__managers
[0m11:32:55.694580 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__categories"
[0m11:32:55.698596 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__dates"
[0m11:32:55.702128 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__items"
[0m11:32:55.704137 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__managers"
[0m11:32:55.706129 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__categories
[0m11:32:55.726689 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_d365_fo__dates
[0m11:32:55.734721 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__categories"
[0m11:32:55.742795 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_d365_fo__managers
[0m11:32:55.742795 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_d365_fo__items
[0m11:32:55.741794 [debug] [Thread-2 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__dates"
[0m11:32:55.746791 [debug] [Thread-4 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__managers"
[0m11:32:55.751862 [debug] [Thread-3 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__items"
[0m11:32:55.752859 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__categories"
[0m11:32:55.754863 [debug] [Thread-2 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__dates"
[0m11:32:55.756862 [debug] [Thread-4 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__managers"
[0m11:32:55.756862 [debug] [Thread-1 (]: On model.epicaldemo.stg_d365_fo__categories: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__categories"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__categories
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.category
),

final AS (
    SELECT
        id AS "category_id"
        ,INITCAP(name) AS "Category"
        ,managerid AS "manager_id"
    FROM source
)

SELECT * FROM final
  );
[0m11:32:55.757862 [debug] [Thread-3 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__items"
[0m11:32:55.758866 [debug] [Thread-2 (]: On model.epicaldemo.stg_d365_fo__dates: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__dates"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__dates
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.date
),

final AS (
    SELECT
        id AS "date_id"
        ,date AS "Date"
        ,year AS "Year"
        ,yearmonth AS "Year Month"
        ,monthnumber AS "Month Number"
        ,quarter AS "Quarter"
        ,quarternumber AS "Quarter Number"
        ,monthname AS "Month"
    FROM source
)

SELECT * FROM final
  );
[0m11:32:55.759371 [debug] [Thread-4 (]: On model.epicaldemo.stg_d365_fo__managers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__managers"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__managers
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.manager
),

final as (
    SELECT
        id AS "manager_id"
        ,firstname || ' ' || lastname AS "Manager"
    FROM source
)

SELECT * FROM final
  );
[0m11:32:55.760379 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:32:55.760379 [debug] [Thread-3 (]: On model.epicaldemo.stg_d365_fo__items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__items"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__items
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.item
),

final AS (
    SELECT
        id AS "item_id"
        ,name AS "Item"
        ,COALESCE(brand, 'Missing') AS "Brand"
        ,categoryid AS "category_id"
        ,COALESCE(flavor, 'Missing') AS "Flavor"
        ,sku AS "SKU"
    FROM source
)

SELECT * FROM final
  );
[0m11:32:55.761391 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:32:55.761391 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:32:55.762388 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:32:56.377948 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.618 seconds
[0m11:32:56.399005 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '677c6e3f-9f06-4d48-b990-15c9fadd42be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002883E3A9750>]}
[0m11:32:56.400015 [info ] [Thread-1 (]: 1 of 14 OK created sql view model broman_analytics.stg_d365_fo__categories ..... [[32mSUCCESS 1[0m in 0.71s]
[0m11:32:56.401016 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__categories
[0m11:32:56.402015 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__transactions
[0m11:32:56.403015 [info ] [Thread-1 (]: 5 of 14 START sql view model broman_analytics.stg_d365_fo__transactions ........ [RUN]
[0m11:32:56.403015 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__categories, now model.epicaldemo.stg_d365_fo__transactions)
[0m11:32:56.404125 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__transactions
[0m11:32:56.408012 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__transactions"
[0m11:32:56.409516 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__transactions
[0m11:32:56.412527 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__transactions"
[0m11:32:56.414526 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__transactions"
[0m11:32:56.415525 [debug] [Thread-1 (]: On model.epicaldemo.stg_d365_fo__transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__transactions"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__transactions
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.transactions
),

final AS (
    SELECT
        -- Identifiers
        CAST(TO_CHAR(date::DATE, 'YYYYMMDD') AS INTEGER) AS "date_id"
        ,sku AS "SKU"
        ,store AS "Store"
        ,customernumber AS "Customer Number"

        -- Metrics
        ,quantity AS "Qty"
        ,unitprice::NUMERIC(10,2) AS "Unit Price"
        ,(quantity * unitprice)::NUMERIC(10,2) AS "Sales Amount"
        ,unitcost::NUMERIC(10,2) AS "Unit Cost"
        ,(quantity * unitcost)::NUMERIC(10,2) AS "Cost"
        ,(quantity * unitprice)::NUMERIC(10,2) - (quantity * unitcost)::NUMERIC(10,2) AS "Margin"
    FROM source
)

SELECT * FROM final
  );
[0m11:32:56.437564 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.675 seconds
[0m11:32:56.439714 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '677c6e3f-9f06-4d48-b990-15c9fadd42be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002883EE78590>]}
[0m11:32:56.440713 [info ] [Thread-3 (]: 3 of 14 OK created sql view model broman_analytics.stg_d365_fo__items .......... [[32mSUCCESS 1[0m in 0.75s]
[0m11:32:56.441715 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_d365_fo__items
[0m11:32:56.442714 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_inriver__item_attributes
[0m11:32:56.442714 [info ] [Thread-3 (]: 6 of 14 START sql view model broman_analytics.stg_inriver__item_attributes ..... [RUN]
[0m11:32:56.443715 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__items, now model.epicaldemo.stg_inriver__item_attributes)
[0m11:32:56.443715 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_inriver__item_attributes
[0m11:32:56.446717 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_inriver__item_attributes"
[0m11:32:56.448716 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_inriver__item_attributes
[0m11:32:56.451761 [debug] [Thread-3 (]: Writing runtime sql for node "model.epicaldemo.stg_inriver__item_attributes"
[0m11:32:56.453766 [debug] [Thread-3 (]: Using snowflake connection "model.epicaldemo.stg_inriver__item_attributes"
[0m11:32:56.454765 [debug] [Thread-3 (]: On model.epicaldemo.stg_inriver__item_attributes: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_inriver__item_attributes"} */
create or replace   view EPICALDEMO.broman_analytics.stg_inriver__item_attributes
  
   as (
    with

source as (
    select
        *
    from EPICALDEMO.inriver.item_attributes
),

final as (
    select
        id AS "item_attributes_id"
        ,sku AS "SKU"
        ,COALESCE(crunch_level, 'Missing') AS "Crunch Level"
        ,COALESCE(snack_time, 'Missing') AS "Snack Time"
    from source
)

select * from final
  );
[0m11:32:56.583434 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.822 seconds
[0m11:32:56.586434 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '677c6e3f-9f06-4d48-b990-15c9fadd42be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002883F3E1910>]}
[0m11:32:56.587435 [info ] [Thread-4 (]: 4 of 14 OK created sql view model broman_analytics.stg_d365_fo__managers ....... [[32mSUCCESS 1[0m in 0.90s]
[0m11:32:56.587435 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_d365_fo__managers
[0m11:32:56.588941 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_salesforce__customers
[0m11:32:56.588941 [info ] [Thread-4 (]: 7 of 14 START sql view model broman_analytics.stg_salesforce__customers ........ [RUN]
[0m11:32:56.589945 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__managers, now model.epicaldemo.stg_salesforce__customers)
[0m11:32:56.589945 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_salesforce__customers
[0m11:32:56.593957 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_salesforce__customers"
[0m11:32:56.594957 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_salesforce__customers
[0m11:32:56.597950 [debug] [Thread-4 (]: Writing runtime sql for node "model.epicaldemo.stg_salesforce__customers"
[0m11:32:56.599453 [debug] [Thread-4 (]: Using snowflake connection "model.epicaldemo.stg_salesforce__customers"
[0m11:32:56.599453 [debug] [Thread-4 (]: On model.epicaldemo.stg_salesforce__customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_salesforce__customers"} */
create or replace   view EPICALDEMO.broman_analytics.stg_salesforce__customers
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.salesforce.customer
),

final AS (
    SELECT
        id AS "customer_id"
        ,customernumber AS "Customer Number"
        ,age AS "Customer Age"

        ,CASE
            WHEN age < 20 THEN '< 20'
            WHEN age >= 20 AND age < 30 THEN '20 - 30'
            WHEN age >= 30 AND age < 50 THEN '30 - 50'
            WHEN age >= 50 AND age < 60 THEN '50 - 60'
            ELSE '60+'
         END AS "Customer Age Group"

        ,CASE
            WHEN age < 20 THEN 1
            WHEN age >= 20 AND age < 30 THEN 2
            WHEN age >= 30 AND age < 50 THEN 3
            WHEN age >= 50 AND age < 60 THEN 4
            ELSE 5
         END AS "customer_age_group_sort"

        ,state AS "Customer State"
    FROM source
)

SELECT * FROM final
  );
[0m11:32:56.699647 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.284 seconds
[0m11:32:56.701646 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '677c6e3f-9f06-4d48-b990-15c9fadd42be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002883F26E850>]}
[0m11:32:56.702664 [info ] [Thread-1 (]: 5 of 14 OK created sql view model broman_analytics.stg_d365_fo__transactions ... [[32mSUCCESS 1[0m in 0.30s]
[0m11:32:56.703656 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__transactions
[0m11:32:56.704643 [debug] [Thread-1 (]: Began running node snapshot.epicaldemo.stores_snapshot
[0m11:32:56.704643 [info ] [Thread-1 (]: 8 of 14 START snapshot broman_analytics.stores_snapshot ........................ [RUN]
[0m11:32:56.705650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__transactions, now snapshot.epicaldemo.stores_snapshot)
[0m11:32:56.705650 [debug] [Thread-1 (]: Began compiling node snapshot.epicaldemo.stores_snapshot
[0m11:32:56.709156 [debug] [Thread-1 (]: Began executing node snapshot.epicaldemo.stores_snapshot
[0m11:32:56.744711 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m11:32:56.745708 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
[0m11:32:56.857744 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.112 seconds
[0m11:32:56.898855 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m11:32:56.898855 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
create or replace temporary table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp"
as (
    
    
    with snapshot_query as (

        select * from EPICALDEMO.d365_fo.store

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            
  
  coalesce(nullif(modified, modified), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            modified as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.modified)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.modified)
        )
    )

    select * from insertions
    union all
    select * from updates

    )
;
[0m11:32:57.414665 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.654 seconds
[0m11:32:57.417674 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '677c6e3f-9f06-4d48-b990-15c9fadd42be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002883F3FE090>]}
[0m11:32:57.417674 [info ] [Thread-2 (]: 2 of 14 OK created sql view model broman_analytics.stg_d365_fo__dates .......... [[32mSUCCESS 1[0m in 1.73s]
[0m11:32:57.418669 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_d365_fo__dates
[0m11:32:57.420155 [debug] [Thread-2 (]: Began running node model.epicaldemo.dim_dates
[0m11:32:57.420155 [info ] [Thread-2 (]: 9 of 14 START sql table model broman_analytics.dim_dates ....................... [RUN]
[0m11:32:57.421157 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__dates, now model.epicaldemo.dim_dates)
[0m11:32:57.421157 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.dim_dates
[0m11:32:57.424158 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.dim_dates"
[0m11:32:57.425159 [debug] [Thread-2 (]: Began executing node model.epicaldemo.dim_dates
[0m11:32:57.441985 [debug] [Thread-2 (]: Writing runtime sql for node "model.epicaldemo.dim_dates"
[0m11:32:57.443986 [debug] [Thread-2 (]: Using snowflake connection "model.epicaldemo.dim_dates"
[0m11:32:57.443986 [debug] [Thread-2 (]: On model.epicaldemo.dim_dates: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_dates"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_dates
    

    
    as (with

dates AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__dates
),

final AS (
    SELECT
        "date_id"
        ,"Date"
        ,"Year"
        ,"Year Month"
        ,LEFT(date_id::TEXT, 6) AS "Year Month Number"
        ,"Month Number"
        ,"Quarter"
        ,"Quarter Number"
        ,"Month"
        ,LEFT("Month",3) AS "Month Short"
    FROM dates
)

SELECT * FROM final
    )
;
[0m11:32:57.454135 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.999 seconds
[0m11:32:57.457144 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '677c6e3f-9f06-4d48-b990-15c9fadd42be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002883F860110>]}
[0m11:32:57.457144 [info ] [Thread-3 (]: 6 of 14 OK created sql view model broman_analytics.stg_inriver__item_attributes  [[32mSUCCESS 1[0m in 1.01s]
[0m11:32:57.458651 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_inriver__item_attributes
[0m11:32:57.459656 [debug] [Thread-3 (]: Began running node model.epicaldemo.dim_items
[0m11:32:57.459656 [info ] [Thread-3 (]: 10 of 14 START sql table model broman_analytics.dim_items ...................... [RUN]
[0m11:32:57.460657 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_inriver__item_attributes, now model.epicaldemo.dim_items)
[0m11:32:57.460657 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.dim_items
[0m11:32:57.464665 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.dim_items"
[0m11:32:57.465656 [debug] [Thread-3 (]: Began executing node model.epicaldemo.dim_items
[0m11:32:57.469181 [debug] [Thread-3 (]: Writing runtime sql for node "model.epicaldemo.dim_items"
[0m11:32:57.472196 [debug] [Thread-3 (]: Using snowflake connection "model.epicaldemo.dim_items"
[0m11:32:57.473195 [debug] [Thread-3 (]: On model.epicaldemo.dim_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_items"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_items
    

    
    as (with

items AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__items
),

item_attributes AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_inriver__item_attributes
),

categories AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__categories
),

managers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__managers
),

unknown AS (
    SELECT
        -1 AS "item_id"
        ,'Unknown' AS "SKU"
        ,'Unknown' AS "Item"
        ,'Missing' AS "Brand"
        ,'Missing' AS "Flavor"
        ,'Missing' AS "Crunch Level"
        ,'Missing' AS "Snack Time"
        ,'Missing' AS "Category"
        ,'Missing' AS "Manager"
),

missing AS (
    SELECT
        -2 AS "item_id"
        ,'Missing' AS "SKU"
        ,'Missing' AS "Item"
        ,'Missing' AS "Brand"
        ,'Missing' AS "Flavor"
        ,'Missing' AS "Crunch Level"
        ,'Missing' AS "Snack Time"
        ,'Missing' AS "Category"
        ,'Missing' AS "Manager"
),

final AS (
    SELECT
        items."item_id"
        ,items."SKU"
        ,items."Item"
        ,items."Brand"
        ,items."Flavor"
        ,COALESCE(item_attributes."Crunch Level", 'Missing') AS "Crunch Level"
        ,COALESCE(item_attributes."Snack Time", 'Missing') AS "Snack Time"
        ,categories."Category"
        ,managers."Manager"
    FROM items
    LEFT JOIN item_attributes ON item_attributes."SKU" = items."SKU"
    LEFT JOIN categories ON categories."category_id" = items."category_id"
    LEFT JOIN managers ON managers."manager_id" = categories."manager_id"

    UNION

    SELECT * FROM unknown

    UNION

    SELECT * FROM missing
)

SELECT * FROM final
    )
;
[0m11:32:57.504864 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.905 seconds
[0m11:32:57.506871 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '677c6e3f-9f06-4d48-b990-15c9fadd42be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002883F1643D0>]}
[0m11:32:57.507874 [info ] [Thread-4 (]: 7 of 14 OK created sql view model broman_analytics.stg_salesforce__customers ... [[32mSUCCESS 1[0m in 0.92s]
[0m11:32:57.508863 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_salesforce__customers
[0m11:32:57.508863 [debug] [Thread-4 (]: Began running node model.epicaldemo.dim_customers
[0m11:32:57.510362 [info ] [Thread-4 (]: 11 of 14 START sql table model broman_analytics.dim_customers .................. [RUN]
[0m11:32:57.511361 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_salesforce__customers, now model.epicaldemo.dim_customers)
[0m11:32:57.511361 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.dim_customers
[0m11:32:57.514360 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.dim_customers"
[0m11:32:57.515372 [debug] [Thread-4 (]: Began executing node model.epicaldemo.dim_customers
[0m11:32:57.518874 [debug] [Thread-4 (]: Writing runtime sql for node "model.epicaldemo.dim_customers"
[0m11:32:57.520883 [debug] [Thread-4 (]: Using snowflake connection "model.epicaldemo.dim_customers"
[0m11:32:57.520883 [debug] [Thread-4 (]: On model.epicaldemo.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_customers"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_customers
    

    
    as (WITH

customers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_salesforce__customers
),

final AS (
    SELECT
        "customer_id"
        ,"Customer Number"
        ,"Customer Age"
        ,"Customer Age Group"
        ,"customer_age_group_sort"
        ,"Customer State"
    FROM customers
)

SELECT * FROM final
    )
;
[0m11:32:57.588574 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.689 seconds
[0m11:32:57.591585 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m11:32:57.592585 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp"
[0m11:32:57.704942 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01bceedc-0004-ce00-0000-d2e9000268ce
[0m11:32:57.704942 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 19 at position 14
invalid identifier 'DATE_ID'
[0m11:32:57.707942 [debug] [Thread-2 (]: Database Error in model dim_dates (models\mart\dimensions\dim_dates.sql)
  000904 (42000): SQL compilation error: error line 19 at position 14
  invalid identifier 'DATE_ID'
  compiled code at target\run\epicaldemo\models\mart\dimensions\dim_dates.sql
[0m11:32:57.708942 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '677c6e3f-9f06-4d48-b990-15c9fadd42be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002884003C890>]}
[0m11:32:57.710010 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.117 seconds
[0m11:32:57.711004 [error] [Thread-2 (]: 9 of 14 ERROR creating sql table model broman_analytics.dim_dates .............. [[31mERROR[0m in 0.29s]
[0m11:32:57.713999 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m11:32:57.714997 [debug] [Thread-2 (]: Finished running node model.epicaldemo.dim_dates
[0m11:32:57.715993 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
[0m11:32:57.715993 [debug] [Thread-7 (]: Marking all children of 'model.epicaldemo.dim_dates' to be skipped because of status 'error'.  Reason: Database Error in model dim_dates (models\mart\dimensions\dim_dates.sql)
  000904 (42000): SQL compilation error: error line 19 at position 14
  invalid identifier 'DATE_ID'
  compiled code at target\run\epicaldemo\models\mart\dimensions\dim_dates.sql.
[0m11:32:57.821635 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.105 seconds
[0m11:32:57.825629 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m11:32:57.825629 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp"
[0m11:32:57.969721 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.143 seconds
[0m11:32:57.972720 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m11:32:57.973720 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
[0m11:32:58.079220 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.105 seconds
[0m11:32:58.086748 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m11:32:58.087747 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp"
[0m11:32:58.183630 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.095 seconds
[0m11:32:58.202929 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m11:32:58.203930 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from EPICALDEMO.d365_fo.store

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            
  
  coalesce(nullif(modified, modified), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            modified as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.modified)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.modified)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m11:32:58.256557 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.735 seconds
[0m11:32:58.258557 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '677c6e3f-9f06-4d48-b990-15c9fadd42be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002883F8B5D90>]}
[0m11:32:58.259708 [info ] [Thread-4 (]: 11 of 14 OK created sql table model broman_analytics.dim_customers ............. [[32mSUCCESS 1[0m in 0.75s]
[0m11:32:58.260709 [debug] [Thread-4 (]: Finished running node model.epicaldemo.dim_customers
[0m11:32:58.394753 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.190 seconds
[0m11:32:58.400264 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m11:32:58.400264 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m11:32:58.495689 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.094 seconds
[0m11:32:58.496690 [warn ] [Thread-1 (]: Data type of snapshot table timestamp columns (TIMESTAMP_NTZ) doesn't match derived column 'updated_at' (DATE). Please update snapshot config 'updated_at'.
[0m11:32:58.496690 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.epicaldemo.stores_snapshot"
[0m11:32:58.499198 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m11:32:58.499198 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
BEGIN
[0m11:32:58.509736 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.037 seconds
[0m11:32:58.511734 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '677c6e3f-9f06-4d48-b990-15c9fadd42be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028840005290>]}
[0m11:32:58.513737 [info ] [Thread-3 (]: 10 of 14 OK created sql table model broman_analytics.dim_items ................. [[32mSUCCESS 1[0m in 1.05s]
[0m11:32:58.514735 [debug] [Thread-3 (]: Finished running node model.epicaldemo.dim_items
[0m11:32:58.610875 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.111 seconds
[0m11:32:58.611876 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m11:32:58.611876 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
merge into "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT" as DBT_INTERNAL_DEST
    using "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
	
	
	and ((DBT_INTERNAL_DEST.dbt_valid_to = to_date('9999-12-31'))
 or DBT_INTERNAL_DEST.dbt_valid_to is null)

     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("ID", "NAME", "LOCATION", "LATITUDE", "LONGITUDE", "ONLINEPRESENCE", "MODIFIED", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("ID", "NAME", "LOCATION", "LATITUDE", "LONGITUDE", "ONLINEPRESENCE", "MODIFIED", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m11:32:59.141454 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.529 seconds
[0m11:32:59.142461 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m11:32:59.143460 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
COMMIT
[0m11:32:59.427401 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.285 seconds
[0m11:32:59.432922 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '677c6e3f-9f06-4d48-b990-15c9fadd42be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002883F3BAD10>]}
[0m11:32:59.432922 [info ] [Thread-1 (]: 8 of 14 OK snapshotted broman_analytics.stores_snapshot ........................ [[32mSUCCESS 0[0m in 2.73s]
[0m11:32:59.433917 [debug] [Thread-1 (]: Finished running node snapshot.epicaldemo.stores_snapshot
[0m11:32:59.434918 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_d365_fo__stores
[0m11:32:59.435918 [info ] [Thread-2 (]: 12 of 14 START sql view model broman_analytics.stg_d365_fo__stores ............. [RUN]
[0m11:32:59.435918 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.dim_dates, now model.epicaldemo.stg_d365_fo__stores)
[0m11:32:59.436917 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_d365_fo__stores
[0m11:32:59.439961 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__stores"
[0m11:32:59.440963 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_d365_fo__stores
[0m11:32:59.442963 [debug] [Thread-2 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__stores"
[0m11:32:59.444962 [debug] [Thread-2 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__stores"
[0m11:32:59.444962 [debug] [Thread-2 (]: On model.epicaldemo.stg_d365_fo__stores: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__stores"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__stores
  
   as (
    WITH

stores_snapshots AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stores_snapshot
),

final AS (
    SELECT
        id AS "store_id"
        ,dbt_scd_id AS "dbt_scd_id"

        ,ROW_NUMBER() OVER (ORDER BY id ASC, dbt_valid_from ASC) AS "store_key"

        ,CASE WHEN dbt_valid_to = '9999-12-31' THEN 1 ELSE 0 END AS "is_current"
        ,name AS "Store"
        ,SPLIT_PART(location, ',', 1) AS "Store State"
        ,SPLIT_PART(location, ',', 2) AS "Store City"
        ,latitude AS "Lat"
        ,longitude AS "Lon"
        ,onlinepresence AS "Online Presence"
        ,modified AS "modified"
        ,CAST(TO_CHAR(dbt_valid_from::DATE, 'YYYYMMDD') AS INTEGER) AS "valid_from"
        ,CAST(TO_CHAR(dbt_valid_to::DATE, 'YYYYMMDD') AS INTEGER) AS "valid_to"
    FROM stores_snapshots
)

SELECT * FROM final
  );
[0m11:32:59.778618 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.333 seconds
[0m11:32:59.781664 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '677c6e3f-9f06-4d48-b990-15c9fadd42be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002883F910290>]}
[0m11:32:59.781664 [info ] [Thread-2 (]: 12 of 14 OK created sql view model broman_analytics.stg_d365_fo__stores ........ [[32mSUCCESS 1[0m in 0.34s]
[0m11:32:59.783167 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_d365_fo__stores
[0m11:32:59.784173 [debug] [Thread-3 (]: Began running node model.epicaldemo.dim_stores
[0m11:32:59.784173 [debug] [Thread-1 (]: Began running node model.epicaldemo.fact_sales_transactions
[0m11:32:59.785171 [info ] [Thread-3 (]: 13 of 14 START sql table model broman_analytics.dim_stores ..................... [RUN]
[0m11:32:59.785171 [info ] [Thread-1 (]: 14 of 14 START sql table model broman_analytics.fact_sales_transactions ........ [RUN]
[0m11:32:59.786173 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.dim_items, now model.epicaldemo.dim_stores)
[0m11:32:59.786173 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.epicaldemo.stores_snapshot, now model.epicaldemo.fact_sales_transactions)
[0m11:32:59.787172 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.dim_stores
[0m11:32:59.787172 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.fact_sales_transactions
[0m11:32:59.790690 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.dim_stores"
[0m11:32:59.793689 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.fact_sales_transactions"
[0m11:32:59.794681 [debug] [Thread-3 (]: Began executing node model.epicaldemo.dim_stores
[0m11:32:59.794681 [debug] [Thread-1 (]: Began executing node model.epicaldemo.fact_sales_transactions
[0m11:32:59.797681 [debug] [Thread-3 (]: Writing runtime sql for node "model.epicaldemo.dim_stores"
[0m11:32:59.799201 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.fact_sales_transactions"
[0m11:32:59.801209 [debug] [Thread-3 (]: Using snowflake connection "model.epicaldemo.dim_stores"
[0m11:32:59.801209 [debug] [Thread-3 (]: On model.epicaldemo.dim_stores: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_stores"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_stores
    

    
    as (with

store AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__stores
),

final AS (
    SELECT
        "store_key"
        ,"store_id"
        ,"is_current"
        ,"Store"
        ,"Store State"
        ,"Store City"
        ,"Lat"
        ,"Lon"
        ,"Online Presence"
        ,"modified"
        ,"valid_from"
        ,"valid_to"
    FROM store
)

SELECT * FROM final
    )
;
[0m11:32:59.803210 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions"
[0m11:32:59.804212 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions"} */
create or replace transient table EPICALDEMO.broman_analytics.fact_sales_transactions
    

    
    as (WITH

sales AS (
    select
        *
    from EPICALDEMO.broman_analytics.stg_d365_fo__transactions
),

items AS (
    select
        *
    from EPICALDEMO.broman_analytics.stg_d365_fo__items
),

stores AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__stores
),

customers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_salesforce__customers
),

final AS (
    SELECT
        -- Identifiers
        sales."date_id"

        ,CASE
            WHEN sales."SKU" IS NULL THEN -2 -- SKU is missing from Source
            WHEN items."item_id" IS NULL THEN -1 -- SKU is not known from Source
            ELSE items."item_id" -- Join item_id from Dim based on SKU
         END AS "item_id"

        ,CASE
            WHEN sales."Store" IS NULL THEN -2
            WHEN stores."store_key" IS NULL THEN -1
            ELSE stores."store_key"
         END AS "store_key"

        ,CASE
            WHEN sales."Customer Number" IS NULL THEN -2
            WHEN customers."customer_id" IS NULL THEN -1
            ELSE customers."customer_id"
         END AS "customer_id"

        -- Metrics
        ,sales."Qty"
        ,sales."Unit Price"
        ,sales."Sales Amount"
        ,sales."Unit Cost"
        ,sales."Cost"
        ,sales."Margin"
    FROM sales
    LEFT JOIN items ON items."SKU" = sales."SKU"
    LEFT JOIN stores ON stores."Store" = sales."Store" AND sales."date_id" >= stores."valid_from" AND sales."date_id" < stores."valid_to"
    LEFT JOIN customers ON customers."Customer Number" = sales."Customer Number"
)

SELECT * FROM final
    )
;
[0m11:33:00.658725 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.856 seconds
[0m11:33:00.661765 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '677c6e3f-9f06-4d48-b990-15c9fadd42be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028840033590>]}
[0m11:33:00.661765 [info ] [Thread-3 (]: 13 of 14 OK created sql table model broman_analytics.dim_stores ................ [[32mSUCCESS 1[0m in 0.87s]
[0m11:33:00.663764 [debug] [Thread-3 (]: Finished running node model.epicaldemo.dim_stores
[0m11:33:01.089943 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.284 seconds
[0m11:33:01.091956 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '677c6e3f-9f06-4d48-b990-15c9fadd42be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028840151750>]}
[0m11:33:01.092943 [info ] [Thread-1 (]: 14 of 14 OK created sql table model broman_analytics.fact_sales_transactions ... [[32mSUCCESS 1[0m in 1.31s]
[0m11:33:01.093943 [debug] [Thread-1 (]: Finished running node model.epicaldemo.fact_sales_transactions
[0m11:33:01.095945 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:33:01.095945 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m11:33:01.095945 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m11:33:01.286467 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m11:33:01.286467 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m11:33:01.446927 [debug] [MainThread]: Connection 'model.epicaldemo.fact_sales_transactions' was left open.
[0m11:33:01.447918 [debug] [MainThread]: On model.epicaldemo.fact_sales_transactions: Close
[0m11:33:01.603839 [debug] [MainThread]: Connection 'model.epicaldemo.stg_d365_fo__stores' was left open.
[0m11:33:01.604841 [debug] [MainThread]: On model.epicaldemo.stg_d365_fo__stores: Close
[0m11:33:01.758827 [debug] [MainThread]: Connection 'model.epicaldemo.dim_stores' was left open.
[0m11:33:01.759864 [debug] [MainThread]: On model.epicaldemo.dim_stores: Close
[0m11:33:01.916803 [debug] [MainThread]: Connection 'model.epicaldemo.dim_customers' was left open.
[0m11:33:01.917802 [debug] [MainThread]: On model.epicaldemo.dim_customers: Close
[0m11:33:02.083683 [info ] [MainThread]: 
[0m11:33:02.084682 [info ] [MainThread]: Finished running 1 snapshot, 5 table models, 8 view models in 0 hours 0 minutes and 8.33 seconds (8.33s).
[0m11:33:02.086734 [debug] [MainThread]: Command end result
[0m11:33:02.108763 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m11:33:02.112024 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m11:33:02.119537 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m11:33:02.120536 [info ] [MainThread]: 
[0m11:33:02.121534 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:33:02.121534 [info ] [MainThread]: 
[0m11:33:02.122533 [error] [MainThread]:   Database Error in model dim_dates (models\mart\dimensions\dim_dates.sql)
  000904 (42000): SQL compilation error: error line 19 at position 14
  invalid identifier 'DATE_ID'
  compiled code at target\run\epicaldemo\models\mart\dimensions\dim_dates.sql
[0m11:33:02.122533 [info ] [MainThread]: 
[0m11:33:02.123536 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=1 SKIP=0 TOTAL=14
[0m11:33:02.124534 [debug] [MainThread]: Command `dbt build` failed at 11:33:02.124534 after 9.61 seconds
[0m11:33:02.124534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002883CFC4C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028837893090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288386795D0>]}
[0m11:33:02.125534 [debug] [MainThread]: Flushing usage events
[0m11:33:02.785174 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:40:03.213193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271E39B8F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271E39A0BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271E39BAD50>]}


============================== 11:40:03.217193 | 8242afb8-e61e-49ba-9559-cd5d80e6fbd4 ==============================
[0m11:40:03.217193 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:40:03.218700 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt build', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:40:03.618480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8242afb8-e61e-49ba-9559-cd5d80e6fbd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271E4DF1D90>]}
[0m11:40:03.660096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8242afb8-e61e-49ba-9559-cd5d80e6fbd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271E4D314D0>]}
[0m11:40:03.662117 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m11:40:03.972971 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:40:04.170611 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:40:04.170611 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:40:04.176611 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m11:40:04.216684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8242afb8-e61e-49ba-9559-cd5d80e6fbd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271E560D410>]}
[0m11:40:04.294283 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m11:40:04.299795 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m11:40:04.328987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8242afb8-e61e-49ba-9559-cd5d80e6fbd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271E5853FD0>]}
[0m11:40:04.329992 [info ] [MainThread]: Found 13 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m11:40:04.332991 [info ] [MainThread]: 
[0m11:40:04.332991 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:40:04.333990 [info ] [MainThread]: 
[0m11:40:04.333990 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:40:04.338497 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m11:40:04.424738 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m11:40:04.424738 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m11:40:04.425738 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:40:05.191694 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.766 seconds
[0m11:40:05.194696 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m11:40:05.204231 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m11:40:05.204231 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m11:40:05.205231 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:40:05.688815 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.483 seconds
[0m11:40:05.692846 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m11:40:05.693843 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m11:40:05.853537 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.159 seconds
[0m11:40:05.855540 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m11:40:05.856542 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m11:40:05.977230 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.120 seconds
[0m11:40:05.980752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8242afb8-e61e-49ba-9559-cd5d80e6fbd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271E32CC790>]}
[0m11:40:05.984753 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__categories
[0m11:40:05.984753 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_d365_fo__dates
[0m11:40:05.985740 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_d365_fo__items
[0m11:40:05.985740 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_d365_fo__managers
[0m11:40:05.986755 [info ] [Thread-1 (]: 1 of 14 START sql view model broman_analytics.stg_d365_fo__categories .......... [RUN]
[0m11:40:05.987740 [info ] [Thread-2 (]: 2 of 14 START sql view model broman_analytics.stg_d365_fo__dates ............... [RUN]
[0m11:40:05.987740 [info ] [Thread-3 (]: 3 of 14 START sql view model broman_analytics.stg_d365_fo__items ............... [RUN]
[0m11:40:05.988743 [info ] [Thread-4 (]: 4 of 14 START sql view model broman_analytics.stg_d365_fo__managers ............ [RUN]
[0m11:40:05.989845 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__categories'
[0m11:40:05.990843 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__dates'
[0m11:40:05.990843 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__items'
[0m11:40:05.991849 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__managers'
[0m11:40:05.991849 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__categories
[0m11:40:05.992843 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_d365_fo__dates
[0m11:40:05.992843 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_d365_fo__items
[0m11:40:05.993845 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_d365_fo__managers
[0m11:40:05.999950 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__categories"
[0m11:40:06.002957 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__dates"
[0m11:40:06.005959 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__items"
[0m11:40:06.009475 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__managers"
[0m11:40:06.012476 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__categories
[0m11:40:06.013477 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_d365_fo__dates
[0m11:40:06.031064 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_d365_fo__items
[0m11:40:06.042570 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__categories"
[0m11:40:06.043582 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_d365_fo__managers
[0m11:40:06.053083 [debug] [Thread-2 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__dates"
[0m11:40:06.056094 [debug] [Thread-3 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__items"
[0m11:40:06.060625 [debug] [Thread-4 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__managers"
[0m11:40:06.063615 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__categories"
[0m11:40:06.066957 [debug] [Thread-2 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__dates"
[0m11:40:06.068462 [debug] [Thread-1 (]: On model.epicaldemo.stg_d365_fo__categories: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__categories"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__categories
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.category
),

final AS (
    SELECT
        id AS "category_id"
        ,INITCAP(name) AS "Category"
        ,managerid AS "manager_id"
    FROM source
)

SELECT * FROM final
  );
[0m11:40:06.070490 [debug] [Thread-3 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__items"
[0m11:40:06.070490 [debug] [Thread-2 (]: On model.epicaldemo.stg_d365_fo__dates: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__dates"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__dates
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.date
),

final AS (
    SELECT
        id AS "date_id"
        ,date AS "Date"
        ,year AS "Year"
        ,yearmonth AS "Year Month"
        ,LEFT(id::TEXT, 4) || '-' || RIGHT(id::TEXT, 2) AS "Year Month Number"
        ,monthnumber AS "Month Number"
        ,quarter AS "Quarter"
        ,quarternumber AS "Quarter Number"
        ,monthname AS "Month"
        ,LEFT(monthname,3) AS "Month Short"
    FROM source
)

SELECT * FROM final
  );
[0m11:40:06.072484 [debug] [Thread-4 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__managers"
[0m11:40:06.072484 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:40:06.074473 [debug] [Thread-3 (]: On model.epicaldemo.stg_d365_fo__items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__items"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__items
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.item
),

final AS (
    SELECT
        id AS "item_id"
        ,name AS "Item"
        ,COALESCE(brand, 'Missing') AS "Brand"
        ,categoryid AS "category_id"
        ,COALESCE(flavor, 'Missing') AS "Flavor"
        ,sku AS "SKU"
    FROM source
)

SELECT * FROM final
  );
[0m11:40:06.074473 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:40:06.075468 [debug] [Thread-4 (]: On model.epicaldemo.stg_d365_fo__managers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__managers"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__managers
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.manager
),

final as (
    SELECT
        id AS "manager_id"
        ,firstname || ' ' || lastname AS "Manager"
    FROM source
)

SELECT * FROM final
  );
[0m11:40:06.076468 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:40:06.081598 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:40:06.883594 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.811 seconds
[0m11:40:06.904632 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.824 seconds
[0m11:40:06.907712 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8242afb8-e61e-49ba-9559-cd5d80e6fbd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271E5CE8B10>]}
[0m11:40:06.907712 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8242afb8-e61e-49ba-9559-cd5d80e6fbd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271E52EE150>]}
[0m11:40:06.908693 [info ] [Thread-1 (]: 1 of 14 OK created sql view model broman_analytics.stg_d365_fo__categories ..... [[32mSUCCESS 1[0m in 0.91s]
[0m11:40:06.909294 [info ] [Thread-4 (]: 4 of 14 OK created sql view model broman_analytics.stg_d365_fo__managers ....... [[32mSUCCESS 1[0m in 0.91s]
[0m11:40:06.910302 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__categories
[0m11:40:06.911313 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_d365_fo__managers
[0m11:40:06.911313 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__transactions
[0m11:40:06.912298 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_inriver__item_attributes
[0m11:40:06.912298 [info ] [Thread-1 (]: 5 of 14 START sql view model broman_analytics.stg_d365_fo__transactions ........ [RUN]
[0m11:40:06.913299 [info ] [Thread-4 (]: 6 of 14 START sql view model broman_analytics.stg_inriver__item_attributes ..... [RUN]
[0m11:40:06.914299 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__categories, now model.epicaldemo.stg_d365_fo__transactions)
[0m11:40:06.915299 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__managers, now model.epicaldemo.stg_inriver__item_attributes)
[0m11:40:06.915299 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__transactions
[0m11:40:06.916300 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_inriver__item_attributes
[0m11:40:06.918804 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__transactions"
[0m11:40:06.921819 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_inriver__item_attributes"
[0m11:40:06.922809 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__transactions
[0m11:40:06.922809 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_inriver__item_attributes
[0m11:40:06.925335 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__transactions"
[0m11:40:06.927331 [debug] [Thread-4 (]: Writing runtime sql for node "model.epicaldemo.stg_inriver__item_attributes"
[0m11:40:06.929843 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__transactions"
[0m11:40:06.929843 [debug] [Thread-1 (]: On model.epicaldemo.stg_d365_fo__transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__transactions"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__transactions
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.transactions
),

final AS (
    SELECT
        -- Identifiers
        CAST(TO_CHAR(date::DATE, 'YYYYMMDD') AS INTEGER) AS "date_id"
        ,sku AS "SKU"
        ,store AS "Store"
        ,customernumber AS "Customer Number"

        -- Metrics
        ,quantity AS "Qty"
        ,unitprice::NUMERIC(10,2) AS "Unit Price"
        ,(quantity * unitprice)::NUMERIC(10,2) AS "Sales Amount"
        ,unitcost::NUMERIC(10,2) AS "Unit Cost"
        ,(quantity * unitcost)::NUMERIC(10,2) AS "Cost"
        ,(quantity * unitprice)::NUMERIC(10,2) - (quantity * unitcost)::NUMERIC(10,2) AS "Margin"
    FROM source
)

SELECT * FROM final
  );
[0m11:40:06.930843 [debug] [Thread-4 (]: Using snowflake connection "model.epicaldemo.stg_inriver__item_attributes"
[0m11:40:06.931842 [debug] [Thread-4 (]: On model.epicaldemo.stg_inriver__item_attributes: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_inriver__item_attributes"} */
create or replace   view EPICALDEMO.broman_analytics.stg_inriver__item_attributes
  
   as (
    with

source as (
    select
        *
    from EPICALDEMO.inriver.item_attributes
),

final as (
    select
        id AS "item_attributes_id"
        ,sku AS "SKU"
        ,COALESCE(crunch_level, 'Missing') AS "Crunch Level"
        ,COALESCE(snack_time, 'Missing') AS "Snack Time"
    from source
)

select * from final
  );
[0m11:40:06.952910 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.876 seconds
[0m11:40:06.954909 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8242afb8-e61e-49ba-9559-cd5d80e6fbd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271E616E590>]}
[0m11:40:06.955908 [info ] [Thread-3 (]: 3 of 14 OK created sql view model broman_analytics.stg_d365_fo__items .......... [[32mSUCCESS 1[0m in 0.96s]
[0m11:40:06.956918 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_d365_fo__items
[0m11:40:06.957908 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_salesforce__customers
[0m11:40:06.958910 [info ] [Thread-3 (]: 7 of 14 START sql view model broman_analytics.stg_salesforce__customers ........ [RUN]
[0m11:40:06.958910 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__items, now model.epicaldemo.stg_salesforce__customers)
[0m11:40:06.960294 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_salesforce__customers
[0m11:40:06.965299 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_salesforce__customers"
[0m11:40:06.967299 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_salesforce__customers
[0m11:40:06.970810 [debug] [Thread-3 (]: Writing runtime sql for node "model.epicaldemo.stg_salesforce__customers"
[0m11:40:06.972815 [debug] [Thread-3 (]: Using snowflake connection "model.epicaldemo.stg_salesforce__customers"
[0m11:40:06.972815 [debug] [Thread-3 (]: On model.epicaldemo.stg_salesforce__customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_salesforce__customers"} */
create or replace   view EPICALDEMO.broman_analytics.stg_salesforce__customers
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.salesforce.customer
),

final AS (
    SELECT
        id AS "customer_id"
        ,customernumber AS "Customer Number"
        ,age AS "Customer Age"

        ,CASE
            WHEN age < 20 THEN '< 20'
            WHEN age >= 20 AND age < 30 THEN '20 - 30'
            WHEN age >= 30 AND age < 50 THEN '30 - 50'
            WHEN age >= 50 AND age < 60 THEN '50 - 60'
            ELSE '60+'
         END AS "Customer Age Group"

        ,CASE
            WHEN age < 20 THEN 1
            WHEN age >= 20 AND age < 30 THEN 2
            WHEN age >= 30 AND age < 50 THEN 3
            WHEN age >= 50 AND age < 60 THEN 4
            ELSE 5
         END AS "customer_age_group_sort"

        ,state AS "Customer State"
    FROM source
)

SELECT * FROM final
  );
[0m11:40:06.981364 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.907 seconds
[0m11:40:06.984358 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8242afb8-e61e-49ba-9559-cd5d80e6fbd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271E60BB510>]}
[0m11:40:06.984358 [info ] [Thread-2 (]: 2 of 14 OK created sql view model broman_analytics.stg_d365_fo__dates .......... [[32mSUCCESS 1[0m in 0.99s]
[0m11:40:06.985350 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_d365_fo__dates
[0m11:40:06.986351 [debug] [Thread-2 (]: Began running node snapshot.epicaldemo.stores_snapshot
[0m11:40:06.987367 [info ] [Thread-2 (]: 8 of 14 START snapshot broman_analytics.stores_snapshot ........................ [RUN]
[0m11:40:06.987367 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__dates, now snapshot.epicaldemo.stores_snapshot)
[0m11:40:06.987367 [debug] [Thread-2 (]: Began compiling node snapshot.epicaldemo.stores_snapshot
[0m11:40:06.990891 [debug] [Thread-2 (]: Began executing node snapshot.epicaldemo.stores_snapshot
[0m11:40:07.027689 [debug] [Thread-2 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m11:40:07.028690 [debug] [Thread-2 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
[0m11:40:07.131531 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.102 seconds
[0m11:40:07.171755 [debug] [Thread-2 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m11:40:07.173760 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.241 seconds
[0m11:40:07.173760 [debug] [Thread-2 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
create or replace temporary table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp"
as (
    
    
    with snapshot_query as (

        select * from EPICALDEMO.d365_fo.store

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            
  
  coalesce(nullif(modified, modified), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            modified as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.modified)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.modified)
        )
    )

    select * from insertions
    union all
    select * from updates

    )
;
[0m11:40:07.175757 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8242afb8-e61e-49ba-9559-cd5d80e6fbd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271E5C85110>]}
[0m11:40:07.177752 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.247 seconds
[0m11:40:07.178745 [info ] [Thread-4 (]: 6 of 14 OK created sql view model broman_analytics.stg_inriver__item_attributes  [[32mSUCCESS 1[0m in 0.26s]
[0m11:40:07.181287 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8242afb8-e61e-49ba-9559-cd5d80e6fbd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271E52F7ED0>]}
[0m11:40:07.182273 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_inriver__item_attributes
[0m11:40:07.183272 [info ] [Thread-1 (]: 5 of 14 OK created sql view model broman_analytics.stg_d365_fo__transactions ... [[32mSUCCESS 1[0m in 0.27s]
[0m11:40:07.183272 [debug] [Thread-4 (]: Began running node model.epicaldemo.dim_dates
[0m11:40:07.184272 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__transactions
[0m11:40:07.185285 [info ] [Thread-4 (]: 9 of 14 START sql table model broman_analytics.dim_dates ....................... [RUN]
[0m11:40:07.185285 [debug] [Thread-1 (]: Began running node model.epicaldemo.dim_items
[0m11:40:07.186273 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_inriver__item_attributes, now model.epicaldemo.dim_dates)
[0m11:40:07.186273 [info ] [Thread-1 (]: 10 of 14 START sql table model broman_analytics.dim_items ...................... [RUN]
[0m11:40:07.187274 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.dim_dates
[0m11:40:07.187274 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__transactions, now model.epicaldemo.dim_items)
[0m11:40:07.190784 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.dim_dates"
[0m11:40:07.191784 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.dim_items
[0m11:40:07.196796 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.dim_items"
[0m11:40:07.196796 [debug] [Thread-4 (]: Began executing node model.epicaldemo.dim_dates
[0m11:40:07.212828 [debug] [Thread-4 (]: Writing runtime sql for node "model.epicaldemo.dim_dates"
[0m11:40:07.213830 [debug] [Thread-1 (]: Began executing node model.epicaldemo.dim_items
[0m11:40:07.218829 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.dim_items"
[0m11:40:07.221367 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.247 seconds
[0m11:40:07.222366 [debug] [Thread-4 (]: Using snowflake connection "model.epicaldemo.dim_dates"
[0m11:40:07.224876 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8242afb8-e61e-49ba-9559-cd5d80e6fbd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271E5853D50>]}
[0m11:40:07.225876 [debug] [Thread-4 (]: On model.epicaldemo.dim_dates: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_dates"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_dates
    

    
    as (with

dates AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__dates
),

final AS (
    SELECT
        "date_id"
        ,"Date"
        ,"Year"
        ,"Year Month"
        ,"Year Month Number"
        ,"Month Number"
        ,"Quarter"
        ,"Quarter Number"
        ,"Month"
        ,"Month Short"
    FROM dates
)

SELECT * FROM final
    )
;
[0m11:40:07.226875 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.dim_items"
[0m11:40:07.227875 [info ] [Thread-3 (]: 7 of 14 OK created sql view model broman_analytics.stg_salesforce__customers ... [[32mSUCCESS 1[0m in 0.27s]
[0m11:40:07.230242 [debug] [Thread-1 (]: On model.epicaldemo.dim_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_items"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_items
    

    
    as (with

items AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__items
),

item_attributes AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_inriver__item_attributes
),

categories AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__categories
),

managers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__managers
),

unknown AS (
    SELECT
        -1 AS "item_id"
        ,'Unknown' AS "SKU"
        ,'Unknown' AS "Item"
        ,'Missing' AS "Brand"
        ,'Missing' AS "Flavor"
        ,'Missing' AS "Crunch Level"
        ,'Missing' AS "Snack Time"
        ,'Missing' AS "Category"
        ,'Missing' AS "Manager"
),

missing AS (
    SELECT
        -2 AS "item_id"
        ,'Missing' AS "SKU"
        ,'Missing' AS "Item"
        ,'Missing' AS "Brand"
        ,'Missing' AS "Flavor"
        ,'Missing' AS "Crunch Level"
        ,'Missing' AS "Snack Time"
        ,'Missing' AS "Category"
        ,'Missing' AS "Manager"
),

final AS (
    SELECT
        items."item_id"
        ,items."SKU"
        ,items."Item"
        ,items."Brand"
        ,items."Flavor"
        ,COALESCE(item_attributes."Crunch Level", 'Missing') AS "Crunch Level"
        ,COALESCE(item_attributes."Snack Time", 'Missing') AS "Snack Time"
        ,categories."Category"
        ,managers."Manager"
    FROM items
    LEFT JOIN item_attributes ON item_attributes."SKU" = items."SKU"
    LEFT JOIN categories ON categories."category_id" = items."category_id"
    LEFT JOIN managers ON managers."manager_id" = categories."manager_id"

    UNION

    SELECT * FROM unknown

    UNION

    SELECT * FROM missing
)

SELECT * FROM final
    )
;
[0m11:40:07.231242 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_salesforce__customers
[0m11:40:07.234635 [debug] [Thread-3 (]: Began running node model.epicaldemo.dim_customers
[0m11:40:07.237738 [info ] [Thread-3 (]: 11 of 14 START sql table model broman_analytics.dim_customers .................. [RUN]
[0m11:40:07.239758 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_salesforce__customers, now model.epicaldemo.dim_customers)
[0m11:40:07.240766 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.dim_customers
[0m11:40:07.244487 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.dim_customers"
[0m11:40:07.245490 [debug] [Thread-3 (]: Began executing node model.epicaldemo.dim_customers
[0m11:40:07.250997 [debug] [Thread-3 (]: Writing runtime sql for node "model.epicaldemo.dim_customers"
[0m11:40:07.253999 [debug] [Thread-3 (]: Using snowflake connection "model.epicaldemo.dim_customers"
[0m11:40:07.255009 [debug] [Thread-3 (]: On model.epicaldemo.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_customers"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_customers
    

    
    as (WITH

customers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_salesforce__customers
),

final AS (
    SELECT
        "customer_id"
        ,"Customer Number"
        ,"Customer Age"
        ,"Customer Age Group"
        ,"customer_age_group_sort"
        ,"Customer State"
    FROM customers
)

SELECT * FROM final
    )
;
[0m11:40:07.648520 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.471 seconds
[0m11:40:07.650588 [debug] [Thread-2 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m11:40:07.651588 [debug] [Thread-2 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp"
[0m11:40:07.755838 [debug] [Thread-2 (]: SQL status: SUCCESS 13 in 0.104 seconds
[0m11:40:07.759877 [debug] [Thread-2 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m11:40:07.760879 [debug] [Thread-2 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
[0m11:40:07.859604 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.604 seconds
[0m11:40:07.861604 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8242afb8-e61e-49ba-9559-cd5d80e6fbd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271E619F010>]}
[0m11:40:07.862606 [info ] [Thread-3 (]: 11 of 14 OK created sql table model broman_analytics.dim_customers ............. [[32mSUCCESS 1[0m in 0.62s]
[0m11:40:07.863605 [debug] [Thread-3 (]: Finished running node model.epicaldemo.dim_customers
[0m11:40:07.876771 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.115 seconds
[0m11:40:07.880835 [debug] [Thread-2 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m11:40:07.880835 [debug] [Thread-2 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp"
[0m11:40:07.971726 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.742 seconds
[0m11:40:07.973726 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8242afb8-e61e-49ba-9559-cd5d80e6fbd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271E60E5310>]}
[0m11:40:07.974727 [info ] [Thread-4 (]: 9 of 14 OK created sql table model broman_analytics.dim_dates .................. [[32mSUCCESS 1[0m in 0.79s]
[0m11:40:07.975727 [debug] [Thread-4 (]: Finished running node model.epicaldemo.dim_dates
[0m11:40:07.999865 [debug] [Thread-2 (]: SQL status: SUCCESS 13 in 0.118 seconds
[0m11:40:08.003875 [debug] [Thread-2 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m11:40:08.003875 [debug] [Thread-2 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
[0m11:40:08.107706 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.104 seconds
[0m11:40:08.113808 [debug] [Thread-2 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m11:40:08.114805 [debug] [Thread-2 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp"
[0m11:40:08.174505 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.942 seconds
[0m11:40:08.177505 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8242afb8-e61e-49ba-9559-cd5d80e6fbd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271E4DFA410>]}
[0m11:40:08.178507 [info ] [Thread-1 (]: 10 of 14 OK created sql table model broman_analytics.dim_items ................. [[32mSUCCESS 1[0m in 0.99s]
[0m11:40:08.178507 [debug] [Thread-1 (]: Finished running node model.epicaldemo.dim_items
[0m11:40:08.211463 [debug] [Thread-2 (]: SQL status: SUCCESS 13 in 0.096 seconds
[0m11:40:08.233363 [debug] [Thread-2 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m11:40:08.234368 [debug] [Thread-2 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from EPICALDEMO.d365_fo.store

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            
  
  coalesce(nullif(modified, modified), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            modified as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.modified)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.modified)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m11:40:08.507756 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.272 seconds
[0m11:40:08.512304 [debug] [Thread-2 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m11:40:08.513302 [debug] [Thread-2 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m11:40:08.619846 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.107 seconds
[0m11:40:08.620855 [warn ] [Thread-2 (]: Data type of snapshot table timestamp columns (TIMESTAMP_NTZ) doesn't match derived column 'updated_at' (DATE). Please update snapshot config 'updated_at'.
[0m11:40:08.620855 [debug] [Thread-2 (]: Writing runtime sql for node "snapshot.epicaldemo.stores_snapshot"
[0m11:40:08.623364 [debug] [Thread-2 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m11:40:08.623364 [debug] [Thread-2 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
BEGIN
[0m11:40:08.757516 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.133 seconds
[0m11:40:08.758516 [debug] [Thread-2 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m11:40:08.759027 [debug] [Thread-2 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
merge into "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT" as DBT_INTERNAL_DEST
    using "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
	
	
	and ((DBT_INTERNAL_DEST.dbt_valid_to = to_date('9999-12-31'))
 or DBT_INTERNAL_DEST.dbt_valid_to is null)

     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("ID", "NAME", "LOCATION", "LATITUDE", "LONGITUDE", "ONLINEPRESENCE", "MODIFIED", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("ID", "NAME", "LOCATION", "LATITUDE", "LONGITUDE", "ONLINEPRESENCE", "MODIFIED", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m11:40:09.319845 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.561 seconds
[0m11:40:09.320844 [debug] [Thread-2 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m11:40:09.320844 [debug] [Thread-2 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
COMMIT
[0m11:40:09.635939 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.314 seconds
[0m11:40:09.640468 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8242afb8-e61e-49ba-9559-cd5d80e6fbd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271E6148710>]}
[0m11:40:09.640468 [info ] [Thread-2 (]: 8 of 14 OK snapshotted broman_analytics.stores_snapshot ........................ [[32mSUCCESS 0[0m in 2.65s]
[0m11:40:09.641480 [debug] [Thread-2 (]: Finished running node snapshot.epicaldemo.stores_snapshot
[0m11:40:09.642469 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_d365_fo__stores
[0m11:40:09.643475 [info ] [Thread-3 (]: 12 of 14 START sql view model broman_analytics.stg_d365_fo__stores ............. [RUN]
[0m11:40:09.644468 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.dim_customers, now model.epicaldemo.stg_d365_fo__stores)
[0m11:40:09.644468 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_d365_fo__stores
[0m11:40:09.647473 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__stores"
[0m11:40:09.648469 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_d365_fo__stores
[0m11:40:09.652518 [debug] [Thread-3 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__stores"
[0m11:40:09.653509 [debug] [Thread-3 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__stores"
[0m11:40:09.654509 [debug] [Thread-3 (]: On model.epicaldemo.stg_d365_fo__stores: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__stores"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__stores
  
   as (
    WITH

stores_snapshots AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stores_snapshot
),

final AS (
    SELECT
        id AS "store_id"
        ,dbt_scd_id AS "dbt_scd_id"

        ,ROW_NUMBER() OVER (ORDER BY id ASC, dbt_valid_from ASC) AS "store_key"

        ,CASE WHEN dbt_valid_to = '9999-12-31' THEN 1 ELSE 0 END AS "is_current"
        ,name AS "Store"
        ,SPLIT_PART(location, ',', 1) AS "Store State"
        ,SPLIT_PART(location, ',', 2) AS "Store City"
        ,latitude AS "Lat"
        ,longitude AS "Lon"
        ,onlinepresence AS "Online Presence"
        ,modified AS "modified"
        ,CAST(TO_CHAR(dbt_valid_from::DATE, 'YYYYMMDD') AS INTEGER) AS "valid_from"
        ,CAST(TO_CHAR(dbt_valid_to::DATE, 'YYYYMMDD') AS INTEGER) AS "valid_to"
    FROM stores_snapshots
)

SELECT * FROM final
  );
[0m11:40:09.975497 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.320 seconds
[0m11:40:09.977494 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8242afb8-e61e-49ba-9559-cd5d80e6fbd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271E6A21810>]}
[0m11:40:09.978485 [info ] [Thread-3 (]: 12 of 14 OK created sql view model broman_analytics.stg_d365_fo__stores ........ [[32mSUCCESS 1[0m in 0.33s]
[0m11:40:09.979527 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_d365_fo__stores
[0m11:40:09.980528 [debug] [Thread-1 (]: Began running node model.epicaldemo.dim_stores
[0m11:40:09.980528 [debug] [Thread-2 (]: Began running node model.epicaldemo.fact_sales_transactions
[0m11:40:09.981527 [info ] [Thread-1 (]: 13 of 14 START sql table model broman_analytics.dim_stores ..................... [RUN]
[0m11:40:09.981527 [info ] [Thread-2 (]: 14 of 14 START sql table model broman_analytics.fact_sales_transactions ........ [RUN]
[0m11:40:09.982526 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.dim_items, now model.epicaldemo.dim_stores)
[0m11:40:09.982526 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly snapshot.epicaldemo.stores_snapshot, now model.epicaldemo.fact_sales_transactions)
[0m11:40:09.983530 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.dim_stores
[0m11:40:09.983530 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.fact_sales_transactions
[0m11:40:09.986535 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.dim_stores"
[0m11:40:09.989039 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.fact_sales_transactions"
[0m11:40:09.991046 [debug] [Thread-1 (]: Began executing node model.epicaldemo.dim_stores
[0m11:40:09.991046 [debug] [Thread-2 (]: Began executing node model.epicaldemo.fact_sales_transactions
[0m11:40:09.995044 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.dim_stores"
[0m11:40:09.998550 [debug] [Thread-2 (]: Writing runtime sql for node "model.epicaldemo.fact_sales_transactions"
[0m11:40:10.000554 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.dim_stores"
[0m11:40:10.000554 [debug] [Thread-1 (]: On model.epicaldemo.dim_stores: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_stores"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_stores
    

    
    as (with

store AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__stores
),

final AS (
    SELECT
        "store_key"
        ,"store_id"
        ,"is_current"
        ,"Store"
        ,"Store State"
        ,"Store City"
        ,"Lat"
        ,"Lon"
        ,"Online Presence"
        ,"modified"
        ,"valid_from"
        ,"valid_to"
    FROM store
)

SELECT * FROM final
    )
;
[0m11:40:10.002568 [debug] [Thread-2 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions"
[0m11:40:10.003555 [debug] [Thread-2 (]: On model.epicaldemo.fact_sales_transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions"} */
create or replace transient table EPICALDEMO.broman_analytics.fact_sales_transactions
    

    
    as (WITH

sales AS (
    select
        *
    from EPICALDEMO.broman_analytics.stg_d365_fo__transactions
),

items AS (
    select
        *
    from EPICALDEMO.broman_analytics.stg_d365_fo__items
),

stores AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__stores
),

customers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_salesforce__customers
),

final AS (
    SELECT
        -- Identifiers
        sales."date_id"

        ,CASE
            WHEN sales."SKU" IS NULL THEN -2 -- SKU is missing from Source
            WHEN items."item_id" IS NULL THEN -1 -- SKU is not known from Source
            ELSE items."item_id" -- Join item_id from Dim based on SKU
         END AS "item_id"

        ,CASE
            WHEN sales."Store" IS NULL THEN -2
            WHEN stores."store_key" IS NULL THEN -1
            ELSE stores."store_key"
         END AS "store_key"

        ,CASE
            WHEN sales."Customer Number" IS NULL THEN -2
            WHEN customers."customer_id" IS NULL THEN -1
            ELSE customers."customer_id"
         END AS "customer_id"

        -- Metrics
        ,sales."Qty"
        ,sales."Unit Price"
        ,sales."Sales Amount"
        ,sales."Unit Cost"
        ,sales."Cost"
        ,sales."Margin"
    FROM sales
    LEFT JOIN items ON items."SKU" = sales."SKU"
    LEFT JOIN stores ON stores."Store" = sales."Store" AND sales."date_id" >= stores."valid_from" AND sales."date_id" < stores."valid_to"
    LEFT JOIN customers ON customers."Customer Number" = sales."Customer Number"
)

SELECT * FROM final
    )
;
[0m11:40:10.625581 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.623 seconds
[0m11:40:10.627580 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8242afb8-e61e-49ba-9559-cd5d80e6fbd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271E61D1E90>]}
[0m11:40:10.628580 [info ] [Thread-1 (]: 13 of 14 OK created sql table model broman_analytics.dim_stores ................ [[32mSUCCESS 1[0m in 0.65s]
[0m11:40:10.629926 [debug] [Thread-1 (]: Finished running node model.epicaldemo.dim_stores
[0m11:40:11.243383 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.240 seconds
[0m11:40:11.246385 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8242afb8-e61e-49ba-9559-cd5d80e6fbd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271E6171410>]}
[0m11:40:11.247382 [info ] [Thread-2 (]: 14 of 14 OK created sql table model broman_analytics.fact_sales_transactions ... [[32mSUCCESS 1[0m in 1.26s]
[0m11:40:11.247382 [debug] [Thread-2 (]: Finished running node model.epicaldemo.fact_sales_transactions
[0m11:40:11.249891 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:40:11.249891 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m11:40:11.250905 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m11:40:11.403681 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m11:40:11.404677 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m11:40:11.580073 [debug] [MainThread]: Connection 'model.epicaldemo.dim_stores' was left open.
[0m11:40:11.581082 [debug] [MainThread]: On model.epicaldemo.dim_stores: Close
[0m11:40:11.755777 [debug] [MainThread]: Connection 'model.epicaldemo.fact_sales_transactions' was left open.
[0m11:40:11.756776 [debug] [MainThread]: On model.epicaldemo.fact_sales_transactions: Close
[0m11:40:11.908674 [debug] [MainThread]: Connection 'model.epicaldemo.stg_d365_fo__stores' was left open.
[0m11:40:11.909196 [debug] [MainThread]: On model.epicaldemo.stg_d365_fo__stores: Close
[0m11:40:12.092547 [debug] [MainThread]: Connection 'model.epicaldemo.dim_dates' was left open.
[0m11:40:12.093555 [debug] [MainThread]: On model.epicaldemo.dim_dates: Close
[0m11:40:12.260920 [info ] [MainThread]: 
[0m11:40:12.260920 [info ] [MainThread]: Finished running 1 snapshot, 5 table models, 8 view models in 0 hours 0 minutes and 7.93 seconds (7.93s).
[0m11:40:12.263910 [debug] [MainThread]: Command end result
[0m11:40:12.285501 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m11:40:12.290526 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m11:40:12.300063 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m11:40:12.303059 [info ] [MainThread]: 
[0m11:40:12.304061 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:40:12.305060 [info ] [MainThread]: 
[0m11:40:12.306069 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m11:40:12.307062 [debug] [MainThread]: Command `dbt build` succeeded at 11:40:12.307062 after 9.16 seconds
[0m11:40:12.308570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271E39D1D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271DE293090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271DE212190>]}
[0m11:40:12.309576 [debug] [MainThread]: Flushing usage events
[0m11:40:12.997858 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:41:14.237658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E486C73E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E486C70110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E486C739D0>]}


============================== 11:41:14.242726 | 34eb2e98-0ad1-4939-bf45-ceab9da1ce0c ==============================
[0m11:41:14.242726 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:41:14.243728 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -s dim_stores', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:41:14.645916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34eb2e98-0ad1-4939-bf45-ceab9da1ce0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E487F23E10>]}
[0m11:41:14.687548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '34eb2e98-0ad1-4939-bf45-ceab9da1ce0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E487E31650>]}
[0m11:41:14.689584 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m11:41:15.002525 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:41:15.196803 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:41:15.196803 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:41:15.202344 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m11:41:15.242986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34eb2e98-0ad1-4939-bf45-ceab9da1ce0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4871C2290>]}
[0m11:41:15.320619 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m11:41:15.324623 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m11:41:15.343707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34eb2e98-0ad1-4939-bf45-ceab9da1ce0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E487E5AE10>]}
[0m11:41:15.344709 [info ] [MainThread]: Found 13 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m11:41:15.345710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34eb2e98-0ad1-4939-bf45-ceab9da1ce0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4886DDFD0>]}
[0m11:41:15.346707 [info ] [MainThread]: 
[0m11:41:15.347724 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:41:15.348707 [info ] [MainThread]: 
[0m11:41:15.348707 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:41:15.349914 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m11:41:15.434212 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m11:41:15.435201 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m11:41:15.435201 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:41:16.158722 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.723 seconds
[0m11:41:16.164728 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m11:41:16.174279 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m11:41:16.174279 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m11:41:16.175284 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:41:16.790620 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.616 seconds
[0m11:41:16.795621 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m11:41:16.796620 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m11:41:16.935720 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.138 seconds
[0m11:41:16.938717 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m11:41:16.939221 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m11:41:17.036435 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.097 seconds
[0m11:41:17.040452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34eb2e98-0ad1-4939-bf45-ceab9da1ce0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E488807490>]}
[0m11:41:17.045453 [debug] [Thread-1 (]: Began running node model.epicaldemo.dim_stores
[0m11:41:17.046456 [info ] [Thread-1 (]: 1 of 1 START sql table model broman_analytics.dim_stores ....................... [RUN]
[0m11:41:17.047454 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.dim_stores'
[0m11:41:17.047454 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.dim_stores
[0m11:41:17.055536 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.dim_stores"
[0m11:41:17.056534 [debug] [Thread-1 (]: Began executing node model.epicaldemo.dim_stores
[0m11:41:17.097195 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.dim_stores"
[0m11:41:17.103708 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.dim_stores"
[0m11:41:17.104709 [debug] [Thread-1 (]: On model.epicaldemo.dim_stores: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_stores"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_stores
    

    
    as (with

store AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__stores
),

final AS (
    SELECT
        "store_key"
        ,"store_id"
        ,"is_current"
        ,"Store"
        ,"Store State"
        ,"Store City"
        ,"Lat"
        ,"Lon"
        ,"Online Presence"
        --,"modified"
        ,"valid_from"
        ,"valid_to"
    FROM store
)

SELECT * FROM final
    )
;
[0m11:41:17.104709 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:41:18.177722 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.072 seconds
[0m11:41:18.196761 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34eb2e98-0ad1-4939-bf45-ceab9da1ce0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E488B8C6D0>]}
[0m11:41:18.197763 [info ] [Thread-1 (]: 1 of 1 OK created sql table model broman_analytics.dim_stores .................. [[32mSUCCESS 1[0m in 1.15s]
[0m11:41:18.198761 [debug] [Thread-1 (]: Finished running node model.epicaldemo.dim_stores
[0m11:41:18.200944 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:41:18.201946 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m11:41:18.201946 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m11:41:18.368971 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m11:41:18.369976 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m11:41:18.519540 [debug] [MainThread]: Connection 'model.epicaldemo.dim_stores' was left open.
[0m11:41:18.520540 [debug] [MainThread]: On model.epicaldemo.dim_stores: Close
[0m11:41:18.674790 [info ] [MainThread]: 
[0m11:41:18.675782 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.33 seconds (3.33s).
[0m11:41:18.676794 [debug] [MainThread]: Command end result
[0m11:41:18.701981 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m11:41:18.704982 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m11:41:18.716509 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m11:41:18.717510 [info ] [MainThread]: 
[0m11:41:18.718506 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:41:18.719569 [info ] [MainThread]: 
[0m11:41:18.719569 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:41:18.723572 [debug] [MainThread]: Command `dbt run` succeeded at 11:41:18.723572 after 4.55 seconds
[0m11:41:18.725568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E486CDFF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E486CDFFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4FFCC1210>]}
[0m11:41:18.726567 [debug] [MainThread]: Flushing usage events
[0m11:41:19.244031 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:44:42.357778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259AC6798D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259AC679C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259AC679BD0>]}


============================== 11:44:42.373895 | 1b8d10b2-d1fb-431b-b490-8ff96cfa33ad ==============================
[0m11:44:42.373895 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:44:42.374893 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:44:45.674579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b8d10b2-d1fb-431b-b490-8ff96cfa33ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259AD90CD90>]}
[0m11:44:45.722773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b8d10b2-d1fb-431b-b490-8ff96cfa33ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259AB04FA50>]}
[0m11:44:45.733303 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m11:44:46.193800 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:44:47.694710 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:44:47.696709 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:44:47.702826 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m11:44:47.744515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b8d10b2-d1fb-431b-b490-8ff96cfa33ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259AE0AC650>]}
[0m11:44:48.015704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b8d10b2-d1fb-431b-b490-8ff96cfa33ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259ADDF41D0>]}
[0m11:44:48.016703 [info ] [MainThread]: Found 13 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m11:44:48.017704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b8d10b2-d1fb-431b-b490-8ff96cfa33ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259AE03ADD0>]}
[0m11:44:48.019851 [info ] [MainThread]: 
[0m11:44:48.020855 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:44:48.021853 [info ] [MainThread]: 
[0m11:44:48.022852 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:44:48.026852 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m11:44:50.793837 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m11:44:50.794836 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m11:44:50.795836 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:44:51.672408 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.877 seconds
[0m11:44:51.675406 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m11:44:51.676919 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m11:44:51.819478 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.142 seconds
[0m11:44:51.823497 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m11:44:51.824495 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m11:44:51.949501 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.124 seconds
[0m11:44:51.954505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b8d10b2-d1fb-431b-b490-8ff96cfa33ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259ADDC8A50>]}
[0m11:44:51.960047 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__categories
[0m11:44:51.961054 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_d365_fo__dates
[0m11:44:51.961054 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_d365_fo__items
[0m11:44:51.961054 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_d365_fo__managers
[0m11:44:51.962054 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__categories'
[0m11:44:51.963046 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__dates'
[0m11:44:51.963046 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__items'
[0m11:44:51.964047 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__managers'
[0m11:44:51.965046 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__categories
[0m11:44:51.965046 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_d365_fo__dates
[0m11:44:51.966046 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_d365_fo__items
[0m11:44:51.966046 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_d365_fo__managers
[0m11:44:51.974571 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__categories"
[0m11:44:51.978615 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__dates"
[0m11:44:51.981621 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__items"
[0m11:44:51.984621 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__managers"
[0m11:44:51.986623 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__categories
[0m11:44:51.986623 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_d365_fo__dates
[0m11:44:51.987622 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_d365_fo__items
[0m11:44:51.988624 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__categories
[0m11:44:51.988624 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_d365_fo__managers
[0m11:44:51.989781 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_d365_fo__dates
[0m11:44:51.990780 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_d365_fo__items
[0m11:44:51.991781 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__transactions
[0m11:44:51.991781 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_d365_fo__managers
[0m11:44:51.992792 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_inriver__item_attributes
[0m11:44:51.993787 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_salesforce__customers
[0m11:44:51.993787 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__categories, now model.epicaldemo.stg_d365_fo__transactions)
[0m11:44:51.994787 [debug] [Thread-4 (]: Began running node snapshot.epicaldemo.stores_snapshot
[0m11:44:51.994787 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__dates, now model.epicaldemo.stg_inriver__item_attributes)
[0m11:44:51.995776 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__items, now model.epicaldemo.stg_salesforce__customers)
[0m11:44:51.996780 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__transactions
[0m11:44:51.996780 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__managers, now snapshot.epicaldemo.stores_snapshot)
[0m11:44:51.997793 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_inriver__item_attributes
[0m11:44:51.997793 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_salesforce__customers
[0m11:44:52.001293 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__transactions"
[0m11:44:52.002293 [debug] [Thread-4 (]: Began compiling node snapshot.epicaldemo.stores_snapshot
[0m11:44:52.004298 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_inriver__item_attributes"
[0m11:44:52.006285 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_salesforce__customers"
[0m11:44:52.009796 [debug] [Thread-4 (]: Began executing node snapshot.epicaldemo.stores_snapshot
[0m11:44:52.010805 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__transactions
[0m11:44:52.011797 [debug] [Thread-4 (]: Finished running node snapshot.epicaldemo.stores_snapshot
[0m11:44:52.012796 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_inriver__item_attributes
[0m11:44:52.012796 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_salesforce__customers
[0m11:44:52.013796 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__transactions
[0m11:44:52.014795 [debug] [Thread-4 (]: Began running node model.epicaldemo.dim_dates
[0m11:44:52.015806 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_inriver__item_attributes
[0m11:44:52.015806 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_salesforce__customers
[0m11:44:52.016795 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__stores
[0m11:44:52.016795 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly snapshot.epicaldemo.stores_snapshot, now model.epicaldemo.dim_dates)
[0m11:44:52.017795 [debug] [Thread-2 (]: Began running node model.epicaldemo.dim_items
[0m11:44:52.018794 [debug] [Thread-3 (]: Began running node model.epicaldemo.dim_customers
[0m11:44:52.018794 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__transactions, now model.epicaldemo.stg_d365_fo__stores)
[0m11:44:52.020007 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.dim_dates
[0m11:44:52.021009 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_inriver__item_attributes, now model.epicaldemo.dim_items)
[0m11:44:52.021009 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_salesforce__customers, now model.epicaldemo.dim_customers)
[0m11:44:52.022007 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__stores
[0m11:44:52.025016 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.dim_dates"
[0m11:44:52.026007 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.dim_items
[0m11:44:52.026007 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.dim_customers
[0m11:44:52.029528 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__stores"
[0m11:44:52.033526 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.dim_items"
[0m11:44:52.035518 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.dim_customers"
[0m11:44:52.035518 [debug] [Thread-4 (]: Began executing node model.epicaldemo.dim_dates
[0m11:44:52.036519 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__stores
[0m11:44:52.037517 [debug] [Thread-2 (]: Began executing node model.epicaldemo.dim_items
[0m11:44:52.038517 [debug] [Thread-4 (]: Finished running node model.epicaldemo.dim_dates
[0m11:44:52.038517 [debug] [Thread-3 (]: Began executing node model.epicaldemo.dim_customers
[0m11:44:52.039629 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__stores
[0m11:44:52.040643 [debug] [Thread-2 (]: Finished running node model.epicaldemo.dim_items
[0m11:44:52.041639 [debug] [Thread-3 (]: Finished running node model.epicaldemo.dim_customers
[0m11:44:52.042639 [debug] [Thread-4 (]: Began running node model.epicaldemo.dim_stores
[0m11:44:52.042639 [debug] [Thread-1 (]: Began running node model.epicaldemo.fact_sales_transactions
[0m11:44:52.044629 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.dim_dates, now model.epicaldemo.dim_stores)
[0m11:44:52.044629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__stores, now model.epicaldemo.fact_sales_transactions)
[0m11:44:52.045631 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.dim_stores
[0m11:44:52.045631 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.fact_sales_transactions
[0m11:44:52.049135 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.dim_stores"
[0m11:44:52.053147 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.fact_sales_transactions"
[0m11:44:52.055142 [debug] [Thread-4 (]: Began executing node model.epicaldemo.dim_stores
[0m11:44:52.055142 [debug] [Thread-1 (]: Began executing node model.epicaldemo.fact_sales_transactions
[0m11:44:52.056141 [debug] [Thread-4 (]: Finished running node model.epicaldemo.dim_stores
[0m11:44:52.057140 [debug] [Thread-1 (]: Finished running node model.epicaldemo.fact_sales_transactions
[0m11:44:52.058644 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:44:52.059649 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m11:44:52.059649 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m11:44:52.222641 [debug] [MainThread]: Connection 'model.epicaldemo.fact_sales_transactions' was properly closed.
[0m11:44:52.223638 [debug] [MainThread]: Connection 'model.epicaldemo.dim_items' was properly closed.
[0m11:44:52.223638 [debug] [MainThread]: Connection 'model.epicaldemo.dim_customers' was properly closed.
[0m11:44:52.224627 [debug] [MainThread]: Connection 'model.epicaldemo.dim_stores' was properly closed.
[0m11:44:52.227637 [debug] [MainThread]: Command end result
[0m11:44:52.304470 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m11:44:52.333541 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m11:44:52.342569 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m11:44:52.641869 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m11:44:52.642867 [info ] [MainThread]: Building catalog
[0m11:44:52.653395 [debug] [ThreadPool]: Acquiring new snowflake connection 'EPICALDEMO.information_schema'
[0m11:44:52.677471 [debug] [ThreadPool]: Using snowflake connection "EPICALDEMO.information_schema"
[0m11:44:52.678483 [debug] [ThreadPool]: On EPICALDEMO.information_schema: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "EPICALDEMO.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from EPICALDEMO.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_items' and upper("table_name") = upper('dim_items')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_customers' and upper("table_name") = upper('dim_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__categories' and upper("table_name") = upper('stg_d365_fo__categories')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_dates' and upper("table_name") = upper('dim_dates')

                )
             or 
                (
                    
    "table_schema" ilike 'salesforce' and upper("table_schema") = upper('salesforce')

                    and 
    "table_name" ilike 'customer' and upper("table_name") = upper('customer')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stores_snapshot' and upper("table_name") = upper('stores_snapshot')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__transactions' and upper("table_name") = upper('stg_d365_fo__transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__dates' and upper("table_name") = upper('stg_d365_fo__dates')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__stores' and upper("table_name") = upper('stg_d365_fo__stores')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_inriver__item_attributes' and upper("table_name") = upper('stg_inriver__item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_salesforce__customers' and upper("table_name") = upper('stg_salesforce__customers')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__managers' and upper("table_name") = upper('stg_d365_fo__managers')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'manager' and upper("table_name") = upper('manager')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_stores' and upper("table_name") = upper('dim_stores')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'transactions' and upper("table_name") = upper('transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'date' and upper("table_name") = upper('date')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'fact_sales_transactions' and upper("table_name") = upper('fact_sales_transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'item' and upper("table_name") = upper('item')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__items' and upper("table_name") = upper('stg_d365_fo__items')

                )
             or 
                (
                    
    "table_schema" ilike 'inriver' and upper("table_schema") = upper('inriver')

                    and 
    "table_name" ilike 'item_attributes' and upper("table_name") = upper('item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'category' and upper("table_name") = upper('category')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'store' and upper("table_name") = upper('store')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from EPICALDEMO.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_items' and upper("table_name") = upper('dim_items')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_customers' and upper("table_name") = upper('dim_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__categories' and upper("table_name") = upper('stg_d365_fo__categories')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_dates' and upper("table_name") = upper('dim_dates')

                )
             or 
                (
                    
    "table_schema" ilike 'salesforce' and upper("table_schema") = upper('salesforce')

                    and 
    "table_name" ilike 'customer' and upper("table_name") = upper('customer')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stores_snapshot' and upper("table_name") = upper('stores_snapshot')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__transactions' and upper("table_name") = upper('stg_d365_fo__transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__dates' and upper("table_name") = upper('stg_d365_fo__dates')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__stores' and upper("table_name") = upper('stg_d365_fo__stores')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_inriver__item_attributes' and upper("table_name") = upper('stg_inriver__item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_salesforce__customers' and upper("table_name") = upper('stg_salesforce__customers')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__managers' and upper("table_name") = upper('stg_d365_fo__managers')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'manager' and upper("table_name") = upper('manager')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_stores' and upper("table_name") = upper('dim_stores')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'transactions' and upper("table_name") = upper('transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'date' and upper("table_name") = upper('date')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'fact_sales_transactions' and upper("table_name") = upper('fact_sales_transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'item' and upper("table_name") = upper('item')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__items' and upper("table_name") = upper('stg_d365_fo__items')

                )
             or 
                (
                    
    "table_schema" ilike 'inriver' and upper("table_schema") = upper('inriver')

                    and 
    "table_name" ilike 'item_attributes' and upper("table_name") = upper('item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'category' and upper("table_name") = upper('category')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'store' and upper("table_name") = upper('store')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m11:44:52.680490 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:45:03.072496 [debug] [ThreadPool]: SQL status: SUCCESS 153 in 10.393 seconds
[0m11:45:03.125283 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\catalog.json
[0m11:45:03.146313 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m11:45:03.148818 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m11:45:03.149827 [info ] [MainThread]: Catalog written to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\catalog.json
[0m11:45:03.151822 [debug] [MainThread]: Command `dbt docs generate` succeeded at 11:45:03.150824 after 20.89 seconds
[0m11:45:03.151822 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m11:45:03.151822 [debug] [MainThread]: Connection 'EPICALDEMO.information_schema' was left open.
[0m11:45:03.152824 [debug] [MainThread]: On EPICALDEMO.information_schema: Close
[0m11:45:03.309528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259ABF951D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259AD83CE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259A8A14CD0>]}
[0m11:45:03.310540 [debug] [MainThread]: Flushing usage events
[0m11:45:03.860488 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:45:11.447126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB14172090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB1416BC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB14170D50>]}


============================== 11:45:11.450637 | 854bd71e-308d-4a30-930a-4e70482c0750 ==============================
[0m11:45:11.450637 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:45:11.451637 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt docs serve', 'send_anonymous_usage_stats': 'True'}
[0m11:45:11.863707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '854bd71e-308d-4a30-930a-4e70482c0750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB1586E3D0>]}
[0m11:45:11.906767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '854bd71e-308d-4a30-930a-4e70482c0750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB12B4F8D0>]}
[0m11:50:48.355345 [error] [MainThread]: Encountered an error:

[0m11:50:48.371424 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m11:50:48.374425 [debug] [MainThread]: Command `dbt docs serve` failed at 11:50:48.374425 after 337.00 seconds
[0m11:50:48.375425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB141D9B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB141BEA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB141BD150>]}
[0m11:50:48.375425 [debug] [MainThread]: Flushing usage events
[0m11:50:48.900914 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:51:50.496920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F46F378A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F46F379810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F46F379310>]}


============================== 11:51:50.504439 | af4d9247-c91c-47cf-a7e8-f92b1c373a61 ==============================
[0m11:51:50.504439 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:51:50.505438 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt docs serve', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:51:51.178336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af4d9247-c91c-47cf-a7e8-f92b1c373a61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F470A1EBD0>]}
[0m11:51:51.222325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af4d9247-c91c-47cf-a7e8-f92b1c373a61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F46DB4FA50>]}
[0m11:55:35.401340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016676F6F510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016676F6F2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016676F6C650>]}


============================== 11:55:35.405342 | bc7ddfba-b0cf-497f-8f08-b4a826adf089 ==============================
[0m11:55:35.405342 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:55:35.407332 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'c:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'profiles_dir': 'c:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:55:35.510734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc7ddfba-b0cf-497f-8f08-b4a826adf089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016676DAC810>]}
[0m11:55:35.615547 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:55:35.618539 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:55:35.619624 [debug] [MainThread]: Command `cli deps` succeeded at 11:55:35.619624 after 0.29 seconds
[0m11:55:35.620637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166713751D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016671374D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016671374ED0>]}
[0m11:55:35.620637 [debug] [MainThread]: Flushing usage events
[0m11:55:36.148568 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:58:47.276603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE7DB78C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE7DB78310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE7DB79810>]}


============================== 11:58:47.291192 | 120321e4-f88e-4d68-a552-1cbd55a90c3a ==============================
[0m11:58:47.291192 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:58:47.292192 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:58:50.364444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '120321e4-f88e-4d68-a552-1cbd55a90c3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE79888FD0>]}
[0m11:58:50.408652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '120321e4-f88e-4d68-a552-1cbd55a90c3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE7EF2D7D0>]}
[0m12:01:35.209438 [error] [MainThread]: Encountered an error:

[0m12:01:35.250566 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m12:01:35.254563 [debug] [MainThread]: Command `dbt docs serve` failed at 12:01:35.254563 after 168.06 seconds
[0m12:01:35.255563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE7DB78C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE7F370790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE7DB6B550>]}
[0m12:01:35.256562 [debug] [MainThread]: Flushing usage events
[0m12:01:35.800251 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:00:56.904826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238BC96FB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238BC96F990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238BC96F810>]}


============================== 13:00:56.918825 | a9882272-5590-47e7-a871-0f6dabc378a6 ==============================
[0m13:00:56.918825 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:00:56.919826 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'c:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'version_check': 'True', 'debug': 'False', 'log_path': 'c:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:00:57.017962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9882272-5590-47e7-a871-0f6dabc378a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238BC9DF490>]}
[0m13:00:57.102999 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:00:57.105002 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:00:57.107004 [debug] [MainThread]: Command `cli deps` succeeded at 13:00:57.106002 after 0.27 seconds
[0m13:00:57.107004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238BC9B79D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238BC79E3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238B6D75190>]}
[0m13:00:57.108019 [debug] [MainThread]: Flushing usage events
[0m13:00:57.621550 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:15:33.202132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179AA16D310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179AA1B7ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179A9FAC590>]}


============================== 14:15:33.206134 | bd2a18b8-06d8-4e51-93f7-42665a37d5f3 ==============================
[0m14:15:33.206134 [info ] [MainThread]: Running with dbt=1.9.4
[0m14:15:33.207133 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'c:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'profiles_dir': 'c:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:15:33.311781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd2a18b8-06d8-4e51-93f7-42665a37d5f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179AA1F0390>]}
[0m14:15:33.387540 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:15:33.390046 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:15:33.391054 [debug] [MainThread]: Command `cli deps` succeeded at 14:15:33.391054 after 0.26 seconds
[0m14:15:33.392054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179AA163250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179AA1B7B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179AA1B7ED0>]}
[0m14:15:33.393050 [debug] [MainThread]: Flushing usage events
[0m14:15:33.978440 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:29:20.738147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C87F9D110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C8826C8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C8826E910>]}


============================== 13:29:20.743147 | 01551a5a-4e1c-48ea-bc41-557d2042d8e9 ==============================
[0m13:29:20.743147 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:29:20.745149 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'c:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'c:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:29:20.866336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01551a5a-4e1c-48ea-bc41-557d2042d8e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C882B7810>]}
[0m13:29:20.972862 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:29:20.975528 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:29:20.976534 [debug] [MainThread]: Command `cli deps` succeeded at 13:29:20.976534 after 0.32 seconds
[0m13:29:20.977533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C87B90B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C882780D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C82474E50>]}
[0m13:29:20.977533 [debug] [MainThread]: Flushing usage events
[0m13:29:21.506967 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:41:24.171377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D7A36D1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D7A1ACD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D7A36FD10>]}


============================== 18:41:24.173459 | bfadc2cb-f10d-44be-95fa-51bca25c64fb ==============================
[0m18:41:24.173459 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:41:24.173459 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'c:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'debug': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:41:24.267668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bfadc2cb-f10d-44be-95fa-51bca25c64fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D7A81DA90>]}
[0m18:41:24.345683 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m18:41:24.345683 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m18:41:24.345683 [debug] [MainThread]: Command `cli deps` succeeded at 18:41:24.345683 after 0.25 seconds
[0m18:41:24.345683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D7A3B8A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D7A3E4450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D7A378150>]}
[0m18:41:24.345683 [debug] [MainThread]: Flushing usage events
[0m18:41:24.816970 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:51:10.659136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023082C70050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023082C73D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023082C70850>]}


============================== 18:51:10.659136 | c7075bb6-3d71-4b0d-941f-dab2581a7dca ==============================
[0m18:51:10.659136 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:51:10.659136 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:51:10.674763 [info ] [MainThread]: dbt version: 1.9.4
[0m18:51:10.674763 [info ] [MainThread]: python version: 3.11.9
[0m18:51:10.688865 [info ] [MainThread]: python path: C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Scripts\python.exe
[0m18:51:10.689886 [info ] [MainThread]: os info: Windows-10-10.0.22621-SP0
[0m18:51:12.899201 [info ] [MainThread]: Using profiles dir at C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo
[0m18:51:12.901516 [info ] [MainThread]: Using profiles.yml file at C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\profiles.yml
[0m18:51:12.902010 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\dbt_project.yml
[0m18:51:12.909041 [info ] [MainThread]: adapter type: snowflake
[0m18:51:12.910033 [info ] [MainThread]: adapter version: 1.9.4
[0m18:51:12.978329 [info ] [MainThread]: Configuration:
[0m18:51:12.979193 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:51:12.980207 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:51:12.981210 [info ] [MainThread]: Required dependencies:
[0m18:51:12.981210 [debug] [MainThread]: Executing "git --help"
[0m18:51:13.019190 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:51:13.019190 [debug] [MainThread]: STDERR: "b''"
[0m18:51:13.019190 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:51:13.019190 [info ] [MainThread]: Connection:
[0m18:51:13.019190 [info ] [MainThread]:   account: XGOYSZJ-XF88916
[0m18:51:13.019190 [info ] [MainThread]:   user: epicaldemo
[0m18:51:13.019190 [info ] [MainThread]:   database: EPICALDEMO
[0m18:51:13.019190 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m18:51:13.019190 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m18:51:13.019190 [info ] [MainThread]:   schema: broman_analytics
[0m18:51:13.019190 [info ] [MainThread]:   authenticator: None
[0m18:51:13.019190 [info ] [MainThread]:   oauth_client_id: None
[0m18:51:13.019190 [info ] [MainThread]:   query_tag: None
[0m18:51:13.019190 [info ] [MainThread]:   client_session_keep_alive: False
[0m18:51:13.019190 [info ] [MainThread]:   host: None
[0m18:51:13.019190 [info ] [MainThread]:   port: None
[0m18:51:13.019190 [info ] [MainThread]:   proxy_host: None
[0m18:51:13.027944 [info ] [MainThread]:   proxy_port: None
[0m18:51:13.027944 [info ] [MainThread]:   protocol: None
[0m18:51:13.028944 [info ] [MainThread]:   connect_retries: 1
[0m18:51:13.028944 [info ] [MainThread]:   connect_timeout: None
[0m18:51:13.029946 [info ] [MainThread]:   retry_on_database_errors: False
[0m18:51:13.029946 [info ] [MainThread]:   retry_all: False
[0m18:51:13.030943 [info ] [MainThread]:   insecure_mode: False
[0m18:51:13.030943 [info ] [MainThread]:   reuse_connections: True
[0m18:51:13.031943 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m18:51:13.403992 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m18:51:15.645096 [debug] [MainThread]: Using snowflake connection "debug"
[0m18:51:15.645784 [debug] [MainThread]: On debug: select 1 as id
[0m18:51:15.646813 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:51:16.626160 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.980 seconds
[0m18:51:16.626160 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:51:16.626160 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:51:16.626160 [debug] [MainThread]: Command `dbt debug` succeeded at 18:51:16.626160 after 6.04 seconds
[0m18:51:16.626160 [debug] [MainThread]: Connection 'debug' was left open.
[0m18:51:16.626160 [debug] [MainThread]: On debug: Close
[0m18:51:16.695308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023082C6B410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023082C6BA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230FD0F3090>]}
[0m18:51:16.695308 [debug] [MainThread]: Flushing usage events
[0m18:51:17.126654 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:52:30.984318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CF1A72190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CF1A70850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CF1A70110>]}


============================== 18:52:30.984318 | 0dc5a547-b916-4672-b6f9-2e5f3630fe1f ==============================
[0m18:52:30.984318 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:52:30.984318 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt build', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:52:31.346772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0dc5a547-b916-4672-b6f9-2e5f3630fe1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CF2BFDE50>]}
[0m18:52:31.383115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0dc5a547-b916-4672-b6f9-2e5f3630fe1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CF044FA50>]}
[0m18:52:31.394168 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m18:52:31.688279 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:52:31.861483 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:52:31.861483 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:52:31.861483 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m18:52:31.907725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0dc5a547-b916-4672-b6f9-2e5f3630fe1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CF2D5EA50>]}
[0m18:52:31.982883 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m18:52:31.994952 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m18:52:32.113616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0dc5a547-b916-4672-b6f9-2e5f3630fe1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CF3752A50>]}
[0m18:52:32.114617 [info ] [MainThread]: Found 13 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m18:52:32.117630 [info ] [MainThread]: 
[0m18:52:32.117630 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:52:32.118617 [info ] [MainThread]: 
[0m18:52:32.118617 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:52:32.124136 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m18:52:32.205989 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m18:52:32.205989 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m18:52:32.206990 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:52:32.619624 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.425 seconds
[0m18:52:32.619624 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_EPICALDEMO, now create_EPICALDEMO_broman_analytics)
[0m18:52:32.635254 [debug] [ThreadPool]: Creating schema "database: "EPICALDEMO"
schema: "broman_analytics"
"
[0m18:52:32.636563 [debug] [ThreadPool]: Using snowflake connection "create_EPICALDEMO_broman_analytics"
[0m18:52:32.636563 [debug] [ThreadPool]: On create_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "create_EPICALDEMO_broman_analytics"} */
create schema if not exists EPICALDEMO.broman_analytics
[0m18:52:32.708762 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.077 seconds
[0m18:52:32.708762 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m18:52:32.724376 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m18:52:32.724376 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m18:52:32.724376 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:52:32.960146 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.236 seconds
[0m18:52:32.975650 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m18:52:32.975650 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m18:52:33.022686 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.055 seconds
[0m18:52:33.022686 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m18:52:33.022686 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m18:52:33.086313 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.064 seconds
[0m18:52:33.101319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0dc5a547-b916-4672-b6f9-2e5f3630fe1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CF11CC850>]}
[0m18:52:33.116953 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__categories
[0m18:52:33.116953 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_d365_fo__dates
[0m18:52:33.116953 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_d365_fo__items
[0m18:52:33.116953 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_d365_fo__managers
[0m18:52:33.116953 [info ] [Thread-1 (]: 1 of 14 START sql view model broman_analytics.stg_d365_fo__categories .......... [RUN]
[0m18:52:33.116953 [info ] [Thread-2 (]: 2 of 14 START sql view model broman_analytics.stg_d365_fo__dates ............... [RUN]
[0m18:52:33.116953 [info ] [Thread-3 (]: 3 of 14 START sql view model broman_analytics.stg_d365_fo__items ............... [RUN]
[0m18:52:33.116953 [info ] [Thread-4 (]: 4 of 14 START sql view model broman_analytics.stg_d365_fo__managers ............ [RUN]
[0m18:52:33.116953 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__categories'
[0m18:52:33.116953 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__dates'
[0m18:52:33.116953 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__items'
[0m18:52:33.116953 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__managers'
[0m18:52:33.116953 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__categories
[0m18:52:33.116953 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_d365_fo__dates
[0m18:52:33.116953 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_d365_fo__items
[0m18:52:33.116953 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_d365_fo__managers
[0m18:52:33.135284 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__categories"
[0m18:52:33.138156 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__dates"
[0m18:52:33.138487 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__items"
[0m18:52:33.144547 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__managers"
[0m18:52:33.146552 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__categories
[0m18:52:33.147553 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_d365_fo__items
[0m18:52:33.148552 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_d365_fo__dates
[0m18:52:33.162455 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_d365_fo__managers
[0m18:52:33.162455 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__categories"
[0m18:52:33.179818 [debug] [Thread-3 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__items"
[0m18:52:33.182806 [debug] [Thread-2 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__dates"
[0m18:52:33.184810 [debug] [Thread-4 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__managers"
[0m18:52:33.187341 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__categories"
[0m18:52:33.188337 [debug] [Thread-1 (]: On model.epicaldemo.stg_d365_fo__categories: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__categories"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__categories
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.category
),

final AS (
    SELECT
        id AS "category_id"
        ,INITCAP(name) AS "Category"
        ,managerid AS "manager_id"
    FROM source
)

SELECT * FROM final
  );
[0m18:52:33.188337 [debug] [Thread-4 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__managers"
[0m18:52:33.189336 [debug] [Thread-2 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__dates"
[0m18:52:33.190346 [debug] [Thread-3 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__items"
[0m18:52:33.190346 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:52:33.191335 [debug] [Thread-4 (]: On model.epicaldemo.stg_d365_fo__managers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__managers"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__managers
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.manager
),

final AS (
    SELECT
        id AS "manager_id"
        ,firstname || ' ' || lastname AS "Manager"
    FROM source
)

SELECT * FROM final
  );
[0m18:52:33.192345 [debug] [Thread-2 (]: On model.epicaldemo.stg_d365_fo__dates: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__dates"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__dates
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.date
),

final AS (
    SELECT
        id AS "date_id"
        ,date AS "Date"
        ,year AS "Year"
        ,yearmonth AS "Year Month"
        ,LEFT(id::TEXT, 4) || '-' || RIGHT(id::TEXT, 2) AS "Year Month Number"
        ,monthnumber AS "Month Number"
        ,quarter AS "Quarter"
        ,quarternumber AS "Quarter Number"
        ,monthname AS "Month"
        ,LEFT(monthname,3) AS "Month Short"
    FROM source
)

SELECT * FROM final
  );
[0m18:52:33.192345 [debug] [Thread-3 (]: On model.epicaldemo.stg_d365_fo__items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__items"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__items
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.item
),

final AS (
    SELECT
        id AS "item_id"
        ,name AS "Item"
        ,COALESCE(brand, 'Missing') AS "Brand"
        ,categoryid AS "category_id"
        ,COALESCE(flavor, 'Missing') AS "Flavor"
        ,sku AS "SKU"
    FROM source
)

SELECT * FROM final
  );
[0m18:52:33.195991 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:52:33.196987 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:52:33.196987 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:52:33.604782 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.410 seconds
[0m18:52:33.636032 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0dc5a547-b916-4672-b6f9-2e5f3630fe1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CF2D07910>]}
[0m18:52:33.636032 [info ] [Thread-4 (]: 4 of 14 OK created sql view model broman_analytics.stg_d365_fo__managers ....... [[32mSUCCESS 1[0m in 0.50s]
[0m18:52:33.636032 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_d365_fo__managers
[0m18:52:33.636032 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_d365_fo__transactions
[0m18:52:33.636032 [info ] [Thread-4 (]: 5 of 14 START sql view model broman_analytics.stg_d365_fo__transactions ........ [RUN]
[0m18:52:33.636032 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__managers, now model.epicaldemo.stg_d365_fo__transactions)
[0m18:52:33.636032 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_d365_fo__transactions
[0m18:52:33.636032 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__transactions"
[0m18:52:33.656461 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_d365_fo__transactions
[0m18:52:33.660414 [debug] [Thread-4 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__transactions"
[0m18:52:33.662402 [debug] [Thread-4 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__transactions"
[0m18:52:33.663416 [debug] [Thread-4 (]: On model.epicaldemo.stg_d365_fo__transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__transactions"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__transactions
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.transactions
),

final AS (
    SELECT
        -- Identifiers
        CAST(TO_CHAR(date::DATE, 'YYYYMMDD') AS INTEGER) AS "date_id"
        ,sku AS "SKU"
        ,store AS "Store"
        ,customernumber AS "Customer Number"

        -- Metrics
        ,quantity AS "Qty"
        ,unitprice::NUMERIC(10,2) AS "Unit Price"
        ,(quantity * unitprice)::NUMERIC(10,2) AS "Sales Amount"
        ,unitcost::NUMERIC(10,2) AS "Unit Cost"
        ,(quantity * unitcost)::NUMERIC(10,2) AS "Cost"
        ,(quantity * unitprice)::NUMERIC(10,2) - (quantity * unitcost)::NUMERIC(10,2) AS "Margin"
    FROM source
)

SELECT * FROM final
  );
[0m18:52:33.679404 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.484 seconds
[0m18:52:33.679404 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0dc5a547-b916-4672-b6f9-2e5f3630fe1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CF3BE23D0>]}
[0m18:52:33.679404 [info ] [Thread-2 (]: 2 of 14 OK created sql view model broman_analytics.stg_d365_fo__dates .......... [[32mSUCCESS 1[0m in 0.56s]
[0m18:52:33.679404 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_d365_fo__dates
[0m18:52:33.679404 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_inriver__item_attributes
[0m18:52:33.687412 [info ] [Thread-2 (]: 6 of 14 START sql view model broman_analytics.stg_inriver__item_attributes ..... [RUN]
[0m18:52:33.687412 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__dates, now model.epicaldemo.stg_inriver__item_attributes)
[0m18:52:33.687412 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_inriver__item_attributes
[0m18:52:33.687412 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_inriver__item_attributes"
[0m18:52:33.687412 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_inriver__item_attributes
[0m18:52:33.696935 [debug] [Thread-2 (]: Writing runtime sql for node "model.epicaldemo.stg_inriver__item_attributes"
[0m18:52:33.698935 [debug] [Thread-2 (]: Using snowflake connection "model.epicaldemo.stg_inriver__item_attributes"
[0m18:52:33.698935 [debug] [Thread-2 (]: On model.epicaldemo.stg_inriver__item_attributes: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_inriver__item_attributes"} */
create or replace   view EPICALDEMO.broman_analytics.stg_inriver__item_attributes
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.inriver.item_attributes
),

final AS (
    SELECT
        id AS "item_attributes_id"
        ,sku AS "SKU"
        ,COALESCE(crunch_level, 'Missing') AS "Crunch Level"
        ,COALESCE(snack_time, 'Missing') AS "Snack Time"
    FROM source
)

SELECT * FROM final
  );
[0m18:52:33.729704 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.550 seconds
[0m18:52:33.729704 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0dc5a547-b916-4672-b6f9-2e5f3630fe1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CF4169A10>]}
[0m18:52:33.729704 [info ] [Thread-1 (]: 1 of 14 OK created sql view model broman_analytics.stg_d365_fo__categories ..... [[32mSUCCESS 1[0m in 0.61s]
[0m18:52:33.744713 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__categories
[0m18:52:33.745765 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_salesforce__customers
[0m18:52:33.745765 [info ] [Thread-1 (]: 7 of 14 START sql view model broman_analytics.stg_salesforce__customers ........ [RUN]
[0m18:52:33.746767 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__categories, now model.epicaldemo.stg_salesforce__customers)
[0m18:52:33.747771 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_salesforce__customers
[0m18:52:33.749768 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_salesforce__customers"
[0m18:52:33.751764 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_salesforce__customers
[0m18:52:33.754767 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.stg_salesforce__customers"
[0m18:52:33.755770 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.stg_salesforce__customers"
[0m18:52:33.756767 [debug] [Thread-1 (]: On model.epicaldemo.stg_salesforce__customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_salesforce__customers"} */
create or replace   view EPICALDEMO.broman_analytics.stg_salesforce__customers
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.salesforce.customer
),

final AS (
    SELECT
        id AS "customer_id"
        ,customernumber AS "Customer Number"
        ,age AS "Customer Age"

        ,CASE
            WHEN age < 20 THEN '< 20'
            WHEN age >= 20 AND age < 30 THEN '20 - 30'
            WHEN age >= 30 AND age < 50 THEN '30 - 50'
            WHEN age >= 50 AND age < 60 THEN '50 - 60'
            ELSE '60+'
         END AS "Customer Age Group"

        ,CASE
            WHEN age < 20 THEN 1
            WHEN age >= 20 AND age < 30 THEN 2
            WHEN age >= 30 AND age < 50 THEN 3
            WHEN age >= 50 AND age < 60 THEN 4
            ELSE 5
         END AS "customer_age_group_sort"

        ,state AS "Customer State"
    FROM source
)

SELECT * FROM final
  );
[0m18:52:33.762704 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.565 seconds
[0m18:52:33.763702 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0dc5a547-b916-4672-b6f9-2e5f3630fe1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CF40A7BD0>]}
[0m18:52:33.764701 [info ] [Thread-3 (]: 3 of 14 OK created sql view model broman_analytics.stg_d365_fo__items .......... [[32mSUCCESS 1[0m in 0.65s]
[0m18:52:33.765722 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_d365_fo__items
[0m18:52:33.766698 [debug] [Thread-3 (]: Began running node snapshot.epicaldemo.stores_snapshot
[0m18:52:33.766698 [info ] [Thread-3 (]: 8 of 14 START snapshot broman_analytics.stores_snapshot ........................ [RUN]
[0m18:52:33.767713 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__items, now snapshot.epicaldemo.stores_snapshot)
[0m18:52:33.767713 [debug] [Thread-3 (]: Began compiling node snapshot.epicaldemo.stores_snapshot
[0m18:52:33.770702 [debug] [Thread-3 (]: Began executing node snapshot.epicaldemo.stores_snapshot
[0m18:52:33.828939 [debug] [Thread-3 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m18:52:33.830188 [debug] [Thread-3 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id,
        modified as dbt_updated_at,
        modified as dbt_valid_from,
        
  
  coalesce(nullif(modified, modified), to_date('9999-12-31'))
  as dbt_valid_to
from (
        select * from EPICALDEMO.d365_fo.store
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m18:52:33.846381 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.160 seconds
[0m18:52:33.861602 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0dc5a547-b916-4672-b6f9-2e5f3630fe1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CF37522D0>]}
[0m18:52:33.862660 [info ] [Thread-2 (]: 6 of 14 OK created sql view model broman_analytics.stg_inriver__item_attributes  [[32mSUCCESS 1[0m in 0.17s]
[0m18:52:33.863600 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_inriver__item_attributes
[0m18:52:33.864593 [debug] [Thread-2 (]: Began running node model.epicaldemo.dim_dates
[0m18:52:33.865585 [info ] [Thread-2 (]: 9 of 14 START sql table model broman_analytics.dim_dates ....................... [RUN]
[0m18:52:33.866587 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_inriver__item_attributes, now model.epicaldemo.dim_dates)
[0m18:52:33.866587 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.dim_dates
[0m18:52:33.869730 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.dim_dates"
[0m18:52:33.880932 [debug] [Thread-2 (]: Began executing node model.epicaldemo.dim_dates
[0m18:52:33.889803 [debug] [Thread-2 (]: Writing runtime sql for node "model.epicaldemo.dim_dates"
[0m18:52:33.889803 [debug] [Thread-2 (]: Using snowflake connection "model.epicaldemo.dim_dates"
[0m18:52:33.889803 [debug] [Thread-2 (]: On model.epicaldemo.dim_dates: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_dates"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_dates
    

    
    as (with

dates AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__dates
),

final AS (
    SELECT
        "date_id"
        ,"Date"
        ,"Year"
        ,"Year Month"
        ,"Year Month Number"
        ,"Month Number"
        ,"Quarter"
        ,"Quarter Number"
        ,"Month"
        ,"Month Short"
    FROM dates
)

SELECT * FROM final
    )
;
[0m18:52:33.928919 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 0.099 seconds
[0m18:52:33.928919 [debug] [Thread-3 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m18:52:33.928919 [debug] [Thread-3 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m18:52:33.964081 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.300 seconds
[0m18:52:33.965077 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0dc5a547-b916-4672-b6f9-2e5f3630fe1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CF4120C10>]}
[0m18:52:33.966092 [info ] [Thread-4 (]: 5 of 14 OK created sql view model broman_analytics.stg_d365_fo__transactions ... [[32mSUCCESS 1[0m in 0.33s]
[0m18:52:33.967048 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_d365_fo__transactions
[0m18:52:33.968092 [debug] [Thread-4 (]: Began running node model.epicaldemo.dim_items
[0m18:52:33.969015 [info ] [Thread-4 (]: 10 of 14 START sql table model broman_analytics.dim_items ...................... [RUN]
[0m18:52:33.970031 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__transactions, now model.epicaldemo.dim_items)
[0m18:52:33.971028 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.dim_items
[0m18:52:33.974026 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.dim_items"
[0m18:52:33.975018 [debug] [Thread-4 (]: Began executing node model.epicaldemo.dim_items
[0m18:52:33.979183 [debug] [Thread-4 (]: Writing runtime sql for node "model.epicaldemo.dim_items"
[0m18:52:33.980855 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 0.044 seconds
[0m18:52:33.981644 [warn ] [Thread-3 (]: Data type of snapshot table timestamp columns (TIMESTAMP_NTZ) doesn't match derived column 'updated_at' (DATE). Please update snapshot config 'updated_at'.
[0m18:52:33.982682 [debug] [Thread-3 (]: Writing runtime sql for node "snapshot.epicaldemo.stores_snapshot"
[0m18:52:33.987735 [debug] [Thread-4 (]: Using snowflake connection "model.epicaldemo.dim_items"
[0m18:52:33.987735 [debug] [Thread-4 (]: On model.epicaldemo.dim_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_items"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_items
    

    
    as (with

items AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__items
),

item_attributes AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_inriver__item_attributes
),

categories AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__categories
),

managers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__managers
),

unknown AS (
    SELECT
        -1 AS "item_id"
        ,'Unknown' AS "SKU"
        ,'Unknown' AS "Item"
        ,'Missing' AS "Brand"
        ,'Missing' AS "Flavor"
        ,'Missing' AS "Crunch Level"
        ,'Missing' AS "Snack Time"
        ,'Missing' AS "Category"
        ,'Missing' AS "Manager"
),

missing AS (
    SELECT
        -2 AS "item_id"
        ,'Missing' AS "SKU"
        ,'Missing' AS "Item"
        ,'Missing' AS "Brand"
        ,'Missing' AS "Flavor"
        ,'Missing' AS "Crunch Level"
        ,'Missing' AS "Snack Time"
        ,'Missing' AS "Category"
        ,'Missing' AS "Manager"
),

final AS (
    SELECT
        items."item_id"
        ,items."SKU"
        ,items."Item"
        ,items."Brand"
        ,items."Flavor"
        ,COALESCE(item_attributes."Crunch Level", 'Missing') AS "Crunch Level"
        ,COALESCE(item_attributes."Snack Time", 'Missing') AS "Snack Time"
        ,categories."Category"
        ,managers."Manager"
    FROM items
    LEFT JOIN item_attributes ON item_attributes."SKU" = items."SKU"
    LEFT JOIN categories ON categories."category_id" = items."category_id"
    LEFT JOIN managers ON managers."manager_id" = categories."manager_id"

    UNION

    SELECT * FROM unknown

    UNION

    SELECT * FROM missing
)

SELECT * FROM final
    )
;
[0m18:52:33.987735 [debug] [Thread-3 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m18:52:33.987735 [debug] [Thread-3 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
create or replace transient table EPICALDEMO.broman_analytics.stores_snapshot
    

    
    as (
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id,
        modified as dbt_updated_at,
        modified as dbt_valid_from,
        
  
  coalesce(nullif(modified, modified), to_date('9999-12-31'))
  as dbt_valid_to
from (
        select * from EPICALDEMO.d365_fo.store
    ) sbq



    )
;
[0m18:52:34.014585 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.257 seconds
[0m18:52:34.016580 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0dc5a547-b916-4672-b6f9-2e5f3630fe1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CF41F13D0>]}
[0m18:52:34.017580 [info ] [Thread-1 (]: 7 of 14 OK created sql view model broman_analytics.stg_salesforce__customers ... [[32mSUCCESS 1[0m in 0.27s]
[0m18:52:34.018649 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_salesforce__customers
[0m18:52:34.018649 [debug] [Thread-1 (]: Began running node model.epicaldemo.dim_customers
[0m18:52:34.018649 [info ] [Thread-1 (]: 11 of 14 START sql table model broman_analytics.dim_customers .................. [RUN]
[0m18:52:34.018649 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_salesforce__customers, now model.epicaldemo.dim_customers)
[0m18:52:34.018649 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.dim_customers
[0m18:52:34.018649 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.dim_customers"
[0m18:52:34.018649 [debug] [Thread-1 (]: Began executing node model.epicaldemo.dim_customers
[0m18:52:34.028971 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.dim_customers"
[0m18:52:34.030963 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.dim_customers"
[0m18:52:34.031960 [debug] [Thread-1 (]: On model.epicaldemo.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_customers"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_customers
    

    
    as (WITH

customers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_salesforce__customers
),

final AS (
    SELECT
        "customer_id"
        ,"Customer Number"
        ,"Customer Age"
        ,"Customer Age Group"
        ,"customer_age_group_sort"
        ,"Customer State"
    FROM customers
)

SELECT * FROM final
    )
;
[0m18:52:34.638126 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.645 seconds
[0m18:52:34.638126 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0dc5a547-b916-4672-b6f9-2e5f3630fe1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CF4158410>]}
[0m18:52:34.638126 [info ] [Thread-3 (]: 8 of 14 OK snapshotted broman_analytics.stores_snapshot ........................ [[32mSUCCESS 1[0m in 0.87s]
[0m18:52:34.638126 [debug] [Thread-3 (]: Finished running node snapshot.epicaldemo.stores_snapshot
[0m18:52:34.638126 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_d365_fo__stores
[0m18:52:34.638126 [info ] [Thread-3 (]: 12 of 14 START sql view model broman_analytics.stg_d365_fo__stores ............. [RUN]
[0m18:52:34.638126 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly snapshot.epicaldemo.stores_snapshot, now model.epicaldemo.stg_d365_fo__stores)
[0m18:52:34.638126 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_d365_fo__stores
[0m18:52:34.638126 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__stores"
[0m18:52:34.653678 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_d365_fo__stores
[0m18:52:34.656758 [debug] [Thread-3 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__stores"
[0m18:52:34.658444 [debug] [Thread-3 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__stores"
[0m18:52:34.659441 [debug] [Thread-3 (]: On model.epicaldemo.stg_d365_fo__stores: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__stores"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__stores
  
   as (
    WITH

stores_snapshots AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stores_snapshot
),

final AS (
    SELECT
        -- Identifiers
        id AS "store_id"

        -- SCD2 Fields
        ,dbt_scd_id AS "dbt_scd_id"
        ,ROW_NUMBER() OVER (ORDER BY id ASC, dbt_valid_from ASC) AS "store_key"
        ,CASE WHEN dbt_valid_to = '9999-12-31' THEN 1 ELSE 0 END AS "is_current"
        ,modified AS "modified"
        ,CAST(TO_CHAR(dbt_valid_from::DATE, 'YYYYMMDD') AS INTEGER) AS "valid_from"
        ,CAST(TO_CHAR(dbt_valid_to::DATE, 'YYYYMMDD') AS INTEGER) AS "valid_to"

        -- Attributes
        ,name AS "Store"
        ,SPLIT_PART(location, ',', 1) AS "Store State"
        ,SPLIT_PART(location, ',', 2) AS "Store City"
        ,latitude AS "Lat"
        ,longitude AS "Lon"
        ,onlinepresence AS "Online Presence"
    FROM stores_snapshots
)

SELECT * FROM final
  );
[0m18:52:34.796733 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.907 seconds
[0m18:52:34.796733 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0dc5a547-b916-4672-b6f9-2e5f3630fe1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CF41AAB10>]}
[0m18:52:34.796733 [info ] [Thread-2 (]: 9 of 14 OK created sql table model broman_analytics.dim_dates .................. [[32mSUCCESS 1[0m in 0.93s]
[0m18:52:34.796733 [debug] [Thread-2 (]: Finished running node model.epicaldemo.dim_dates
[0m18:52:34.851534 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.820 seconds
[0m18:52:34.851534 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0dc5a547-b916-4672-b6f9-2e5f3630fe1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CF4118D10>]}
[0m18:52:34.851534 [info ] [Thread-1 (]: 11 of 14 OK created sql table model broman_analytics.dim_customers ............. [[32mSUCCESS 1[0m in 0.83s]
[0m18:52:34.851534 [debug] [Thread-1 (]: Finished running node model.epicaldemo.dim_customers
[0m18:52:34.962288 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.303 seconds
[0m18:52:34.967351 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0dc5a547-b916-4672-b6f9-2e5f3630fe1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CF4118D50>]}
[0m18:52:34.968355 [info ] [Thread-3 (]: 12 of 14 OK created sql view model broman_analytics.stg_d365_fo__stores ........ [[32mSUCCESS 1[0m in 0.33s]
[0m18:52:34.969283 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_d365_fo__stores
[0m18:52:34.970283 [debug] [Thread-2 (]: Began running node model.epicaldemo.dim_stores
[0m18:52:34.970283 [debug] [Thread-1 (]: Began running node model.epicaldemo.fact_sales_transactions
[0m18:52:34.971365 [info ] [Thread-2 (]: 13 of 14 START sql table model broman_analytics.dim_stores ..................... [RUN]
[0m18:52:34.972287 [info ] [Thread-1 (]: 14 of 14 START sql table model broman_analytics.fact_sales_transactions ........ [RUN]
[0m18:52:34.973293 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.dim_dates, now model.epicaldemo.dim_stores)
[0m18:52:34.974283 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.dim_customers, now model.epicaldemo.fact_sales_transactions)
[0m18:52:34.974283 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.dim_stores
[0m18:52:34.975287 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.fact_sales_transactions
[0m18:52:34.978320 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.dim_stores"
[0m18:52:34.981945 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.fact_sales_transactions"
[0m18:52:34.982935 [debug] [Thread-2 (]: Began executing node model.epicaldemo.dim_stores
[0m18:52:34.983851 [debug] [Thread-1 (]: Began executing node model.epicaldemo.fact_sales_transactions
[0m18:52:34.986866 [debug] [Thread-2 (]: Writing runtime sql for node "model.epicaldemo.dim_stores"
[0m18:52:34.988858 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.fact_sales_transactions"
[0m18:52:34.989930 [debug] [Thread-2 (]: Using snowflake connection "model.epicaldemo.dim_stores"
[0m18:52:34.989930 [debug] [Thread-2 (]: On model.epicaldemo.dim_stores: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_stores"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_stores
    

    
    as (WITH

store AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__stores
),

final AS (
    SELECT
        "store_key"
        ,"store_id"
        ,"is_current"
        ,"Store"
        ,"Store State"
        ,"Store City"
        ,"Lat"
        ,"Lon"
        ,"Online Presence"
        --,"modified"
        ,"valid_from"
        ,"valid_to"
    FROM store
)

SELECT * FROM final
    )
;
[0m18:52:34.989930 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions"
[0m18:52:34.995550 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions"} */
create or replace transient table EPICALDEMO.broman_analytics.fact_sales_transactions
    

    
    as (WITH

sales AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__transactions
),

items AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__items
),

stores AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__stores
),

customers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_salesforce__customers
),

final AS (
    SELECT
        -- Identifiers
        sales."date_id"

        ,CASE
            WHEN sales."SKU" IS NULL THEN -2 -- SKU is missing FROM Source
            WHEN items."item_id" IS NULL THEN -1 -- SKU is not known FROM Source
            ELSE items."item_id" -- Join item_id FROM Dim based on SKU
         END AS "item_id"

        ,CASE
            WHEN sales."Store" IS NULL THEN -2
            WHEN stores."store_key" IS NULL THEN -1
            ELSE stores."store_key"
         END AS "store_key"

        ,CASE
            WHEN sales."Customer Number" IS NULL THEN -2
            WHEN customers."customer_id" IS NULL THEN -1
            ELSE customers."customer_id"
         END AS "customer_id"

        -- Metrics
        ,sales."Qty"
        ,sales."Unit Price"
        ,sales."Sales Amount"
        ,sales."Unit Cost"
        ,sales."Cost"
        ,sales."Margin"
    FROM sales
    LEFT JOIN items ON items."SKU" = sales."SKU"
    LEFT JOIN stores ON stores."Store" = sales."Store" AND sales."date_id" >= stores."valid_FROM" AND sales."date_id" < stores."valid_to"
    LEFT JOIN customers ON customers."Customer Number" = sales."Customer Number"
)

SELECT * FROM final
    )
;
[0m18:52:35.342479 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.360 seconds
[0m18:52:35.342479 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0dc5a547-b916-4672-b6f9-2e5f3630fe1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CF3756F10>]}
[0m18:52:35.342479 [info ] [Thread-4 (]: 10 of 14 OK created sql table model broman_analytics.dim_items ................. [[32mSUCCESS 1[0m in 1.37s]
[0m18:52:35.358101 [debug] [Thread-4 (]: Finished running node model.epicaldemo.dim_items
[0m18:52:35.439970 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bcf634-0004-ce6d-0000-d2e90002b22e
[0m18:52:35.440970 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 63 at position 78
invalid identifier 'STORES."valid_FROM"'
[0m18:52:35.443970 [debug] [Thread-1 (]: Database Error in model fact_sales_transactions (models\mart\facts\fact_sales_transactions.sql)
  000904 (42000): SQL compilation error: error line 63 at position 78
  invalid identifier 'STORES."valid_FROM"'
  compiled code at target\run\epicaldemo\models\mart\facts\fact_sales_transactions.sql
[0m18:52:35.445013 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0dc5a547-b916-4672-b6f9-2e5f3630fe1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CF4275910>]}
[0m18:52:35.445013 [error] [Thread-1 (]: 14 of 14 ERROR creating sql table model broman_analytics.fact_sales_transactions  [[31mERROR[0m in 0.47s]
[0m18:52:35.446019 [debug] [Thread-1 (]: Finished running node model.epicaldemo.fact_sales_transactions
[0m18:52:35.447018 [debug] [Thread-7 (]: Marking all children of 'model.epicaldemo.fact_sales_transactions' to be skipped because of status 'error'.  Reason: Database Error in model fact_sales_transactions (models\mart\facts\fact_sales_transactions.sql)
  000904 (42000): SQL compilation error: error line 63 at position 78
  invalid identifier 'STORES."valid_FROM"'
  compiled code at target\run\epicaldemo\models\mart\facts\fact_sales_transactions.sql.
[0m18:52:35.593446 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.607 seconds
[0m18:52:35.593446 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0dc5a547-b916-4672-b6f9-2e5f3630fe1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CF4296F90>]}
[0m18:52:35.593446 [info ] [Thread-2 (]: 13 of 14 OK created sql table model broman_analytics.dim_stores ................ [[32mSUCCESS 1[0m in 0.62s]
[0m18:52:35.593446 [debug] [Thread-2 (]: Finished running node model.epicaldemo.dim_stores
[0m18:52:35.609079 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:52:35.609079 [debug] [MainThread]: Connection 'create_EPICALDEMO_broman_analytics' was left open.
[0m18:52:35.609079 [debug] [MainThread]: On create_EPICALDEMO_broman_analytics: Close
[0m18:52:35.651463 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m18:52:35.651463 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m18:52:35.716796 [debug] [MainThread]: Connection 'model.epicaldemo.fact_sales_transactions' was left open.
[0m18:52:35.717782 [debug] [MainThread]: On model.epicaldemo.fact_sales_transactions: Close
[0m18:52:35.759159 [debug] [MainThread]: Connection 'model.epicaldemo.dim_stores' was left open.
[0m18:52:35.759159 [debug] [MainThread]: On model.epicaldemo.dim_stores: Close
[0m18:52:35.807898 [debug] [MainThread]: Connection 'model.epicaldemo.stg_d365_fo__stores' was left open.
[0m18:52:35.807898 [debug] [MainThread]: On model.epicaldemo.stg_d365_fo__stores: Close
[0m18:52:35.843588 [debug] [MainThread]: Connection 'model.epicaldemo.dim_items' was left open.
[0m18:52:35.843588 [debug] [MainThread]: On model.epicaldemo.dim_items: Close
[0m18:52:35.906652 [info ] [MainThread]: 
[0m18:52:35.906652 [info ] [MainThread]: Finished running 1 snapshot, 5 table models, 8 view models in 0 hours 0 minutes and 3.79 seconds (3.79s).
[0m18:52:35.906652 [debug] [MainThread]: Command end result
[0m18:52:35.934736 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m18:52:35.934736 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m18:52:35.947216 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m18:52:35.947216 [info ] [MainThread]: 
[0m18:52:35.947216 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:52:35.947216 [info ] [MainThread]: 
[0m18:52:35.947216 [error] [MainThread]:   Database Error in model fact_sales_transactions (models\mart\facts\fact_sales_transactions.sql)
  000904 (42000): SQL compilation error: error line 63 at position 78
  invalid identifier 'STORES."valid_FROM"'
  compiled code at target\run\epicaldemo\models\mart\facts\fact_sales_transactions.sql
[0m18:52:35.947216 [info ] [MainThread]: 
[0m18:52:35.947216 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=1 SKIP=0 TOTAL=14
[0m18:52:35.947216 [debug] [MainThread]: Command `dbt build` failed at 18:52:35.947216 after 5.03 seconds
[0m18:52:35.947216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CF1A93F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CF1AD1D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015CECF98590>]}
[0m18:52:35.947216 [debug] [MainThread]: Flushing usage events
[0m18:52:36.472004 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:53:12.070945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014702E7DF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014702E73E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014702E72750>]}


============================== 18:53:12.070945 | 2fb948ca-0dcc-434e-87aa-309f87738c92 ==============================
[0m18:53:12.070945 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:53:12.070945 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:53:12.431776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2fb948ca-0dcc-434e-87aa-309f87738c92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014702E72B50>]}
[0m18:53:12.479042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2fb948ca-0dcc-434e-87aa-309f87738c92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147041AB010>]}
[0m18:53:12.479042 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m18:53:12.776185 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:53:12.964628 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:53:12.964628 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:53:12.964628 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m18:53:13.002054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2fb948ca-0dcc-434e-87aa-309f87738c92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014704151110>]}
[0m18:53:13.079072 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m18:53:13.079072 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m18:53:13.110410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2fb948ca-0dcc-434e-87aa-309f87738c92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014704B53290>]}
[0m18:53:13.110410 [info ] [MainThread]: Found 13 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m18:53:13.110410 [info ] [MainThread]: 
[0m18:53:13.110410 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:53:13.110410 [info ] [MainThread]: 
[0m18:53:13.110410 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:53:13.110410 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m18:53:13.200516 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m18:53:13.201531 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m18:53:13.201531 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:53:13.701811 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.500 seconds
[0m18:53:13.701811 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m18:53:13.701811 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m18:53:13.701811 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m18:53:13.701811 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:53:13.939849 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.230 seconds
[0m18:53:13.939849 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m18:53:13.939849 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m18:53:14.065956 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 0.117 seconds
[0m18:53:14.065956 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m18:53:14.065956 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m18:53:14.128515 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.062 seconds
[0m18:53:14.128515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2fb948ca-0dcc-434e-87aa-309f87738c92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147045BD8D0>]}
[0m18:53:14.144102 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__categories
[0m18:53:14.144102 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_d365_fo__dates
[0m18:53:14.144102 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_d365_fo__items
[0m18:53:14.144102 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_d365_fo__managers
[0m18:53:14.144102 [info ] [Thread-1 (]: 1 of 14 START sql view model broman_analytics.stg_d365_fo__categories .......... [RUN]
[0m18:53:14.144102 [info ] [Thread-2 (]: 2 of 14 START sql view model broman_analytics.stg_d365_fo__dates ............... [RUN]
[0m18:53:14.144102 [info ] [Thread-3 (]: 3 of 14 START sql view model broman_analytics.stg_d365_fo__items ............... [RUN]
[0m18:53:14.144102 [info ] [Thread-4 (]: 4 of 14 START sql view model broman_analytics.stg_d365_fo__managers ............ [RUN]
[0m18:53:14.144102 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__categories'
[0m18:53:14.144102 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__dates'
[0m18:53:14.144102 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__items'
[0m18:53:14.144102 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__managers'
[0m18:53:14.144102 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__categories
[0m18:53:14.144102 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_d365_fo__dates
[0m18:53:14.144102 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_d365_fo__items
[0m18:53:14.144102 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_d365_fo__managers
[0m18:53:14.165060 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__categories"
[0m18:53:14.167059 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__dates"
[0m18:53:14.169059 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__items"
[0m18:53:14.171049 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__managers"
[0m18:53:14.172049 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__categories
[0m18:53:14.173052 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_d365_fo__dates
[0m18:53:14.174046 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_d365_fo__items
[0m18:53:14.195546 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__categories"
[0m18:53:14.196611 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_d365_fo__managers
[0m18:53:14.200776 [debug] [Thread-2 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__dates"
[0m18:53:14.200776 [debug] [Thread-3 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__items"
[0m18:53:14.200776 [debug] [Thread-4 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__managers"
[0m18:53:14.200776 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__categories"
[0m18:53:14.200776 [debug] [Thread-2 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__dates"
[0m18:53:14.200776 [debug] [Thread-3 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__items"
[0m18:53:14.200776 [debug] [Thread-1 (]: On model.epicaldemo.stg_d365_fo__categories: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__categories"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__categories
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.category
),

final AS (
    SELECT
        id AS "category_id"
        ,INITCAP(name) AS "Category"
        ,managerid AS "manager_id"
    FROM source
)

SELECT * FROM final
  );
[0m18:53:14.211001 [debug] [Thread-4 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__managers"
[0m18:53:14.211001 [debug] [Thread-2 (]: On model.epicaldemo.stg_d365_fo__dates: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__dates"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__dates
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.date
),

final AS (
    SELECT
        id AS "date_id"
        ,date AS "Date"
        ,year AS "Year"
        ,yearmonth AS "Year Month"
        ,LEFT(id::TEXT, 4) || '-' || RIGHT(id::TEXT, 2) AS "Year Month Number"
        ,monthnumber AS "Month Number"
        ,quarter AS "Quarter"
        ,quarternumber AS "Quarter Number"
        ,monthname AS "Month"
        ,LEFT(monthname,3) AS "Month Short"
    FROM source
)

SELECT * FROM final
  );
[0m18:53:14.212022 [debug] [Thread-3 (]: On model.epicaldemo.stg_d365_fo__items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__items"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__items
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.item
),

final AS (
    SELECT
        id AS "item_id"
        ,name AS "Item"
        ,COALESCE(brand, 'Missing') AS "Brand"
        ,categoryid AS "category_id"
        ,COALESCE(flavor, 'Missing') AS "Flavor"
        ,sku AS "SKU"
    FROM source
)

SELECT * FROM final
  );
[0m18:53:14.213009 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:53:14.213009 [debug] [Thread-4 (]: On model.epicaldemo.stg_d365_fo__managers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__managers"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__managers
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.manager
),

final AS (
    SELECT
        id AS "manager_id"
        ,firstname || ' ' || lastname AS "Manager"
    FROM source
)

SELECT * FROM final
  );
[0m18:53:14.214009 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:53:14.214009 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:53:14.216013 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:53:14.642852 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.436 seconds
[0m18:53:14.664924 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fb948ca-0dcc-434e-87aa-309f87738c92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001470520AB90>]}
[0m18:53:14.664924 [info ] [Thread-3 (]: 3 of 14 OK created sql view model broman_analytics.stg_d365_fo__items .......... [[32mSUCCESS 1[0m in 0.52s]
[0m18:53:14.664924 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_d365_fo__items
[0m18:53:14.664924 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_d365_fo__transactions
[0m18:53:14.664924 [info ] [Thread-3 (]: 5 of 14 START sql view model broman_analytics.stg_d365_fo__transactions ........ [RUN]
[0m18:53:14.664924 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__items, now model.epicaldemo.stg_d365_fo__transactions)
[0m18:53:14.664924 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_d365_fo__transactions
[0m18:53:14.675599 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__transactions"
[0m18:53:14.676399 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_d365_fo__transactions
[0m18:53:14.678898 [debug] [Thread-3 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__transactions"
[0m18:53:14.680551 [debug] [Thread-3 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__transactions"
[0m18:53:14.680551 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.469 seconds
[0m18:53:14.680551 [debug] [Thread-3 (]: On model.epicaldemo.stg_d365_fo__transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__transactions"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__transactions
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.transactions
),

final AS (
    SELECT
        -- Identifiers
        CAST(TO_CHAR(date::DATE, 'YYYYMMDD') AS INTEGER) AS "date_id"
        ,sku AS "SKU"
        ,store AS "Store"
        ,customernumber AS "Customer Number"

        -- Metrics
        ,quantity AS "Qty"
        ,unitprice::NUMERIC(10,2) AS "Unit Price"
        ,(quantity * unitprice)::NUMERIC(10,2) AS "Sales Amount"
        ,unitcost::NUMERIC(10,2) AS "Unit Cost"
        ,(quantity * unitcost)::NUMERIC(10,2) AS "Cost"
        ,(quantity * unitprice)::NUMERIC(10,2) - (quantity * unitcost)::NUMERIC(10,2) AS "Margin"
    FROM source
)

SELECT * FROM final
  );
[0m18:53:14.680551 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fb948ca-0dcc-434e-87aa-309f87738c92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014704FDEA50>]}
[0m18:53:14.680551 [info ] [Thread-2 (]: 2 of 14 OK created sql view model broman_analytics.stg_d365_fo__dates .......... [[32mSUCCESS 1[0m in 0.54s]
[0m18:53:14.680551 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_d365_fo__dates
[0m18:53:14.689190 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_inriver__item_attributes
[0m18:53:14.690196 [info ] [Thread-2 (]: 6 of 14 START sql view model broman_analytics.stg_inriver__item_attributes ..... [RUN]
[0m18:53:14.691198 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__dates, now model.epicaldemo.stg_inriver__item_attributes)
[0m18:53:14.691198 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_inriver__item_attributes
[0m18:53:14.694259 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_inriver__item_attributes"
[0m18:53:14.694822 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_inriver__item_attributes
[0m18:53:14.694822 [debug] [Thread-2 (]: Writing runtime sql for node "model.epicaldemo.stg_inriver__item_attributes"
[0m18:53:14.694822 [debug] [Thread-2 (]: Using snowflake connection "model.epicaldemo.stg_inriver__item_attributes"
[0m18:53:14.694822 [debug] [Thread-2 (]: On model.epicaldemo.stg_inriver__item_attributes: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_inriver__item_attributes"} */
create or replace   view EPICALDEMO.broman_analytics.stg_inriver__item_attributes
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.inriver.item_attributes
),

final AS (
    SELECT
        id AS "item_attributes_id"
        ,sku AS "SKU"
        ,COALESCE(crunch_level, 'Missing') AS "Crunch Level"
        ,COALESCE(snack_time, 'Missing') AS "Snack Time"
    FROM source
)

SELECT * FROM final
  );
[0m18:53:14.728367 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.524 seconds
[0m18:53:14.728367 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fb948ca-0dcc-434e-87aa-309f87738c92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147052CB310>]}
[0m18:53:14.728367 [info ] [Thread-4 (]: 4 of 14 OK created sql view model broman_analytics.stg_d365_fo__managers ....... [[32mSUCCESS 1[0m in 0.58s]
[0m18:53:14.744513 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_d365_fo__managers
[0m18:53:14.745312 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_salesforce__customers
[0m18:53:14.745312 [info ] [Thread-4 (]: 7 of 14 START sql view model broman_analytics.stg_salesforce__customers ........ [RUN]
[0m18:53:14.745312 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__managers, now model.epicaldemo.stg_salesforce__customers)
[0m18:53:14.745312 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_salesforce__customers
[0m18:53:14.745312 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_salesforce__customers"
[0m18:53:14.745312 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_salesforce__customers
[0m18:53:14.745312 [debug] [Thread-4 (]: Writing runtime sql for node "model.epicaldemo.stg_salesforce__customers"
[0m18:53:14.745312 [debug] [Thread-4 (]: Using snowflake connection "model.epicaldemo.stg_salesforce__customers"
[0m18:53:14.745312 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.545 seconds
[0m18:53:14.745312 [debug] [Thread-4 (]: On model.epicaldemo.stg_salesforce__customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_salesforce__customers"} */
create or replace   view EPICALDEMO.broman_analytics.stg_salesforce__customers
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.salesforce.customer
),

final AS (
    SELECT
        id AS "customer_id"
        ,customernumber AS "Customer Number"
        ,age AS "Customer Age"

        ,CASE
            WHEN age < 20 THEN '< 20'
            WHEN age >= 20 AND age < 30 THEN '20 - 30'
            WHEN age >= 30 AND age < 50 THEN '30 - 50'
            WHEN age >= 50 AND age < 60 THEN '50 - 60'
            ELSE '60+'
         END AS "Customer Age Group"

        ,CASE
            WHEN age < 20 THEN 1
            WHEN age >= 20 AND age < 30 THEN 2
            WHEN age >= 30 AND age < 50 THEN 3
            WHEN age >= 50 AND age < 60 THEN 4
            ELSE 5
         END AS "customer_age_group_sort"

        ,state AS "Customer State"
    FROM source
)

SELECT * FROM final
  );
[0m18:53:14.760972 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fb948ca-0dcc-434e-87aa-309f87738c92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147052B7210>]}
[0m18:53:14.761987 [info ] [Thread-1 (]: 1 of 14 OK created sql view model broman_analytics.stg_d365_fo__categories ..... [[32mSUCCESS 1[0m in 0.62s]
[0m18:53:14.763981 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__categories
[0m18:53:14.764462 [debug] [Thread-1 (]: Began running node snapshot.epicaldemo.stores_snapshot
[0m18:53:14.764970 [info ] [Thread-1 (]: 8 of 14 START snapshot broman_analytics.stores_snapshot ........................ [RUN]
[0m18:53:14.765986 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__categories, now snapshot.epicaldemo.stores_snapshot)
[0m18:53:14.766639 [debug] [Thread-1 (]: Began compiling node snapshot.epicaldemo.stores_snapshot
[0m18:53:14.769762 [debug] [Thread-1 (]: Began executing node snapshot.epicaldemo.stores_snapshot
[0m18:53:14.795681 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m18:53:14.795681 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
[0m18:53:14.855416 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.050 seconds
[0m18:53:14.893351 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m18:53:14.893351 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
create or replace temporary table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp"
as (
    
    
    with snapshot_query as (

        select * from EPICALDEMO.d365_fo.store

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            
  
  coalesce(nullif(modified, modified), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            modified as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.modified)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.modified)
        )
    )

    select * from insertions
    union all
    select * from updates

    )
;
[0m18:53:14.908975 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.209 seconds
[0m18:53:14.908975 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fb948ca-0dcc-434e-87aa-309f87738c92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001470520B250>]}
[0m18:53:14.908975 [info ] [Thread-2 (]: 6 of 14 OK created sql view model broman_analytics.stg_inriver__item_attributes  [[32mSUCCESS 1[0m in 0.22s]
[0m18:53:14.908975 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_inriver__item_attributes
[0m18:53:14.908975 [debug] [Thread-2 (]: Began running node model.epicaldemo.dim_dates
[0m18:53:14.908975 [info ] [Thread-2 (]: 9 of 14 START sql table model broman_analytics.dim_dates ....................... [RUN]
[0m18:53:14.908975 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_inriver__item_attributes, now model.epicaldemo.dim_dates)
[0m18:53:14.908975 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.dim_dates
[0m18:53:14.908975 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.dim_dates"
[0m18:53:14.908975 [debug] [Thread-2 (]: Began executing node model.epicaldemo.dim_dates
[0m18:53:14.931151 [debug] [Thread-2 (]: Writing runtime sql for node "model.epicaldemo.dim_dates"
[0m18:53:14.931151 [debug] [Thread-2 (]: Using snowflake connection "model.epicaldemo.dim_dates"
[0m18:53:14.931151 [debug] [Thread-2 (]: On model.epicaldemo.dim_dates: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_dates"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_dates
    

    
    as (with

dates AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__dates
),

final AS (
    SELECT
        "date_id"
        ,"Date"
        ,"Year"
        ,"Year Month"
        ,"Year Month Number"
        ,"Month Number"
        ,"Quarter"
        ,"Quarter Number"
        ,"Month"
        ,"Month Short"
    FROM dates
)

SELECT * FROM final
    )
;
[0m18:53:14.945323 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.259 seconds
[0m18:53:14.947230 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fb948ca-0dcc-434e-87aa-309f87738c92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014704B53AD0>]}
[0m18:53:14.948238 [info ] [Thread-3 (]: 5 of 14 OK created sql view model broman_analytics.stg_d365_fo__transactions ... [[32mSUCCESS 1[0m in 0.28s]
[0m18:53:14.949226 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_d365_fo__transactions
[0m18:53:14.949226 [debug] [Thread-3 (]: Began running node model.epicaldemo.dim_items
[0m18:53:14.950226 [info ] [Thread-3 (]: 10 of 14 START sql table model broman_analytics.dim_items ...................... [RUN]
[0m18:53:14.950226 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__transactions, now model.epicaldemo.dim_items)
[0m18:53:14.951231 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.dim_items
[0m18:53:14.951231 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.dim_items"
[0m18:53:14.951231 [debug] [Thread-3 (]: Began executing node model.epicaldemo.dim_items
[0m18:53:14.951231 [debug] [Thread-3 (]: Writing runtime sql for node "model.epicaldemo.dim_items"
[0m18:53:14.951231 [debug] [Thread-3 (]: Using snowflake connection "model.epicaldemo.dim_items"
[0m18:53:14.960897 [debug] [Thread-3 (]: On model.epicaldemo.dim_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_items"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_items
    

    
    as (with

items AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__items
),

item_attributes AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_inriver__item_attributes
),

categories AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__categories
),

managers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__managers
),

unknown AS (
    SELECT
        -1 AS "item_id"
        ,'Unknown' AS "SKU"
        ,'Unknown' AS "Item"
        ,'Missing' AS "Brand"
        ,'Missing' AS "Flavor"
        ,'Missing' AS "Crunch Level"
        ,'Missing' AS "Snack Time"
        ,'Missing' AS "Category"
        ,'Missing' AS "Manager"
),

missing AS (
    SELECT
        -2 AS "item_id"
        ,'Missing' AS "SKU"
        ,'Missing' AS "Item"
        ,'Missing' AS "Brand"
        ,'Missing' AS "Flavor"
        ,'Missing' AS "Crunch Level"
        ,'Missing' AS "Snack Time"
        ,'Missing' AS "Category"
        ,'Missing' AS "Manager"
),

final AS (
    SELECT
        items."item_id"
        ,items."SKU"
        ,items."Item"
        ,items."Brand"
        ,items."Flavor"
        ,COALESCE(item_attributes."Crunch Level", 'Missing') AS "Crunch Level"
        ,COALESCE(item_attributes."Snack Time", 'Missing') AS "Snack Time"
        ,categories."Category"
        ,managers."Manager"
    FROM items
    LEFT JOIN item_attributes ON item_attributes."SKU" = items."SKU"
    LEFT JOIN categories ON categories."category_id" = items."category_id"
    LEFT JOIN managers ON managers."manager_id" = categories."manager_id"

    UNION

    SELECT * FROM unknown

    UNION

    SELECT * FROM missing
)

SELECT * FROM final
    )
;
[0m18:53:14.967295 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.206 seconds
[0m18:53:14.969293 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fb948ca-0dcc-434e-87aa-309f87738c92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014704EE7650>]}
[0m18:53:14.969293 [info ] [Thread-4 (]: 7 of 14 OK created sql view model broman_analytics.stg_salesforce__customers ... [[32mSUCCESS 1[0m in 0.22s]
[0m18:53:14.969293 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_salesforce__customers
[0m18:53:14.971532 [debug] [Thread-4 (]: Began running node model.epicaldemo.dim_customers
[0m18:53:14.971532 [info ] [Thread-4 (]: 11 of 14 START sql table model broman_analytics.dim_customers .................. [RUN]
[0m18:53:14.972548 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_salesforce__customers, now model.epicaldemo.dim_customers)
[0m18:53:14.972548 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.dim_customers
[0m18:53:14.975545 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.dim_customers"
[0m18:53:14.976537 [debug] [Thread-4 (]: Began executing node model.epicaldemo.dim_customers
[0m18:53:14.979320 [debug] [Thread-4 (]: Writing runtime sql for node "model.epicaldemo.dim_customers"
[0m18:53:14.980999 [debug] [Thread-4 (]: Using snowflake connection "model.epicaldemo.dim_customers"
[0m18:53:14.980999 [debug] [Thread-4 (]: On model.epicaldemo.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_customers"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_customers
    

    
    as (WITH

customers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_salesforce__customers
),

final AS (
    SELECT
        "customer_id"
        ,"Customer Number"
        ,"Customer Age"
        ,"Customer Age Group"
        ,"customer_age_group_sort"
        ,"Customer State"
    FROM customers
)

SELECT * FROM final
    )
;
[0m18:53:15.440938 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.559 seconds
[0m18:53:15.456545 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m18:53:15.456545 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp"
[0m18:53:15.519518 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.060 seconds
[0m18:53:15.519518 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m18:53:15.519518 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
[0m18:53:15.566375 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.042 seconds
[0m18:53:15.566375 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m18:53:15.566375 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp"
[0m18:53:15.628894 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.049 seconds
[0m18:53:15.628894 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m18:53:15.628894 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
[0m18:53:15.628894 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.654 seconds
[0m18:53:15.628894 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fb948ca-0dcc-434e-87aa-309f87738c92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001470569B350>]}
[0m18:53:15.628894 [info ] [Thread-4 (]: 11 of 14 OK created sql table model broman_analytics.dim_customers ............. [[32mSUCCESS 1[0m in 0.66s]
[0m18:53:15.628894 [debug] [Thread-4 (]: Finished running node model.epicaldemo.dim_customers
[0m18:53:15.680487 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.743 seconds
[0m18:53:15.682486 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fb948ca-0dcc-434e-87aa-309f87738c92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147056E6490>]}
[0m18:53:15.684497 [info ] [Thread-2 (]: 9 of 14 OK created sql table model broman_analytics.dim_dates .................. [[32mSUCCESS 1[0m in 0.77s]
[0m18:53:15.684497 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.049 seconds
[0m18:53:15.684497 [debug] [Thread-2 (]: Finished running node model.epicaldemo.dim_dates
[0m18:53:15.684497 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m18:53:15.684497 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp"
[0m18:53:15.729268 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.047 seconds
[0m18:53:15.745762 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m18:53:15.745762 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from EPICALDEMO.d365_fo.store

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            
  
  coalesce(nullif(modified, modified), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            modified as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.modified)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.modified)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m18:53:15.910967 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.155 seconds
[0m18:53:15.910967 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m18:53:15.910967 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m18:53:15.966244 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.047 seconds
[0m18:53:15.966244 [warn ] [Thread-1 (]: Data type of snapshot table timestamp columns (TIMESTAMP_NTZ) doesn't match derived column 'updated_at' (DATE). Please update snapshot config 'updated_at'.
[0m18:53:15.966244 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.epicaldemo.stores_snapshot"
[0m18:53:15.966244 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m18:53:15.973269 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
BEGIN
[0m18:53:16.037892 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.064 seconds
[0m18:53:16.038890 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m18:53:16.040152 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
merge into "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT" as DBT_INTERNAL_DEST
    using "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
	
	
	and ((DBT_INTERNAL_DEST.dbt_valid_to = to_date('9999-12-31'))
 or DBT_INTERNAL_DEST.dbt_valid_to is null)

     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("ID", "NAME", "LOCATION", "LATITUDE", "LONGITUDE", "ONLINEPRESENCE", "MODIFIED", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("ID", "NAME", "LOCATION", "LATITUDE", "LONGITUDE", "ONLINEPRESENCE", "MODIFIED", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m18:53:16.313281 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.364 seconds
[0m18:53:16.328939 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fb948ca-0dcc-434e-87aa-309f87738c92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014704FE2490>]}
[0m18:53:16.328939 [info ] [Thread-3 (]: 10 of 14 OK created sql table model broman_analytics.dim_items ................. [[32mSUCCESS 1[0m in 1.38s]
[0m18:53:16.328939 [debug] [Thread-3 (]: Finished running node model.epicaldemo.dim_items
[0m18:53:16.587476 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.550 seconds
[0m18:53:16.587476 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m18:53:16.587476 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
COMMIT
[0m18:53:16.876778 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.293 seconds
[0m18:53:16.876778 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fb948ca-0dcc-434e-87aa-309f87738c92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014705763810>]}
[0m18:53:16.892416 [info ] [Thread-1 (]: 8 of 14 OK snapshotted broman_analytics.stores_snapshot ........................ [[32mSUCCESS 0[0m in 2.11s]
[0m18:53:16.892416 [debug] [Thread-1 (]: Finished running node snapshot.epicaldemo.stores_snapshot
[0m18:53:16.892416 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_d365_fo__stores
[0m18:53:16.892416 [info ] [Thread-4 (]: 12 of 14 START sql view model broman_analytics.stg_d365_fo__stores ............. [RUN]
[0m18:53:16.892416 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.dim_customers, now model.epicaldemo.stg_d365_fo__stores)
[0m18:53:16.892416 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_d365_fo__stores
[0m18:53:16.892416 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__stores"
[0m18:53:16.892416 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_d365_fo__stores
[0m18:53:16.892416 [debug] [Thread-4 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__stores"
[0m18:53:16.892416 [debug] [Thread-4 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__stores"
[0m18:53:16.892416 [debug] [Thread-4 (]: On model.epicaldemo.stg_d365_fo__stores: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__stores"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__stores
  
   as (
    WITH

stores_snapshots AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stores_snapshot
),

final AS (
    SELECT
        -- Identifiers
        id AS "store_id"

        -- SCD2 Fields
        ,dbt_scd_id AS "dbt_scd_id"
        ,ROW_NUMBER() OVER (ORDER BY id ASC, dbt_valid_from ASC) AS "store_key"
        ,CASE WHEN dbt_valid_to = '9999-12-31' THEN 1 ELSE 0 END AS "is_current"
        ,modified AS "modified"
        ,CAST(TO_CHAR(dbt_valid_from::DATE, 'YYYYMMDD') AS INTEGER) AS "valid_from"
        ,CAST(TO_CHAR(dbt_valid_to::DATE, 'YYYYMMDD') AS INTEGER) AS "valid_to"

        -- Attributes
        ,name AS "Store"
        ,SPLIT_PART(location, ',', 1) AS "Store State"
        ,SPLIT_PART(location, ',', 2) AS "Store City"
        ,latitude AS "Lat"
        ,longitude AS "Lon"
        ,onlinepresence AS "Online Presence"
    FROM stores_snapshots
)

SELECT * FROM final
  );
[0m18:53:17.168840 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.274 seconds
[0m18:53:17.168840 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fb948ca-0dcc-434e-87aa-309f87738c92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001470569BAD0>]}
[0m18:53:17.168840 [info ] [Thread-4 (]: 12 of 14 OK created sql view model broman_analytics.stg_d365_fo__stores ........ [[32mSUCCESS 1[0m in 0.28s]
[0m18:53:17.168840 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_d365_fo__stores
[0m18:53:17.184476 [debug] [Thread-3 (]: Began running node model.epicaldemo.dim_stores
[0m18:53:17.184476 [debug] [Thread-1 (]: Began running node model.epicaldemo.fact_sales_transactions
[0m18:53:17.184476 [info ] [Thread-3 (]: 13 of 14 START sql table model broman_analytics.dim_stores ..................... [RUN]
[0m18:53:17.184476 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.dim_items, now model.epicaldemo.dim_stores)
[0m18:53:17.184476 [info ] [Thread-1 (]: 14 of 14 START sql table model broman_analytics.fact_sales_transactions ........ [RUN]
[0m18:53:17.184476 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.dim_stores
[0m18:53:17.184476 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.epicaldemo.stores_snapshot, now model.epicaldemo.fact_sales_transactions)
[0m18:53:17.184476 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.dim_stores"
[0m18:53:17.184476 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.fact_sales_transactions
[0m18:53:17.184476 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.fact_sales_transactions"
[0m18:53:17.184476 [debug] [Thread-3 (]: Began executing node model.epicaldemo.dim_stores
[0m18:53:17.184476 [debug] [Thread-3 (]: Writing runtime sql for node "model.epicaldemo.dim_stores"
[0m18:53:17.184476 [debug] [Thread-1 (]: Began executing node model.epicaldemo.fact_sales_transactions
[0m18:53:17.200116 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.fact_sales_transactions"
[0m18:53:17.201188 [debug] [Thread-3 (]: Using snowflake connection "model.epicaldemo.dim_stores"
[0m18:53:17.202015 [debug] [Thread-3 (]: On model.epicaldemo.dim_stores: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_stores"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_stores
    

    
    as (WITH

store AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__stores
),

final AS (
    SELECT
        "store_key"
        ,"store_id"
        ,"is_current"
        ,"Store"
        ,"Store State"
        ,"Store City"
        ,"Lat"
        ,"Lon"
        ,"Online Presence"
        --,"modified"
        ,"valid_from"
        ,"valid_to"
    FROM store
)

SELECT * FROM final
    )
;
[0m18:53:17.204321 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions"
[0m18:53:17.205299 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions"} */
create or replace transient table EPICALDEMO.broman_analytics.fact_sales_transactions
    

    
    as (WITH

sales AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__transactions
),

items AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__items
),

stores AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__stores
),

customers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_salesforce__customers
),

final AS (
    SELECT
        -- Identifiers
        sales."date_id"

        ,CASE
            WHEN sales."SKU" IS NULL THEN -2 -- SKU is missing FROM Source
            WHEN items."item_id" IS NULL THEN -1 -- SKU is not known FROM Source
            ELSE items."item_id" -- Join item_id FROM Dim based on SKU
         END AS "item_id"

        ,CASE
            WHEN sales."Store" IS NULL THEN -2
            WHEN stores."store_key" IS NULL THEN -1
            ELSE stores."store_key"
         END AS "store_key"

        ,CASE
            WHEN sales."Customer Number" IS NULL THEN -2
            WHEN customers."customer_id" IS NULL THEN -1
            ELSE customers."customer_id"
         END AS "customer_id"

        -- Metrics
        ,sales."Qty"
        ,sales."Unit Price"
        ,sales."Sales Amount"
        ,sales."Unit Cost"
        ,sales."Cost"
        ,sales."Margin"
    FROM sales
    LEFT JOIN items ON items."SKU" = sales."SKU"
    LEFT JOIN stores ON stores."Store" = sales."Store" AND sales."date_id" >= stores."valid_from" AND sales."date_id" < stores."valid_to"
    LEFT JOIN customers ON customers."Customer Number" = sales."Customer Number"
)

SELECT * FROM final
    )
;
[0m18:53:17.951210 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.757 seconds
[0m18:53:17.951210 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fb948ca-0dcc-434e-87aa-309f87738c92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147057503D0>]}
[0m18:53:17.966810 [info ] [Thread-3 (]: 13 of 14 OK created sql table model broman_analytics.dim_stores ................ [[32mSUCCESS 1[0m in 0.77s]
[0m18:53:17.966810 [debug] [Thread-3 (]: Finished running node model.epicaldemo.dim_stores
[0m18:53:18.502191 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.306 seconds
[0m18:53:18.502191 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fb948ca-0dcc-434e-87aa-309f87738c92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014705759CD0>]}
[0m18:53:18.502191 [info ] [Thread-1 (]: 14 of 14 OK created sql table model broman_analytics.fact_sales_transactions ... [[32mSUCCESS 1[0m in 1.32s]
[0m18:53:18.502191 [debug] [Thread-1 (]: Finished running node model.epicaldemo.fact_sales_transactions
[0m18:53:18.517835 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:53:18.517835 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m18:53:18.517835 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m18:53:18.581905 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m18:53:18.581905 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m18:53:18.627247 [debug] [MainThread]: Connection 'model.epicaldemo.fact_sales_transactions' was left open.
[0m18:53:18.627247 [debug] [MainThread]: On model.epicaldemo.fact_sales_transactions: Close
[0m18:53:18.674569 [debug] [MainThread]: Connection 'model.epicaldemo.dim_dates' was left open.
[0m18:53:18.674569 [debug] [MainThread]: On model.epicaldemo.dim_dates: Close
[0m18:53:18.721553 [debug] [MainThread]: Connection 'model.epicaldemo.dim_stores' was left open.
[0m18:53:18.721553 [debug] [MainThread]: On model.epicaldemo.dim_stores: Close
[0m18:53:18.784669 [debug] [MainThread]: Connection 'model.epicaldemo.stg_d365_fo__stores' was left open.
[0m18:53:18.784669 [debug] [MainThread]: On model.epicaldemo.stg_d365_fo__stores: Close
[0m18:53:18.831689 [info ] [MainThread]: 
[0m18:53:18.831689 [info ] [MainThread]: Finished running 1 snapshot, 5 table models, 8 view models in 0 hours 0 minutes and 5.72 seconds (5.72s).
[0m18:53:18.847188 [debug] [MainThread]: Command end result
[0m18:53:18.869609 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m18:53:18.872150 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m18:53:18.881188 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m18:53:18.882188 [info ] [MainThread]: 
[0m18:53:18.883186 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:53:18.883186 [info ] [MainThread]: 
[0m18:53:18.884189 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m18:53:18.885187 [debug] [MainThread]: Command `dbt build` succeeded at 18:53:18.885187 after 6.88 seconds
[0m18:53:18.885187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146FD2F3090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001470561C410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146FD272190>]}
[0m18:53:18.885187 [debug] [MainThread]: Flushing usage events
[0m18:53:19.392513 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:02:14.923375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197BDF8FD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197BDF73590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197BDF72B50>]}


============================== 19:02:14.940551 | ba04be05-4333-4240-a193-2b61f3388b0d ==============================
[0m19:02:14.940551 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:02:14.940551 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:02:17.199366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba04be05-4333-4240-a193-2b61f3388b0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197BD923B90>]}
[0m19:02:17.230614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ba04be05-4333-4240-a193-2b61f3388b0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197BF331810>]}
[0m19:02:17.246249 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m19:02:17.620734 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:02:18.593333 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:02:18.593333 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:02:18.593333 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m19:02:18.637503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ba04be05-4333-4240-a193-2b61f3388b0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197BF3A8410>]}
[0m19:02:18.710351 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m19:02:18.732254 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m19:02:18.920777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ba04be05-4333-4240-a193-2b61f3388b0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197BF667010>]}
[0m19:02:18.920777 [info ] [MainThread]: Found 13 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m19:02:18.920777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba04be05-4333-4240-a193-2b61f3388b0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197BFC123D0>]}
[0m19:02:18.920777 [info ] [MainThread]: 
[0m19:02:18.920777 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:02:18.920777 [info ] [MainThread]: 
[0m19:02:18.920777 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:02:18.920777 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m19:02:21.135023 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m19:02:21.135023 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m19:02:21.135023 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:02:21.668368 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.531 seconds
[0m19:02:21.689181 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m19:02:21.698332 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m19:02:21.698332 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m19:02:21.698332 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:02:22.106564 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.405 seconds
[0m19:02:22.106564 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m19:02:22.106564 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m19:02:22.203525 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.099 seconds
[0m19:02:22.216568 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m19:02:22.216568 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m19:02:22.263455 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.055 seconds
[0m19:02:22.279016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba04be05-4333-4240-a193-2b61f3388b0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197BC43B1D0>]}
[0m19:02:22.282088 [debug] [Thread-1 (]: Began running node snapshot.epicaldemo.stores_snapshot
[0m19:02:22.282088 [info ] [Thread-1 (]: 1 of 1 START snapshot broman_analytics.stores_snapshot ......................... [RUN]
[0m19:02:22.282088 [debug] [Thread-1 (]: Acquiring new snowflake connection 'snapshot.epicaldemo.stores_snapshot'
[0m19:02:22.282088 [debug] [Thread-1 (]: Began compiling node snapshot.epicaldemo.stores_snapshot
[0m19:02:22.295103 [debug] [Thread-1 (]: Began executing node snapshot.epicaldemo.stores_snapshot
[0m19:02:22.332317 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m19:02:22.347350 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
[0m19:02:22.347350 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:02:22.602986 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.263 seconds
[0m19:02:22.649765 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m19:02:22.649765 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
create or replace temporary table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp"
as (
    
    
    with snapshot_query as (

        select * from EPICALDEMO.d365_fo.store

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            
  
  coalesce(nullif(modified, modified), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            modified as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.modified)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.modified)
        )
    )

    select * from insertions
    union all
    select * from updates

    )
;
[0m19:02:23.583140 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.930 seconds
[0m19:02:23.583140 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m19:02:23.583140 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp"
[0m19:02:23.643650 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.059 seconds
[0m19:02:23.659252 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m19:02:23.659252 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
[0m19:02:23.721907 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.059 seconds
[0m19:02:23.721907 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m19:02:23.721907 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp"
[0m19:02:23.768828 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.044 seconds
[0m19:02:23.776010 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m19:02:23.776010 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
[0m19:02:23.830648 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.050 seconds
[0m19:02:23.830648 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m19:02:23.830648 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp"
[0m19:02:23.877637 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.039 seconds
[0m19:02:23.893774 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m19:02:23.893774 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from EPICALDEMO.d365_fo.store

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            
  
  coalesce(nullif(modified, modified), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            modified as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.modified)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.modified)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m19:02:24.035144 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.138 seconds
[0m19:02:24.035144 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m19:02:24.035144 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m19:02:24.084044 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.039 seconds
[0m19:02:24.084044 [warn ] [Thread-1 (]: Data type of snapshot table timestamp columns (TIMESTAMP_NTZ) doesn't match derived column 'updated_at' (DATE). Please update snapshot config 'updated_at'.
[0m19:02:24.084044 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.epicaldemo.stores_snapshot"
[0m19:02:24.084044 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m19:02:24.084044 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
BEGIN
[0m19:02:24.165246 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.074 seconds
[0m19:02:24.166261 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m19:02:24.167321 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
merge into "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT" as DBT_INTERNAL_DEST
    using "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
	
	
	and ((DBT_INTERNAL_DEST.dbt_valid_to = to_date('9999-12-31'))
 or DBT_INTERNAL_DEST.dbt_valid_to is null)

     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("ID", "NAME", "LOCATION", "LATITUDE", "LONGITUDE", "ONLINEPRESENCE", "MODIFIED", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("ID", "NAME", "LOCATION", "LATITUDE", "LONGITUDE", "ONLINEPRESENCE", "MODIFIED", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m19:02:24.771476 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.607 seconds
[0m19:02:24.771476 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m19:02:24.771476 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
COMMIT
[0m19:02:24.991842 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.223 seconds
[0m19:02:25.023161 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba04be05-4333-4240-a193-2b61f3388b0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197BF613F10>]}
[0m19:02:25.023161 [info ] [Thread-1 (]: 1 of 1 OK snapshotted broman_analytics.stores_snapshot ......................... [[32mSUCCESS 10[0m in 2.74s]
[0m19:02:25.023161 [debug] [Thread-1 (]: Finished running node snapshot.epicaldemo.stores_snapshot
[0m19:02:25.023161 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:02:25.023161 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m19:02:25.023161 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m19:02:25.087271 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m19:02:25.087271 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m19:02:25.148296 [debug] [MainThread]: Connection 'snapshot.epicaldemo.stores_snapshot' was left open.
[0m19:02:25.148296 [debug] [MainThread]: On snapshot.epicaldemo.stores_snapshot: Close
[0m19:02:25.211534 [info ] [MainThread]: 
[0m19:02:25.211534 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 6.29 seconds (6.29s).
[0m19:02:25.211534 [debug] [MainThread]: Command end result
[0m19:02:25.239133 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m19:02:25.239133 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m19:02:25.249052 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m19:02:25.249052 [info ] [MainThread]: 
[0m19:02:25.249052 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:02:25.249052 [info ] [MainThread]: 
[0m19:02:25.249052 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:02:25.249052 [debug] [MainThread]: Command `dbt snapshot` succeeded at 19:02:25.249052 after 10.41 seconds
[0m19:02:25.249052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197BC041410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197B8893010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197B8812190>]}
[0m19:02:25.249052 [debug] [MainThread]: Flushing usage events
[0m19:02:25.651084 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:05:01.291166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F31E078290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F31E0BAA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F31E0BA290>]}


============================== 19:05:01.291166 | 6534a8ea-290a-482e-917b-d7a75e60a1e0 ==============================
[0m19:05:01.291166 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:05:01.291166 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:05:01.660594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6534a8ea-290a-482e-917b-d7a75e60a1e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F31E08DE90>]}
[0m19:05:01.698509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6534a8ea-290a-482e-917b-d7a75e60a1e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F31F4B6790>]}
[0m19:05:01.698509 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m19:05:01.993797 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:05:02.181844 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:05:02.182358 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:05:02.187239 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m19:05:02.219720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6534a8ea-290a-482e-917b-d7a75e60a1e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F31F9B2610>]}
[0m19:05:02.266167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6534a8ea-290a-482e-917b-d7a75e60a1e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F31F8ECA50>]}
[0m19:05:02.267166 [info ] [MainThread]: Found 13 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m19:05:02.268173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6534a8ea-290a-482e-917b-d7a75e60a1e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F31F93D910>]}
[0m19:05:02.270179 [info ] [MainThread]: 
[0m19:05:02.271172 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:05:02.272174 [info ] [MainThread]: 
[0m19:05:02.273263 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:05:02.278358 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m19:05:02.357654 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m19:05:02.357654 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m19:05:02.358668 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:05:02.774458 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.416 seconds
[0m19:05:02.779527 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m19:05:02.779527 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m19:05:02.850089 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.069 seconds
[0m19:05:02.853274 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m19:05:02.854385 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m19:05:02.919999 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.064 seconds
[0m19:05:02.926983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6534a8ea-290a-482e-917b-d7a75e60a1e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F31F960110>]}
[0m19:05:02.932113 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__categories
[0m19:05:02.932113 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_d365_fo__dates
[0m19:05:02.932113 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_d365_fo__items
[0m19:05:02.932113 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__categories'
[0m19:05:02.932113 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_d365_fo__managers
[0m19:05:02.932113 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__dates'
[0m19:05:02.932113 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__items'
[0m19:05:02.932113 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__categories
[0m19:05:02.932113 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__managers'
[0m19:05:02.932113 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_d365_fo__dates
[0m19:05:02.932113 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_d365_fo__items
[0m19:05:02.932113 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__categories"
[0m19:05:02.932113 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_d365_fo__managers
[0m19:05:02.947140 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__dates"
[0m19:05:02.947140 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__items"
[0m19:05:02.947140 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__managers"
[0m19:05:02.947140 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__categories
[0m19:05:02.947140 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_d365_fo__dates
[0m19:05:02.947140 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_d365_fo__items
[0m19:05:02.947140 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__categories
[0m19:05:02.947140 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_d365_fo__managers
[0m19:05:02.947140 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_d365_fo__dates
[0m19:05:02.947140 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_d365_fo__items
[0m19:05:02.947140 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__transactions
[0m19:05:02.947140 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_d365_fo__managers
[0m19:05:02.947140 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_inriver__item_attributes
[0m19:05:02.947140 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_salesforce__customers
[0m19:05:02.947140 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__categories, now model.epicaldemo.stg_d365_fo__transactions)
[0m19:05:02.947140 [debug] [Thread-4 (]: Began running node snapshot.epicaldemo.stores_snapshot
[0m19:05:02.947140 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__dates, now model.epicaldemo.stg_inriver__item_attributes)
[0m19:05:02.962152 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__items, now model.epicaldemo.stg_salesforce__customers)
[0m19:05:02.962152 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__transactions
[0m19:05:02.962152 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__managers, now snapshot.epicaldemo.stores_snapshot)
[0m19:05:02.963166 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_inriver__item_attributes
[0m19:05:02.963166 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_salesforce__customers
[0m19:05:02.963166 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__transactions"
[0m19:05:02.963166 [debug] [Thread-4 (]: Began compiling node snapshot.epicaldemo.stores_snapshot
[0m19:05:02.963166 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_inriver__item_attributes"
[0m19:05:02.963166 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_salesforce__customers"
[0m19:05:02.963166 [debug] [Thread-4 (]: Began executing node snapshot.epicaldemo.stores_snapshot
[0m19:05:02.963166 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__transactions
[0m19:05:02.963166 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_inriver__item_attributes
[0m19:05:02.963166 [debug] [Thread-4 (]: Finished running node snapshot.epicaldemo.stores_snapshot
[0m19:05:02.963166 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_salesforce__customers
[0m19:05:02.963166 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__transactions
[0m19:05:02.963166 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_inriver__item_attributes
[0m19:05:02.963166 [debug] [Thread-4 (]: Began running node model.epicaldemo.dim_dates
[0m19:05:02.978798 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_salesforce__customers
[0m19:05:02.978798 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__stores
[0m19:05:02.978798 [debug] [Thread-2 (]: Began running node model.epicaldemo.dim_items
[0m19:05:02.978798 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly snapshot.epicaldemo.stores_snapshot, now model.epicaldemo.dim_dates)
[0m19:05:02.978798 [debug] [Thread-3 (]: Began running node model.epicaldemo.dim_customers
[0m19:05:02.978798 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__transactions, now model.epicaldemo.stg_d365_fo__stores)
[0m19:05:02.978798 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_inriver__item_attributes, now model.epicaldemo.dim_items)
[0m19:05:02.978798 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.dim_dates
[0m19:05:02.978798 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_salesforce__customers, now model.epicaldemo.dim_customers)
[0m19:05:02.978798 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__stores
[0m19:05:02.978798 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.dim_items
[0m19:05:02.978798 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.dim_dates"
[0m19:05:02.978798 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.dim_customers
[0m19:05:02.978798 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__stores"
[0m19:05:02.978798 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.dim_items"
[0m19:05:02.994428 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.dim_customers"
[0m19:05:02.994428 [debug] [Thread-4 (]: Began executing node model.epicaldemo.dim_dates
[0m19:05:02.994428 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__stores
[0m19:05:02.994428 [debug] [Thread-4 (]: Finished running node model.epicaldemo.dim_dates
[0m19:05:02.994428 [debug] [Thread-2 (]: Began executing node model.epicaldemo.dim_items
[0m19:05:02.994428 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__stores
[0m19:05:02.994428 [debug] [Thread-3 (]: Began executing node model.epicaldemo.dim_customers
[0m19:05:02.994428 [debug] [Thread-2 (]: Finished running node model.epicaldemo.dim_items
[0m19:05:02.994428 [debug] [Thread-4 (]: Began running node model.epicaldemo.dim_stores
[0m19:05:02.994428 [debug] [Thread-1 (]: Began running node model.epicaldemo.fact_sales_transactions
[0m19:05:02.994428 [debug] [Thread-3 (]: Finished running node model.epicaldemo.dim_customers
[0m19:05:02.994428 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.dim_dates, now model.epicaldemo.dim_stores)
[0m19:05:02.994428 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__stores, now model.epicaldemo.fact_sales_transactions)
[0m19:05:02.994428 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.dim_stores
[0m19:05:02.994428 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.fact_sales_transactions
[0m19:05:02.994428 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.dim_stores"
[0m19:05:02.994428 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.fact_sales_transactions"
[0m19:05:03.010053 [debug] [Thread-4 (]: Began executing node model.epicaldemo.dim_stores
[0m19:05:03.010053 [debug] [Thread-4 (]: Finished running node model.epicaldemo.dim_stores
[0m19:05:03.010053 [debug] [Thread-1 (]: Began executing node model.epicaldemo.fact_sales_transactions
[0m19:05:03.010053 [debug] [Thread-1 (]: Finished running node model.epicaldemo.fact_sales_transactions
[0m19:05:03.010053 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:05:03.010053 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m19:05:03.010053 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m19:05:03.088645 [debug] [MainThread]: Connection 'model.epicaldemo.fact_sales_transactions' was properly closed.
[0m19:05:03.088645 [debug] [MainThread]: Connection 'model.epicaldemo.dim_items' was properly closed.
[0m19:05:03.088645 [debug] [MainThread]: Connection 'model.epicaldemo.dim_customers' was properly closed.
[0m19:05:03.088645 [debug] [MainThread]: Connection 'model.epicaldemo.dim_stores' was properly closed.
[0m19:05:03.088645 [debug] [MainThread]: Command end result
[0m19:05:03.162714 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m19:05:03.167221 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m19:05:03.167221 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m19:05:03.470217 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m19:05:03.470217 [info ] [MainThread]: Building catalog
[0m19:05:03.485850 [debug] [ThreadPool]: Acquiring new snowflake connection 'EPICALDEMO.information_schema'
[0m19:05:03.502549 [debug] [ThreadPool]: Using snowflake connection "EPICALDEMO.information_schema"
[0m19:05:03.503558 [debug] [ThreadPool]: On EPICALDEMO.information_schema: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "EPICALDEMO.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from EPICALDEMO.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_customers' and upper("table_name") = upper('dim_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'transactions' and upper("table_name") = upper('transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_inriver__item_attributes' and upper("table_name") = upper('stg_inriver__item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__managers' and upper("table_name") = upper('stg_d365_fo__managers')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__dates' and upper("table_name") = upper('stg_d365_fo__dates')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__items' and upper("table_name") = upper('stg_d365_fo__items')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'item' and upper("table_name") = upper('item')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'category' and upper("table_name") = upper('category')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__categories' and upper("table_name") = upper('stg_d365_fo__categories')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_items' and upper("table_name") = upper('dim_items')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__transactions' and upper("table_name") = upper('stg_d365_fo__transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'date' and upper("table_name") = upper('date')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'manager' and upper("table_name") = upper('manager')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__stores' and upper("table_name") = upper('stg_d365_fo__stores')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_dates' and upper("table_name") = upper('dim_dates')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stores_snapshot' and upper("table_name") = upper('stores_snapshot')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_stores' and upper("table_name") = upper('dim_stores')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'fact_sales_transactions' and upper("table_name") = upper('fact_sales_transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'inriver' and upper("table_schema") = upper('inriver')

                    and 
    "table_name" ilike 'item_attributes' and upper("table_name") = upper('item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_salesforce__customers' and upper("table_name") = upper('stg_salesforce__customers')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'store' and upper("table_name") = upper('store')

                )
             or 
                (
                    
    "table_schema" ilike 'salesforce' and upper("table_schema") = upper('salesforce')

                    and 
    "table_name" ilike 'customer' and upper("table_name") = upper('customer')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from EPICALDEMO.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_customers' and upper("table_name") = upper('dim_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'transactions' and upper("table_name") = upper('transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_inriver__item_attributes' and upper("table_name") = upper('stg_inriver__item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__managers' and upper("table_name") = upper('stg_d365_fo__managers')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__dates' and upper("table_name") = upper('stg_d365_fo__dates')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__items' and upper("table_name") = upper('stg_d365_fo__items')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'item' and upper("table_name") = upper('item')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'category' and upper("table_name") = upper('category')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__categories' and upper("table_name") = upper('stg_d365_fo__categories')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_items' and upper("table_name") = upper('dim_items')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__transactions' and upper("table_name") = upper('stg_d365_fo__transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'date' and upper("table_name") = upper('date')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'manager' and upper("table_name") = upper('manager')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__stores' and upper("table_name") = upper('stg_d365_fo__stores')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_dates' and upper("table_name") = upper('dim_dates')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stores_snapshot' and upper("table_name") = upper('stores_snapshot')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_stores' and upper("table_name") = upper('dim_stores')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'fact_sales_transactions' and upper("table_name") = upper('fact_sales_transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'inriver' and upper("table_schema") = upper('inriver')

                    and 
    "table_name" ilike 'item_attributes' and upper("table_name") = upper('item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_salesforce__customers' and upper("table_name") = upper('stg_salesforce__customers')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'store' and upper("table_name") = upper('store')

                )
             or 
                (
                    
    "table_schema" ilike 'salesforce' and upper("table_schema") = upper('salesforce')

                    and 
    "table_name" ilike 'customer' and upper("table_name") = upper('customer')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m19:05:03.504481 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:05:11.984531 [debug] [ThreadPool]: SQL status: SUCCESS 153 in 8.486 seconds
[0m19:05:12.033475 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\catalog.json
[0m19:05:12.066899 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m19:05:12.066899 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m19:05:12.066899 [info ] [MainThread]: Catalog written to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\catalog.json
[0m19:05:12.066899 [debug] [MainThread]: Command `dbt docs generate` succeeded at 19:05:12.066899 after 10.83 seconds
[0m19:05:12.066899 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m19:05:12.066899 [debug] [MainThread]: Connection 'EPICALDEMO.information_schema' was left open.
[0m19:05:12.066899 [debug] [MainThread]: On EPICALDEMO.information_schema: Close
[0m19:05:12.121654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F31DCB4E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F320093DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F31B414C50>]}
[0m19:05:12.121654 [debug] [MainThread]: Flushing usage events
[0m19:05:12.519931 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:13:24.878646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7257787D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7257791D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A725778A90>]}


============================== 19:13:24.885154 | da1c7359-f879-47b1-9d53-3b20150fdfac ==============================
[0m19:13:24.885154 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:13:24.885154 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:13:25.385996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da1c7359-f879-47b1-9d53-3b20150fdfac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7250A34D0>]}
[0m19:13:25.414254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da1c7359-f879-47b1-9d53-3b20150fdfac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A726B2D650>]}
[0m19:16:00.723808 [error] [MainThread]: Encountered an error:

[0m19:16:00.769343 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m19:16:00.781465 [debug] [MainThread]: Command `dbt docs serve` failed at 19:16:00.781465 after 155.96 seconds
[0m19:16:00.781465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7257CA010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A72576BBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A72576BE10>]}
[0m19:16:00.781465 [debug] [MainThread]: Flushing usage events
[0m19:16:01.297917 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:18:28.111491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B342BA850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B3428F890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B3428CC10>]}


============================== 19:18:28.132165 | fbece0f9-9586-451f-96c2-aac4affd065f ==============================
[0m19:18:28.132165 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:18:28.132165 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:18:30.760700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fbece0f9-9586-451f-96c2-aac4affd065f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B354304D0>]}
[0m19:18:30.807582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fbece0f9-9586-451f-96c2-aac4affd065f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B35431B50>]}
[0m19:18:30.807582 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m19:18:31.181537 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:18:31.354042 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:18:31.354042 [info ] [MainThread]: Unable to do partial parsing because an error occurred. Switching to full reparse.
[0m19:18:31.354042 [debug] [MainThread]: Partial parsing exception processing file epicaldemo://models\raw\_sources.yml
[0m19:18:31.354042 [debug] [MainThread]: PP exception info: {'code': 'if not source_file.nodes:', 'parse_file_type': 'schema', 'exception': "AttributeError: 'SchemaSourceFile' object has no attribute 'nodes'", 'location': 'line 396 in remove_mssat_file', 'traceback': 'Traceback (most recent call last):\n  File "C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\.venv\\Lib\\site-packages\\dbt\\parser\\manifest.py", line 537, in safe_update_project_parser_files_partially\n    project_parser_files = self.partial_parser.get_parsing_files()\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\.venv\\Lib\\site-packages\\dbt\\parser\\partial.py", line 181, in get_parsing_files\n    self.change_schema_file(file_id)\n  File "C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\.venv\\Lib\\site-packages\\dbt\\parser\\partial.py", line 626, in change_schema_file\n    self.handle_schema_file_changes(saved_schema_file, saved_yaml_dict, new_yaml_dict)\n  File "C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\.venv\\Lib\\site-packages\\dbt\\parser\\partial.py", line 692, in handle_schema_file_changes\n    self.delete_schema_source(schema_file, source)\n  File "C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\.venv\\Lib\\site-packages\\dbt\\parser\\partial.py", line 906, in delete_schema_source\n    self.schedule_referencing_nodes_for_parsing(unique_id)\n  File "C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\.venv\\Lib\\site-packages\\dbt\\parser\\partial.py", line 407, in schedule_referencing_nodes_for_parsing\n    self.schedule_nodes_for_parsing(self.saved_manifest.child_map[unique_id])\n  File "C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\.venv\\Lib\\site-packages\\dbt\\parser\\partial.py", line 419, in schedule_nodes_for_parsing\n    self.remove_mssat_file(source_file)\n  File "C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\.venv\\Lib\\site-packages\\dbt\\parser\\partial.py", line 396, in remove_mssat_file\n    if not source_file.nodes:\n           ^^^^^^^^^^^^^^^^^\nAttributeError: \'SchemaSourceFile\' object has no attribute \'nodes\'\n'}
[0m19:18:31.354042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fbece0f9-9586-451f-96c2-aac4affd065f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B342B5650>]}
[0m19:18:32.091995 [error] [MainThread]: Encountered an error:
Parsing Error
  at path ['raw_code']: None is not of type 'string'
[0m19:18:32.091995 [debug] [MainThread]: Command `dbt test` failed at 19:18:32.091995 after 4.04 seconds
[0m19:18:32.091995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B2E672ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B2E672DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B3002A690>]}
[0m19:18:32.091995 [debug] [MainThread]: Flushing usage events
[0m19:18:32.554865 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:22:16.137490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A800170750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A800173A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A8001727D0>]}


============================== 19:22:16.137490 | c3318ff6-36c6-4e07-a7fb-bc7bd842f670 ==============================
[0m19:22:16.137490 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:22:16.137490 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:22:16.525667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3318ff6-36c6-4e07-a7fb-bc7bd842f670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A8015EBB50>]}
[0m19:22:16.568197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c3318ff6-36c6-4e07-a7fb-bc7bd842f670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A8001B5650>]}
[0m19:22:16.570197 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m19:22:16.871040 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:22:17.059663 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:22:17.059663 [info ] [MainThread]: Unable to do partial parsing because an error occurred. Switching to full reparse.
[0m19:22:17.059663 [debug] [MainThread]: Partial parsing exception processing file epicaldemo://models\raw\_sources.yml
[0m19:22:17.059663 [debug] [MainThread]: PP exception info: {'code': 'if not source_file.nodes:', 'parse_file_type': 'schema', 'exception': "AttributeError: 'SchemaSourceFile' object has no attribute 'nodes'", 'location': 'line 396 in remove_mssat_file', 'traceback': 'Traceback (most recent call last):\n  File "C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\.venv\\Lib\\site-packages\\dbt\\parser\\manifest.py", line 537, in safe_update_project_parser_files_partially\n    project_parser_files = self.partial_parser.get_parsing_files()\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\.venv\\Lib\\site-packages\\dbt\\parser\\partial.py", line 181, in get_parsing_files\n    self.change_schema_file(file_id)\n  File "C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\.venv\\Lib\\site-packages\\dbt\\parser\\partial.py", line 626, in change_schema_file\n    self.handle_schema_file_changes(saved_schema_file, saved_yaml_dict, new_yaml_dict)\n  File "C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\.venv\\Lib\\site-packages\\dbt\\parser\\partial.py", line 692, in handle_schema_file_changes\n    self.delete_schema_source(schema_file, source)\n  File "C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\.venv\\Lib\\site-packages\\dbt\\parser\\partial.py", line 906, in delete_schema_source\n    self.schedule_referencing_nodes_for_parsing(unique_id)\n  File "C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\.venv\\Lib\\site-packages\\dbt\\parser\\partial.py", line 407, in schedule_referencing_nodes_for_parsing\n    self.schedule_nodes_for_parsing(self.saved_manifest.child_map[unique_id])\n  File "C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\.venv\\Lib\\site-packages\\dbt\\parser\\partial.py", line 419, in schedule_nodes_for_parsing\n    self.remove_mssat_file(source_file)\n  File "C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\.venv\\Lib\\site-packages\\dbt\\parser\\partial.py", line 396, in remove_mssat_file\n    if not source_file.nodes:\n           ^^^^^^^^^^^^^^^^^\nAttributeError: \'SchemaSourceFile\' object has no attribute \'nodes\'\n'}
[0m19:22:17.059663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c3318ff6-36c6-4e07-a7fb-bc7bd842f670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A80168C890>]}
[0m19:22:17.831508 [error] [MainThread]: Encountered an error:
Parsing Error
  at path ['raw_code']: None is not of type 'string'
[0m19:22:17.831508 [debug] [MainThread]: Command `dbt test` failed at 19:22:17.831508 after 1.77 seconds
[0m19:22:17.847163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A87AA93010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A87AA93090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A800086A10>]}
[0m19:22:17.847163 [debug] [MainThread]: Flushing usage events
[0m19:22:18.287274 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:22:21.020305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D66046E810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D66046E290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D66046F390>]}


============================== 19:22:21.025213 | af3c559c-6d6a-486e-b6a5-b9b35a09bda4 ==============================
[0m19:22:21.025213 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:22:21.025213 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'c:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'c:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m19:22:21.118864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af3c559c-6d6a-486e-b6a5-b9b35a09bda4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D6604E3310>]}
[0m19:22:21.214035 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m19:22:21.216043 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m19:22:21.218029 [debug] [MainThread]: Command `cli deps` succeeded at 19:22:21.217036 after 0.26 seconds
[0m19:22:21.218029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D6604912D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D660491B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D660493790>]}
[0m19:22:21.219029 [debug] [MainThread]: Flushing usage events
[0m19:22:21.662475 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:26:08.378747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014ED886BD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014ED8872490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014ED8873890>]}


============================== 19:26:08.382736 | be2e9a6d-0410-4590-8ae4-c2c180ed5e34 ==============================
[0m19:26:08.382736 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:26:08.383737 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:26:08.796014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be2e9a6d-0410-4590-8ae4-c2c180ed5e34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014ED9A9FCD0>]}
[0m19:26:08.840306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be2e9a6d-0410-4590-8ae4-c2c180ed5e34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014ED9A31150>]}
[0m19:26:08.842639 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m19:26:09.146948 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:26:09.342336 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:26:09.343402 [info ] [MainThread]: Unable to do partial parsing because an error occurred. Switching to full reparse.
[0m19:26:09.346347 [debug] [MainThread]: Partial parsing exception processing file epicaldemo://models\raw\_sources.yml
[0m19:26:09.347707 [debug] [MainThread]: PP exception info: {'code': 'if not source_file.nodes:', 'parse_file_type': 'schema', 'exception': "AttributeError: 'SchemaSourceFile' object has no attribute 'nodes'", 'location': 'line 396 in remove_mssat_file', 'traceback': 'Traceback (most recent call last):\n  File "C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\.venv\\Lib\\site-packages\\dbt\\parser\\manifest.py", line 537, in safe_update_project_parser_files_partially\n    project_parser_files = self.partial_parser.get_parsing_files()\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\.venv\\Lib\\site-packages\\dbt\\parser\\partial.py", line 181, in get_parsing_files\n    self.change_schema_file(file_id)\n  File "C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\.venv\\Lib\\site-packages\\dbt\\parser\\partial.py", line 626, in change_schema_file\n    self.handle_schema_file_changes(saved_schema_file, saved_yaml_dict, new_yaml_dict)\n  File "C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\.venv\\Lib\\site-packages\\dbt\\parser\\partial.py", line 692, in handle_schema_file_changes\n    self.delete_schema_source(schema_file, source)\n  File "C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\.venv\\Lib\\site-packages\\dbt\\parser\\partial.py", line 906, in delete_schema_source\n    self.schedule_referencing_nodes_for_parsing(unique_id)\n  File "C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\.venv\\Lib\\site-packages\\dbt\\parser\\partial.py", line 407, in schedule_referencing_nodes_for_parsing\n    self.schedule_nodes_for_parsing(self.saved_manifest.child_map[unique_id])\n  File "C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\.venv\\Lib\\site-packages\\dbt\\parser\\partial.py", line 419, in schedule_nodes_for_parsing\n    self.remove_mssat_file(source_file)\n  File "C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\.venv\\Lib\\site-packages\\dbt\\parser\\partial.py", line 396, in remove_mssat_file\n    if not source_file.nodes:\n           ^^^^^^^^^^^^^^^^^\nAttributeError: \'SchemaSourceFile\' object has no attribute \'nodes\'\n'}
[0m19:26:09.348717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'be2e9a6d-0410-4590-8ae4-c2c180ed5e34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014ED62ECE50>]}
[0m19:26:10.179284 [error] [MainThread]: Encountered an error:
Parsing Error
  at path ['raw_code']: None is not of type 'string'
[0m19:26:10.179284 [debug] [MainThread]: Command `dbt test` failed at 19:26:10.179284 after 1.87 seconds
[0m19:26:10.193324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014ED84B4B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014ED84B4810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014ED8586950>]}
[0m19:26:10.193324 [debug] [MainThread]: Flushing usage events
[0m19:26:10.652372 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:32:56.266751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E524892150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E524871410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E524873A90>]}


============================== 19:32:56.266751 | b84c4817-4b43-4f18-8d5c-570248b60c83 ==============================
[0m19:32:56.266751 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:32:56.266751 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'False', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt parse --no-partial-parse', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:32:58.463860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b84c4817-4b43-4f18-8d5c-570248b60c83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E525B22290>]}
[0m19:32:58.502936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b84c4817-4b43-4f18-8d5c-570248b60c83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E525B0F810>]}
[0m19:32:58.534263 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m19:32:58.922172 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:32:58.922172 [debug] [MainThread]: Partial parsing not enabled
[0m19:33:00.205712 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m19:33:00.219944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b84c4817-4b43-4f18-8d5c-570248b60c83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E52699AF90>]}
[0m19:33:00.226946 [info ] [MainThread]: Performance info: C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\perf_info.json
[0m19:33:00.386108 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m19:33:00.402957 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m19:33:00.402957 [debug] [MainThread]: Command `dbt parse` succeeded at 19:33:00.402957 after 4.21 seconds
[0m19:33:00.402957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E51ECF2FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E524151A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E526C6FF90>]}
[0m19:33:00.402957 [debug] [MainThread]: Flushing usage events
[0m19:33:00.810556 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:33:23.799111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002242D070550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002242D06BDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002242D0713D0>]}


============================== 19:33:23.799111 | e52c0bd2-af49-4075-83cd-a387dfa4e269 ==============================
[0m19:33:23.799111 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:33:23.810118 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:33:24.174968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e52c0bd2-af49-4075-83cd-a387dfa4e269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002242BA3D0D0>]}
[0m19:33:24.210791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e52c0bd2-af49-4075-83cd-a387dfa4e269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002242E231B10>]}
[0m19:33:24.210791 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m19:33:24.504479 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:33:24.692777 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:33:24.692777 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:33:24.708453 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m19:33:24.755069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e52c0bd2-af49-4075-83cd-a387dfa4e269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002242EB0D390>]}
[0m19:33:24.836614 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m19:33:24.836614 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m19:33:25.054384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e52c0bd2-af49-4075-83cd-a387dfa4e269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002242ED57FD0>]}
[0m19:33:25.054384 [info ] [MainThread]: Found 13 models, 1 snapshot, 1 test, 8 sources, 1 exposure, 476 macros
[0m19:33:25.054384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e52c0bd2-af49-4075-83cd-a387dfa4e269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002242E7FC3D0>]}
[0m19:33:25.054384 [info ] [MainThread]: 
[0m19:33:25.054384 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:33:25.054384 [info ] [MainThread]: 
[0m19:33:25.054384 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:33:25.071914 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m19:33:27.061593 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m19:33:27.061593 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m19:33:27.061593 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:33:27.675335 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.603 seconds
[0m19:33:27.675335 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m19:33:27.675335 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m19:33:27.766526 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.088 seconds
[0m19:33:27.766526 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m19:33:27.766526 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m19:33:27.845079 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.067 seconds
[0m19:33:27.845079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e52c0bd2-af49-4075-83cd-a387dfa4e269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002242F0C1810>]}
[0m19:33:27.845079 [debug] [Thread-1 (]: Began running node test.epicaldemo.source_not_null_d365_fo_transactions_SKU.794eb85dd7
[0m19:33:27.845079 [info ] [Thread-1 (]: 1 of 1 START test source_not_null_d365_fo_transactions_SKU ..................... [RUN]
[0m19:33:27.845079 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.epicaldemo.source_not_null_d365_fo_transactions_SKU.794eb85dd7'
[0m19:33:27.845079 [debug] [Thread-1 (]: Began compiling node test.epicaldemo.source_not_null_d365_fo_transactions_SKU.794eb85dd7
[0m19:33:27.860713 [debug] [Thread-1 (]: Writing injected SQL for node "test.epicaldemo.source_not_null_d365_fo_transactions_SKU.794eb85dd7"
[0m19:33:27.860713 [debug] [Thread-1 (]: Began executing node test.epicaldemo.source_not_null_d365_fo_transactions_SKU.794eb85dd7
[0m19:33:27.890445 [debug] [Thread-1 (]: Writing runtime sql for node "test.epicaldemo.source_not_null_d365_fo_transactions_SKU.794eb85dd7"
[0m19:33:27.892431 [debug] [Thread-1 (]: Using snowflake connection "test.epicaldemo.source_not_null_d365_fo_transactions_SKU.794eb85dd7"
[0m19:33:27.893440 [debug] [Thread-1 (]: On test.epicaldemo.source_not_null_d365_fo_transactions_SKU.794eb85dd7: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "test.epicaldemo.source_not_null_d365_fo_transactions_SKU.794eb85dd7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select SKU
from EPICALDEMO.d365_fo.transactions
where SKU is null



  
  
      
    ) dbt_internal_test
[0m19:33:27.893440 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:33:28.958190 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.067 seconds
[0m19:33:28.958190 [error] [Thread-1 (]: 1 of 1 FAIL 1 source_not_null_d365_fo_transactions_SKU ......................... [[31mFAIL 1[0m in 1.11s]
[0m19:33:28.958190 [debug] [Thread-1 (]: Finished running node test.epicaldemo.source_not_null_d365_fo_transactions_SKU.794eb85dd7
[0m19:33:28.973749 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:33:28.973749 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m19:33:28.973749 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m19:33:29.021512 [debug] [MainThread]: Connection 'test.epicaldemo.source_not_null_d365_fo_transactions_SKU.794eb85dd7' was left open.
[0m19:33:29.022535 [debug] [MainThread]: On test.epicaldemo.source_not_null_d365_fo_transactions_SKU.794eb85dd7: Close
[0m19:33:29.083336 [info ] [MainThread]: 
[0m19:33:29.084323 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 4.03 seconds (4.03s).
[0m19:33:29.086323 [debug] [MainThread]: Command end result
[0m19:33:29.107551 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m19:33:29.110346 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m19:33:29.110346 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m19:33:29.110346 [info ] [MainThread]: 
[0m19:33:29.110346 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:33:29.120952 [info ] [MainThread]: 
[0m19:33:29.121458 [error] [MainThread]: [31mFailure in test source_not_null_d365_fo_transactions_SKU (models\raw\_sources.yml)[0m
[0m19:33:29.122497 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m19:33:29.123463 [info ] [MainThread]: 
[0m19:33:29.123463 [info ] [MainThread]:   compiled code at target\compiled\epicaldemo\models\raw\_sources.yml\source_not_null_d365_fo_transactions_SKU.sql
[0m19:33:29.124464 [info ] [MainThread]: 
[0m19:33:29.125480 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:33:29.127293 [debug] [MainThread]: Command `dbt test` failed at 19:33:29.126463 after 5.38 seconds
[0m19:33:29.127799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002242D0C6590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002242D0B9810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002242D0B9E50>]}
[0m19:33:29.128843 [debug] [MainThread]: Flushing usage events
[0m19:33:29.554588 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:34:14.975555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026607970610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026607970050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026607972310>]}


============================== 19:34:14.978554 | 5326ebe4-c9c4-4a7f-8d9a-93cb150b85e0 ==============================
[0m19:34:14.978554 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:34:14.979554 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:34:15.381922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5326ebe4-c9c4-4a7f-8d9a-93cb150b85e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026607970C90>]}
[0m19:34:15.425764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5326ebe4-c9c4-4a7f-8d9a-93cb150b85e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026608E5F810>]}
[0m19:34:15.427690 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m19:34:15.738851 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:34:15.951260 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:34:15.952267 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:34:15.957032 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m19:34:15.999163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5326ebe4-c9c4-4a7f-8d9a-93cb150b85e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026608EAC250>]}
[0m19:34:16.089507 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m19:34:16.093596 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m19:34:16.106745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5326ebe4-c9c4-4a7f-8d9a-93cb150b85e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026609957ED0>]}
[0m19:34:16.106745 [info ] [MainThread]: Found 13 models, 1 snapshot, 1 test, 8 sources, 1 exposure, 476 macros
[0m19:34:16.106745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5326ebe4-c9c4-4a7f-8d9a-93cb150b85e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026608F50B90>]}
[0m19:34:16.122302 [info ] [MainThread]: 
[0m19:34:16.122302 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:34:16.122302 [info ] [MainThread]: 
[0m19:34:16.122302 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:34:16.122302 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m19:34:16.207509 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m19:34:16.207509 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m19:34:16.207509 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:34:16.672374 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.456 seconds
[0m19:34:16.672374 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m19:34:16.672374 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m19:34:16.707381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185F9C6F510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185F9CAF650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185F9C6F2D0>]}


============================== 19:34:16.707381 | 5bb68eea-7e1e-46ef-9d99-65d6023f1046 ==============================
[0m19:34:16.707381 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:34:16.707381 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'c:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m19:34:16.747385 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.066 seconds
[0m19:34:16.748379 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m19:34:16.749379 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m19:34:16.807538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5bb68eea-7e1e-46ef-9d99-65d6023f1046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185F9CB9110>]}
[0m19:34:16.807538 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.064 seconds
[0m19:34:16.807538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5326ebe4-c9c4-4a7f-8d9a-93cb150b85e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026607886C50>]}
[0m19:34:16.822545 [debug] [Thread-1 (]: Began running node test.epicaldemo.source_not_null_d365_fo_transactions_SKU.794eb85dd7
[0m19:34:16.823447 [info ] [Thread-1 (]: 1 of 1 START test source_not_null_d365_fo_transactions_SKU ..................... [RUN]
[0m19:34:16.823670 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.epicaldemo.source_not_null_d365_fo_transactions_SKU.794eb85dd7'
[0m19:34:16.824740 [debug] [Thread-1 (]: Began compiling node test.epicaldemo.source_not_null_d365_fo_transactions_SKU.794eb85dd7
[0m19:34:16.837789 [debug] [Thread-1 (]: Writing injected SQL for node "test.epicaldemo.source_not_null_d365_fo_transactions_SKU.794eb85dd7"
[0m19:34:16.838783 [debug] [Thread-1 (]: Began executing node test.epicaldemo.source_not_null_d365_fo_transactions_SKU.794eb85dd7
[0m19:34:16.855482 [debug] [Thread-1 (]: Writing runtime sql for node "test.epicaldemo.source_not_null_d365_fo_transactions_SKU.794eb85dd7"
[0m19:34:16.857928 [debug] [Thread-1 (]: Using snowflake connection "test.epicaldemo.source_not_null_d365_fo_transactions_SKU.794eb85dd7"
[0m19:34:16.857928 [debug] [Thread-1 (]: On test.epicaldemo.source_not_null_d365_fo_transactions_SKU.794eb85dd7: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "test.epicaldemo.source_not_null_d365_fo_transactions_SKU.794eb85dd7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select SKU
from EPICALDEMO.d365_fo.transactions
where SKU is null



  
  
      
    ) dbt_internal_test
[0m19:34:16.858935 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:34:16.907380 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m19:34:16.907380 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m19:34:16.907380 [debug] [MainThread]: Command `cli deps` succeeded at 19:34:16.907380 after 0.26 seconds
[0m19:34:16.907380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185F98AC850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185F989FE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185F9D30590>]}
[0m19:34:16.907380 [debug] [MainThread]: Flushing usage events
[0m19:34:17.206725 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.358 seconds
[0m19:34:17.224634 [error] [Thread-1 (]: 1 of 1 FAIL 1 source_not_null_d365_fo_transactions_SKU ......................... [[31mFAIL 1[0m in 0.40s]
[0m19:34:17.225632 [debug] [Thread-1 (]: Finished running node test.epicaldemo.source_not_null_d365_fo_transactions_SKU.794eb85dd7
[0m19:34:17.227632 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:34:17.227632 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m19:34:17.228633 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m19:34:17.274754 [debug] [MainThread]: Connection 'test.epicaldemo.source_not_null_d365_fo_transactions_SKU.794eb85dd7' was left open.
[0m19:34:17.274754 [debug] [MainThread]: On test.epicaldemo.source_not_null_d365_fo_transactions_SKU.794eb85dd7: Close
[0m19:34:17.332725 [info ] [MainThread]: 
[0m19:34:17.333727 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 1.21 seconds (1.21s).
[0m19:34:17.334723 [debug] [MainThread]: Command end result
[0m19:34:17.359105 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m19:34:17.362001 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m19:34:17.368041 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m19:34:17.368041 [info ] [MainThread]: 
[0m19:34:17.368041 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:34:17.368041 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:34:17.373500 [info ] [MainThread]: 
[0m19:34:17.373500 [error] [MainThread]: [31mFailure in test source_not_null_d365_fo_transactions_SKU (models\raw\_sources.yml)[0m
[0m19:34:17.374509 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m19:34:17.375507 [info ] [MainThread]: 
[0m19:34:17.376513 [info ] [MainThread]:   compiled code at target\compiled\epicaldemo\models\raw\_sources.yml\source_not_null_d365_fo_transactions_SKU.sql
[0m19:34:17.376513 [info ] [MainThread]: 
[0m19:34:17.377509 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:34:17.378516 [debug] [MainThread]: Command `dbt test` failed at 19:34:17.378516 after 2.46 seconds
[0m19:34:17.379521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266079C7FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026602212ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026602212DD0>]}
[0m19:34:17.380507 [debug] [MainThread]: Flushing usage events
[0m19:34:17.807584 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:39:29.853771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAC32789D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAC3279C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAC3279690>]}


============================== 19:39:29.869471 | 2851e878-ee23-4650-b654-ff2b5e0e7fb9 ==============================
[0m19:39:29.869471 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:39:29.869471 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:39:30.277566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2851e878-ee23-4650-b654-ff2b5e0e7fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAC1D061D0>]}
[0m19:39:30.324437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2851e878-ee23-4650-b654-ff2b5e0e7fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAC1C4F990>]}
[0m19:39:30.329448 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m19:39:30.630050 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:39:30.811639 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:39:30.811639 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:39:30.811639 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m19:39:30.861143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2851e878-ee23-4650-b654-ff2b5e0e7fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAC1CDA190>]}
[0m19:39:30.903939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2851e878-ee23-4650-b654-ff2b5e0e7fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAC49FC190>]}
[0m19:39:30.904938 [info ] [MainThread]: Found 13 models, 1 snapshot, 1 test, 8 sources, 1 exposure, 476 macros
[0m19:39:30.905939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2851e878-ee23-4650-b654-ff2b5e0e7fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAC49C8490>]}
[0m19:39:30.907791 [info ] [MainThread]: 
[0m19:39:30.908790 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:39:30.909795 [info ] [MainThread]: 
[0m19:39:30.909795 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:39:30.914790 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m19:39:30.989985 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m19:39:30.989985 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m19:39:30.989985 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:39:31.470480 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.482 seconds
[0m19:39:31.470480 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m19:39:31.470480 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m19:39:31.580162 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.102 seconds
[0m19:39:31.580162 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m19:39:31.580162 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m19:39:31.643234 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.056 seconds
[0m19:39:31.660437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2851e878-ee23-4650-b654-ff2b5e0e7fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAC49C8490>]}
[0m19:39:31.660928 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__categories
[0m19:39:31.660928 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_d365_fo__dates
[0m19:39:31.660928 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_d365_fo__items
[0m19:39:31.660928 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__categories'
[0m19:39:31.660928 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_d365_fo__managers
[0m19:39:31.660928 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__dates'
[0m19:39:31.660928 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__items'
[0m19:39:31.660928 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__categories
[0m19:39:31.660928 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__managers'
[0m19:39:31.660928 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_d365_fo__dates
[0m19:39:31.673157 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_d365_fo__items
[0m19:39:31.678170 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__categories"
[0m19:39:31.679170 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_d365_fo__managers
[0m19:39:31.681823 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__dates"
[0m19:39:31.683888 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__items"
[0m19:39:31.686823 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__managers"
[0m19:39:31.687870 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__categories
[0m19:39:31.689778 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__categories
[0m19:39:31.689778 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_d365_fo__dates
[0m19:39:31.689778 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__transactions
[0m19:39:31.689778 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_d365_fo__items
[0m19:39:31.689778 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_d365_fo__dates
[0m19:39:31.689778 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__categories, now model.epicaldemo.stg_d365_fo__transactions)
[0m19:39:31.689778 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_d365_fo__managers
[0m19:39:31.689778 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_d365_fo__items
[0m19:39:31.689778 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_inriver__item_attributes
[0m19:39:31.689778 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__transactions
[0m19:39:31.689778 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_d365_fo__managers
[0m19:39:31.689778 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_salesforce__customers
[0m19:39:31.689778 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__dates, now model.epicaldemo.stg_inriver__item_attributes)
[0m19:39:31.689778 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__transactions"
[0m19:39:31.689778 [debug] [Thread-4 (]: Began running node snapshot.epicaldemo.stores_snapshot
[0m19:39:31.689778 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__items, now model.epicaldemo.stg_salesforce__customers)
[0m19:39:31.689778 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_inriver__item_attributes
[0m19:39:31.689778 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__managers, now snapshot.epicaldemo.stores_snapshot)
[0m19:39:31.689778 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__transactions
[0m19:39:31.689778 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_salesforce__customers
[0m19:39:31.689778 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_inriver__item_attributes"
[0m19:39:31.689778 [debug] [Thread-4 (]: Began compiling node snapshot.epicaldemo.stores_snapshot
[0m19:39:31.704797 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__transactions
[0m19:39:31.704797 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_salesforce__customers"
[0m19:39:31.704797 [debug] [Thread-4 (]: Began executing node snapshot.epicaldemo.stores_snapshot
[0m19:39:31.704797 [debug] [Thread-1 (]: Began running node test.epicaldemo.source_not_null_d365_fo_transactions_SKU.794eb85dd7
[0m19:39:31.704797 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_inriver__item_attributes
[0m19:39:31.704797 [debug] [Thread-4 (]: Finished running node snapshot.epicaldemo.stores_snapshot
[0m19:39:31.704797 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__transactions, now test.epicaldemo.source_not_null_d365_fo_transactions_SKU.794eb85dd7)
[0m19:39:31.704797 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_salesforce__customers
[0m19:39:31.704797 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_inriver__item_attributes
[0m19:39:31.704797 [debug] [Thread-4 (]: Began running node model.epicaldemo.dim_dates
[0m19:39:31.704797 [debug] [Thread-1 (]: Began compiling node test.epicaldemo.source_not_null_d365_fo_transactions_SKU.794eb85dd7
[0m19:39:31.704797 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_salesforce__customers
[0m19:39:31.704797 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_d365_fo__stores
[0m19:39:31.704797 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly snapshot.epicaldemo.stores_snapshot, now model.epicaldemo.dim_dates)
[0m19:39:31.720444 [debug] [Thread-1 (]: Writing injected SQL for node "test.epicaldemo.source_not_null_d365_fo_transactions_SKU.794eb85dd7"
[0m19:39:31.720444 [debug] [Thread-3 (]: Began running node model.epicaldemo.dim_items
[0m19:39:31.720444 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_inriver__item_attributes, now model.epicaldemo.stg_d365_fo__stores)
[0m19:39:31.720444 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.dim_dates
[0m19:39:31.720444 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_salesforce__customers, now model.epicaldemo.dim_items)
[0m19:39:31.720444 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_d365_fo__stores
[0m19:39:31.720444 [debug] [Thread-1 (]: Began executing node test.epicaldemo.source_not_null_d365_fo_transactions_SKU.794eb85dd7
[0m19:39:31.720444 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.dim_dates"
[0m19:39:31.720444 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.dim_items
[0m19:39:31.732450 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__stores"
[0m19:39:31.732450 [debug] [Thread-1 (]: Finished running node test.epicaldemo.source_not_null_d365_fo_transactions_SKU.794eb85dd7
[0m19:39:31.736456 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.dim_items"
[0m19:39:31.736456 [debug] [Thread-4 (]: Began executing node model.epicaldemo.dim_dates
[0m19:39:31.736456 [debug] [Thread-1 (]: Began running node model.epicaldemo.dim_customers
[0m19:39:31.736456 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_d365_fo__stores
[0m19:39:31.736456 [debug] [Thread-4 (]: Finished running node model.epicaldemo.dim_dates
[0m19:39:31.736456 [debug] [Thread-3 (]: Began executing node model.epicaldemo.dim_items
[0m19:39:31.736456 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.epicaldemo.source_not_null_d365_fo_transactions_SKU.794eb85dd7, now model.epicaldemo.dim_customers)
[0m19:39:31.736456 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_d365_fo__stores
[0m19:39:31.736456 [debug] [Thread-3 (]: Finished running node model.epicaldemo.dim_items
[0m19:39:31.736456 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.dim_customers
[0m19:39:31.736456 [debug] [Thread-4 (]: Began running node model.epicaldemo.dim_stores
[0m19:39:31.736456 [debug] [Thread-2 (]: Began running node model.epicaldemo.fact_sales_transactions
[0m19:39:31.736456 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.dim_customers"
[0m19:39:31.736456 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.dim_dates, now model.epicaldemo.dim_stores)
[0m19:39:31.736456 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__stores, now model.epicaldemo.fact_sales_transactions)
[0m19:39:31.736456 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.dim_stores
[0m19:39:31.752089 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.fact_sales_transactions
[0m19:39:31.752089 [debug] [Thread-1 (]: Began executing node model.epicaldemo.dim_customers
[0m19:39:31.752089 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.dim_stores"
[0m19:39:31.752089 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.fact_sales_transactions"
[0m19:39:31.752089 [debug] [Thread-1 (]: Finished running node model.epicaldemo.dim_customers
[0m19:39:31.752089 [debug] [Thread-4 (]: Began executing node model.epicaldemo.dim_stores
[0m19:39:31.752089 [debug] [Thread-2 (]: Began executing node model.epicaldemo.fact_sales_transactions
[0m19:39:31.752089 [debug] [Thread-4 (]: Finished running node model.epicaldemo.dim_stores
[0m19:39:31.752089 [debug] [Thread-2 (]: Finished running node model.epicaldemo.fact_sales_transactions
[0m19:39:31.752089 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:39:31.752089 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m19:39:31.752089 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m19:39:31.814654 [debug] [MainThread]: Connection 'model.epicaldemo.dim_customers' was properly closed.
[0m19:39:31.814654 [debug] [MainThread]: Connection 'model.epicaldemo.fact_sales_transactions' was properly closed.
[0m19:39:31.814654 [debug] [MainThread]: Connection 'model.epicaldemo.dim_items' was properly closed.
[0m19:39:31.814654 [debug] [MainThread]: Connection 'model.epicaldemo.dim_stores' was properly closed.
[0m19:39:31.814654 [debug] [MainThread]: Command end result
[0m19:39:31.893367 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m19:39:31.893367 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m19:39:31.908938 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m19:39:32.168038 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m19:39:32.168038 [info ] [MainThread]: Building catalog
[0m19:39:32.184615 [debug] [ThreadPool]: Acquiring new snowflake connection 'EPICALDEMO.information_schema'
[0m19:39:32.205173 [debug] [ThreadPool]: Using snowflake connection "EPICALDEMO.information_schema"
[0m19:39:32.206165 [debug] [ThreadPool]: On EPICALDEMO.information_schema: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "EPICALDEMO.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from EPICALDEMO.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'manager' and upper("table_name") = upper('manager')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__transactions' and upper("table_name") = upper('stg_d365_fo__transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__stores' and upper("table_name") = upper('stg_d365_fo__stores')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'transactions' and upper("table_name") = upper('transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'category' and upper("table_name") = upper('category')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_customers' and upper("table_name") = upper('dim_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stores_snapshot' and upper("table_name") = upper('stores_snapshot')

                )
             or 
                (
                    
    "table_schema" ilike 'salesforce' and upper("table_schema") = upper('salesforce')

                    and 
    "table_name" ilike 'customer' and upper("table_name") = upper('customer')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__dates' and upper("table_name") = upper('stg_d365_fo__dates')

                )
             or 
                (
                    
    "table_schema" ilike 'inriver' and upper("table_schema") = upper('inriver')

                    and 
    "table_name" ilike 'item_attributes' and upper("table_name") = upper('item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_stores' and upper("table_name") = upper('dim_stores')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_dates' and upper("table_name") = upper('dim_dates')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'date' and upper("table_name") = upper('date')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_salesforce__customers' and upper("table_name") = upper('stg_salesforce__customers')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'fact_sales_transactions' and upper("table_name") = upper('fact_sales_transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_items' and upper("table_name") = upper('dim_items')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__managers' and upper("table_name") = upper('stg_d365_fo__managers')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__categories' and upper("table_name") = upper('stg_d365_fo__categories')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__items' and upper("table_name") = upper('stg_d365_fo__items')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_inriver__item_attributes' and upper("table_name") = upper('stg_inriver__item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'store' and upper("table_name") = upper('store')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'item' and upper("table_name") = upper('item')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from EPICALDEMO.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'manager' and upper("table_name") = upper('manager')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__transactions' and upper("table_name") = upper('stg_d365_fo__transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__stores' and upper("table_name") = upper('stg_d365_fo__stores')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'transactions' and upper("table_name") = upper('transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'category' and upper("table_name") = upper('category')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_customers' and upper("table_name") = upper('dim_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stores_snapshot' and upper("table_name") = upper('stores_snapshot')

                )
             or 
                (
                    
    "table_schema" ilike 'salesforce' and upper("table_schema") = upper('salesforce')

                    and 
    "table_name" ilike 'customer' and upper("table_name") = upper('customer')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__dates' and upper("table_name") = upper('stg_d365_fo__dates')

                )
             or 
                (
                    
    "table_schema" ilike 'inriver' and upper("table_schema") = upper('inriver')

                    and 
    "table_name" ilike 'item_attributes' and upper("table_name") = upper('item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_stores' and upper("table_name") = upper('dim_stores')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_dates' and upper("table_name") = upper('dim_dates')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'date' and upper("table_name") = upper('date')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_salesforce__customers' and upper("table_name") = upper('stg_salesforce__customers')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'fact_sales_transactions' and upper("table_name") = upper('fact_sales_transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_items' and upper("table_name") = upper('dim_items')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__managers' and upper("table_name") = upper('stg_d365_fo__managers')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__categories' and upper("table_name") = upper('stg_d365_fo__categories')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__items' and upper("table_name") = upper('stg_d365_fo__items')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_inriver__item_attributes' and upper("table_name") = upper('stg_inriver__item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'store' and upper("table_name") = upper('store')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'item' and upper("table_name") = upper('item')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m19:39:32.207169 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:39:41.396413 [debug] [ThreadPool]: SQL status: SUCCESS 153 in 9.197 seconds
[0m19:39:41.443282 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\catalog.json
[0m19:39:41.459301 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m19:39:41.459301 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m19:39:41.459301 [info ] [MainThread]: Catalog written to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\catalog.json
[0m19:39:41.459301 [debug] [MainThread]: Command `dbt docs generate` succeeded at 19:39:41.459301 after 11.66 seconds
[0m19:39:41.459301 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m19:39:41.459301 [debug] [MainThread]: Connection 'EPICALDEMO.information_schema' was left open.
[0m19:39:41.459301 [debug] [MainThread]: On EPICALDEMO.information_schema: Close
[0m19:39:41.511730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAC1DA9C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAC51BCD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAC32BB5D0>]}
[0m19:39:41.511730 [debug] [MainThread]: Flushing usage events
[0m19:39:41.976434 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:39:48.233198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCB2478190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCB247AD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCB2479550>]}


============================== 19:39:48.233198 | f19c41e6-8093-474b-96f0-c1fc303040b1 ==============================
[0m19:39:48.233198 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:39:48.233198 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt docs serve', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:39:48.624448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f19c41e6-8093-474b-96f0-c1fc303040b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCB376E1D0>]}
[0m19:39:48.656546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f19c41e6-8093-474b-96f0-c1fc303040b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCB24B8350>]}
[0m19:42:20.433526 [error] [MainThread]: Encountered an error:

[0m19:42:20.456408 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m19:42:20.459406 [debug] [MainThread]: Command `dbt docs serve` failed at 19:42:20.459406 after 152.27 seconds
[0m19:42:20.460406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCB24BD990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCB24C82D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCB0FA9E90>]}
[0m19:42:20.460406 [debug] [MainThread]: Flushing usage events
[0m19:42:20.877065 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:42:24.452970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CD6578E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CD656BBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CD6578990>]}


============================== 19:42:24.456970 | c2250df0-6273-47ad-9b13-3861f11059cc ==============================
[0m19:42:24.456970 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:42:24.457970 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:42:24.883173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c2250df0-6273-47ad-9b13-3861f11059cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CD7C074D0>]}
[0m19:42:24.924174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c2250df0-6273-47ad-9b13-3861f11059cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CD792D550>]}
[0m19:43:34.421140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C5F16C450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C5EEB9B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C5F16C5D0>]}


============================== 19:43:34.424617 | 6b2d4bba-29dc-4e30-94e7-5ab4b7178a3c ==============================
[0m19:43:34.424617 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:43:34.424617 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'c:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'c:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:43:34.525816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b2d4bba-29dc-4e30-94e7-5ab4b7178a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C5F1B8A90>]}
[0m19:43:34.543219 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m19:43:34.543219 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m19:43:34.543219 [debug] [MainThread]: Command `cli deps` succeeded at 19:43:34.543219 after 0.20 seconds
[0m19:43:34.552450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C5F1B8ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C5F1B7910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C5F1B7B10>]}
[0m19:43:34.553839 [debug] [MainThread]: Flushing usage events
[0m19:43:35.133157 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:45:38.911067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D467E705D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D467E70590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D467E73A90>]}


============================== 19:45:38.915724 | 35404351-6302-4898-8c7a-fdf023b27bda ==============================
[0m19:45:38.915724 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:45:38.916737 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'c:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:45:39.012061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35404351-6302-4898-8c7a-fdf023b27bda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D467EB7E50>]}
[0m19:45:39.078950 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m19:45:39.092388 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m19:45:39.093792 [debug] [MainThread]: Command `cli deps` succeeded at 19:45:39.093792 after 0.25 seconds
[0m19:45:39.094851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D467751450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D462074B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D462074D10>]}
[0m19:45:39.094851 [debug] [MainThread]: Flushing usage events
[0m19:45:39.574047 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:46:46.577689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DC9278490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DC9279C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DC927AF90>]}


============================== 19:46:46.577689 | 6cc1b50f-4757-4a0b-babc-fafb314385e6 ==============================
[0m19:46:46.577689 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:46:46.577689 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:46:46.954727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6cc1b50f-4757-4a0b-babc-fafb314385e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DCA512E10>]}
[0m19:46:46.979480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6cc1b50f-4757-4a0b-babc-fafb314385e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DCA4320D0>]}
[0m19:46:46.995115 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m19:46:47.301741 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:46:47.474813 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:46:47.490422 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:46:47.490422 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m19:46:47.530366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6cc1b50f-4757-4a0b-babc-fafb314385e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DCAD0DA90>]}
[0m19:46:47.562951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6cc1b50f-4757-4a0b-babc-fafb314385e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DCA9B8E50>]}
[0m19:46:47.563957 [info ] [MainThread]: Found 13 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m19:46:47.565052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6cc1b50f-4757-4a0b-babc-fafb314385e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DC92B4E10>]}
[0m19:46:47.566971 [info ] [MainThread]: 
[0m19:46:47.567634 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:46:47.568129 [info ] [MainThread]: 
[0m19:46:47.569135 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:46:47.573134 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m19:46:49.384298 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m19:46:49.384298 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m19:46:49.384298 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:46:49.950137 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.571 seconds
[0m19:46:49.966300 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m19:46:49.966300 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m19:46:50.044440 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.076 seconds
[0m19:46:50.047422 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m19:46:50.047422 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m19:46:50.114121 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.070 seconds
[0m19:46:50.114121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6cc1b50f-4757-4a0b-babc-fafb314385e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DCB02B890>]}
[0m19:46:50.129128 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__categories
[0m19:46:50.129128 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_d365_fo__dates
[0m19:46:50.129128 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__categories'
[0m19:46:50.129128 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_d365_fo__items
[0m19:46:50.129128 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_d365_fo__managers
[0m19:46:50.129128 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__dates'
[0m19:46:50.129128 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__categories
[0m19:46:50.129128 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__items'
[0m19:46:50.129128 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__managers'
[0m19:46:50.129128 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_d365_fo__dates
[0m19:46:50.129128 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__categories"
[0m19:46:50.129128 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_d365_fo__items
[0m19:46:50.129128 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_d365_fo__managers
[0m19:46:50.129128 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__dates"
[0m19:46:50.144762 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__items"
[0m19:46:50.144762 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__categories
[0m19:46:50.144762 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__managers"
[0m19:46:50.144762 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__categories
[0m19:46:50.144762 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_d365_fo__dates
[0m19:46:50.144762 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_d365_fo__items
[0m19:46:50.144762 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__transactions
[0m19:46:50.144762 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_d365_fo__dates
[0m19:46:50.144762 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_d365_fo__managers
[0m19:46:50.144762 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_d365_fo__items
[0m19:46:50.144762 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__categories, now model.epicaldemo.stg_d365_fo__transactions)
[0m19:46:50.144762 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_inriver__item_attributes
[0m19:46:50.144762 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_d365_fo__managers
[0m19:46:50.144762 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_salesforce__customers
[0m19:46:50.144762 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__transactions
[0m19:46:50.144762 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__dates, now model.epicaldemo.stg_inriver__item_attributes)
[0m19:46:50.144762 [debug] [Thread-4 (]: Began running node snapshot.epicaldemo.stores_snapshot
[0m19:46:50.144762 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__items, now model.epicaldemo.stg_salesforce__customers)
[0m19:46:50.160786 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__transactions"
[0m19:46:50.160786 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_inriver__item_attributes
[0m19:46:50.160786 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__managers, now snapshot.epicaldemo.stores_snapshot)
[0m19:46:50.160786 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_salesforce__customers
[0m19:46:50.160786 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_inriver__item_attributes"
[0m19:46:50.160786 [debug] [Thread-4 (]: Began compiling node snapshot.epicaldemo.stores_snapshot
[0m19:46:50.160786 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__transactions
[0m19:46:50.160786 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_salesforce__customers"
[0m19:46:50.160786 [debug] [Thread-4 (]: Began executing node snapshot.epicaldemo.stores_snapshot
[0m19:46:50.160786 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_inriver__item_attributes
[0m19:46:50.160786 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__transactions
[0m19:46:50.160786 [debug] [Thread-4 (]: Finished running node snapshot.epicaldemo.stores_snapshot
[0m19:46:50.160786 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_salesforce__customers
[0m19:46:50.160786 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_inriver__item_attributes
[0m19:46:50.160786 [debug] [Thread-1 (]: Began running node model.epicaldemo.dim_dates
[0m19:46:50.160786 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_d365_fo__stores
[0m19:46:50.176420 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_salesforce__customers
[0m19:46:50.176420 [debug] [Thread-2 (]: Began running node model.epicaldemo.dim_items
[0m19:46:50.176420 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__transactions, now model.epicaldemo.dim_dates)
[0m19:46:50.176420 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly snapshot.epicaldemo.stores_snapshot, now model.epicaldemo.stg_d365_fo__stores)
[0m19:46:50.176420 [debug] [Thread-3 (]: Began running node model.epicaldemo.dim_customers
[0m19:46:50.176420 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_inriver__item_attributes, now model.epicaldemo.dim_items)
[0m19:46:50.176420 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.dim_dates
[0m19:46:50.176420 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_d365_fo__stores
[0m19:46:50.176420 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_salesforce__customers, now model.epicaldemo.dim_customers)
[0m19:46:50.176420 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.dim_items
[0m19:46:50.176420 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.dim_dates"
[0m19:46:50.176420 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__stores"
[0m19:46:50.176420 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.dim_customers
[0m19:46:50.176420 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.dim_items"
[0m19:46:50.176420 [debug] [Thread-1 (]: Began executing node model.epicaldemo.dim_dates
[0m19:46:50.192061 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.dim_customers"
[0m19:46:50.192061 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_d365_fo__stores
[0m19:46:50.192061 [debug] [Thread-1 (]: Finished running node model.epicaldemo.dim_dates
[0m19:46:50.192061 [debug] [Thread-2 (]: Began executing node model.epicaldemo.dim_items
[0m19:46:50.192061 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_d365_fo__stores
[0m19:46:50.192061 [debug] [Thread-3 (]: Began executing node model.epicaldemo.dim_customers
[0m19:46:50.192061 [debug] [Thread-2 (]: Finished running node model.epicaldemo.dim_items
[0m19:46:50.192061 [debug] [Thread-1 (]: Began running node model.epicaldemo.dim_stores
[0m19:46:50.192061 [debug] [Thread-4 (]: Began running node model.epicaldemo.fact_sales_transactions
[0m19:46:50.192061 [debug] [Thread-3 (]: Finished running node model.epicaldemo.dim_customers
[0m19:46:50.192061 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.dim_dates, now model.epicaldemo.dim_stores)
[0m19:46:50.192061 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__stores, now model.epicaldemo.fact_sales_transactions)
[0m19:46:50.192061 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.dim_stores
[0m19:46:50.192061 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.fact_sales_transactions
[0m19:46:50.192061 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.dim_stores"
[0m19:46:50.192061 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.fact_sales_transactions"
[0m19:46:50.192061 [debug] [Thread-1 (]: Began executing node model.epicaldemo.dim_stores
[0m19:46:50.192061 [debug] [Thread-4 (]: Began executing node model.epicaldemo.fact_sales_transactions
[0m19:46:50.192061 [debug] [Thread-1 (]: Finished running node model.epicaldemo.dim_stores
[0m19:46:50.207677 [debug] [Thread-4 (]: Finished running node model.epicaldemo.fact_sales_transactions
[0m19:46:50.207677 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:46:50.207677 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m19:46:50.207677 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m19:46:50.264083 [debug] [MainThread]: Connection 'model.epicaldemo.dim_stores' was properly closed.
[0m19:46:50.265075 [debug] [MainThread]: Connection 'model.epicaldemo.dim_items' was properly closed.
[0m19:46:50.266027 [debug] [MainThread]: Connection 'model.epicaldemo.dim_customers' was properly closed.
[0m19:46:50.266027 [debug] [MainThread]: Connection 'model.epicaldemo.fact_sales_transactions' was properly closed.
[0m19:46:50.269074 [debug] [MainThread]: Command end result
[0m19:46:50.326392 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m19:46:50.360810 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m19:46:50.360810 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m19:46:50.687907 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m19:46:50.687907 [info ] [MainThread]: Building catalog
[0m19:46:50.703496 [debug] [ThreadPool]: Acquiring new snowflake connection 'EPICALDEMO.information_schema'
[0m19:46:50.719128 [debug] [ThreadPool]: Using snowflake connection "EPICALDEMO.information_schema"
[0m19:46:50.719128 [debug] [ThreadPool]: On EPICALDEMO.information_schema: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "EPICALDEMO.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from EPICALDEMO.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__stores' and upper("table_name") = upper('stg_d365_fo__stores')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_dates' and upper("table_name") = upper('dim_dates')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_salesforce__customers' and upper("table_name") = upper('stg_salesforce__customers')

                )
             or 
                (
                    
    "table_schema" ilike 'inriver' and upper("table_schema") = upper('inriver')

                    and 
    "table_name" ilike 'item_attributes' and upper("table_name") = upper('item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_items' and upper("table_name") = upper('dim_items')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'item' and upper("table_name") = upper('item')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_inriver__item_attributes' and upper("table_name") = upper('stg_inriver__item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'fact_sales_transactions' and upper("table_name") = upper('fact_sales_transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_customers' and upper("table_name") = upper('dim_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'salesforce' and upper("table_schema") = upper('salesforce')

                    and 
    "table_name" ilike 'customer' and upper("table_name") = upper('customer')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__transactions' and upper("table_name") = upper('stg_d365_fo__transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__items' and upper("table_name") = upper('stg_d365_fo__items')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'category' and upper("table_name") = upper('category')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__dates' and upper("table_name") = upper('stg_d365_fo__dates')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stores_snapshot' and upper("table_name") = upper('stores_snapshot')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_stores' and upper("table_name") = upper('dim_stores')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'store' and upper("table_name") = upper('store')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__managers' and upper("table_name") = upper('stg_d365_fo__managers')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'manager' and upper("table_name") = upper('manager')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__categories' and upper("table_name") = upper('stg_d365_fo__categories')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'date' and upper("table_name") = upper('date')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'transactions' and upper("table_name") = upper('transactions')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from EPICALDEMO.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__stores' and upper("table_name") = upper('stg_d365_fo__stores')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_dates' and upper("table_name") = upper('dim_dates')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_salesforce__customers' and upper("table_name") = upper('stg_salesforce__customers')

                )
             or 
                (
                    
    "table_schema" ilike 'inriver' and upper("table_schema") = upper('inriver')

                    and 
    "table_name" ilike 'item_attributes' and upper("table_name") = upper('item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_items' and upper("table_name") = upper('dim_items')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'item' and upper("table_name") = upper('item')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_inriver__item_attributes' and upper("table_name") = upper('stg_inriver__item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'fact_sales_transactions' and upper("table_name") = upper('fact_sales_transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_customers' and upper("table_name") = upper('dim_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'salesforce' and upper("table_schema") = upper('salesforce')

                    and 
    "table_name" ilike 'customer' and upper("table_name") = upper('customer')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__transactions' and upper("table_name") = upper('stg_d365_fo__transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__items' and upper("table_name") = upper('stg_d365_fo__items')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'category' and upper("table_name") = upper('category')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__dates' and upper("table_name") = upper('stg_d365_fo__dates')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stores_snapshot' and upper("table_name") = upper('stores_snapshot')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_stores' and upper("table_name") = upper('dim_stores')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'store' and upper("table_name") = upper('store')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__managers' and upper("table_name") = upper('stg_d365_fo__managers')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'manager' and upper("table_name") = upper('manager')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__categories' and upper("table_name") = upper('stg_d365_fo__categories')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'date' and upper("table_name") = upper('date')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'transactions' and upper("table_name") = upper('transactions')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m19:46:50.719128 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:47:00.645495 [debug] [ThreadPool]: SQL status: SUCCESS 153 in 9.928 seconds
[0m19:47:00.692805 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\catalog.json
[0m19:47:00.708443 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m19:47:00.708443 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m19:47:00.708443 [info ] [MainThread]: Catalog written to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\catalog.json
[0m19:47:00.724069 [debug] [MainThread]: Command `dbt docs generate` succeeded at 19:47:00.724069 after 14.19 seconds
[0m19:47:00.724069 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m19:47:00.724069 [debug] [MainThread]: Connection 'EPICALDEMO.information_schema' was left open.
[0m19:47:00.724069 [debug] [MainThread]: On EPICALDEMO.information_schema: Close
[0m19:47:00.764454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DC92BAAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DC92B91D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DC5614B10>]}
[0m19:47:00.764454 [debug] [MainThread]: Flushing usage events
[0m19:47:01.195592 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:47:08.531439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE0C5780D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE0C56BF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE0C57AA90>]}


============================== 19:47:08.531439 | f584d536-8d71-4609-a282-2d7ffca264a4 ==============================
[0m19:47:08.531439 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:47:08.531439 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt docs serve', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:47:08.914333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f584d536-8d71-4609-a282-2d7ffca264a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE0DC6E4D0>]}
[0m19:47:08.947419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f584d536-8d71-4609-a282-2d7ffca264a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE0B206510>]}
[0m19:47:55.102873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002702F56E750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002702F56F490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002702F56EE50>]}


============================== 19:47:55.102873 | e5bfd14f-a39a-4737-9d2c-d96ebb113a4e ==============================
[0m19:47:55.102873 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:47:55.102873 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'c:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'profiles_dir': 'c:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt ', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:47:55.199054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e5bfd14f-a39a-4737-9d2c-d96ebb113a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002702FA1DE10>]}
[0m19:47:55.224411 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m19:47:55.227094 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m19:47:55.229093 [debug] [MainThread]: Command `cli deps` succeeded at 19:47:55.229093 after 0.19 seconds
[0m19:47:55.230174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002702F5BAB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002702F5B8F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002702F5B8E10>]}
[0m19:47:55.231095 [debug] [MainThread]: Flushing usage events
[0m19:47:55.674319 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:48:35.500789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165C9272B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165C9272190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165C9273590>]}


============================== 19:48:35.504791 | 67e0dc75-58ee-4c37-91c2-b7c88820e0fd ==============================
[0m19:48:35.504791 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:48:35.505789 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt build', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:48:35.904803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '67e0dc75-58ee-4c37-91c2-b7c88820e0fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165C9291550>]}
[0m19:48:35.944868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '67e0dc75-58ee-4c37-91c2-b7c88820e0fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165C7C4FA10>]}
[0m19:48:35.946803 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m19:48:36.243742 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:48:36.434133 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:48:36.434133 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:48:36.434133 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m19:48:36.475665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '67e0dc75-58ee-4c37-91c2-b7c88820e0fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165CACB2850>]}
[0m19:48:36.547467 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m19:48:36.550467 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m19:48:36.614149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '67e0dc75-58ee-4c37-91c2-b7c88820e0fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165CAF57F10>]}
[0m19:48:36.614149 [info ] [MainThread]: Found 13 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m19:48:36.614149 [info ] [MainThread]: 
[0m19:48:36.614149 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:48:36.614149 [info ] [MainThread]: 
[0m19:48:36.614149 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:48:36.629739 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m19:48:36.734969 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m19:48:36.734969 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m19:48:36.735963 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:48:37.205785 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.479 seconds
[0m19:48:37.205785 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m19:48:37.221450 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m19:48:37.221450 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m19:48:37.221450 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:48:37.456336 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.242 seconds
[0m19:48:37.471964 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m19:48:37.471964 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m19:48:37.550645 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.089 seconds
[0m19:48:37.566260 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m19:48:37.566260 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m19:48:37.613200 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.052 seconds
[0m19:48:37.613200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67e0dc75-58ee-4c37-91c2-b7c88820e0fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165C4CD0E50>]}
[0m19:48:37.631857 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__categories
[0m19:48:37.631857 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_d365_fo__dates
[0m19:48:37.631857 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_d365_fo__items
[0m19:48:37.631857 [info ] [Thread-1 (]: 1 of 14 START sql view model broman_analytics.stg_d365_fo__categories .......... [RUN]
[0m19:48:37.631857 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_d365_fo__managers
[0m19:48:37.631857 [info ] [Thread-2 (]: 2 of 14 START sql view model broman_analytics.stg_d365_fo__dates ............... [RUN]
[0m19:48:37.631857 [info ] [Thread-3 (]: 3 of 14 START sql view model broman_analytics.stg_d365_fo__items ............... [RUN]
[0m19:48:37.631857 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__categories'
[0m19:48:37.631857 [info ] [Thread-4 (]: 4 of 14 START sql view model broman_analytics.stg_d365_fo__managers ............ [RUN]
[0m19:48:37.631857 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__dates'
[0m19:48:37.631857 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__items'
[0m19:48:37.631857 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__categories
[0m19:48:37.631857 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__managers'
[0m19:48:37.631857 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_d365_fo__dates
[0m19:48:37.631857 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_d365_fo__items
[0m19:48:37.644873 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__categories"
[0m19:48:37.646211 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_d365_fo__managers
[0m19:48:37.648564 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__dates"
[0m19:48:37.652234 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__items"
[0m19:48:37.656246 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__managers"
[0m19:48:37.657306 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__categories
[0m19:48:37.657306 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_d365_fo__dates
[0m19:48:37.657306 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_d365_fo__items
[0m19:48:37.668082 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__categories"
[0m19:48:37.683088 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_d365_fo__managers
[0m19:48:37.685165 [debug] [Thread-2 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__dates"
[0m19:48:37.685165 [debug] [Thread-3 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__items"
[0m19:48:37.685165 [debug] [Thread-4 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__managers"
[0m19:48:37.685165 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__categories"
[0m19:48:37.685165 [debug] [Thread-2 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__dates"
[0m19:48:37.685165 [debug] [Thread-1 (]: On model.epicaldemo.stg_d365_fo__categories: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__categories"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__categories
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.category
),

final AS (
    SELECT
        id AS "category_id"
        ,INITCAP(name) AS "Category"
        ,managerid AS "manager_id"
    FROM source
)

SELECT * FROM final
  );
[0m19:48:37.685165 [debug] [Thread-3 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__items"
[0m19:48:37.685165 [debug] [Thread-2 (]: On model.epicaldemo.stg_d365_fo__dates: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__dates"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__dates
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.date
),

final AS (
    SELECT
        id AS "date_id"
        ,date AS "Date"
        ,year AS "Year"
        ,yearmonth AS "Year Month"
        ,LEFT(id::TEXT, 4) || '-' || RIGHT(id::TEXT, 2) AS "Year Month Number"
        ,monthnumber AS "Month Number"
        ,quarter AS "Quarter"
        ,quarternumber AS "Quarter Number"
        ,monthname AS "Month"
        ,LEFT(monthname,3) AS "Month Short"
    FROM source
)

SELECT * FROM final
  );
[0m19:48:37.685165 [debug] [Thread-4 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__managers"
[0m19:48:37.685165 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:48:37.685165 [debug] [Thread-3 (]: On model.epicaldemo.stg_d365_fo__items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__items"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__items
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.item
),

final AS (
    SELECT
        id AS "item_id"
        ,name AS "Item"
        ,COALESCE(brand, 'Missing') AS "Brand"
        ,categoryid AS "category_id"
        ,COALESCE(flavor, 'Missing') AS "Flavor"
        ,sku AS "SKU"
    FROM source
)

SELECT * FROM final
  );
[0m19:48:37.685165 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:48:37.685165 [debug] [Thread-4 (]: On model.epicaldemo.stg_d365_fo__managers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__managers"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__managers
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.manager
),

final AS (
    SELECT
        id AS "manager_id"
        ,firstname || ' ' || lastname AS "Manager"
    FROM source
)

SELECT * FROM final
  );
[0m19:48:37.701484 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:48:37.701484 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:48:38.070399 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.385 seconds
[0m19:48:38.101520 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.402 seconds
[0m19:48:38.101520 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67e0dc75-58ee-4c37-91c2-b7c88820e0fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165CAF81650>]}
[0m19:48:38.101520 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67e0dc75-58ee-4c37-91c2-b7c88820e0fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165CB508AD0>]}
[0m19:48:38.101520 [info ] [Thread-1 (]: 1 of 14 OK created sql view model broman_analytics.stg_d365_fo__categories ..... [[32mSUCCESS 1[0m in 0.47s]
[0m19:48:38.101520 [info ] [Thread-3 (]: 3 of 14 OK created sql view model broman_analytics.stg_d365_fo__items .......... [[32mSUCCESS 1[0m in 0.47s]
[0m19:48:38.116531 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__categories
[0m19:48:38.117443 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_d365_fo__items
[0m19:48:38.118449 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__transactions
[0m19:48:38.118449 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_inriver__item_attributes
[0m19:48:38.118449 [info ] [Thread-1 (]: 5 of 14 START sql view model broman_analytics.stg_d365_fo__transactions ........ [RUN]
[0m19:48:38.118449 [info ] [Thread-3 (]: 6 of 14 START sql view model broman_analytics.stg_inriver__item_attributes ..... [RUN]
[0m19:48:38.118449 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__categories, now model.epicaldemo.stg_d365_fo__transactions)
[0m19:48:38.118449 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__items, now model.epicaldemo.stg_inriver__item_attributes)
[0m19:48:38.122048 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__transactions
[0m19:48:38.123248 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_inriver__item_attributes
[0m19:48:38.127249 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__transactions"
[0m19:48:38.129032 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_inriver__item_attributes"
[0m19:48:38.129032 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__transactions
[0m19:48:38.132572 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_inriver__item_attributes
[0m19:48:38.135455 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__transactions"
[0m19:48:38.138741 [debug] [Thread-3 (]: Writing runtime sql for node "model.epicaldemo.stg_inriver__item_attributes"
[0m19:48:38.138741 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__transactions"
[0m19:48:38.138741 [debug] [Thread-3 (]: Using snowflake connection "model.epicaldemo.stg_inriver__item_attributes"
[0m19:48:38.138741 [debug] [Thread-1 (]: On model.epicaldemo.stg_d365_fo__transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__transactions"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__transactions
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.transactions
),

final AS (
    SELECT
        -- Identifiers
        CAST(TO_CHAR(date::DATE, 'YYYYMMDD') AS INTEGER) AS "date_id"
        ,sku AS "SKU"
        ,store AS "Store"
        ,customernumber AS "Customer Number"

        -- Metrics
        ,quantity AS "Qty"
        ,unitprice::NUMERIC(10,2) AS "Unit Price"
        ,(quantity * unitprice)::NUMERIC(10,2) AS "Sales Amount"
        ,unitcost::NUMERIC(10,2) AS "Unit Cost"
        ,(quantity * unitcost)::NUMERIC(10,2) AS "Cost"
        ,(quantity * unitprice)::NUMERIC(10,2) - (quantity * unitcost)::NUMERIC(10,2) AS "Margin"
    FROM source
)

SELECT * FROM final
  );
[0m19:48:38.138741 [debug] [Thread-3 (]: On model.epicaldemo.stg_inriver__item_attributes: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_inriver__item_attributes"} */
create or replace   view EPICALDEMO.broman_analytics.stg_inriver__item_attributes
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.inriver.item_attributes
),

final AS (
    SELECT
        id AS "item_attributes_id"
        ,sku AS "SKU"
        ,COALESCE(crunch_level, 'Missing') AS "Crunch Level"
        ,COALESCE(snack_time, 'Missing') AS "Snack Time"
    FROM source
)

SELECT * FROM final
  );
[0m19:48:38.218024 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.513 seconds
[0m19:48:38.220053 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67e0dc75-58ee-4c37-91c2-b7c88820e0fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165CB509650>]}
[0m19:48:38.221053 [info ] [Thread-4 (]: 4 of 14 OK created sql view model broman_analytics.stg_d365_fo__managers ....... [[32mSUCCESS 1[0m in 0.59s]
[0m19:48:38.222061 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_d365_fo__managers
[0m19:48:38.222061 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_salesforce__customers
[0m19:48:38.223048 [info ] [Thread-4 (]: 7 of 14 START sql view model broman_analytics.stg_salesforce__customers ........ [RUN]
[0m19:48:38.224048 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__managers, now model.epicaldemo.stg_salesforce__customers)
[0m19:48:38.224048 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_salesforce__customers
[0m19:48:38.227796 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_salesforce__customers"
[0m19:48:38.229825 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_salesforce__customers
[0m19:48:38.231824 [debug] [Thread-4 (]: Writing runtime sql for node "model.epicaldemo.stg_salesforce__customers"
[0m19:48:38.233346 [debug] [Thread-4 (]: Using snowflake connection "model.epicaldemo.stg_salesforce__customers"
[0m19:48:38.234529 [debug] [Thread-4 (]: On model.epicaldemo.stg_salesforce__customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_salesforce__customers"} */
create or replace   view EPICALDEMO.broman_analytics.stg_salesforce__customers
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.salesforce.customer
),

final AS (
    SELECT
        id AS "customer_id"
        ,customernumber AS "Customer Number"
        ,age AS "Customer Age"

        ,CASE
            WHEN age < 20 THEN '< 20'
            WHEN age >= 20 AND age < 30 THEN '20 - 30'
            WHEN age >= 30 AND age < 50 THEN '30 - 50'
            WHEN age >= 50 AND age < 60 THEN '50 - 60'
            ELSE '60+'
         END AS "Customer Age Group"

        ,CASE
            WHEN age < 20 THEN 1
            WHEN age >= 20 AND age < 30 THEN 2
            WHEN age >= 30 AND age < 50 THEN 3
            WHEN age >= 50 AND age < 60 THEN 4
            ELSE 5
         END AS "customer_age_group_sort"

        ,state AS "Customer State"
    FROM source
)

SELECT * FROM final
  );
[0m19:48:38.309599 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.610 seconds
[0m19:48:38.311605 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67e0dc75-58ee-4c37-91c2-b7c88820e0fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165CBA41D90>]}
[0m19:48:38.312603 [info ] [Thread-2 (]: 2 of 14 OK created sql view model broman_analytics.stg_d365_fo__dates .......... [[32mSUCCESS 1[0m in 0.68s]
[0m19:48:38.313603 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_d365_fo__dates
[0m19:48:38.313603 [debug] [Thread-2 (]: Began running node snapshot.epicaldemo.stores_snapshot
[0m19:48:38.314606 [info ] [Thread-2 (]: 8 of 14 START snapshot broman_analytics.stores_snapshot ........................ [RUN]
[0m19:48:38.315605 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__dates, now snapshot.epicaldemo.stores_snapshot)
[0m19:48:38.315605 [debug] [Thread-2 (]: Began compiling node snapshot.epicaldemo.stores_snapshot
[0m19:48:38.318364 [debug] [Thread-2 (]: Began executing node snapshot.epicaldemo.stores_snapshot
[0m19:48:38.355367 [debug] [Thread-2 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m19:48:38.356360 [debug] [Thread-2 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
[0m19:48:38.370448 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.227 seconds
[0m19:48:38.371633 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67e0dc75-58ee-4c37-91c2-b7c88820e0fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165CBA19650>]}
[0m19:48:38.371633 [info ] [Thread-3 (]: 6 of 14 OK created sql view model broman_analytics.stg_inriver__item_attributes  [[32mSUCCESS 1[0m in 0.25s]
[0m19:48:38.371633 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_inriver__item_attributes
[0m19:48:38.371633 [debug] [Thread-3 (]: Began running node model.epicaldemo.dim_dates
[0m19:48:38.371633 [info ] [Thread-3 (]: 9 of 14 START sql table model broman_analytics.dim_dates ....................... [RUN]
[0m19:48:38.371633 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_inriver__item_attributes, now model.epicaldemo.dim_dates)
[0m19:48:38.371633 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.dim_dates
[0m19:48:38.371633 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.dim_dates"
[0m19:48:38.371633 [debug] [Thread-3 (]: Began executing node model.epicaldemo.dim_dates
[0m19:48:38.402378 [debug] [Thread-3 (]: Writing runtime sql for node "model.epicaldemo.dim_dates"
[0m19:48:38.406237 [debug] [Thread-3 (]: Using snowflake connection "model.epicaldemo.dim_dates"
[0m19:48:38.408297 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.173 seconds
[0m19:48:38.409302 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.052 seconds
[0m19:48:38.409302 [debug] [Thread-3 (]: On model.epicaldemo.dim_dates: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_dates"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_dates
    

    
    as (with

dates AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__dates
),

final AS (
    SELECT
        "date_id"
        ,"Date"
        ,"Year"
        ,"Year Month"
        ,"Year Month Number"
        ,"Month Number"
        ,"Quarter"
        ,"Quarter Number"
        ,"Month"
        ,"Month Short"
    FROM dates
)

SELECT * FROM final
    )
;
[0m19:48:38.409302 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67e0dc75-58ee-4c37-91c2-b7c88820e0fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165CB513050>]}
[0m19:48:38.435622 [debug] [Thread-2 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m19:48:38.435622 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.305 seconds
[0m19:48:38.435622 [info ] [Thread-4 (]: 7 of 14 OK created sql view model broman_analytics.stg_salesforce__customers ... [[32mSUCCESS 1[0m in 0.19s]
[0m19:48:38.452159 [debug] [Thread-2 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
create or replace temporary table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp"
as (
    
    
    with snapshot_query as (

        select * from EPICALDEMO.d365_fo.store

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            
  
  coalesce(nullif(modified, modified), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            modified as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.modified)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.modified)
        )
    )

    select * from insertions
    union all
    select * from updates

    )
;
[0m19:48:38.454234 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67e0dc75-58ee-4c37-91c2-b7c88820e0fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165CB50A3D0>]}
[0m19:48:38.455225 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_salesforce__customers
[0m19:48:38.457226 [debug] [Thread-4 (]: Began running node model.epicaldemo.dim_items
[0m19:48:38.456212 [info ] [Thread-1 (]: 5 of 14 OK created sql view model broman_analytics.stg_d365_fo__transactions ... [[32mSUCCESS 1[0m in 0.34s]
[0m19:48:38.458166 [info ] [Thread-4 (]: 10 of 14 START sql table model broman_analytics.dim_items ...................... [RUN]
[0m19:48:38.459165 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__transactions
[0m19:48:38.460164 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_salesforce__customers, now model.epicaldemo.dim_items)
[0m19:48:38.461247 [debug] [Thread-1 (]: Began running node model.epicaldemo.dim_customers
[0m19:48:38.462248 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.dim_items
[0m19:48:38.463248 [info ] [Thread-1 (]: 11 of 14 START sql table model broman_analytics.dim_customers .................. [RUN]
[0m19:48:38.467166 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.dim_items"
[0m19:48:38.467166 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__transactions, now model.epicaldemo.dim_customers)
[0m19:48:38.468173 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.dim_customers
[0m19:48:38.471175 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.dim_customers"
[0m19:48:38.471175 [debug] [Thread-4 (]: Began executing node model.epicaldemo.dim_items
[0m19:48:38.475686 [debug] [Thread-4 (]: Writing runtime sql for node "model.epicaldemo.dim_items"
[0m19:48:38.475686 [debug] [Thread-1 (]: Began executing node model.epicaldemo.dim_customers
[0m19:48:38.478681 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.dim_customers"
[0m19:48:38.479672 [debug] [Thread-4 (]: Using snowflake connection "model.epicaldemo.dim_items"
[0m19:48:38.479672 [debug] [Thread-4 (]: On model.epicaldemo.dim_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_items"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_items
    

    
    as (with

items AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__items
),

item_attributes AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_inriver__item_attributes
),

categories AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__categories
),

managers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__managers
),

unknown AS (
    SELECT
        -1 AS "item_id"
        ,'Unknown' AS "SKU"
        ,'Unknown' AS "Item"
        ,'Missing' AS "Brand"
        ,'Missing' AS "Flavor"
        ,'Missing' AS "Crunch Level"
        ,'Missing' AS "Snack Time"
        ,'Missing' AS "Category"
        ,'Missing' AS "Manager"
),

missing AS (
    SELECT
        -2 AS "item_id"
        ,'Missing' AS "SKU"
        ,'Missing' AS "Item"
        ,'Missing' AS "Brand"
        ,'Missing' AS "Flavor"
        ,'Missing' AS "Crunch Level"
        ,'Missing' AS "Snack Time"
        ,'Missing' AS "Category"
        ,'Missing' AS "Manager"
),

final AS (
    SELECT
        items."item_id"
        ,items."SKU"
        ,items."Item"
        ,items."Brand"
        ,items."Flavor"
        ,COALESCE(item_attributes."Crunch Level", 'Missing') AS "Crunch Level"
        ,COALESCE(item_attributes."Snack Time", 'Missing') AS "Snack Time"
        ,categories."Category"
        ,managers."Manager"
    FROM items
    LEFT JOIN item_attributes ON item_attributes."SKU" = items."SKU"
    LEFT JOIN categories ON categories."category_id" = items."category_id"
    LEFT JOIN managers ON managers."manager_id" = categories."manager_id"

    UNION

    SELECT * FROM unknown

    UNION

    SELECT * FROM missing
)

SELECT * FROM final
    )
;
[0m19:48:38.479672 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.dim_customers"
[0m19:48:38.479672 [debug] [Thread-1 (]: On model.epicaldemo.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_customers"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_customers
    

    
    as (WITH

customers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_salesforce__customers
),

final AS (
    SELECT
        "customer_id"
        ,"Customer Number"
        ,"Customer Age"
        ,"Customer Age Group"
        ,"customer_age_group_sort"
        ,"Customer State"
    FROM customers
)

SELECT * FROM final
    )
;
[0m19:48:39.313452 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.861 seconds
[0m19:48:39.313452 [debug] [Thread-2 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m19:48:39.313452 [debug] [Thread-2 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp"
[0m19:48:39.373170 [debug] [Thread-2 (]: SQL status: SUCCESS 13 in 0.053 seconds
[0m19:48:39.376170 [debug] [Thread-2 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m19:48:39.376170 [debug] [Thread-2 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
[0m19:48:39.384149 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.902 seconds
[0m19:48:39.384149 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67e0dc75-58ee-4c37-91c2-b7c88820e0fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165CBAA6190>]}
[0m19:48:39.384149 [info ] [Thread-1 (]: 11 of 14 OK created sql table model broman_analytics.dim_customers ............. [[32mSUCCESS 1[0m in 0.92s]
[0m19:48:39.384149 [debug] [Thread-1 (]: Finished running node model.epicaldemo.dim_customers
[0m19:48:39.405358 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.958 seconds
[0m19:48:39.405358 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67e0dc75-58ee-4c37-91c2-b7c88820e0fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165CA4ABD50>]}
[0m19:48:39.405358 [info ] [Thread-3 (]: 9 of 14 OK created sql table model broman_analytics.dim_dates .................. [[32mSUCCESS 1[0m in 1.03s]
[0m19:48:39.405358 [debug] [Thread-3 (]: Finished running node model.epicaldemo.dim_dates
[0m19:48:39.438146 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.061 seconds
[0m19:48:39.441246 [debug] [Thread-2 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m19:48:39.441246 [debug] [Thread-2 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp"
[0m19:48:39.485988 [debug] [Thread-2 (]: SQL status: SUCCESS 13 in 0.043 seconds
[0m19:48:39.488993 [debug] [Thread-2 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m19:48:39.489985 [debug] [Thread-2 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
[0m19:48:39.538663 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.048 seconds
[0m19:48:39.544852 [debug] [Thread-2 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m19:48:39.544852 [debug] [Thread-2 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp"
[0m19:48:39.583167 [debug] [Thread-2 (]: SQL status: SUCCESS 13 in 0.038 seconds
[0m19:48:39.602303 [debug] [Thread-2 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m19:48:39.603291 [debug] [Thread-2 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from EPICALDEMO.d365_fo.store

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            
  
  coalesce(nullif(modified, modified), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            modified as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.modified)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.modified)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m19:48:39.734548 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.265 seconds
[0m19:48:39.749555 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67e0dc75-58ee-4c37-91c2-b7c88820e0fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165CBA196D0>]}
[0m19:48:39.749555 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.147 seconds
[0m19:48:39.749555 [info ] [Thread-4 (]: 10 of 14 OK created sql table model broman_analytics.dim_items ................. [[32mSUCCESS 1[0m in 1.27s]
[0m19:48:39.749555 [debug] [Thread-2 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m19:48:39.749555 [debug] [Thread-4 (]: Finished running node model.epicaldemo.dim_items
[0m19:48:39.749555 [debug] [Thread-2 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m19:48:39.800765 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.042 seconds
[0m19:48:39.801914 [warn ] [Thread-2 (]: Data type of snapshot table timestamp columns (TIMESTAMP_NTZ) doesn't match derived column 'updated_at' (DATE). Please update snapshot config 'updated_at'.
[0m19:48:39.803596 [debug] [Thread-2 (]: Writing runtime sql for node "snapshot.epicaldemo.stores_snapshot"
[0m19:48:39.803596 [debug] [Thread-2 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m19:48:39.803596 [debug] [Thread-2 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
BEGIN
[0m19:48:39.887925 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.081 seconds
[0m19:48:39.887925 [debug] [Thread-2 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m19:48:39.888925 [debug] [Thread-2 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
merge into "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT" as DBT_INTERNAL_DEST
    using "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
	
	
	and ((DBT_INTERNAL_DEST.dbt_valid_to = to_date('9999-12-31'))
 or DBT_INTERNAL_DEST.dbt_valid_to is null)

     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("ID", "NAME", "LOCATION", "LATITUDE", "LONGITUDE", "ONLINEPRESENCE", "MODIFIED", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("ID", "NAME", "LOCATION", "LATITUDE", "LONGITUDE", "ONLINEPRESENCE", "MODIFIED", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m19:48:40.299643 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.423 seconds
[0m19:48:40.299643 [debug] [Thread-2 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m19:48:40.315288 [debug] [Thread-2 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
COMMIT
[0m19:48:40.544985 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.240 seconds
[0m19:48:40.544985 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67e0dc75-58ee-4c37-91c2-b7c88820e0fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165CBB67E50>]}
[0m19:48:40.560638 [info ] [Thread-2 (]: 8 of 14 OK snapshotted broman_analytics.stores_snapshot ........................ [[32mSUCCESS 0[0m in 2.23s]
[0m19:48:40.560638 [debug] [Thread-2 (]: Finished running node snapshot.epicaldemo.stores_snapshot
[0m19:48:40.560638 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__stores
[0m19:48:40.560638 [info ] [Thread-1 (]: 12 of 14 START sql view model broman_analytics.stg_d365_fo__stores ............. [RUN]
[0m19:48:40.560638 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.dim_customers, now model.epicaldemo.stg_d365_fo__stores)
[0m19:48:40.560638 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__stores
[0m19:48:40.560638 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__stores"
[0m19:48:40.560638 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__stores
[0m19:48:40.560638 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__stores"
[0m19:48:40.560638 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__stores"
[0m19:48:40.576263 [debug] [Thread-1 (]: On model.epicaldemo.stg_d365_fo__stores: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__stores"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__stores
  
   as (
    WITH

stores_snapshots AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stores_snapshot
),

final AS (
    SELECT
        -- Identifiers
        id AS "store_id"

        -- SCD2 Fields
        ,dbt_scd_id AS "dbt_scd_id"
        ,ROW_NUMBER() OVER (ORDER BY id ASC, dbt_valid_from ASC) AS "store_key"
        ,CASE WHEN dbt_valid_to = '9999-12-31' THEN 1 ELSE 0 END AS "is_current"
        ,modified AS "modified"
        ,CAST(TO_CHAR(dbt_valid_from::DATE, 'YYYYMMDD') AS INTEGER) AS "valid_from"
        ,CAST(TO_CHAR(dbt_valid_to::DATE, 'YYYYMMDD') AS INTEGER) AS "valid_to"

        -- Attributes
        ,name AS "Store"
        ,SPLIT_PART(location, ',', 1) AS "Store State"
        ,SPLIT_PART(location, ',', 2) AS "Store City"
        ,latitude AS "Lat"
        ,longitude AS "Lon"
        ,onlinepresence AS "Online Presence"
    FROM stores_snapshots
)

SELECT * FROM final
  );
[0m19:48:40.857117 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.290 seconds
[0m19:48:40.857117 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67e0dc75-58ee-4c37-91c2-b7c88820e0fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165CBB3F650>]}
[0m19:48:40.857117 [info ] [Thread-1 (]: 12 of 14 OK created sql view model broman_analytics.stg_d365_fo__stores ........ [[32mSUCCESS 1[0m in 0.30s]
[0m19:48:40.857117 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__stores
[0m19:48:40.872681 [debug] [Thread-4 (]: Began running node model.epicaldemo.dim_stores
[0m19:48:40.872681 [debug] [Thread-2 (]: Began running node model.epicaldemo.fact_sales_transactions
[0m19:48:40.872681 [info ] [Thread-4 (]: 13 of 14 START sql table model broman_analytics.dim_stores ..................... [RUN]
[0m19:48:40.872681 [info ] [Thread-2 (]: 14 of 14 START sql table model broman_analytics.fact_sales_transactions ........ [RUN]
[0m19:48:40.872681 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.dim_items, now model.epicaldemo.dim_stores)
[0m19:48:40.872681 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly snapshot.epicaldemo.stores_snapshot, now model.epicaldemo.fact_sales_transactions)
[0m19:48:40.872681 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.dim_stores
[0m19:48:40.872681 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.fact_sales_transactions
[0m19:48:40.872681 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.dim_stores"
[0m19:48:40.872681 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.fact_sales_transactions"
[0m19:48:40.872681 [debug] [Thread-2 (]: Began executing node model.epicaldemo.fact_sales_transactions
[0m19:48:40.872681 [debug] [Thread-4 (]: Began executing node model.epicaldemo.dim_stores
[0m19:48:40.872681 [debug] [Thread-2 (]: Writing runtime sql for node "model.epicaldemo.fact_sales_transactions"
[0m19:48:40.888318 [debug] [Thread-4 (]: Writing runtime sql for node "model.epicaldemo.dim_stores"
[0m19:48:40.891792 [debug] [Thread-2 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions"
[0m19:48:40.891792 [debug] [Thread-4 (]: Using snowflake connection "model.epicaldemo.dim_stores"
[0m19:48:40.892837 [debug] [Thread-2 (]: On model.epicaldemo.fact_sales_transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions"} */
create or replace transient table EPICALDEMO.broman_analytics.fact_sales_transactions
    

    
    as (WITH

sales AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__transactions
),

items AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__items
),

stores AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__stores
),

customers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_salesforce__customers
),

final AS (
    SELECT
        -- Identifiers
        sales."date_id"

        ,CASE
            WHEN sales."SKU" IS NULL THEN -2 -- SKU is missing FROM Source
            WHEN items."item_id" IS NULL THEN -1 -- SKU is not known FROM Source
            ELSE items."item_id" -- Join item_id FROM Dim based on SKU
         END AS "item_id"

        ,CASE
            WHEN sales."Store" IS NULL THEN -2
            WHEN stores."store_key" IS NULL THEN -1
            ELSE stores."store_key"
         END AS "store_key"

        ,CASE
            WHEN sales."Customer Number" IS NULL THEN -2
            WHEN customers."customer_id" IS NULL THEN -1
            ELSE customers."customer_id"
         END AS "customer_id"

        -- Metrics
        ,sales."Qty"
        ,sales."Unit Price"
        ,sales."Sales Amount"
        ,sales."Unit Cost"
        ,sales."Cost"
        ,sales."Margin"
    FROM sales
    LEFT JOIN items ON items."SKU" = sales."SKU"
    LEFT JOIN stores ON stores."Store" = sales."Store" AND sales."date_id" >= stores."valid_from" AND sales."date_id" < stores."valid_to"
    LEFT JOIN customers ON customers."Customer Number" = sales."Customer Number"
)

SELECT * FROM final
    )
;
[0m19:48:40.893825 [debug] [Thread-4 (]: On model.epicaldemo.dim_stores: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_stores"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_stores
    

    
    as (WITH

store AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__stores
),

final AS (
    SELECT
        "store_key"
        ,"store_id"
        ,"is_current"
        ,"Store"
        ,"Store State"
        ,"Store City"
        ,"Lat"
        ,"Lon"
        ,"Online Presence"
        --,"modified"
        ,"valid_from"
        ,"valid_to"
    FROM store
)

SELECT * FROM final
    )
;
[0m19:48:41.908590 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.019 seconds
[0m19:48:41.908590 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67e0dc75-58ee-4c37-91c2-b7c88820e0fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165CBB4C9D0>]}
[0m19:48:41.908590 [info ] [Thread-2 (]: 14 of 14 OK created sql table model broman_analytics.fact_sales_transactions ... [[32mSUCCESS 1[0m in 1.04s]
[0m19:48:41.908590 [debug] [Thread-2 (]: Finished running node model.epicaldemo.fact_sales_transactions
[0m19:48:42.112925 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.227 seconds
[0m19:48:42.112925 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67e0dc75-58ee-4c37-91c2-b7c88820e0fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165CB3F0810>]}
[0m19:48:42.112925 [info ] [Thread-4 (]: 13 of 14 OK created sql table model broman_analytics.dim_stores ................ [[32mSUCCESS 1[0m in 1.24s]
[0m19:48:42.112925 [debug] [Thread-4 (]: Finished running node model.epicaldemo.dim_stores
[0m19:48:42.112925 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:48:42.112925 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m19:48:42.112925 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m19:48:42.174058 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m19:48:42.174058 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m19:48:42.228120 [debug] [MainThread]: Connection 'model.epicaldemo.stg_d365_fo__stores' was left open.
[0m19:48:42.229177 [debug] [MainThread]: On model.epicaldemo.stg_d365_fo__stores: Close
[0m19:48:42.282186 [debug] [MainThread]: Connection 'model.epicaldemo.fact_sales_transactions' was left open.
[0m19:48:42.282186 [debug] [MainThread]: On model.epicaldemo.fact_sales_transactions: Close
[0m19:48:42.345198 [debug] [MainThread]: Connection 'model.epicaldemo.dim_dates' was left open.
[0m19:48:42.345198 [debug] [MainThread]: On model.epicaldemo.dim_dates: Close
[0m19:48:42.392159 [debug] [MainThread]: Connection 'model.epicaldemo.dim_stores' was left open.
[0m19:48:42.392159 [debug] [MainThread]: On model.epicaldemo.dim_stores: Close
[0m19:48:42.439030 [info ] [MainThread]: 
[0m19:48:42.439030 [info ] [MainThread]: Finished running 1 snapshot, 5 table models, 8 view models in 0 hours 0 minutes and 5.82 seconds (5.82s).
[0m19:48:42.439030 [debug] [MainThread]: Command end result
[0m19:48:42.474773 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m19:48:42.474773 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m19:48:42.484742 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m19:48:42.484742 [info ] [MainThread]: 
[0m19:48:42.485705 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:48:42.485705 [info ] [MainThread]: 
[0m19:48:42.485705 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m19:48:42.485705 [debug] [MainThread]: Command `dbt build` succeeded at 19:48:42.485705 after 7.05 seconds
[0m19:48:42.485705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165C36F3090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165C3672190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165C3672210>]}
[0m19:48:42.485705 [debug] [MainThread]: Flushing usage events
[0m19:48:42.963542 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:11:19.682712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A267D7AA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A267D78410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A267D79190>]}


============================== 20:11:19.699003 | e5402392-d9a0-48ef-a1d3-540cd49d4536 ==============================
[0m20:11:19.699003 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:11:19.699003 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:11:22.207660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e5402392-d9a0-48ef-a1d3-540cd49d4536', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A267D8D550>]}
[0m20:11:22.254588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e5402392-d9a0-48ef-a1d3-540cd49d4536', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A26654F8D0>]}
[0m20:18:11.602360 [error] [MainThread]: Encountered an error:

[0m20:18:11.638908 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m20:18:11.655266 [debug] [MainThread]: Command `dbt docs serve` failed at 20:18:11.655266 after 412.04 seconds
[0m20:18:11.656284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A267D8FFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A269570790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A267D6B2D0>]}
[0m20:18:11.657363 [debug] [MainThread]: Flushing usage events
[0m20:18:12.118402 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:54:17.961583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7E226C2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7E226C810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7E226F590>]}


============================== 09:54:17.966590 | c76697ca-0451-42d8-ad7b-b6d132438b09 ==============================
[0m09:54:17.966590 [info ] [MainThread]: Running with dbt=1.9.4
[0m09:54:17.968618 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'c:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'c:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:54:18.066956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c76697ca-0451-42d8-ad7b-b6d132438b09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7E22BA390>]}
[0m09:54:18.160939 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m09:54:18.163982 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m09:54:18.165001 [debug] [MainThread]: Command `cli deps` succeeded at 09:54:18.165001 after 0.29 seconds
[0m09:54:18.166523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7E2263850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7E2379FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7E0DA5450>]}
[0m09:54:18.166523 [debug] [MainThread]: Flushing usage events
[0m09:54:18.777292 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:15:14.422353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002977166F1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002977166C990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002977166D590>]}


============================== 14:15:14.427856 | 59b9d014-9d2b-4dbd-8c61-892a5458f6cd ==============================
[0m14:15:14.427856 [info ] [MainThread]: Running with dbt=1.9.4
[0m14:15:14.428875 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'debug': 'False', 'profiles_dir': 'c:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:15:14.553488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59b9d014-9d2b-4dbd-8c61-892a5458f6cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029771663210>]}
[0m14:15:14.678951 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:15:14.688457 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:15:14.691471 [debug] [MainThread]: Command `cli deps` succeeded at 14:15:14.691471 after 0.36 seconds
[0m14:15:14.692468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029771692590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029771678190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029771781FD0>]}
[0m14:15:14.694469 [debug] [MainThread]: Flushing usage events
[0m14:15:16.108996 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:00:30.220163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A7AE703D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A7AE739D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A7AE71910>]}


============================== 15:00:30.223160 | fcae777f-23dc-496e-a329-3bcf9442163c ==============================
[0m15:00:30.223160 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:00:30.224160 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -s stg_d365_fo__transactions', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:00:30.618359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fcae777f-23dc-496e-a329-3bcf9442163c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A7C1692D0>]}
[0m15:00:30.659005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fcae777f-23dc-496e-a329-3bcf9442163c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A7984F990>]}
[0m15:00:30.660997 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m15:00:31.026277 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:00:31.213515 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:00:31.214516 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:00:31.220028 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m15:00:31.254567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fcae777f-23dc-496e-a329-3bcf9442163c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A7C8B2610>]}
[0m15:00:31.329960 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m15:00:31.348645 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m15:00:31.378921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fcae777f-23dc-496e-a329-3bcf9442163c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A78ADBBD0>]}
[0m15:00:31.378921 [info ] [MainThread]: Found 14 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m15:00:31.379921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcae777f-23dc-496e-a329-3bcf9442163c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A78FA9B10>]}
[0m15:00:31.381921 [info ] [MainThread]: 
[0m15:00:31.381921 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:00:31.382920 [info ] [MainThread]: 
[0m15:00:31.383920 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:00:31.384922 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m15:00:31.465677 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m15:00:31.466694 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m15:00:31.466694 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:00:32.552904 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.086 seconds
[0m15:00:32.558445 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m15:00:32.567943 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m15:00:32.567943 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m15:00:32.568947 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:00:34.018628 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.450 seconds
[0m15:00:34.022627 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m15:00:34.023626 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m15:00:34.250618 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.227 seconds
[0m15:00:34.252617 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m15:00:34.252617 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m15:00:34.405875 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.152 seconds
[0m15:00:34.409872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcae777f-23dc-496e-a329-3bcf9442163c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A7C8B2E10>]}
[0m15:00:34.416832 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__transactions
[0m15:00:34.416832 [info ] [Thread-1 (]: 1 of 1 START sql view model broman_analytics.stg_d365_fo__transactions ......... [RUN]
[0m15:00:34.417831 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__transactions'
[0m15:00:34.418835 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__transactions
[0m15:00:34.424831 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__transactions"
[0m15:00:34.427337 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__transactions
[0m15:00:34.452878 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__transactions"
[0m15:00:34.455987 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__transactions"
[0m15:00:34.456997 [debug] [Thread-1 (]: On model.epicaldemo.stg_d365_fo__transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__transactions"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__transactions
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.transactions
),

final AS (
    SELECT
        -- Identifiers
        updated_at
        ,CAST(TO_CHAR(transaction_date::DATE, 'YYYYMMDD') AS INTEGER) AS "date_id"
        ,sku AS "SKU"
        ,store AS "Store"
        ,customernumber AS "Customer Number"

        -- Metrics
        ,quantity AS "Qty"
        ,unitprice::NUMERIC(10,2) AS "Unit Price"
        ,(quantity * unitprice)::NUMERIC(10,2) AS "Sales Amount"
        ,unitcost::NUMERIC(10,2) AS "Unit Cost"
        ,(quantity * unitcost)::NUMERIC(10,2) AS "Cost"
        ,(quantity * unitprice)::NUMERIC(10,2) - (quantity * unitcost)::NUMERIC(10,2) AS "Margin"
    FROM source
)

SELECT * FROM final
  );
[0m15:00:34.456997 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:00:35.260911 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.804 seconds
[0m15:00:35.289512 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcae777f-23dc-496e-a329-3bcf9442163c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A7CEFE9D0>]}
[0m15:00:35.290508 [info ] [Thread-1 (]: 1 of 1 OK created sql view model broman_analytics.stg_d365_fo__transactions .... [[32mSUCCESS 1[0m in 0.86s]
[0m15:00:35.291528 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__transactions
[0m15:00:35.293500 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:00:35.294510 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m15:00:35.294510 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m15:00:35.511065 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m15:00:35.512066 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m15:00:35.746918 [debug] [MainThread]: Connection 'model.epicaldemo.stg_d365_fo__transactions' was left open.
[0m15:00:35.747939 [debug] [MainThread]: On model.epicaldemo.stg_d365_fo__transactions: Close
[0m15:00:35.969005 [info ] [MainThread]: 
[0m15:00:35.969930 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.59 seconds (4.59s).
[0m15:00:35.970930 [debug] [MainThread]: Command end result
[0m15:00:35.992000 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m15:00:35.995007 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m15:00:36.003460 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m15:00:36.004447 [info ] [MainThread]: 
[0m15:00:36.004447 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:00:36.005952 [info ] [MainThread]: 
[0m15:00:36.005952 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:00:36.006959 [debug] [MainThread]: Command `dbt run` succeeded at 15:00:36.006959 after 5.85 seconds
[0m15:00:36.007968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A7AEDBE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A7AED99D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A752C1250>]}
[0m15:00:36.007968 [debug] [MainThread]: Flushing usage events
[0m15:00:36.670577 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:01:03.582811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279FA473210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279FA471FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279FA473610>]}


============================== 15:01:03.586326 | c3189667-6c79-442e-a8f5-3109c1ea527f ==============================
[0m15:01:03.586326 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:01:03.587335 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -s fact_sales_transactions_incremental', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:01:03.974717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3189667-6c79-442e-a8f5-3109c1ea527f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279FA48D1D0>]}
[0m15:01:04.023915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c3189667-6c79-442e-a8f5-3109c1ea527f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279FB631810>]}
[0m15:01:04.024907 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m15:01:04.314526 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:01:04.490747 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:01:04.491744 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:01:04.496263 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m15:01:04.531862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c3189667-6c79-442e-a8f5-3109c1ea527f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279FBEE8F10>]}
[0m15:01:04.605743 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m15:01:04.608966 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m15:01:04.628026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c3189667-6c79-442e-a8f5-3109c1ea527f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279FB6F6850>]}
[0m15:01:04.629025 [info ] [MainThread]: Found 14 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m15:01:04.630025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3189667-6c79-442e-a8f5-3109c1ea527f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279FBEE8F90>]}
[0m15:01:04.631026 [info ] [MainThread]: 
[0m15:01:04.632025 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:01:04.633027 [info ] [MainThread]: 
[0m15:01:04.633027 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:01:04.634028 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m15:01:04.709632 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m15:01:04.710632 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m15:01:04.711633 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:01:05.808759 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.098 seconds
[0m15:01:05.815780 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m15:01:05.825886 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m15:01:05.825886 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m15:01:05.826839 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:01:06.882760 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.056 seconds
[0m15:01:06.886278 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m15:01:06.886278 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m15:01:07.656454 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.769 seconds
[0m15:01:07.658458 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m15:01:07.658458 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m15:01:07.807513 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.148 seconds
[0m15:01:07.815527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3189667-6c79-442e-a8f5-3109c1ea527f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279F848F490>]}
[0m15:01:07.821725 [debug] [Thread-1 (]: Began running node model.epicaldemo.fact_sales_transactions_incremental
[0m15:01:07.821725 [info ] [Thread-1 (]: 1 of 1 START sql incremental model broman_analytics.fact_sales_transactions_incremental  [RUN]
[0m15:01:07.822737 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.fact_sales_transactions_incremental'
[0m15:01:07.823733 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.fact_sales_transactions_incremental
[0m15:01:07.834506 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.fact_sales_transactions_incremental"
[0m15:01:07.846100 [debug] [Thread-1 (]: Began executing node model.epicaldemo.fact_sales_transactions_incremental
[0m15:01:07.894744 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.fact_sales_transactions_incremental"
[0m15:01:07.898265 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m15:01:07.899277 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
create or replace transient table EPICALDEMO.broman_analytics.fact_sales_transactions_incremental
    

    
    as (

WITH

sales AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__transactions

    
),

items AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__items
),

stores AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__stores
),

customers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_salesforce__customers
),

final AS (
    SELECT
        -- Identifiers
        sales."date_id"
        ,sales."UPDATED_AT"

        ,CASE
            WHEN sales."SKU" IS NULL THEN -2 -- SKU is missing FROM Source
            WHEN items."item_id" IS NULL THEN -1 -- SKU is not known FROM Source
            ELSE items."item_id" -- Use item_id FROM Dim based on SKU
         END AS "item_id"

        ,CASE
            WHEN sales."Store" IS NULL THEN -2
            WHEN stores."store_key" IS NULL THEN -1
            ELSE stores."store_key"
         END AS "store_key"

        ,CASE
            WHEN sales."Customer Number" IS NULL THEN -2
            WHEN customers."customer_id" IS NULL THEN -1
            ELSE customers."customer_id"
         END AS "customer_id"

        -- Metrics
        ,sales."Qty"
        ,sales."Unit Price"
        ,sales."Sales Amount"
        ,sales."Unit Cost"
        ,sales."Cost"
        ,sales."Margin"
    FROM sales
    LEFT JOIN items ON items."SKU" = sales."SKU"
    LEFT JOIN stores ON stores."Store" = sales."Store" AND sales."date_id" >= stores."valid_from" AND sales."date_id" < stores."valid_to"
    LEFT JOIN customers ON customers."Customer Number" = sales."Customer Number"
)

SELECT * FROM final
    )
;
[0m15:01:07.900267 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:01:10.918712 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.019 seconds
[0m15:01:10.939395 [debug] [Thread-1 (]: Applying DROP to: EPICALDEMO.broman_analytics.fact_sales_transactions_incremental__dbt_tmp
[0m15:01:10.945899 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m15:01:10.945899 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
drop view if exists EPICALDEMO.broman_analytics.fact_sales_transactions_incremental__dbt_tmp cascade
[0m15:01:11.079249 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.133 seconds
[0m15:01:11.097287 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3189667-6c79-442e-a8f5-3109c1ea527f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279FCA0D290>]}
[0m15:01:11.098303 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model broman_analytics.fact_sales_transactions_incremental  [[32mSUCCESS 1[0m in 3.27s]
[0m15:01:11.099286 [debug] [Thread-1 (]: Finished running node model.epicaldemo.fact_sales_transactions_incremental
[0m15:01:11.101288 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:01:11.102341 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m15:01:11.103281 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m15:01:11.309409 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m15:01:11.310410 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m15:01:11.561343 [debug] [MainThread]: Connection 'model.epicaldemo.fact_sales_transactions_incremental' was left open.
[0m15:01:11.562332 [debug] [MainThread]: On model.epicaldemo.fact_sales_transactions_incremental: Close
[0m15:01:11.835754 [info ] [MainThread]: 
[0m15:01:11.837691 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 7.20 seconds (7.20s).
[0m15:01:11.839918 [debug] [MainThread]: Command end result
[0m15:01:11.862128 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m15:01:11.865630 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m15:01:11.872634 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m15:01:11.873638 [info ] [MainThread]: 
[0m15:01:11.874634 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:01:11.875640 [info ] [MainThread]: 
[0m15:01:11.876146 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:01:11.878159 [debug] [MainThread]: Command `dbt run` succeeded at 15:01:11.878159 after 8.35 seconds
[0m15:01:11.878159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279FA48F910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279FA195A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279F4724E90>]}
[0m15:01:11.879157 [debug] [MainThread]: Flushing usage events
[0m15:01:12.583400 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:13:26.654739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C33F79A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C33F71D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C33F71510>]}


============================== 15:13:26.677474 | 9c0366d2-36a8-474d-b431-1cb54c00de3d ==============================
[0m15:13:26.677474 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:13:26.679523 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -s fact_sales_transactions_incremental', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:13:30.102375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c0366d2-36a8-474d-b431-1cb54c00de3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C3539BC50>]}
[0m15:13:30.150654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c0366d2-36a8-474d-b431-1cb54c00de3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C35331B50>]}
[0m15:13:30.170766 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m15:13:30.552748 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:13:30.735984 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:13:30.736987 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:13:30.740988 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m15:13:30.777353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c0366d2-36a8-474d-b431-1cb54c00de3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C35AECDD0>]}
[0m15:13:30.854049 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m15:13:30.870585 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m15:13:31.122064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c0366d2-36a8-474d-b431-1cb54c00de3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C35B14990>]}
[0m15:13:31.123249 [info ] [MainThread]: Found 14 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m15:13:31.124255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c0366d2-36a8-474d-b431-1cb54c00de3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C33FB4E10>]}
[0m15:13:31.125250 [info ] [MainThread]: 
[0m15:13:31.126258 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:13:31.126258 [info ] [MainThread]: 
[0m15:13:31.127259 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:13:31.128249 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m15:13:33.567114 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m15:13:33.568114 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m15:13:33.568114 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:13:34.725335 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.157 seconds
[0m15:13:34.742602 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m15:13:34.764681 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m15:13:34.764681 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m15:13:34.765681 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:13:36.462164 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.696 seconds
[0m15:13:36.468045 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m15:13:36.468045 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m15:13:36.624311 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.154 seconds
[0m15:13:36.628310 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m15:13:36.630299 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m15:13:36.776730 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.145 seconds
[0m15:13:36.782287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c0366d2-36a8-474d-b431-1cb54c00de3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C35BEA890>]}
[0m15:13:36.787300 [debug] [Thread-1 (]: Began running node model.epicaldemo.fact_sales_transactions_incremental
[0m15:13:36.788302 [info ] [Thread-1 (]: 1 of 1 START sql incremental model broman_analytics.fact_sales_transactions_incremental  [RUN]
[0m15:13:36.788302 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.fact_sales_transactions_incremental'
[0m15:13:36.789303 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.fact_sales_transactions_incremental
[0m15:13:36.809373 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.fact_sales_transactions_incremental"
[0m15:13:36.811379 [debug] [Thread-1 (]: Began executing node model.epicaldemo.fact_sales_transactions_incremental
[0m15:13:36.862979 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.fact_sales_transactions_incremental"
[0m15:13:36.866979 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m15:13:36.867990 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
create or replace transient table EPICALDEMO.broman_analytics.fact_sales_transactions_incremental
    

    
    as (

WITH

sales AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__transactions

    
),

items AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__items
),

stores AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__stores
),

customers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_salesforce__customers
),

final AS (
    SELECT
        -- Identifiers
        sales."date_id"
        ,sales."UPDATED_AT"
        ,CONVERT_TIMEZONE('Europe/Stockholm', CURRENT_TIMESTAMP()) AS "LOADED_AT"

        ,CASE
            WHEN sales."SKU" IS NULL THEN -2 -- SKU is missing FROM Source
            WHEN items."item_id" IS NULL THEN -1 -- SKU is not known FROM Source
            ELSE items."item_id" -- Use item_id FROM Dim based on SKU
         END AS "item_id"

        ,CASE
            WHEN sales."Store" IS NULL THEN -2
            WHEN stores."store_key" IS NULL THEN -1
            ELSE stores."store_key"
         END AS "store_key"

        ,CASE
            WHEN sales."Customer Number" IS NULL THEN -2
            WHEN customers."customer_id" IS NULL THEN -1
            ELSE customers."customer_id"
         END AS "customer_id"

        -- Metrics
        ,sales."Qty"
        ,sales."Unit Price"
        ,sales."Sales Amount"
        ,sales."Unit Cost"
        ,sales."Cost"
        ,sales."Margin"
    FROM sales
    LEFT JOIN items ON items."SKU" = sales."SKU"
    LEFT JOIN stores ON stores."Store" = sales."Store" AND sales."date_id" >= stores."valid_from" AND sales."date_id" < stores."valid_to"
    LEFT JOIN customers ON customers."Customer Number" = sales."Customer Number"
)

SELECT * FROM final
    )
;
[0m15:13:36.867990 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:13:39.675431 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.807 seconds
[0m15:13:39.697422 [debug] [Thread-1 (]: Applying DROP to: EPICALDEMO.broman_analytics.fact_sales_transactions_incremental__dbt_tmp
[0m15:13:39.705440 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m15:13:39.706440 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
drop view if exists EPICALDEMO.broman_analytics.fact_sales_transactions_incremental__dbt_tmp cascade
[0m15:13:39.838214 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.131 seconds
[0m15:13:39.878639 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c0366d2-36a8-474d-b431-1cb54c00de3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C35AB7850>]}
[0m15:13:39.880640 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model broman_analytics.fact_sales_transactions_incremental  [[32mSUCCESS 1[0m in 3.08s]
[0m15:13:39.882146 [debug] [Thread-1 (]: Finished running node model.epicaldemo.fact_sales_transactions_incremental
[0m15:13:39.884169 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:13:39.885179 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m15:13:39.886190 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m15:13:40.119193 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m15:13:40.120199 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m15:13:40.340613 [debug] [MainThread]: Connection 'model.epicaldemo.fact_sales_transactions_incremental' was left open.
[0m15:13:40.340613 [debug] [MainThread]: On model.epicaldemo.fact_sales_transactions_incremental: Close
[0m15:13:40.565256 [info ] [MainThread]: 
[0m15:13:40.567281 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 9.44 seconds (9.44s).
[0m15:13:40.571270 [debug] [MainThread]: Command end result
[0m15:13:40.608542 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m15:13:40.612533 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m15:13:40.619108 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m15:13:40.619108 [info ] [MainThread]: 
[0m15:13:40.620120 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:13:40.621123 [info ] [MainThread]: 
[0m15:13:40.621123 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:13:40.623666 [debug] [MainThread]: Command `dbt run` succeeded at 15:13:40.623666 after 14.04 seconds
[0m15:13:40.624657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C2E861250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C2E812E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C2E812210>]}
[0m15:13:40.624657 [debug] [MainThread]: Flushing usage events
[0m15:13:41.274098 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:23:10.052950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231C6273F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231C6271DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231C6272010>]}


============================== 15:23:10.056958 | cecfc242-754f-4ae6-b984-eafef2578e8c ==============================
[0m15:23:10.056958 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:23:10.057958 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -s fact_sales_transactions_incremental', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:23:10.493727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cecfc242-754f-4ae6-b984-eafef2578e8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231C741BF50>]}
[0m15:23:10.534401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cecfc242-754f-4ae6-b984-eafef2578e8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231C749B390>]}
[0m15:23:10.536396 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m15:23:10.832326 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:23:11.037581 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:23:11.038583 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:23:11.044114 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m15:23:11.082169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cecfc242-754f-4ae6-b984-eafef2578e8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231C7CB3350>]}
[0m15:23:11.163471 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m15:23:11.167474 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m15:23:11.190092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cecfc242-754f-4ae6-b984-eafef2578e8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231C79FEAD0>]}
[0m15:23:11.191100 [info ] [MainThread]: Found 14 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m15:23:11.192105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cecfc242-754f-4ae6-b984-eafef2578e8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231C79B9650>]}
[0m15:23:11.194103 [info ] [MainThread]: 
[0m15:23:11.194103 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:23:11.195102 [info ] [MainThread]: 
[0m15:23:11.195102 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:23:11.197103 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m15:23:11.281442 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m15:23:11.281442 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m15:23:11.282442 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:12.265818 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.983 seconds
[0m15:23:12.272995 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m15:23:12.281494 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m15:23:12.282498 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m15:23:12.282498 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:13.048888 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.767 seconds
[0m15:23:13.053436 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m15:23:13.054427 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m15:23:13.242663 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.188 seconds
[0m15:23:13.246655 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m15:23:13.246655 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m15:23:13.388915 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.141 seconds
[0m15:23:13.392482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cecfc242-754f-4ae6-b984-eafef2578e8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231C7DFC590>]}
[0m15:23:13.397483 [debug] [Thread-1 (]: Began running node model.epicaldemo.fact_sales_transactions_incremental
[0m15:23:13.398495 [info ] [Thread-1 (]: 1 of 1 START sql incremental model broman_analytics.fact_sales_transactions_incremental  [RUN]
[0m15:23:13.399493 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.fact_sales_transactions_incremental'
[0m15:23:13.400004 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.fact_sales_transactions_incremental
[0m15:23:13.411526 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.fact_sales_transactions_incremental"
[0m15:23:13.413547 [debug] [Thread-1 (]: Began executing node model.epicaldemo.fact_sales_transactions_incremental
[0m15:23:13.461687 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.fact_sales_transactions_incremental"
[0m15:23:13.464691 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m15:23:13.464691 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
create or replace transient table EPICALDEMO.broman_analytics.fact_sales_transactions_incremental
    

    
    as (

WITH

sales AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__transactions

    
),

items AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__items
),

stores AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__stores
),

customers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_salesforce__customers
),

final AS (
    SELECT
        -- Identifiers
        sales."ID"
        ,sales."date_id"
        ,sales."UPDATED_AT"
        ,CONVERT_TIMEZONE('Europe/Stockholm', CURRENT_TIMESTAMP()) AS "LOADED_AT"

        ,CASE
            WHEN sales."SKU" IS NULL THEN -2 -- SKU is missing FROM Source
            WHEN items."item_id" IS NULL THEN -1 -- SKU is not known FROM Source
            ELSE items."item_id" -- Use item_id FROM Dim based on SKU
         END AS "item_id"

        ,CASE
            WHEN sales."Store" IS NULL THEN -2
            WHEN stores."store_key" IS NULL THEN -1
            ELSE stores."store_key"
         END AS "store_key"

        ,CASE
            WHEN sales."Customer Number" IS NULL THEN -2
            WHEN customers."customer_id" IS NULL THEN -1
            ELSE customers."customer_id"
         END AS "customer_id"

        -- Metrics
        ,sales."Qty"
        ,sales."Unit Price"
        ,sales."Sales Amount"
        ,sales."Unit Cost"
        ,sales."Cost"
        ,sales."Margin"
    FROM sales
    LEFT JOIN items ON items."SKU" = sales."SKU"
    LEFT JOIN stores ON stores."Store" = sales."Store" AND sales."date_id" >= stores."valid_from" AND sales."date_id" < stores."valid_to"
    LEFT JOIN customers ON customers."Customer Number" = sales."Customer Number"
)

SELECT * FROM final
    )
;
[0m15:23:13.465694 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:23:14.446423 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bd00a3-0004-ce6d-0000-d2e9000305b2
[0m15:23:14.447407 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 38 at position 8
invalid identifier 'SALES.ID'
[0m15:23:14.449875 [debug] [Thread-1 (]: Database Error in model fact_sales_transactions_incremental (models\mart\facts\fact_sales_transactions_incremental.sql)
  000904 (42000): SQL compilation error: error line 38 at position 8
  invalid identifier 'SALES.ID'
  compiled code at target\run\epicaldemo\models\mart\facts\fact_sales_transactions_incremental.sql
[0m15:23:14.451891 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cecfc242-754f-4ae6-b984-eafef2578e8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231C7513150>]}
[0m15:23:14.452893 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model broman_analytics.fact_sales_transactions_incremental  [[31mERROR[0m in 1.05s]
[0m15:23:14.453882 [debug] [Thread-1 (]: Finished running node model.epicaldemo.fact_sales_transactions_incremental
[0m15:23:14.454884 [debug] [Thread-7 (]: Marking all children of 'model.epicaldemo.fact_sales_transactions_incremental' to be skipped because of status 'error'.  Reason: Database Error in model fact_sales_transactions_incremental (models\mart\facts\fact_sales_transactions_incremental.sql)
  000904 (42000): SQL compilation error: error line 38 at position 8
  invalid identifier 'SALES.ID'
  compiled code at target\run\epicaldemo\models\mart\facts\fact_sales_transactions_incremental.sql.
[0m15:23:14.456883 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:23:14.456883 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m15:23:14.457891 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m15:23:14.676627 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m15:23:14.677624 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m15:23:14.908489 [debug] [MainThread]: Connection 'model.epicaldemo.fact_sales_transactions_incremental' was left open.
[0m15:23:14.908489 [debug] [MainThread]: On model.epicaldemo.fact_sales_transactions_incremental: Close
[0m15:23:15.140405 [info ] [MainThread]: 
[0m15:23:15.140405 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 3.94 seconds (3.94s).
[0m15:23:15.142393 [debug] [MainThread]: Command end result
[0m15:23:15.163468 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m15:23:15.166470 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m15:23:15.174019 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m15:23:15.174019 [info ] [MainThread]: 
[0m15:23:15.176008 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:23:15.176008 [info ] [MainThread]: 
[0m15:23:15.177012 [error] [MainThread]:   Database Error in model fact_sales_transactions_incremental (models\mart\facts\fact_sales_transactions_incremental.sql)
  000904 (42000): SQL compilation error: error line 38 at position 8
  invalid identifier 'SALES.ID'
  compiled code at target\run\epicaldemo\models\mart\facts\fact_sales_transactions_incremental.sql
[0m15:23:15.178014 [info ] [MainThread]: 
[0m15:23:15.178014 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:23:15.179575 [debug] [MainThread]: Command `dbt run` failed at 15:23:15.179575 after 5.19 seconds
[0m15:23:15.180528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231C5EB5250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231C0672E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231C62C5C50>]}
[0m15:23:15.180528 [debug] [MainThread]: Flushing usage events
[0m15:23:15.820714 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:33:20.711312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000167C20B4D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000167C2470690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000167C2472D90>]}


============================== 15:33:20.723833 | 5d977d5b-a15d-451e-a38a-5adc403a783d ==============================
[0m15:33:20.723833 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:33:20.724833 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -s stg_d365_fo__transactions', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:33:23.625838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d977d5b-a15d-451e-a38a-5adc403a783d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000167C36FFD90>]}
[0m15:33:23.676118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d977d5b-a15d-451e-a38a-5adc403a783d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000167C37A6790>]}
[0m15:33:23.685350 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m15:33:24.093369 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:33:24.272203 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:33:24.273203 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:33:24.278218 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m15:33:24.312757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d977d5b-a15d-451e-a38a-5adc403a783d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000167C3EE8D10>]}
[0m15:33:24.383835 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m15:33:24.399898 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m15:33:24.638164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d977d5b-a15d-451e-a38a-5adc403a783d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000167C00DA110>]}
[0m15:33:24.639050 [info ] [MainThread]: Found 14 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m15:33:24.640120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d977d5b-a15d-451e-a38a-5adc403a783d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000167C3EF5F10>]}
[0m15:33:24.642059 [info ] [MainThread]: 
[0m15:33:24.643047 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:33:24.643047 [info ] [MainThread]: 
[0m15:33:24.644064 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:33:24.645043 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m15:33:26.922982 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m15:33:26.923982 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m15:33:26.923982 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:33:27.969812 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.046 seconds
[0m15:33:27.974803 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m15:33:27.983833 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m15:33:27.983833 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m15:33:27.984832 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:33:28.784235 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.800 seconds
[0m15:33:28.788745 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m15:33:28.789750 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m15:33:29.192409 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.402 seconds
[0m15:33:29.194409 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m15:33:29.195409 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m15:33:29.544198 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.348 seconds
[0m15:33:29.549840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d977d5b-a15d-451e-a38a-5adc403a783d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000167C20B4D10>]}
[0m15:33:29.554782 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__transactions
[0m15:33:29.555782 [info ] [Thread-1 (]: 1 of 1 START sql view model broman_analytics.stg_d365_fo__transactions ......... [RUN]
[0m15:33:29.556773 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__transactions'
[0m15:33:29.558193 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__transactions
[0m15:33:29.564190 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__transactions"
[0m15:33:29.565181 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__transactions
[0m15:33:29.589915 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__transactions"
[0m15:33:29.592911 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__transactions"
[0m15:33:29.593906 [debug] [Thread-1 (]: On model.epicaldemo.stg_d365_fo__transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__transactions"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__transactions
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.transactions
),

final AS (
    SELECT
        -- Identifiers
        ,id
        updated_at
        ,CAST(TO_CHAR(transaction_date::DATE, 'YYYYMMDD') AS INTEGER) AS "date_id"
        ,sku AS "SKU"
        ,store AS "Store"
        ,customernumber AS "Customer Number"

        -- Metrics
        ,quantity AS "Qty"
        ,unitprice::NUMERIC(10,2) AS "Unit Price"
        ,(quantity * unitprice)::NUMERIC(10,2) AS "Sales Amount"
        ,unitcost::NUMERIC(10,2) AS "Unit Cost"
        ,(quantity * unitcost)::NUMERIC(10,2) AS "Cost"
        ,(quantity * unitprice)::NUMERIC(10,2) - (quantity * unitcost)::NUMERIC(10,2) AS "Margin"
    FROM source
)

SELECT * FROM final
  );
[0m15:33:29.594906 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:33:30.389594 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bd00ad-0004-ce9e-0000-d2e90002d626
[0m15:33:30.390594 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 15 at position 8 unexpected ','.
syntax error line 16 at position 8 unexpected 'updated_at'.
syntax error line 17 at position 21 unexpected '('.
syntax error line 17 at position 44 unexpected ','.
syntax error line 17 at position 46 unexpected ''YYYYMMDD''.
syntax error line 17 at position 68 unexpected ')'.
syntax error line 17 at position 70 unexpected 'AS'.
[0m15:33:30.394595 [debug] [Thread-1 (]: Database Error in model stg_d365_fo__transactions (models\staging\d365_fo\stg_d365_fo__transactions.sql)
  001003 (42000): SQL compilation error:
  syntax error line 15 at position 8 unexpected ','.
  syntax error line 16 at position 8 unexpected 'updated_at'.
  syntax error line 17 at position 21 unexpected '('.
  syntax error line 17 at position 44 unexpected ','.
  syntax error line 17 at position 46 unexpected ''YYYYMMDD''.
  syntax error line 17 at position 68 unexpected ')'.
  syntax error line 17 at position 70 unexpected 'AS'.
  compiled code at target\run\epicaldemo\models\staging\d365_fo\stg_d365_fo__transactions.sql
[0m15:33:30.403135 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d977d5b-a15d-451e-a38a-5adc403a783d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000167C4527E50>]}
[0m15:33:30.404124 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model broman_analytics.stg_d365_fo__transactions  [[31mERROR[0m in 0.84s]
[0m15:33:30.405126 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__transactions
[0m15:33:30.406638 [debug] [Thread-7 (]: Marking all children of 'model.epicaldemo.stg_d365_fo__transactions' to be skipped because of status 'error'.  Reason: Database Error in model stg_d365_fo__transactions (models\staging\d365_fo\stg_d365_fo__transactions.sql)
  001003 (42000): SQL compilation error:
  syntax error line 15 at position 8 unexpected ','.
  syntax error line 16 at position 8 unexpected 'updated_at'.
  syntax error line 17 at position 21 unexpected '('.
  syntax error line 17 at position 44 unexpected ','.
  syntax error line 17 at position 46 unexpected ''YYYYMMDD''.
  syntax error line 17 at position 68 unexpected ')'.
  syntax error line 17 at position 70 unexpected 'AS'.
  compiled code at target\run\epicaldemo\models\staging\d365_fo\stg_d365_fo__transactions.sql.
[0m15:33:30.408657 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:33:30.409643 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m15:33:30.409643 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m15:33:30.668588 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m15:33:30.669584 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m15:33:30.886849 [debug] [MainThread]: Connection 'model.epicaldemo.stg_d365_fo__transactions' was left open.
[0m15:33:30.888306 [debug] [MainThread]: On model.epicaldemo.stg_d365_fo__transactions: Close
[0m15:33:31.119183 [info ] [MainThread]: 
[0m15:33:31.119675 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.48 seconds (6.48s).
[0m15:33:31.120689 [debug] [MainThread]: Command end result
[0m15:33:31.141870 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m15:33:31.145892 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m15:33:31.151390 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m15:33:31.152384 [info ] [MainThread]: 
[0m15:33:31.153385 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:33:31.154386 [info ] [MainThread]: 
[0m15:33:31.154386 [error] [MainThread]:   Database Error in model stg_d365_fo__transactions (models\staging\d365_fo\stg_d365_fo__transactions.sql)
  001003 (42000): SQL compilation error:
  syntax error line 15 at position 8 unexpected ','.
  syntax error line 16 at position 8 unexpected 'updated_at'.
  syntax error line 17 at position 21 unexpected '('.
  syntax error line 17 at position 44 unexpected ','.
  syntax error line 17 at position 46 unexpected ''YYYYMMDD''.
  syntax error line 17 at position 68 unexpected ')'.
  syntax error line 17 at position 70 unexpected 'AS'.
  compiled code at target\run\epicaldemo\models\staging\d365_fo\stg_d365_fo__transactions.sql
[0m15:33:31.155382 [info ] [MainThread]: 
[0m15:33:31.155382 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:33:31.157894 [debug] [MainThread]: Command `dbt run` failed at 15:33:31.157894 after 10.51 seconds
[0m15:33:31.158900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000167BC872E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000167C24C6050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000167C2478B50>]}
[0m15:33:31.158900 [debug] [MainThread]: Flushing usage events
[0m15:33:31.874116 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:33:43.409808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2C2679790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2C2671FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2C26714D0>]}


============================== 15:33:43.412810 | 1e7b237f-1538-4208-9277-713afee99684 ==============================
[0m15:33:43.412810 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:33:43.413808 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -s stg_d365_fo__transactions', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:33:43.800958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e7b237f-1538-4208-9277-713afee99684', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2C3968E10>]}
[0m15:33:43.841104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e7b237f-1538-4208-9277-713afee99684', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2C39AE790>]}
[0m15:33:43.842109 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m15:33:44.152738 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:33:44.344768 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:33:44.344768 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:33:44.350284 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m15:33:44.385874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e7b237f-1538-4208-9277-713afee99684', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2C40E9150>]}
[0m15:33:44.455696 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m15:33:44.460218 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m15:33:44.479289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e7b237f-1538-4208-9277-713afee99684', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2C38E1BD0>]}
[0m15:33:44.479289 [info ] [MainThread]: Found 14 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m15:33:44.480304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e7b237f-1538-4208-9277-713afee99684', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2C3858D10>]}
[0m15:33:44.481310 [info ] [MainThread]: 
[0m15:33:44.482301 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:33:44.482301 [info ] [MainThread]: 
[0m15:33:44.483288 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:33:44.484289 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m15:33:44.560855 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m15:33:44.560855 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m15:33:44.561858 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:33:45.503501 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.942 seconds
[0m15:33:45.508986 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m15:33:45.517513 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m15:33:45.518529 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m15:33:45.518529 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:33:46.354655 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.836 seconds
[0m15:33:46.358161 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m15:33:46.359166 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m15:33:46.525178 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.167 seconds
[0m15:33:46.527709 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m15:33:46.528730 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m15:33:46.671966 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.142 seconds
[0m15:33:46.674960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e7b237f-1538-4208-9277-713afee99684', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2C4204CD0>]}
[0m15:33:46.679468 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__transactions
[0m15:33:46.680479 [info ] [Thread-1 (]: 1 of 1 START sql view model broman_analytics.stg_d365_fo__transactions ......... [RUN]
[0m15:33:46.681468 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__transactions'
[0m15:33:46.682485 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__transactions
[0m15:33:46.688007 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__transactions"
[0m15:33:46.690008 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__transactions
[0m15:33:46.713612 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__transactions"
[0m15:33:46.715604 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__transactions"
[0m15:33:46.716605 [debug] [Thread-1 (]: On model.epicaldemo.stg_d365_fo__transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__transactions"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__transactions
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.transactions
),

final AS (
    SELECT
        -- Identifiers
        id
        ,updated_at
        ,CAST(TO_CHAR(transaction_date::DATE, 'YYYYMMDD') AS INTEGER) AS "date_id"
        ,sku AS "SKU"
        ,store AS "Store"
        ,customernumber AS "Customer Number"

        -- Metrics
        ,quantity AS "Qty"
        ,unitprice::NUMERIC(10,2) AS "Unit Price"
        ,(quantity * unitprice)::NUMERIC(10,2) AS "Sales Amount"
        ,unitcost::NUMERIC(10,2) AS "Unit Cost"
        ,(quantity * unitcost)::NUMERIC(10,2) AS "Cost"
        ,(quantity * unitprice)::NUMERIC(10,2) - (quantity * unitcost)::NUMERIC(10,2) AS "Margin"
    FROM source
)

SELECT * FROM final
  );
[0m15:33:46.717122 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:33:47.851280 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.133 seconds
[0m15:33:47.869341 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e7b237f-1538-4208-9277-713afee99684', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2C3D73210>]}
[0m15:33:47.870335 [info ] [Thread-1 (]: 1 of 1 OK created sql view model broman_analytics.stg_d365_fo__transactions .... [[32mSUCCESS 1[0m in 1.19s]
[0m15:33:47.871333 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__transactions
[0m15:33:47.873332 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:33:47.873332 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m15:33:47.874343 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m15:33:48.099353 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m15:33:48.100351 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m15:33:48.384675 [debug] [MainThread]: Connection 'model.epicaldemo.stg_d365_fo__transactions' was left open.
[0m15:33:48.384675 [debug] [MainThread]: On model.epicaldemo.stg_d365_fo__transactions: Close
[0m15:33:48.836716 [info ] [MainThread]: 
[0m15:33:48.837743 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.35 seconds (4.35s).
[0m15:33:48.837743 [debug] [MainThread]: Command end result
[0m15:33:48.859803 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m15:33:48.863804 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m15:33:48.869340 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m15:33:48.869340 [info ] [MainThread]: 
[0m15:33:48.870352 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:33:48.871344 [info ] [MainThread]: 
[0m15:33:48.871344 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:33:48.872348 [debug] [MainThread]: Command `dbt run` succeeded at 15:33:48.872348 after 5.52 seconds
[0m15:33:48.873344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2C22B4E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2BCAC1250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2BCA72E10>]}
[0m15:33:48.873344 [debug] [MainThread]: Flushing usage events
[0m15:33:49.527616 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:33:53.371818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248F6C79890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248F6C726D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248F6C72650>]}


============================== 15:33:53.385308 | 6f361a5f-d021-4bfe-96c2-d77e03977bd7 ==============================
[0m15:33:53.385308 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:33:53.386813 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -s fact_sales_transactions_incremental', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:33:53.772849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f361a5f-d021-4bfe-96c2-d77e03977bd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248F7E30290>]}
[0m15:33:53.811966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6f361a5f-d021-4bfe-96c2-d77e03977bd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248F7E31750>]}
[0m15:33:53.812958 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m15:33:54.120199 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:33:54.308142 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:33:54.309157 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:33:54.314150 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m15:33:54.349280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f361a5f-d021-4bfe-96c2-d77e03977bd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248F8614110>]}
[0m15:33:54.420530 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m15:33:54.424521 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m15:33:54.443541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f361a5f-d021-4bfe-96c2-d77e03977bd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248F88044D0>]}
[0m15:33:54.444539 [info ] [MainThread]: Found 14 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m15:33:54.445555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f361a5f-d021-4bfe-96c2-d77e03977bd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248F86B3690>]}
[0m15:33:54.447043 [info ] [MainThread]: 
[0m15:33:54.448076 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:33:54.448076 [info ] [MainThread]: 
[0m15:33:54.449049 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:33:54.450048 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m15:33:54.524270 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m15:33:54.524270 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m15:33:54.525261 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:33:55.297708 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.773 seconds
[0m15:33:55.303330 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m15:33:55.312792 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m15:33:55.312792 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m15:33:55.313783 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:33:56.361481 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.048 seconds
[0m15:33:56.367077 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m15:33:56.367981 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m15:33:56.537674 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.169 seconds
[0m15:33:56.539726 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m15:33:56.539726 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m15:33:56.686941 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.145 seconds
[0m15:33:56.689742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f361a5f-d021-4bfe-96c2-d77e03977bd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248F882BB10>]}
[0m15:33:56.694741 [debug] [Thread-1 (]: Began running node model.epicaldemo.fact_sales_transactions_incremental
[0m15:33:56.695751 [info ] [Thread-1 (]: 1 of 1 START sql incremental model broman_analytics.fact_sales_transactions_incremental  [RUN]
[0m15:33:56.696745 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.fact_sales_transactions_incremental'
[0m15:33:56.696745 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.fact_sales_transactions_incremental
[0m15:33:56.707863 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.fact_sales_transactions_incremental"
[0m15:33:56.708872 [debug] [Thread-1 (]: Began executing node model.epicaldemo.fact_sales_transactions_incremental
[0m15:33:56.758528 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.fact_sales_transactions_incremental"
[0m15:33:56.762537 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m15:33:56.763529 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
create or replace transient table EPICALDEMO.broman_analytics.fact_sales_transactions_incremental
    

    
    as (

WITH

sales AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__transactions

    
),

items AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__items
),

stores AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__stores
),

customers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_salesforce__customers
),

final AS (
    SELECT
        -- Identifiers
        sales."ID"
        ,sales."date_id"
        ,sales."UPDATED_AT"
        ,CONVERT_TIMEZONE('Europe/Stockholm', CURRENT_TIMESTAMP()) AS "LOADED_AT"

        ,CASE
            WHEN sales."SKU" IS NULL THEN -2 -- SKU is missing FROM Source
            WHEN items."item_id" IS NULL THEN -1 -- SKU is not known FROM Source
            ELSE items."item_id" -- Use item_id FROM Dim based on SKU
         END AS "item_id"

        ,CASE
            WHEN sales."Store" IS NULL THEN -2
            WHEN stores."store_key" IS NULL THEN -1
            ELSE stores."store_key"
         END AS "store_key"

        ,CASE
            WHEN sales."Customer Number" IS NULL THEN -2
            WHEN customers."customer_id" IS NULL THEN -1
            ELSE customers."customer_id"
         END AS "customer_id"

        -- Metrics
        ,sales."Qty"
        ,sales."Unit Price"
        ,sales."Sales Amount"
        ,sales."Unit Cost"
        ,sales."Cost"
        ,sales."Margin"
    FROM sales
    LEFT JOIN items ON items."SKU" = sales."SKU"
    LEFT JOIN stores ON stores."Store" = sales."Store" AND sales."date_id" >= stores."valid_from" AND sales."date_id" < stores."valid_to"
    LEFT JOIN customers ON customers."Customer Number" = sales."Customer Number"
)

SELECT * FROM final
    )
;
[0m15:33:56.763529 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:33:59.489555 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.726 seconds
[0m15:33:59.495589 [debug] [Thread-1 (]: Applying DROP to: EPICALDEMO.broman_analytics.fact_sales_transactions_incremental__dbt_tmp
[0m15:33:59.501103 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m15:33:59.502101 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
drop view if exists EPICALDEMO.broman_analytics.fact_sales_transactions_incremental__dbt_tmp cascade
[0m15:33:59.648111 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.145 seconds
[0m15:33:59.663620 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f361a5f-d021-4bfe-96c2-d77e03977bd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248F7EAADD0>]}
[0m15:33:59.664613 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model broman_analytics.fact_sales_transactions_incremental  [[32mSUCCESS 1[0m in 2.97s]
[0m15:33:59.665615 [debug] [Thread-1 (]: Finished running node model.epicaldemo.fact_sales_transactions_incremental
[0m15:33:59.666619 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:33:59.668092 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m15:33:59.668092 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m15:33:59.883250 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m15:33:59.884240 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m15:34:00.087937 [debug] [MainThread]: Connection 'model.epicaldemo.fact_sales_transactions_incremental' was left open.
[0m15:34:00.089920 [debug] [MainThread]: On model.epicaldemo.fact_sales_transactions_incremental: Close
[0m15:34:00.317191 [info ] [MainThread]: 
[0m15:34:00.318266 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 5.87 seconds (5.87s).
[0m15:34:00.319212 [debug] [MainThread]: Command end result
[0m15:34:00.340274 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m15:34:00.343266 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m15:34:00.350791 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m15:34:00.350791 [info ] [MainThread]: 
[0m15:34:00.351808 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:34:00.352793 [info ] [MainThread]: 
[0m15:34:00.352793 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:34:00.354804 [debug] [MainThread]: Command `dbt run` succeeded at 15:34:00.353813 after 7.04 seconds
[0m15:34:00.354804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248F6C8FB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248F6CC4110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248F107CB10>]}
[0m15:34:00.355791 [debug] [MainThread]: Flushing usage events
[0m15:34:00.968560 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:36:33.568131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C9E472C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C9E471E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C9E471110>]}


============================== 15:36:33.572477 | 1c219713-2c7d-4905-ae9c-e71aa1c7a715 ==============================
[0m15:36:33.572477 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:36:33.573492 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -s fact_sales_transactions_incremental', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:36:33.973883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c219713-2c7d-4905-ae9c-e71aa1c7a715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C9E47F490>]}
[0m15:36:34.013941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1c219713-2c7d-4905-ae9c-e71aa1c7a715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C9CE4FB10>]}
[0m15:36:34.014941 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m15:36:34.310214 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:36:34.496945 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:36:34.496945 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:36:34.501949 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m15:36:34.538021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c219713-2c7d-4905-ae9c-e71aa1c7a715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C9F6C2850>]}
[0m15:36:34.611110 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m15:36:34.615112 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m15:36:34.636643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c219713-2c7d-4905-ae9c-e71aa1c7a715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017CA0004190>]}
[0m15:36:34.637647 [info ] [MainThread]: Found 14 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m15:36:34.638649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c219713-2c7d-4905-ae9c-e71aa1c7a715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C9FECFF90>]}
[0m15:36:34.640648 [info ] [MainThread]: 
[0m15:36:34.640648 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:36:34.641648 [info ] [MainThread]: 
[0m15:36:34.642648 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:36:34.643649 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m15:36:34.716258 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m15:36:34.716258 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m15:36:34.717268 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:36:35.672917 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.955 seconds
[0m15:36:35.677421 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m15:36:35.687433 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m15:36:35.688436 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m15:36:35.688436 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:36:36.310086 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.621 seconds
[0m15:36:36.314081 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m15:36:36.314081 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m15:36:36.516136 [debug] [ThreadPool]: SQL status: SUCCESS 15 in 0.201 seconds
[0m15:36:36.518065 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m15:36:36.518065 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m15:36:36.649872 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.130 seconds
[0m15:36:36.654873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c219713-2c7d-4905-ae9c-e71aa1c7a715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017CA0271890>]}
[0m15:36:36.661137 [debug] [Thread-1 (]: Began running node model.epicaldemo.fact_sales_transactions_incremental
[0m15:36:36.662139 [info ] [Thread-1 (]: 1 of 1 START sql incremental model broman_analytics.fact_sales_transactions_incremental  [RUN]
[0m15:36:36.663133 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.fact_sales_transactions_incremental'
[0m15:36:36.664499 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.fact_sales_transactions_incremental
[0m15:36:36.684709 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.fact_sales_transactions_incremental"
[0m15:36:36.687224 [debug] [Thread-1 (]: Began executing node model.epicaldemo.fact_sales_transactions_incremental
[0m15:36:36.736213 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m15:36:36.737317 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
create or replace  temporary view EPICALDEMO.broman_analytics.fact_sales_transactions_incremental__dbt_tmp
  
   as (
    

WITH

sales AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__transactions

    
    WHERE UPDATED_AT >= (SELECT MAX(UPDATED_AT) FROM EPICALDEMO.broman_analytics.fact_sales_transactions_incremental)
    
),

items AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__items
),

stores AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__stores
),

customers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_salesforce__customers
),

final AS (
    SELECT
        -- Identifiers
        sales."ID"
        ,sales."date_id"
        ,sales."UPDATED_AT"
        ,CONVERT_TIMEZONE('Europe/Stockholm', CURRENT_TIMESTAMP()) AS "LOADED_AT"

        ,CASE
            WHEN sales."SKU" IS NULL THEN -2 -- SKU is missing FROM Source
            WHEN items."item_id" IS NULL THEN -1 -- SKU is not known FROM Source
            ELSE items."item_id" -- Use item_id FROM Dim based on SKU
         END AS "item_id"

        ,CASE
            WHEN sales."Store" IS NULL THEN -2
            WHEN stores."store_key" IS NULL THEN -1
            ELSE stores."store_key"
         END AS "store_key"

        ,CASE
            WHEN sales."Customer Number" IS NULL THEN -2
            WHEN customers."customer_id" IS NULL THEN -1
            ELSE customers."customer_id"
         END AS "customer_id"

        -- Metrics
        ,sales."Qty"
        ,sales."Unit Price"
        ,sales."Sales Amount"
        ,sales."Unit Cost"
        ,sales."Cost"
        ,sales."Margin"
    FROM sales
    LEFT JOIN items ON items."SKU" = sales."SKU"
    LEFT JOIN stores ON stores."Store" = sales."Store" AND sales."date_id" >= stores."valid_from" AND sales."date_id" < stores."valid_to"
    LEFT JOIN customers ON customers."Customer Number" = sales."Customer Number"
)

SELECT * FROM final
  );
[0m15:36:36.738329 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:36:37.875861 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.138 seconds
[0m15:36:37.883400 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m15:36:37.883400 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
describe table EPICALDEMO.broman_analytics.fact_sales_transactions_incremental__dbt_tmp
[0m15:36:38.050920 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.166 seconds
[0m15:36:38.054919 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m15:36:38.054919 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
describe table EPICALDEMO.broman_analytics.fact_sales_transactions_incremental
[0m15:36:38.197400 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.141 seconds
[0m15:36:38.206941 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m15:36:38.206941 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."FACT_SALES_TRANSACTIONS_INCREMENTAL"
[0m15:36:38.358185 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.149 seconds
[0m15:36:38.382779 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.fact_sales_transactions_incremental"
[0m15:36:38.384771 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m15:36:38.384771 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
-- back compat for old kwarg name
  
  begin;
[0m15:36:38.540190 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.154 seconds
[0m15:36:38.541190 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m15:36:38.542189 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
merge into EPICALDEMO.broman_analytics.fact_sales_transactions_incremental as DBT_INTERNAL_DEST
        using EPICALDEMO.broman_analytics.fact_sales_transactions_incremental__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.date_id = DBT_INTERNAL_DEST.date_id
                ) and (
                    DBT_INTERNAL_SOURCE.item_id = DBT_INTERNAL_DEST.item_id
                ) and (
                    DBT_INTERNAL_SOURCE.store_key = DBT_INTERNAL_DEST.store_key
                ) and (
                    DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
                )

    
    when matched then update set
        "ID" = DBT_INTERNAL_SOURCE."ID","date_id" = DBT_INTERNAL_SOURCE."date_id","UPDATED_AT" = DBT_INTERNAL_SOURCE."UPDATED_AT","LOADED_AT" = DBT_INTERNAL_SOURCE."LOADED_AT","item_id" = DBT_INTERNAL_SOURCE."item_id","store_key" = DBT_INTERNAL_SOURCE."store_key","customer_id" = DBT_INTERNAL_SOURCE."customer_id","Qty" = DBT_INTERNAL_SOURCE."Qty","Unit Price" = DBT_INTERNAL_SOURCE."Unit Price","Sales Amount" = DBT_INTERNAL_SOURCE."Sales Amount","Unit Cost" = DBT_INTERNAL_SOURCE."Unit Cost","Cost" = DBT_INTERNAL_SOURCE."Cost","Margin" = DBT_INTERNAL_SOURCE."Margin"
    

    when not matched then insert
        ("ID", "date_id", "UPDATED_AT", "LOADED_AT", "item_id", "store_key", "customer_id", "Qty", "Unit Price", "Sales Amount", "Unit Cost", "Cost", "Margin")
    values
        ("ID", "date_id", "UPDATED_AT", "LOADED_AT", "item_id", "store_key", "customer_id", "Qty", "Unit Price", "Sales Amount", "Unit Cost", "Cost", "Margin")

;
[0m15:36:38.887323 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bd00b0-0004-ce6d-0000-d2e900030632
[0m15:36:38.887323 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 4 at position 20
invalid identifier 'DBT_INTERNAL_SOURCE.DATE_ID'
[0m15:36:38.891242 [debug] [Thread-1 (]: Database Error in model fact_sales_transactions_incremental (models\mart\facts\fact_sales_transactions_incremental.sql)
  000904 (42000): SQL compilation error: error line 4 at position 20
  invalid identifier 'DBT_INTERNAL_SOURCE.DATE_ID'
  compiled code at target\run\epicaldemo\models\mart\facts\fact_sales_transactions_incremental.sql
[0m15:36:38.892240 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c219713-2c7d-4905-ae9c-e71aa1c7a715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C9F6CD390>]}
[0m15:36:38.893240 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model broman_analytics.fact_sales_transactions_incremental  [[31mERROR[0m in 2.23s]
[0m15:36:38.894241 [debug] [Thread-1 (]: Finished running node model.epicaldemo.fact_sales_transactions_incremental
[0m15:36:38.895744 [debug] [Thread-7 (]: Marking all children of 'model.epicaldemo.fact_sales_transactions_incremental' to be skipped because of status 'error'.  Reason: Database Error in model fact_sales_transactions_incremental (models\mart\facts\fact_sales_transactions_incremental.sql)
  000904 (42000): SQL compilation error: error line 4 at position 20
  invalid identifier 'DBT_INTERNAL_SOURCE.DATE_ID'
  compiled code at target\run\epicaldemo\models\mart\facts\fact_sales_transactions_incremental.sql.
[0m15:36:38.897769 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:36:38.898762 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m15:36:38.898762 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m15:36:39.102669 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m15:36:39.103677 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m15:36:39.338979 [debug] [MainThread]: Connection 'model.epicaldemo.fact_sales_transactions_incremental' was left open.
[0m15:36:39.339985 [debug] [MainThread]: On model.epicaldemo.fact_sales_transactions_incremental: Close
[0m15:36:39.593556 [info ] [MainThread]: 
[0m15:36:39.594561 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 4.95 seconds (4.95s).
[0m15:36:39.597089 [debug] [MainThread]: Command end result
[0m15:36:39.619106 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m15:36:39.622107 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m15:36:39.628704 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m15:36:39.628704 [info ] [MainThread]: 
[0m15:36:39.629704 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:36:39.630702 [info ] [MainThread]: 
[0m15:36:39.630702 [error] [MainThread]:   Database Error in model fact_sales_transactions_incremental (models\mart\facts\fact_sales_transactions_incremental.sql)
  000904 (42000): SQL compilation error: error line 4 at position 20
  invalid identifier 'DBT_INTERNAL_SOURCE.DATE_ID'
  compiled code at target\run\epicaldemo\models\mart\facts\fact_sales_transactions_incremental.sql
[0m15:36:39.631701 [info ] [MainThread]: 
[0m15:36:39.632703 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:36:39.633706 [debug] [MainThread]: Command `dbt run` failed at 15:36:39.633706 after 6.13 seconds
[0m15:36:39.634705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C9E4B5790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C98872E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C9E4C5CD0>]}
[0m15:36:39.634705 [debug] [MainThread]: Flushing usage events
[0m15:36:40.329133 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:42:40.096716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEF4270910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEF4271D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEF4271150>]}


============================== 15:42:40.110796 | 06c048b4-6b4b-4c80-b7d6-2ddb3149031c ==============================
[0m15:42:40.110796 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:42:40.111804 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s fact_sales_transactions_incremental', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:42:42.998286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06c048b4-6b4b-4c80-b7d6-2ddb3149031c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEF54C0F50>]}
[0m15:42:43.039937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '06c048b4-6b4b-4c80-b7d6-2ddb3149031c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEF54316D0>]}
[0m15:42:43.049482 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m15:42:43.430095 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:42:43.606708 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:42:43.606708 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:42:43.611706 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m15:42:43.647380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06c048b4-6b4b-4c80-b7d6-2ddb3149031c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEF55AC050>]}
[0m15:42:43.717079 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m15:42:43.732624 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m15:42:43.941952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06c048b4-6b4b-4c80-b7d6-2ddb3149031c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEF5C14710>]}
[0m15:42:43.942953 [info ] [MainThread]: Found 14 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m15:42:43.942953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06c048b4-6b4b-4c80-b7d6-2ddb3149031c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEF5D0F9D0>]}
[0m15:42:43.945671 [info ] [MainThread]: 
[0m15:42:43.946621 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:42:43.947355 [info ] [MainThread]: 
[0m15:42:43.947355 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:42:43.949362 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m15:42:46.473126 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m15:42:46.473126 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m15:42:46.474118 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:47.665018 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.192 seconds
[0m15:42:47.671034 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m15:42:47.679570 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m15:42:47.680570 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m15:42:47.680570 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:49.042686 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.363 seconds
[0m15:42:49.047477 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m15:42:49.048477 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m15:42:49.409666 [debug] [ThreadPool]: SQL status: SUCCESS 15 in 0.361 seconds
[0m15:42:49.411674 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m15:42:49.412666 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m15:42:49.545231 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.133 seconds
[0m15:42:49.549237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06c048b4-6b4b-4c80-b7d6-2ddb3149031c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEF54A9310>]}
[0m15:42:49.555308 [debug] [Thread-1 (]: Began running node model.epicaldemo.fact_sales_transactions_incremental
[0m15:42:49.555308 [info ] [Thread-1 (]: 1 of 1 START sql incremental model broman_analytics.fact_sales_transactions_incremental  [RUN]
[0m15:42:49.557330 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.fact_sales_transactions_incremental'
[0m15:42:49.557330 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.fact_sales_transactions_incremental
[0m15:42:49.571497 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.fact_sales_transactions_incremental"
[0m15:42:49.574001 [debug] [Thread-1 (]: Began executing node model.epicaldemo.fact_sales_transactions_incremental
[0m15:42:49.617617 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m15:42:49.618621 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
create or replace  temporary view EPICALDEMO.broman_analytics.fact_sales_transactions_incremental__dbt_tmp
  
   as (
    

WITH

sales AS (
    SELECT
        ID
        ,UPDATED_AT
        ,"date_id"
        ,SKU
        ,"Store"
        ,"Customer Number"
        ,"Qty"
        ,"Unit Price"
        ,"Sales Amount"
        ,"Unit Cost"
        ,"Cost"
        ,"Margin"
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__transactions

    
    WHERE UPDATED_AT >= (SELECT MAX(UPDATED_AT) FROM EPICALDEMO.broman_analytics.fact_sales_transactions_incremental)
    
),

items AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__items
),

stores AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__stores
),

customers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_salesforce__customers
),

final AS (
    SELECT
        -- Identifiers
        sales."ID"
        ,sales."date_id"
        ,sales."UPDATED_AT"
        ,CONVERT_TIMEZONE('Europe/Stockholm', CURRENT_TIMESTAMP()) AS "LOADED_AT"

        ,CASE
            WHEN sales."SKU" IS NULL THEN -2 -- SKU is missing FROM Source
            WHEN items."item_id" IS NULL THEN -1 -- SKU is not known FROM Source
            ELSE items."item_id" -- Use item_id FROM Dim based on SKU
         END AS "item_id"

        ,CASE
            WHEN sales."Store" IS NULL THEN -2
            WHEN stores."store_key" IS NULL THEN -1
            ELSE stores."store_key"
         END AS "store_key"

        ,CASE
            WHEN sales."Customer Number" IS NULL THEN -2
            WHEN customers."customer_id" IS NULL THEN -1
            ELSE customers."customer_id"
         END AS "customer_id"

        -- Metrics
        ,sales."Qty"
        ,sales."Unit Price"
        ,sales."Sales Amount"
        ,sales."Unit Cost"
        ,sales."Cost"
        ,sales."Margin"
    FROM sales
    LEFT JOIN items ON items."SKU" = sales."SKU"
    LEFT JOIN stores ON stores."Store" = sales."Store" AND sales."date_id" >= stores."valid_from" AND sales."date_id" < stores."valid_to"
    LEFT JOIN customers ON customers."Customer Number" = sales."Customer Number"
)

SELECT * FROM final
  );
[0m15:42:49.619618 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:42:50.875254 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.256 seconds
[0m15:42:50.881261 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m15:42:50.882261 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
describe table EPICALDEMO.broman_analytics.fact_sales_transactions_incremental__dbt_tmp
[0m15:42:51.638421 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.755 seconds
[0m15:42:51.642421 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m15:42:51.643926 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
describe table EPICALDEMO.broman_analytics.fact_sales_transactions_incremental
[0m15:42:51.797297 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.153 seconds
[0m15:42:51.803297 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m15:42:51.804355 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."FACT_SALES_TRANSACTIONS_INCREMENTAL"
[0m15:42:51.934371 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.129 seconds
[0m15:42:51.958097 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.fact_sales_transactions_incremental"
[0m15:42:51.960089 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m15:42:51.960089 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
-- back compat for old kwarg name
  
  begin;
[0m15:42:52.100493 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.139 seconds
[0m15:42:52.100493 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m15:42:52.101488 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
merge into EPICALDEMO.broman_analytics.fact_sales_transactions_incremental as DBT_INTERNAL_DEST
        using EPICALDEMO.broman_analytics.fact_sales_transactions_incremental__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.date_id = DBT_INTERNAL_DEST.date_id
                ) and (
                    DBT_INTERNAL_SOURCE.item_id = DBT_INTERNAL_DEST.item_id
                ) and (
                    DBT_INTERNAL_SOURCE.store_key = DBT_INTERNAL_DEST.store_key
                ) and (
                    DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
                )

    
    when matched then update set
        "ID" = DBT_INTERNAL_SOURCE."ID","date_id" = DBT_INTERNAL_SOURCE."date_id","UPDATED_AT" = DBT_INTERNAL_SOURCE."UPDATED_AT","LOADED_AT" = DBT_INTERNAL_SOURCE."LOADED_AT","item_id" = DBT_INTERNAL_SOURCE."item_id","store_key" = DBT_INTERNAL_SOURCE."store_key","customer_id" = DBT_INTERNAL_SOURCE."customer_id","Qty" = DBT_INTERNAL_SOURCE."Qty","Unit Price" = DBT_INTERNAL_SOURCE."Unit Price","Sales Amount" = DBT_INTERNAL_SOURCE."Sales Amount","Unit Cost" = DBT_INTERNAL_SOURCE."Unit Cost","Cost" = DBT_INTERNAL_SOURCE."Cost","Margin" = DBT_INTERNAL_SOURCE."Margin"
    

    when not matched then insert
        ("ID", "date_id", "UPDATED_AT", "LOADED_AT", "item_id", "store_key", "customer_id", "Qty", "Unit Price", "Sales Amount", "Unit Cost", "Cost", "Margin")
    values
        ("ID", "date_id", "UPDATED_AT", "LOADED_AT", "item_id", "store_key", "customer_id", "Qty", "Unit Price", "Sales Amount", "Unit Cost", "Cost", "Margin")

;
[0m15:42:52.544463 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bd00b6-0004-ce9e-0000-d2e90002d722
[0m15:42:52.545469 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 4 at position 20
invalid identifier 'DBT_INTERNAL_SOURCE.DATE_ID'
[0m15:42:52.548473 [debug] [Thread-1 (]: Database Error in model fact_sales_transactions_incremental (models\mart\facts\fact_sales_transactions_incremental.sql)
  000904 (42000): SQL compilation error: error line 4 at position 20
  invalid identifier 'DBT_INTERNAL_SOURCE.DATE_ID'
  compiled code at target\run\epicaldemo\models\mart\facts\fact_sales_transactions_incremental.sql
[0m15:42:52.556196 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06c048b4-6b4b-4c80-b7d6-2ddb3149031c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEF6337FD0>]}
[0m15:42:52.557139 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model broman_analytics.fact_sales_transactions_incremental  [[31mERROR[0m in 2.99s]
[0m15:42:52.558140 [debug] [Thread-1 (]: Finished running node model.epicaldemo.fact_sales_transactions_incremental
[0m15:42:52.559139 [debug] [Thread-7 (]: Marking all children of 'model.epicaldemo.fact_sales_transactions_incremental' to be skipped because of status 'error'.  Reason: Database Error in model fact_sales_transactions_incremental (models\mart\facts\fact_sales_transactions_incremental.sql)
  000904 (42000): SQL compilation error: error line 4 at position 20
  invalid identifier 'DBT_INTERNAL_SOURCE.DATE_ID'
  compiled code at target\run\epicaldemo\models\mart\facts\fact_sales_transactions_incremental.sql.
[0m15:42:52.561146 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:42:52.561146 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m15:42:52.562196 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m15:42:52.789016 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m15:42:52.791031 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m15:42:53.004456 [debug] [MainThread]: Connection 'model.epicaldemo.fact_sales_transactions_incremental' was left open.
[0m15:42:53.004456 [debug] [MainThread]: On model.epicaldemo.fact_sales_transactions_incremental: Close
[0m15:42:53.246699 [info ] [MainThread]: 
[0m15:42:53.246699 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 9.30 seconds (9.30s).
[0m15:42:53.247698 [debug] [MainThread]: Command end result
[0m15:42:53.271722 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m15:42:53.275239 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m15:42:53.282248 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m15:42:53.282248 [info ] [MainThread]: 
[0m15:42:53.283295 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:42:53.284239 [info ] [MainThread]: 
[0m15:42:53.284239 [error] [MainThread]:   Database Error in model fact_sales_transactions_incremental (models\mart\facts\fact_sales_transactions_incremental.sql)
  000904 (42000): SQL compilation error: error line 4 at position 20
  invalid identifier 'DBT_INTERNAL_SOURCE.DATE_ID'
  compiled code at target\run\epicaldemo\models\mart\facts\fact_sales_transactions_incremental.sql
[0m15:42:53.285398 [info ] [MainThread]: 
[0m15:42:53.286390 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:42:53.287387 [debug] [MainThread]: Command `dbt run` failed at 15:42:53.287387 after 13.27 seconds
[0m15:42:53.288388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEF42D5B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEEE672E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEEE672F50>]}
[0m15:42:53.288388 [debug] [MainThread]: Flushing usage events
[0m15:42:54.014355 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:34:19.379104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E2A47E210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E2A47D950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E2A4B6ED0>]}


============================== 16:34:19.391651 | 244ac315-2eb2-4b79-b40d-04c39559d611 ==============================
[0m16:34:19.391651 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:34:19.393642 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s stg_d365_fo__transactions', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:34:22.760181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '244ac315-2eb2-4b79-b40d-04c39559d611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E2A4B6F50>]}
[0m16:34:22.809786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '244ac315-2eb2-4b79-b40d-04c39559d611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E2B7A6790>]}
[0m16:34:22.823303 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m16:34:23.292485 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:34:23.496253 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:34:23.497252 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:34:23.502252 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m16:34:23.552910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '244ac315-2eb2-4b79-b40d-04c39559d611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E2BF0CD90>]}
[0m16:34:23.622150 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m16:34:23.639214 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m16:34:23.900494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '244ac315-2eb2-4b79-b40d-04c39559d611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E2B7A55D0>]}
[0m16:34:23.901492 [info ] [MainThread]: Found 14 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m16:34:23.902492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '244ac315-2eb2-4b79-b40d-04c39559d611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E2BBE2C10>]}
[0m16:34:23.903494 [info ] [MainThread]: 
[0m16:34:23.905111 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:34:23.907007 [info ] [MainThread]: 
[0m16:34:23.908013 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:34:23.911081 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m16:34:27.001123 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m16:34:27.002122 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m16:34:27.002122 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:34:28.578345 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.576 seconds
[0m16:34:28.585858 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m16:34:28.597403 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:34:28.597403 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:34:28.597403 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:34:29.487157 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.889 seconds
[0m16:34:29.499680 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:34:29.500689 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m16:34:30.206858 [debug] [ThreadPool]: SQL status: SUCCESS 15 in 0.705 seconds
[0m16:34:30.210924 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:34:30.212933 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:34:30.361631 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.147 seconds
[0m16:34:30.369288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '244ac315-2eb2-4b79-b40d-04c39559d611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E2B7457D0>]}
[0m16:34:30.383257 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__transactions
[0m16:34:30.385164 [info ] [Thread-1 (]: 1 of 1 START sql view model broman_analytics.stg_d365_fo__transactions ......... [RUN]
[0m16:34:30.386032 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__transactions'
[0m16:34:30.387036 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__transactions
[0m16:34:30.396261 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__transactions"
[0m16:34:30.398262 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__transactions
[0m16:34:30.422336 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__transactions"
[0m16:34:30.424329 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__transactions"
[0m16:34:30.425834 [debug] [Thread-1 (]: On model.epicaldemo.stg_d365_fo__transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__transactions"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__transactions
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.transactions
),

final AS (
    SELECT
        -- Identifiers
        id
        ,updated_at
        ,CAST(TO_CHAR(transaction_date::DATE, 'YYYYMMDD') AS INTEGER) AS date_id
        ,sku AS "SKU"
        ,store AS "Store"
        ,customernumber AS "Customer Number"

        -- Metrics
        ,quantity AS "Qty"
        ,unitprice::NUMERIC(10,2) AS "Unit Price"
        ,(quantity * unitprice)::NUMERIC(10,2) AS "Sales Amount"
        ,unitcost::NUMERIC(10,2) AS "Unit Cost"
        ,(quantity * unitcost)::NUMERIC(10,2) AS "Cost"
        ,(quantity * unitprice)::NUMERIC(10,2) - (quantity * unitcost)::NUMERIC(10,2) AS "Margin"
    FROM source
)

SELECT * FROM final
  );
[0m16:34:30.426842 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:34:31.391440 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.965 seconds
[0m16:34:31.430663 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '244ac315-2eb2-4b79-b40d-04c39559d611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E2C5BE290>]}
[0m16:34:31.431663 [info ] [Thread-1 (]: 1 of 1 OK created sql view model broman_analytics.stg_d365_fo__transactions .... [[32mSUCCESS 1[0m in 1.04s]
[0m16:34:31.433452 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__transactions
[0m16:34:31.435014 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:34:31.435014 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m16:34:31.436057 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m16:34:31.679635 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m16:34:31.679635 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m16:34:31.911677 [debug] [MainThread]: Connection 'model.epicaldemo.stg_d365_fo__transactions' was left open.
[0m16:34:31.913682 [debug] [MainThread]: On model.epicaldemo.stg_d365_fo__transactions: Close
[0m16:34:32.144024 [info ] [MainThread]: 
[0m16:34:32.146672 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 8.24 seconds (8.24s).
[0m16:34:32.148626 [debug] [MainThread]: Command end result
[0m16:34:32.180333 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m16:34:32.183855 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m16:34:32.190372 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m16:34:32.190372 [info ] [MainThread]: 
[0m16:34:32.191383 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:34:32.192367 [info ] [MainThread]: 
[0m16:34:32.193373 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:34:32.194369 [debug] [MainThread]: Command `dbt run` succeeded at 16:34:32.194369 after 12.91 seconds
[0m16:34:32.195369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E2A0B53D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E2487CB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E29DB6390>]}
[0m16:34:32.195879 [debug] [MainThread]: Flushing usage events
[0m16:34:32.886624 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:35:56.369548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D40C379190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D40C37A950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D40C379910>]}


============================== 16:35:56.372548 | 372a84d8-48f2-43f9-bdf1-a408fa86aa03 ==============================
[0m16:35:56.372548 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:35:56.373541 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -s fact_sales_transactions_incremental', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:35:56.770505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '372a84d8-48f2-43f9-bdf1-a408fa86aa03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D40DA69C50>]}
[0m16:35:56.809614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '372a84d8-48f2-43f9-bdf1-a408fa86aa03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D40AD578D0>]}
[0m16:35:56.810607 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m16:35:57.098295 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:35:57.277925 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:35:57.278924 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:35:57.283924 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m16:35:57.318637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '372a84d8-48f2-43f9-bdf1-a408fa86aa03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D40DC6F810>]}
[0m16:35:57.392543 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m16:35:57.396109 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m16:35:57.416166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '372a84d8-48f2-43f9-bdf1-a408fa86aa03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D40DCEBD90>]}
[0m16:35:57.417158 [info ] [MainThread]: Found 14 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m16:35:57.418145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '372a84d8-48f2-43f9-bdf1-a408fa86aa03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D40DA50C50>]}
[0m16:35:57.419163 [info ] [MainThread]: 
[0m16:35:57.420158 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:35:57.421145 [info ] [MainThread]: 
[0m16:35:57.421145 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:35:57.422164 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m16:35:57.496958 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m16:35:57.497958 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m16:35:57.497958 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:58.576858 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.079 seconds
[0m16:35:58.582864 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m16:35:58.592416 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:35:58.592416 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:35:58.593416 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:59.728778 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.136 seconds
[0m16:35:59.732784 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:35:59.733784 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m16:35:59.931836 [debug] [ThreadPool]: SQL status: SUCCESS 15 in 0.197 seconds
[0m16:35:59.933836 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:35:59.933836 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:36:00.077761 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.143 seconds
[0m16:36:00.080825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '372a84d8-48f2-43f9-bdf1-a408fa86aa03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D40E0FC9D0>]}
[0m16:36:00.086201 [debug] [Thread-1 (]: Began running node model.epicaldemo.fact_sales_transactions_incremental
[0m16:36:00.087209 [info ] [Thread-1 (]: 1 of 1 START sql incremental model broman_analytics.fact_sales_transactions_incremental  [RUN]
[0m16:36:00.088206 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.fact_sales_transactions_incremental'
[0m16:36:00.088206 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.fact_sales_transactions_incremental
[0m16:36:00.101737 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.fact_sales_transactions_incremental"
[0m16:36:00.102740 [debug] [Thread-1 (]: Began executing node model.epicaldemo.fact_sales_transactions_incremental
[0m16:36:00.144935 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m16:36:00.144935 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
create or replace  temporary view EPICALDEMO.broman_analytics.fact_sales_transactions_incremental__dbt_tmp
  
   as (
    

WITH

sales AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__transactions

    
    WHERE UPDATED_AT >= (SELECT MAX(UPDATED_AT) FROM EPICALDEMO.broman_analytics.fact_sales_transactions_incremental)
    
),

items AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__items
),

stores AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__stores
),

customers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_salesforce__customers
),

final AS (
    SELECT
        -- Identifiers
        sales.id
        ,sales.date_id
        ,sales.updated_at
        ,CONVERT_TIMEZONE('Europe/Stockholm', CURRENT_TIMESTAMP()) AS loaded_at

        ,CASE
            WHEN sales."SKU" IS NULL THEN -2 -- SKU is missing FROM Source
            WHEN items."item_id" IS NULL THEN -1 -- SKU is not known FROM Source
            ELSE items."item_id" -- Use item_id FROM Dim based on SKU
         END AS "item_id"

        ,CASE
            WHEN sales."Store" IS NULL THEN -2
            WHEN stores."store_key" IS NULL THEN -1
            ELSE stores."store_key"
         END AS "store_key"

        ,CASE
            WHEN sales."Customer Number" IS NULL THEN -2
            WHEN customers."customer_id" IS NULL THEN -1
            ELSE customers."customer_id"
         END AS "customer_id"

        -- Metrics
        ,sales."Qty"
        ,sales."Unit Price"
        ,sales."Sales Amount"
        ,sales."Unit Cost"
        ,sales."Cost"
        ,sales."Margin"
    FROM sales
    LEFT JOIN items ON items."SKU" = sales."SKU"
    LEFT JOIN stores ON stores."Store" = sales."Store" AND sales.date_id >= stores."valid_from" AND sales.date_id < stores."valid_to"
    LEFT JOIN customers ON customers."Customer Number" = sales."Customer Number"
)

SELECT * FROM final
  );
[0m16:36:00.145942 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:36:01.350961 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.204 seconds
[0m16:36:01.358467 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m16:36:01.359467 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
describe table EPICALDEMO.broman_analytics.fact_sales_transactions_incremental__dbt_tmp
[0m16:36:02.055512 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.695 seconds
[0m16:36:02.058444 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m16:36:02.059444 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
describe table EPICALDEMO.broman_analytics.fact_sales_transactions_incremental
[0m16:36:02.206702 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.146 seconds
[0m16:36:02.212700 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m16:36:02.213700 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."FACT_SALES_TRANSACTIONS_INCREMENTAL"
[0m16:36:02.353536 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.139 seconds
[0m16:36:02.379121 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.fact_sales_transactions_incremental"
[0m16:36:02.381114 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m16:36:02.381114 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
-- back compat for old kwarg name
  
  begin;
[0m16:36:02.523677 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.141 seconds
[0m16:36:02.523677 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m16:36:02.524676 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
merge into EPICALDEMO.broman_analytics.fact_sales_transactions_incremental as DBT_INTERNAL_DEST
        using EPICALDEMO.broman_analytics.fact_sales_transactions_incremental__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.date_id = DBT_INTERNAL_DEST.date_id
                ) and (
                    DBT_INTERNAL_SOURCE.item_id = DBT_INTERNAL_DEST.item_id
                ) and (
                    DBT_INTERNAL_SOURCE.store_key = DBT_INTERNAL_DEST.store_key
                ) and (
                    DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
                )

    
    when matched then update set
        "ID" = DBT_INTERNAL_SOURCE."ID","date_id" = DBT_INTERNAL_SOURCE."date_id","UPDATED_AT" = DBT_INTERNAL_SOURCE."UPDATED_AT","LOADED_AT" = DBT_INTERNAL_SOURCE."LOADED_AT","item_id" = DBT_INTERNAL_SOURCE."item_id","store_key" = DBT_INTERNAL_SOURCE."store_key","customer_id" = DBT_INTERNAL_SOURCE."customer_id","Qty" = DBT_INTERNAL_SOURCE."Qty","Unit Price" = DBT_INTERNAL_SOURCE."Unit Price","Sales Amount" = DBT_INTERNAL_SOURCE."Sales Amount","Unit Cost" = DBT_INTERNAL_SOURCE."Unit Cost","Cost" = DBT_INTERNAL_SOURCE."Cost","Margin" = DBT_INTERNAL_SOURCE."Margin"
    

    when not matched then insert
        ("ID", "date_id", "UPDATED_AT", "LOADED_AT", "item_id", "store_key", "customer_id", "Qty", "Unit Price", "Sales Amount", "Unit Cost", "Cost", "Margin")
    values
        ("ID", "date_id", "UPDATED_AT", "LOADED_AT", "item_id", "store_key", "customer_id", "Qty", "Unit Price", "Sales Amount", "Unit Cost", "Cost", "Margin")

;
[0m16:36:03.005452 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bd00ec-0004-ce9e-0000-d2e90002d742
[0m16:36:03.005452 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 21 at position 15
invalid identifier '"date_id"'
[0m16:36:03.008503 [debug] [Thread-1 (]: Database Error in model fact_sales_transactions_incremental (models\mart\facts\fact_sales_transactions_incremental.sql)
  000904 (42000): SQL compilation error: error line 21 at position 15
  invalid identifier '"date_id"'
  compiled code at target\run\epicaldemo\models\mart\facts\fact_sales_transactions_incremental.sql
[0m16:36:03.010519 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '372a84d8-48f2-43f9-bdf1-a408fa86aa03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D40E58B1D0>]}
[0m16:36:03.011481 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model broman_analytics.fact_sales_transactions_incremental  [[31mERROR[0m in 2.92s]
[0m16:36:03.012466 [debug] [Thread-1 (]: Finished running node model.epicaldemo.fact_sales_transactions_incremental
[0m16:36:03.012466 [debug] [Thread-7 (]: Marking all children of 'model.epicaldemo.fact_sales_transactions_incremental' to be skipped because of status 'error'.  Reason: Database Error in model fact_sales_transactions_incremental (models\mart\facts\fact_sales_transactions_incremental.sql)
  000904 (42000): SQL compilation error: error line 21 at position 15
  invalid identifier '"date_id"'
  compiled code at target\run\epicaldemo\models\mart\facts\fact_sales_transactions_incremental.sql.
[0m16:36:03.014965 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:36:03.014965 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m16:36:03.015971 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m16:36:03.267285 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m16:36:03.268283 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m16:36:03.487863 [debug] [MainThread]: Connection 'model.epicaldemo.fact_sales_transactions_incremental' was left open.
[0m16:36:03.488819 [debug] [MainThread]: On model.epicaldemo.fact_sales_transactions_incremental: Close
[0m16:36:03.715858 [info ] [MainThread]: 
[0m16:36:03.716874 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 6.29 seconds (6.29s).
[0m16:36:03.717777 [debug] [MainThread]: Command end result
[0m16:36:03.742334 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m16:36:03.744838 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m16:36:03.753851 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m16:36:03.754842 [info ] [MainThread]: 
[0m16:36:03.754842 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:36:03.755875 [info ] [MainThread]: 
[0m16:36:03.756897 [error] [MainThread]:   Database Error in model fact_sales_transactions_incremental (models\mart\facts\fact_sales_transactions_incremental.sql)
  000904 (42000): SQL compilation error: error line 21 at position 15
  invalid identifier '"date_id"'
  compiled code at target\run\epicaldemo\models\mart\facts\fact_sales_transactions_incremental.sql
[0m16:36:03.756897 [info ] [MainThread]: 
[0m16:36:03.757871 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:36:03.758873 [debug] [MainThread]: Command `dbt run` failed at 16:36:03.758873 after 7.45 seconds
[0m16:36:03.759888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D40C1B4E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D40C3B98D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D40DA69510>]}
[0m16:36:03.759888 [debug] [MainThread]: Flushing usage events
[0m16:36:04.478370 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:37:48.319115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CF31712D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CF3171390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CF31737D0>]}


============================== 16:37:48.324150 | 51faf44c-1316-46bf-b06f-bfd672602980 ==============================
[0m16:37:48.324150 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:37:48.325160 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -s fact_sales_transactions_incremental', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:37:48.704927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51faf44c-1316-46bf-b06f-bfd672602980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CF44FD090>]}
[0m16:37:48.744511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51faf44c-1316-46bf-b06f-bfd672602980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CF4531650>]}
[0m16:37:48.746458 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m16:37:49.035549 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:37:49.216052 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:37:49.216052 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:37:49.221051 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m16:37:49.256722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51faf44c-1316-46bf-b06f-bfd672602980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CF4BFF990>]}
[0m16:37:49.327518 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m16:37:49.332509 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m16:37:49.352556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51faf44c-1316-46bf-b06f-bfd672602980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CF4867F10>]}
[0m16:37:49.354063 [info ] [MainThread]: Found 14 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m16:37:49.355083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51faf44c-1316-46bf-b06f-bfd672602980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CEFFDB6D0>]}
[0m16:37:49.357090 [info ] [MainThread]: 
[0m16:37:49.357090 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:37:49.358069 [info ] [MainThread]: 
[0m16:37:49.358069 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:37:49.360069 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m16:37:49.435932 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m16:37:49.436920 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m16:37:49.436920 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:37:50.483293 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.046 seconds
[0m16:37:50.488830 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m16:37:50.498360 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:37:50.498360 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:37:50.498360 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:37:51.188337 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.689 seconds
[0m16:37:51.192336 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:37:51.192336 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m16:37:51.336469 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.143 seconds
[0m16:37:51.338525 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:37:51.339535 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:37:51.479299 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.140 seconds
[0m16:37:51.483307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51faf44c-1316-46bf-b06f-bfd672602980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CF4F2BED0>]}
[0m16:37:51.488335 [debug] [Thread-1 (]: Began running node model.epicaldemo.fact_sales_transactions_incremental
[0m16:37:51.488335 [info ] [Thread-1 (]: 1 of 1 START sql incremental model broman_analytics.fact_sales_transactions_incremental  [RUN]
[0m16:37:51.489344 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.fact_sales_transactions_incremental'
[0m16:37:51.490337 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.fact_sales_transactions_incremental
[0m16:37:51.501883 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.fact_sales_transactions_incremental"
[0m16:37:51.502881 [debug] [Thread-1 (]: Began executing node model.epicaldemo.fact_sales_transactions_incremental
[0m16:37:51.577469 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.fact_sales_transactions_incremental"
[0m16:37:51.585364 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m16:37:51.587387 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
create or replace transient table EPICALDEMO.broman_analytics.fact_sales_transactions_incremental
    

    
    as (

WITH

sales AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__transactions

    
),

items AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__items
),

stores AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__stores
),

customers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_salesforce__customers
),

final AS (
    SELECT
        -- Identifiers
        sales.id
        ,sales.date_id
        ,sales.updated_at
        ,CONVERT_TIMEZONE('Europe/Stockholm', CURRENT_TIMESTAMP()) AS loaded_at

        ,CASE
            WHEN sales."SKU" IS NULL THEN -2 -- SKU is missing FROM Source
            WHEN items."item_id" IS NULL THEN -1 -- SKU is not known FROM Source
            ELSE items."item_id" -- Use item_id FROM Dim based on SKU
         END AS "item_id"

        ,CASE
            WHEN sales."Store" IS NULL THEN -2
            WHEN stores."store_key" IS NULL THEN -1
            ELSE stores."store_key"
         END AS "store_key"

        ,CASE
            WHEN sales."Customer Number" IS NULL THEN -2
            WHEN customers."customer_id" IS NULL THEN -1
            ELSE customers."customer_id"
         END AS "customer_id"

        -- Metrics
        ,sales."Qty"
        ,sales."Unit Price"
        ,sales."Sales Amount"
        ,sales."Unit Cost"
        ,sales."Cost"
        ,sales."Margin"
    FROM sales
    LEFT JOIN items ON items."SKU" = sales."SKU"
    LEFT JOIN stores ON stores."Store" = sales."Store" AND sales.date_id >= stores."valid_from" AND sales.date_id < stores."valid_to"
    LEFT JOIN customers ON customers."Customer Number" = sales."Customer Number"
)

SELECT * FROM final
    )
;
[0m16:37:51.589369 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:37:54.078091 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.490 seconds
[0m16:37:54.085600 [debug] [Thread-1 (]: Applying DROP to: EPICALDEMO.broman_analytics.fact_sales_transactions_incremental__dbt_tmp
[0m16:37:54.090605 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m16:37:54.090605 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
drop view if exists EPICALDEMO.broman_analytics.fact_sales_transactions_incremental__dbt_tmp cascade
[0m16:37:54.212552 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.121 seconds
[0m16:37:54.228805 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51faf44c-1316-46bf-b06f-bfd672602980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CF45CDD90>]}
[0m16:37:54.228805 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model broman_analytics.fact_sales_transactions_incremental  [[32mSUCCESS 1[0m in 2.74s]
[0m16:37:54.229798 [debug] [Thread-1 (]: Finished running node model.epicaldemo.fact_sales_transactions_incremental
[0m16:37:54.231797 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:37:54.232804 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m16:37:54.232804 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m16:37:54.456931 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m16:37:54.457930 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m16:37:54.700286 [debug] [MainThread]: Connection 'model.epicaldemo.fact_sales_transactions_incremental' was left open.
[0m16:37:54.700286 [debug] [MainThread]: On model.epicaldemo.fact_sales_transactions_incremental: Close
[0m16:37:54.932466 [info ] [MainThread]: 
[0m16:37:54.933985 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 5.57 seconds (5.57s).
[0m16:37:54.934513 [debug] [MainThread]: Command end result
[0m16:37:54.956550 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m16:37:54.959550 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m16:37:54.965222 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m16:37:54.965222 [info ] [MainThread]: 
[0m16:37:54.966223 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:37:54.967219 [info ] [MainThread]: 
[0m16:37:54.967219 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:37:54.969224 [debug] [MainThread]: Command `dbt run` succeeded at 16:37:54.968224 after 6.71 seconds
[0m16:37:54.969224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CF31DFCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CF31DFF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CED624F10>]}
[0m16:37:54.970227 [debug] [MainThread]: Flushing usage events
[0m16:37:55.685165 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:38:34.642468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019799CB78D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019799CB5A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019799CB7810>]}


============================== 16:38:34.647036 | e747ede8-41dd-43fa-9e43-b7aeefa97927 ==============================
[0m16:38:34.647036 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:38:34.648039 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -s stg_d365_fo__transactions', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:38:35.061474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e747ede8-41dd-43fa-9e43-b7aeefa97927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001979AE1BFD0>]}
[0m16:38:35.101131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e747ede8-41dd-43fa-9e43-b7aeefa97927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001979864F9D0>]}
[0m16:38:35.103126 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m16:38:35.415022 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:38:35.608964 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:38:35.608964 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:38:35.614482 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m16:38:35.650024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e747ede8-41dd-43fa-9e43-b7aeefa97927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001979B3EDB90>]}
[0m16:38:35.725650 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m16:38:35.729654 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m16:38:35.751689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e747ede8-41dd-43fa-9e43-b7aeefa97927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001979B3D99D0>]}
[0m16:38:35.752689 [info ] [MainThread]: Found 14 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m16:38:35.752689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e747ede8-41dd-43fa-9e43-b7aeefa97927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001979B3E3550>]}
[0m16:38:35.755209 [info ] [MainThread]: 
[0m16:38:35.756208 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:38:35.756208 [info ] [MainThread]: 
[0m16:38:35.757211 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:38:35.758213 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m16:38:35.838922 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m16:38:35.839924 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m16:38:35.839924 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:38:36.893297 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.053 seconds
[0m16:38:36.899428 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m16:38:36.908440 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:38:36.909440 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:38:36.910445 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:38:38.002329 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.092 seconds
[0m16:38:38.006852 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:38:38.006852 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m16:38:38.207882 [debug] [ThreadPool]: SQL status: SUCCESS 15 in 0.200 seconds
[0m16:38:38.209889 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:38:38.209889 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:38:38.338963 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.128 seconds
[0m16:38:38.343043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e747ede8-41dd-43fa-9e43-b7aeefa97927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001979AEC2BD0>]}
[0m16:38:38.347160 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__transactions
[0m16:38:38.348168 [info ] [Thread-1 (]: 1 of 1 START sql view model broman_analytics.stg_d365_fo__transactions ......... [RUN]
[0m16:38:38.349160 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__transactions'
[0m16:38:38.349160 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__transactions
[0m16:38:38.355709 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__transactions"
[0m16:38:38.356707 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__transactions
[0m16:38:38.382850 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__transactions"
[0m16:38:38.385263 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__transactions"
[0m16:38:38.385263 [debug] [Thread-1 (]: On model.epicaldemo.stg_d365_fo__transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__transactions"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__transactions
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.transactions
),

final AS (
    SELECT
        -- Identifiers
        id
        ,updated_at
        ,CAST(TO_CHAR(transaction_date::DATE, 'YYYYMMDD') AS INTEGER) AS transaction_date_id
        ,sku AS "SKU"
        ,store AS "Store"
        ,customernumber AS "Customer Number"

        -- Metrics
        ,quantity AS "Qty"
        ,unitprice::NUMERIC(10,2) AS "Unit Price"
        ,(quantity * unitprice)::NUMERIC(10,2) AS "Sales Amount"
        ,unitcost::NUMERIC(10,2) AS "Unit Cost"
        ,(quantity * unitcost)::NUMERIC(10,2) AS "Cost"
        ,(quantity * unitprice)::NUMERIC(10,2) - (quantity * unitcost)::NUMERIC(10,2) AS "Margin"
    FROM source
)

SELECT * FROM final
  );
[0m16:38:38.387276 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:38:39.542680 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.155 seconds
[0m16:38:39.560731 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e747ede8-41dd-43fa-9e43-b7aeefa97927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001979AECDD10>]}
[0m16:38:39.561731 [info ] [Thread-1 (]: 1 of 1 OK created sql view model broman_analytics.stg_d365_fo__transactions .... [[32mSUCCESS 1[0m in 1.21s]
[0m16:38:39.562723 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__transactions
[0m16:38:39.565260 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:38:39.565260 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m16:38:39.565260 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m16:38:39.813797 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m16:38:39.813797 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m16:38:40.144068 [debug] [MainThread]: Connection 'model.epicaldemo.stg_d365_fo__transactions' was left open.
[0m16:38:40.144589 [debug] [MainThread]: On model.epicaldemo.stg_d365_fo__transactions: Close
[0m16:38:40.376871 [info ] [MainThread]: 
[0m16:38:40.377924 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.62 seconds (4.62s).
[0m16:38:40.378896 [debug] [MainThread]: Command end result
[0m16:38:40.400948 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m16:38:40.405044 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m16:38:40.412018 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m16:38:40.413035 [info ] [MainThread]: 
[0m16:38:40.414020 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:38:40.415120 [info ] [MainThread]: 
[0m16:38:40.416117 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:38:40.417122 [debug] [MainThread]: Command `dbt run` succeeded at 16:38:40.417122 after 5.84 seconds
[0m16:38:40.418137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001979407CB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019794072E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019794072210>]}
[0m16:38:40.418137 [debug] [MainThread]: Flushing usage events
[0m16:38:41.134508 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:39:29.796359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026571E73550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026571E73FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026571E73CD0>]}


============================== 16:39:29.799358 | be0b1ab6-8891-4c1d-8295-ed1b870d033f ==============================
[0m16:39:29.799358 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:39:29.800350 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s fact_sales_transactions_incremental', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:39:30.194799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be0b1ab6-8891-4c1d-8295-ed1b870d033f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026571EE6610>]}
[0m16:39:30.234931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be0b1ab6-8891-4c1d-8295-ed1b870d033f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026570857850>]}
[0m16:39:30.235921 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m16:39:30.518379 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:39:30.701424 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:39:30.701424 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:39:30.706954 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m16:39:30.742031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be0b1ab6-8891-4c1d-8295-ed1b870d033f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265738E8F10>]}
[0m16:39:30.812707 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m16:39:30.816799 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m16:39:30.836858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be0b1ab6-8891-4c1d-8295-ed1b870d033f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265735FB750>]}
[0m16:39:30.837874 [info ] [MainThread]: Found 14 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m16:39:30.838858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be0b1ab6-8891-4c1d-8295-ed1b870d033f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265738B3F90>]}
[0m16:39:30.840389 [info ] [MainThread]: 
[0m16:39:30.840389 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:39:30.841378 [info ] [MainThread]: 
[0m16:39:30.842371 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:39:30.842371 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m16:39:30.919674 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m16:39:30.919674 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m16:39:30.920673 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:39:31.895340 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.975 seconds
[0m16:39:31.902354 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m16:39:31.911930 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:39:31.911930 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:39:31.911930 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:39:32.749156 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.836 seconds
[0m16:39:32.754678 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:39:32.755672 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m16:39:32.891852 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.136 seconds
[0m16:39:32.892851 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:39:32.893851 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:39:33.047075 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.152 seconds
[0m16:39:33.050073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be0b1ab6-8891-4c1d-8295-ed1b870d033f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026573A00FD0>]}
[0m16:39:33.056235 [debug] [Thread-1 (]: Began running node model.epicaldemo.fact_sales_transactions_incremental
[0m16:39:33.057309 [info ] [Thread-1 (]: 1 of 1 START sql incremental model broman_analytics.fact_sales_transactions_incremental  [RUN]
[0m16:39:33.058244 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.fact_sales_transactions_incremental'
[0m16:39:33.058244 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.fact_sales_transactions_incremental
[0m16:39:33.068962 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.fact_sales_transactions_incremental"
[0m16:39:33.069959 [debug] [Thread-1 (]: Began executing node model.epicaldemo.fact_sales_transactions_incremental
[0m16:39:33.118573 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.fact_sales_transactions_incremental"
[0m16:39:33.121569 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m16:39:33.122589 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
create or replace transient table EPICALDEMO.broman_analytics.fact_sales_transactions_incremental
    

    
    as (

WITH

sales AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__transactions

    
),

items AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__items
),

stores AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__stores
),

customers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_salesforce__customers
),

final AS (
    SELECT
        -- Identifiers
        sales.id
        ,sales.transaction_date_id
        ,sales.updated_at
        ,CONVERT_TIMEZONE('Europe/Stockholm', CURRENT_TIMESTAMP()) AS loaded_at

        ,CASE
            WHEN sales."SKU" IS NULL THEN -2 -- SKU is missing FROM Source
            WHEN items."item_id" IS NULL THEN -1 -- SKU is not known FROM Source
            ELSE items."item_id" -- Use item_id FROM Dim based on SKU
         END AS "item_id"

        ,CASE
            WHEN sales."Store" IS NULL THEN -2
            WHEN stores."store_key" IS NULL THEN -1
            ELSE stores."store_key"
         END AS "store_key"

        ,CASE
            WHEN sales."Customer Number" IS NULL THEN -2
            WHEN customers."customer_id" IS NULL THEN -1
            ELSE customers."customer_id"
         END AS "customer_id"

        -- Metrics
        ,sales."Qty"
        ,sales."Unit Price"
        ,sales."Sales Amount"
        ,sales."Unit Cost"
        ,sales."Cost"
        ,sales."Margin"
    FROM sales
    LEFT JOIN items ON items."SKU" = sales."SKU"
    LEFT JOIN stores ON stores."Store" = sales."Store" AND sales.date_id >= stores."valid_from" AND sales.date_id < stores."valid_to"
    LEFT JOIN customers ON customers."Customer Number" = sales."Customer Number"
)

SELECT * FROM final
    )
;
[0m16:39:33.123566 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:39:34.118008 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bd00ef-0004-ce47-0000-d2e90002f806
[0m16:39:34.119000 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 70 at position 59
invalid identifier 'SALES.DATE_ID'
[0m16:39:34.122004 [debug] [Thread-1 (]: Database Error in model fact_sales_transactions_incremental (models\mart\facts\fact_sales_transactions_incremental.sql)
  000904 (42000): SQL compilation error: error line 70 at position 59
  invalid identifier 'SALES.DATE_ID'
  compiled code at target\run\epicaldemo\models\mart\facts\fact_sales_transactions_incremental.sql
[0m16:39:34.124012 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be0b1ab6-8891-4c1d-8295-ed1b870d033f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026573160E90>]}
[0m16:39:34.124575 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model broman_analytics.fact_sales_transactions_incremental  [[31mERROR[0m in 1.06s]
[0m16:39:34.125923 [debug] [Thread-1 (]: Finished running node model.epicaldemo.fact_sales_transactions_incremental
[0m16:39:34.126936 [debug] [Thread-7 (]: Marking all children of 'model.epicaldemo.fact_sales_transactions_incremental' to be skipped because of status 'error'.  Reason: Database Error in model fact_sales_transactions_incremental (models\mart\facts\fact_sales_transactions_incremental.sql)
  000904 (42000): SQL compilation error: error line 70 at position 59
  invalid identifier 'SALES.DATE_ID'
  compiled code at target\run\epicaldemo\models\mart\facts\fact_sales_transactions_incremental.sql.
[0m16:39:34.128932 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:39:34.128932 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m16:39:34.130033 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m16:39:34.368134 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m16:39:34.369193 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m16:39:34.638153 [debug] [MainThread]: Connection 'model.epicaldemo.fact_sales_transactions_incremental' was left open.
[0m16:39:34.639149 [debug] [MainThread]: On model.epicaldemo.fact_sales_transactions_incremental: Close
[0m16:39:34.870990 [info ] [MainThread]: 
[0m16:39:34.871992 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 4.03 seconds (4.03s).
[0m16:39:34.873001 [debug] [MainThread]: Command end result
[0m16:39:34.895451 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m16:39:34.898451 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m16:39:34.903958 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m16:39:34.903958 [info ] [MainThread]: 
[0m16:39:34.904964 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:39:34.904964 [info ] [MainThread]: 
[0m16:39:34.905964 [error] [MainThread]:   Database Error in model fact_sales_transactions_incremental (models\mart\facts\fact_sales_transactions_incremental.sql)
  000904 (42000): SQL compilation error: error line 70 at position 59
  invalid identifier 'SALES.DATE_ID'
  compiled code at target\run\epicaldemo\models\mart\facts\fact_sales_transactions_incremental.sql
[0m16:39:34.906963 [info ] [MainThread]: 
[0m16:39:34.906963 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:39:34.907965 [debug] [MainThread]: Command `dbt run` failed at 16:39:34.907965 after 5.18 seconds
[0m16:39:34.909047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026571EB9F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026571AB4CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002656D79DC90>]}
[0m16:39:34.909047 [debug] [MainThread]: Flushing usage events
[0m16:39:35.640977 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:40:01.024684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA73F731D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA73F71D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA73F71210>]}


============================== 16:40:01.038183 | bd8c5946-6e66-4b2b-842a-a114ae01e887 ==============================
[0m16:40:01.038183 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:40:01.040183 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -s fact_sales_transactions_incremental', 'send_anonymous_usage_stats': 'True'}
[0m16:40:04.062006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd8c5946-6e66-4b2b-842a-a114ae01e887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA75396890>]}
[0m16:40:04.104659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd8c5946-6e66-4b2b-842a-a114ae01e887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA7274F910>]}
[0m16:40:04.116189 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m16:40:04.528643 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:40:04.718464 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:40:04.719412 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:40:04.724946 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m16:40:04.763072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd8c5946-6e66-4b2b-842a-a114ae01e887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA759E9490>]}
[0m16:40:04.839347 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m16:40:04.855340 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m16:40:05.087719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd8c5946-6e66-4b2b-842a-a114ae01e887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA758FBB10>]}
[0m16:40:05.089706 [info ] [MainThread]: Found 14 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m16:40:05.090705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd8c5946-6e66-4b2b-842a-a114ae01e887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA759CC910>]}
[0m16:40:05.092705 [info ] [MainThread]: 
[0m16:40:05.093723 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:40:05.095106 [info ] [MainThread]: 
[0m16:40:05.096106 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:40:05.098104 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m16:40:07.531821 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m16:40:07.532820 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m16:40:07.533821 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:40:08.810618 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.277 seconds
[0m16:40:08.816129 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m16:40:08.825666 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:40:08.825666 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:40:08.826657 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:40:09.836630 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.010 seconds
[0m16:40:09.840637 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:40:09.841638 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m16:40:10.186182 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.344 seconds
[0m16:40:10.188178 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:40:10.189187 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:40:10.485392 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.296 seconds
[0m16:40:10.489390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd8c5946-6e66-4b2b-842a-a114ae01e887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA758BDE50>]}
[0m16:40:10.494413 [debug] [Thread-1 (]: Began running node model.epicaldemo.fact_sales_transactions_incremental
[0m16:40:10.495412 [info ] [Thread-1 (]: 1 of 1 START sql incremental model broman_analytics.fact_sales_transactions_incremental  [RUN]
[0m16:40:10.496412 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.fact_sales_transactions_incremental'
[0m16:40:10.496412 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.fact_sales_transactions_incremental
[0m16:40:10.507954 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.fact_sales_transactions_incremental"
[0m16:40:10.508947 [debug] [Thread-1 (]: Began executing node model.epicaldemo.fact_sales_transactions_incremental
[0m16:40:10.557383 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.fact_sales_transactions_incremental"
[0m16:40:10.561397 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m16:40:10.562381 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
create or replace transient table EPICALDEMO.broman_analytics.fact_sales_transactions_incremental
    

    
    as (

WITH

sales AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__transactions

    
),

items AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__items
),

stores AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__stores
),

customers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_salesforce__customers
),

final AS (
    SELECT
        -- Identifiers
        sales.id
        ,sales.transaction_date_id
        ,sales.updated_at
        ,CONVERT_TIMEZONE('Europe/Stockholm', CURRENT_TIMESTAMP()) AS loaded_at

        ,CASE
            WHEN sales."SKU" IS NULL THEN -2 -- SKU is missing FROM Source
            WHEN items."item_id" IS NULL THEN -1 -- SKU is not known FROM Source
            ELSE items."item_id" -- Use item_id FROM Dim based on SKU
         END AS "item_id"

        ,CASE
            WHEN sales."Store" IS NULL THEN -2
            WHEN stores."store_key" IS NULL THEN -1
            ELSE stores."store_key"
         END AS "store_key"

        ,CASE
            WHEN sales."Customer Number" IS NULL THEN -2
            WHEN customers."customer_id" IS NULL THEN -1
            ELSE customers."customer_id"
         END AS "customer_id"

        -- Metrics
        ,sales."Qty"
        ,sales."Unit Price"
        ,sales."Sales Amount"
        ,sales."Unit Cost"
        ,sales."Cost"
        ,sales."Margin"
    FROM sales
    LEFT JOIN items ON items."SKU" = sales."SKU"
    LEFT JOIN stores ON stores."Store" = sales."Store" AND sales.transaction_date_id >= stores."valid_from" AND sales.transaction_date_id < stores."valid_to"
    LEFT JOIN customers ON customers."Customer Number" = sales."Customer Number"
)

SELECT * FROM final
    )
;
[0m16:40:10.562381 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:40:12.357605 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.795 seconds
[0m16:40:12.365315 [debug] [Thread-1 (]: Applying DROP to: EPICALDEMO.broman_analytics.fact_sales_transactions_incremental__dbt_tmp
[0m16:40:12.370862 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m16:40:12.370862 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
drop view if exists EPICALDEMO.broman_analytics.fact_sales_transactions_incremental__dbt_tmp cascade
[0m16:40:12.500381 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.128 seconds
[0m16:40:12.526145 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd8c5946-6e66-4b2b-842a-a114ae01e887', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA738CCA50>]}
[0m16:40:12.527145 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model broman_analytics.fact_sales_transactions_incremental  [[32mSUCCESS 1[0m in 2.02s]
[0m16:40:12.529143 [debug] [Thread-1 (]: Finished running node model.epicaldemo.fact_sales_transactions_incremental
[0m16:40:12.530140 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:40:12.531153 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m16:40:12.532143 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m16:40:12.748925 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m16:40:12.748925 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m16:40:12.992447 [debug] [MainThread]: Connection 'model.epicaldemo.fact_sales_transactions_incremental' was left open.
[0m16:40:12.994021 [debug] [MainThread]: On model.epicaldemo.fact_sales_transactions_incremental: Close
[0m16:40:13.229282 [info ] [MainThread]: 
[0m16:40:13.230282 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 8.13 seconds (8.13s).
[0m16:40:13.231279 [debug] [MainThread]: Command end result
[0m16:40:13.254822 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m16:40:13.259827 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m16:40:13.265342 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m16:40:13.266347 [info ] [MainThread]: 
[0m16:40:13.266347 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:40:13.267347 [info ] [MainThread]: 
[0m16:40:13.267347 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:40:13.268348 [debug] [MainThread]: Command `dbt run` succeeded at 16:40:13.268348 after 12.31 seconds
[0m16:40:13.268348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA73C51C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA6E424F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA6E812E10>]}
[0m16:40:13.269918 [debug] [MainThread]: Flushing usage events
[0m16:40:13.957665 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:41:17.045684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A37BB5390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A37D7D790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A37D7DC10>]}


============================== 16:41:17.048694 | 5c7c9353-69e4-4ae1-abc1-f4424246f02e ==============================
[0m16:41:17.048694 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:41:17.049682 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -s fact_sales_transactions_incremental', 'send_anonymous_usage_stats': 'True'}
[0m16:41:17.440799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c7c9353-69e4-4ae1-abc1-f4424246f02e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A391C1F10>]}
[0m16:41:17.481367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c7c9353-69e4-4ae1-abc1-f4424246f02e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A36557850>]}
[0m16:41:17.482328 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m16:41:17.778754 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:41:17.971516 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:41:17.971516 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:41:17.977027 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m16:41:18.013597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c7c9353-69e4-4ae1-abc1-f4424246f02e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A391C1E90>]}
[0m16:41:18.086193 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m16:41:18.090196 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m16:41:18.108220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c7c9353-69e4-4ae1-abc1-f4424246f02e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A396732D0>]}
[0m16:41:18.109229 [info ] [MainThread]: Found 14 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m16:41:18.110220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c7c9353-69e4-4ae1-abc1-f4424246f02e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A391A9CD0>]}
[0m16:41:18.111724 [info ] [MainThread]: 
[0m16:41:18.111724 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:41:18.113246 [info ] [MainThread]: 
[0m16:41:18.114251 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:41:18.115251 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m16:41:18.192096 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m16:41:18.192096 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m16:41:18.193094 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:41:19.329551 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.136 seconds
[0m16:41:19.337079 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m16:41:19.345613 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:41:19.346613 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:41:19.346613 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:41:20.127984 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.781 seconds
[0m16:41:20.133586 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:41:20.134490 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m16:41:20.306890 [debug] [ThreadPool]: SQL status: SUCCESS 15 in 0.172 seconds
[0m16:41:20.307889 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:41:20.308890 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:41:20.444823 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.135 seconds
[0m16:41:20.451826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c7c9353-69e4-4ae1-abc1-f4424246f02e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A396F7190>]}
[0m16:41:20.457347 [debug] [Thread-1 (]: Began running node model.epicaldemo.fact_sales_transactions_incremental
[0m16:41:20.458347 [info ] [Thread-1 (]: 1 of 1 START sql incremental model broman_analytics.fact_sales_transactions_incremental  [RUN]
[0m16:41:20.459340 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.fact_sales_transactions_incremental'
[0m16:41:20.459340 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.fact_sales_transactions_incremental
[0m16:41:20.471888 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.fact_sales_transactions_incremental"
[0m16:41:20.473401 [debug] [Thread-1 (]: Began executing node model.epicaldemo.fact_sales_transactions_incremental
[0m16:41:20.518034 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m16:41:20.518034 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
create or replace  temporary view EPICALDEMO.broman_analytics.fact_sales_transactions_incremental__dbt_tmp
  
   as (
    

WITH

sales AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__transactions

    
    WHERE UPDATED_AT >= (SELECT MAX(UPDATED_AT) FROM EPICALDEMO.broman_analytics.fact_sales_transactions_incremental)
    
),

items AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__items
),

stores AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__stores
),

customers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_salesforce__customers
),

final AS (
    SELECT
        -- Identifiers
        sales.id
        ,sales.transaction_date_id
        ,sales.updated_at
        ,CONVERT_TIMEZONE('Europe/Stockholm', CURRENT_TIMESTAMP()) AS loaded_at

        ,CASE
            WHEN sales."SKU" IS NULL THEN -2 -- SKU is missing FROM Source
            WHEN items."item_id" IS NULL THEN -1 -- SKU is not known FROM Source
            ELSE items."item_id" -- Use item_id FROM Dim based on SKU
         END AS "item_id"

        ,CASE
            WHEN sales."Store" IS NULL THEN -2
            WHEN stores."store_key" IS NULL THEN -1
            ELSE stores."store_key"
         END AS "store_key"

        ,CASE
            WHEN sales."Customer Number" IS NULL THEN -2
            WHEN customers."customer_id" IS NULL THEN -1
            ELSE customers."customer_id"
         END AS "customer_id"

        -- Metrics
        ,sales."Qty"
        ,sales."Unit Price"
        ,sales."Sales Amount"
        ,sales."Unit Cost"
        ,sales."Cost"
        ,sales."Margin"
    FROM sales
    LEFT JOIN items ON items."SKU" = sales."SKU"
    LEFT JOIN stores ON stores."Store" = sales."Store" AND sales.transaction_date_id >= stores."valid_from" AND sales.transaction_date_id < stores."valid_to"
    LEFT JOIN customers ON customers."Customer Number" = sales."Customer Number"
)

SELECT * FROM final
  );
[0m16:41:20.519035 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:41:21.411888 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.892 seconds
[0m16:41:21.419406 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m16:41:21.419406 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
describe table EPICALDEMO.broman_analytics.fact_sales_transactions_incremental__dbt_tmp
[0m16:41:21.665167 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.245 seconds
[0m16:41:21.669164 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m16:41:21.669164 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
describe table EPICALDEMO.broman_analytics.fact_sales_transactions_incremental
[0m16:41:21.806052 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.136 seconds
[0m16:41:21.813576 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m16:41:21.813576 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."FACT_SALES_TRANSACTIONS_INCREMENTAL"
[0m16:41:21.935370 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.121 seconds
[0m16:41:21.965044 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.fact_sales_transactions_incremental"
[0m16:41:21.967969 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m16:41:21.968969 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
-- back compat for old kwarg name
  
  begin;
[0m16:41:22.165203 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.196 seconds
[0m16:41:22.166203 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m16:41:22.166203 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
merge into EPICALDEMO.broman_analytics.fact_sales_transactions_incremental as DBT_INTERNAL_DEST
        using EPICALDEMO.broman_analytics.fact_sales_transactions_incremental__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.date_id = DBT_INTERNAL_DEST.date_id
                ) and (
                    DBT_INTERNAL_SOURCE.item_id = DBT_INTERNAL_DEST.item_id
                ) and (
                    DBT_INTERNAL_SOURCE.store_key = DBT_INTERNAL_DEST.store_key
                ) and (
                    DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
                )

    
    when matched then update set
        "ID" = DBT_INTERNAL_SOURCE."ID","TRANSACTION_DATE_ID" = DBT_INTERNAL_SOURCE."TRANSACTION_DATE_ID","UPDATED_AT" = DBT_INTERNAL_SOURCE."UPDATED_AT","LOADED_AT" = DBT_INTERNAL_SOURCE."LOADED_AT","item_id" = DBT_INTERNAL_SOURCE."item_id","store_key" = DBT_INTERNAL_SOURCE."store_key","customer_id" = DBT_INTERNAL_SOURCE."customer_id","Qty" = DBT_INTERNAL_SOURCE."Qty","Unit Price" = DBT_INTERNAL_SOURCE."Unit Price","Sales Amount" = DBT_INTERNAL_SOURCE."Sales Amount","Unit Cost" = DBT_INTERNAL_SOURCE."Unit Cost","Cost" = DBT_INTERNAL_SOURCE."Cost","Margin" = DBT_INTERNAL_SOURCE."Margin"
    

    when not matched then insert
        ("ID", "TRANSACTION_DATE_ID", "UPDATED_AT", "LOADED_AT", "item_id", "store_key", "customer_id", "Qty", "Unit Price", "Sales Amount", "Unit Cost", "Cost", "Margin")
    values
        ("ID", "TRANSACTION_DATE_ID", "UPDATED_AT", "LOADED_AT", "item_id", "store_key", "customer_id", "Qty", "Unit Price", "Sales Amount", "Unit Cost", "Cost", "Margin")

;
[0m16:41:22.597914 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bd00f1-0004-ce6d-0000-d2e900030826
[0m16:41:22.598914 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 4 at position 20
invalid identifier 'DBT_INTERNAL_SOURCE.DATE_ID'
[0m16:41:22.602914 [debug] [Thread-1 (]: Database Error in model fact_sales_transactions_incremental (models\mart\facts\fact_sales_transactions_incremental.sql)
  000904 (42000): SQL compilation error: error line 4 at position 20
  invalid identifier 'DBT_INTERNAL_SOURCE.DATE_ID'
  compiled code at target\run\epicaldemo\models\mart\facts\fact_sales_transactions_incremental.sql
[0m16:41:22.604422 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c7c9353-69e4-4ae1-abc1-f4424246f02e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A391C03D0>]}
[0m16:41:22.605423 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model broman_analytics.fact_sales_transactions_incremental  [[31mERROR[0m in 2.14s]
[0m16:41:22.606427 [debug] [Thread-1 (]: Finished running node model.epicaldemo.fact_sales_transactions_incremental
[0m16:41:22.607427 [debug] [Thread-7 (]: Marking all children of 'model.epicaldemo.fact_sales_transactions_incremental' to be skipped because of status 'error'.  Reason: Database Error in model fact_sales_transactions_incremental (models\mart\facts\fact_sales_transactions_incremental.sql)
  000904 (42000): SQL compilation error: error line 4 at position 20
  invalid identifier 'DBT_INTERNAL_SOURCE.DATE_ID'
  compiled code at target\run\epicaldemo\models\mart\facts\fact_sales_transactions_incremental.sql.
[0m16:41:22.609430 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:41:22.609430 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m16:41:22.610427 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m16:41:22.857345 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m16:41:22.858352 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m16:41:23.095165 [debug] [MainThread]: Connection 'model.epicaldemo.fact_sales_transactions_incremental' was left open.
[0m16:41:23.096168 [debug] [MainThread]: On model.epicaldemo.fact_sales_transactions_incremental: Close
[0m16:41:23.328023 [info ] [MainThread]: 
[0m16:41:23.328023 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 5.21 seconds (5.21s).
[0m16:41:23.329023 [debug] [MainThread]: Command end result
[0m16:41:23.352077 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m16:41:23.354606 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m16:41:23.360604 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m16:41:23.361600 [info ] [MainThread]: 
[0m16:41:23.363108 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:41:23.363108 [info ] [MainThread]: 
[0m16:41:23.364123 [error] [MainThread]:   Database Error in model fact_sales_transactions_incremental (models\mart\facts\fact_sales_transactions_incremental.sql)
  000904 (42000): SQL compilation error: error line 4 at position 20
  invalid identifier 'DBT_INTERNAL_SOURCE.DATE_ID'
  compiled code at target\run\epicaldemo\models\mart\facts\fact_sales_transactions_incremental.sql
[0m16:41:23.365130 [info ] [MainThread]: 
[0m16:41:23.365130 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:41:23.366123 [debug] [MainThread]: Command `dbt run` failed at 16:41:23.366123 after 6.38 seconds
[0m16:41:23.367127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A37BA1A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A32612E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A37DC4C90>]}
[0m16:41:23.367127 [debug] [MainThread]: Flushing usage events
[0m16:41:24.097130 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:41:45.238016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016070FB6C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016070FB6410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016070FB7890>]}


============================== 16:41:45.241527 | 62a91fb1-d41d-4bda-a29f-931618c3efc6 ==============================
[0m16:41:45.241527 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:41:45.243043 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -s fact_sales_transactions_incremental', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:41:45.650340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '62a91fb1-d41d-4bda-a29f-931618c3efc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016070FB4B90>]}
[0m16:41:45.689468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '62a91fb1-d41d-4bda-a29f-931618c3efc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016072331750>]}
[0m16:41:45.690462 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m16:41:45.977445 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:41:46.162112 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:41:46.163112 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:41:46.167646 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m16:41:46.204156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '62a91fb1-d41d-4bda-a29f-931618c3efc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160714AC510>]}
[0m16:41:46.281432 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m16:41:46.285949 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m16:41:46.305001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '62a91fb1-d41d-4bda-a29f-931618c3efc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016072D00150>]}
[0m16:41:46.306018 [info ] [MainThread]: Found 14 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m16:41:46.307000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62a91fb1-d41d-4bda-a29f-931618c3efc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160729AFE90>]}
[0m16:41:46.308018 [info ] [MainThread]: 
[0m16:41:46.309001 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:41:46.309001 [info ] [MainThread]: 
[0m16:41:46.310001 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:41:46.311000 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m16:41:46.385783 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m16:41:46.386783 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m16:41:46.387775 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:41:47.461053 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.073 seconds
[0m16:41:47.467294 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m16:41:47.476933 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:41:47.477932 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:41:47.477932 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:41:49.067074 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.589 seconds
[0m16:41:49.071083 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:41:49.072083 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m16:41:49.248399 [debug] [ThreadPool]: SQL status: SUCCESS 15 in 0.176 seconds
[0m16:41:49.250451 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:41:49.251464 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:41:49.377310 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.126 seconds
[0m16:41:49.381399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62a91fb1-d41d-4bda-a29f-931618c3efc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001606D2FF7D0>]}
[0m16:41:49.384965 [debug] [Thread-1 (]: Began running node model.epicaldemo.fact_sales_transactions_incremental
[0m16:41:49.385972 [info ] [Thread-1 (]: 1 of 1 START sql incremental model broman_analytics.fact_sales_transactions_incremental  [RUN]
[0m16:41:49.386974 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.fact_sales_transactions_incremental'
[0m16:41:49.387965 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.fact_sales_transactions_incremental
[0m16:41:49.399508 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.fact_sales_transactions_incremental"
[0m16:41:49.401422 [debug] [Thread-1 (]: Began executing node model.epicaldemo.fact_sales_transactions_incremental
[0m16:41:49.441994 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m16:41:49.442998 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
create or replace  temporary view EPICALDEMO.broman_analytics.fact_sales_transactions_incremental__dbt_tmp
  
   as (
    

WITH

sales AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__transactions

    
    WHERE UPDATED_AT >= (SELECT MAX(UPDATED_AT) FROM EPICALDEMO.broman_analytics.fact_sales_transactions_incremental)
    
),

items AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__items
),

stores AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__stores
),

customers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_salesforce__customers
),

final AS (
    SELECT
        -- Identifiers
        sales.id
        ,sales.transaction_date_id
        ,sales.updated_at
        ,CONVERT_TIMEZONE('Europe/Stockholm', CURRENT_TIMESTAMP()) AS loaded_at

        ,CASE
            WHEN sales."SKU" IS NULL THEN -2 -- SKU is missing FROM Source
            WHEN items."item_id" IS NULL THEN -1 -- SKU is not known FROM Source
            ELSE items."item_id" -- Use item_id FROM Dim based on SKU
         END AS "item_id"

        ,CASE
            WHEN sales."Store" IS NULL THEN -2
            WHEN stores."store_key" IS NULL THEN -1
            ELSE stores."store_key"
         END AS "store_key"

        ,CASE
            WHEN sales."Customer Number" IS NULL THEN -2
            WHEN customers."customer_id" IS NULL THEN -1
            ELSE customers."customer_id"
         END AS "customer_id"

        -- Metrics
        ,sales."Qty"
        ,sales."Unit Price"
        ,sales."Sales Amount"
        ,sales."Unit Cost"
        ,sales."Cost"
        ,sales."Margin"
    FROM sales
    LEFT JOIN items ON items."SKU" = sales."SKU"
    LEFT JOIN stores ON stores."Store" = sales."Store" AND sales.transaction_date_id >= stores."valid_from" AND sales.transaction_date_id < stores."valid_to"
    LEFT JOIN customers ON customers."Customer Number" = sales."Customer Number"
)

SELECT * FROM final
  );
[0m16:41:49.444061 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:41:50.579869 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.136 seconds
[0m16:41:50.588399 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m16:41:50.589399 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
describe table EPICALDEMO.broman_analytics.fact_sales_transactions_incremental__dbt_tmp
[0m16:41:50.737916 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.148 seconds
[0m16:41:50.740915 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m16:41:50.741915 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
describe table EPICALDEMO.broman_analytics.fact_sales_transactions_incremental
[0m16:41:50.861008 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.118 seconds
[0m16:41:50.867516 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m16:41:50.867516 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."FACT_SALES_TRANSACTIONS_INCREMENTAL"
[0m16:41:51.011421 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.143 seconds
[0m16:41:51.036006 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.fact_sales_transactions_incremental"
[0m16:41:51.038008 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m16:41:51.038008 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
-- back compat for old kwarg name
  
  begin;
[0m16:41:51.208583 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.170 seconds
[0m16:41:51.209575 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m16:41:51.210566 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
merge into EPICALDEMO.broman_analytics.fact_sales_transactions_incremental as DBT_INTERNAL_DEST
        using EPICALDEMO.broman_analytics.fact_sales_transactions_incremental__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.transaction_date_id = DBT_INTERNAL_DEST.transaction_date_id
                ) and (
                    DBT_INTERNAL_SOURCE.item_id = DBT_INTERNAL_DEST.item_id
                ) and (
                    DBT_INTERNAL_SOURCE.store_key = DBT_INTERNAL_DEST.store_key
                ) and (
                    DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
                )

    
    when matched then update set
        "ID" = DBT_INTERNAL_SOURCE."ID","TRANSACTION_DATE_ID" = DBT_INTERNAL_SOURCE."TRANSACTION_DATE_ID","UPDATED_AT" = DBT_INTERNAL_SOURCE."UPDATED_AT","LOADED_AT" = DBT_INTERNAL_SOURCE."LOADED_AT","item_id" = DBT_INTERNAL_SOURCE."item_id","store_key" = DBT_INTERNAL_SOURCE."store_key","customer_id" = DBT_INTERNAL_SOURCE."customer_id","Qty" = DBT_INTERNAL_SOURCE."Qty","Unit Price" = DBT_INTERNAL_SOURCE."Unit Price","Sales Amount" = DBT_INTERNAL_SOURCE."Sales Amount","Unit Cost" = DBT_INTERNAL_SOURCE."Unit Cost","Cost" = DBT_INTERNAL_SOURCE."Cost","Margin" = DBT_INTERNAL_SOURCE."Margin"
    

    when not matched then insert
        ("ID", "TRANSACTION_DATE_ID", "UPDATED_AT", "LOADED_AT", "item_id", "store_key", "customer_id", "Qty", "Unit Price", "Sales Amount", "Unit Cost", "Cost", "Margin")
    values
        ("ID", "TRANSACTION_DATE_ID", "UPDATED_AT", "LOADED_AT", "item_id", "store_key", "customer_id", "Qty", "Unit Price", "Sales Amount", "Unit Cost", "Cost", "Margin")

;
[0m16:41:51.449512 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bd00f1-0004-ce47-0000-d2e90002f872
[0m16:41:51.449512 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 20
invalid identifier 'DBT_INTERNAL_SOURCE.ITEM_ID'
[0m16:41:51.452979 [debug] [Thread-1 (]: Database Error in model fact_sales_transactions_incremental (models\mart\facts\fact_sales_transactions_incremental.sql)
  000904 (42000): SQL compilation error: error line 6 at position 20
  invalid identifier 'DBT_INTERNAL_SOURCE.ITEM_ID'
  compiled code at target\run\epicaldemo\models\mart\facts\fact_sales_transactions_incremental.sql
[0m16:41:51.454995 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62a91fb1-d41d-4bda-a29f-931618c3efc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160726171D0>]}
[0m16:41:51.455985 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model broman_analytics.fact_sales_transactions_incremental  [[31mERROR[0m in 2.07s]
[0m16:41:51.456999 [debug] [Thread-1 (]: Finished running node model.epicaldemo.fact_sales_transactions_incremental
[0m16:41:51.457818 [debug] [Thread-7 (]: Marking all children of 'model.epicaldemo.fact_sales_transactions_incremental' to be skipped because of status 'error'.  Reason: Database Error in model fact_sales_transactions_incremental (models\mart\facts\fact_sales_transactions_incremental.sql)
  000904 (42000): SQL compilation error: error line 6 at position 20
  invalid identifier 'DBT_INTERNAL_SOURCE.ITEM_ID'
  compiled code at target\run\epicaldemo\models\mart\facts\fact_sales_transactions_incremental.sql.
[0m16:41:51.459895 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:41:51.459895 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m16:41:51.460880 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m16:41:51.675074 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m16:41:51.675074 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m16:41:51.885521 [debug] [MainThread]: Connection 'model.epicaldemo.fact_sales_transactions_incremental' was left open.
[0m16:41:51.886595 [debug] [MainThread]: On model.epicaldemo.fact_sales_transactions_incremental: Close
[0m16:41:52.115018 [info ] [MainThread]: 
[0m16:41:52.115998 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 5.81 seconds (5.81s).
[0m16:41:52.117008 [debug] [MainThread]: Command end result
[0m16:41:52.138063 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m16:41:52.141062 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m16:41:52.148111 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m16:41:52.149102 [info ] [MainThread]: 
[0m16:41:52.150101 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:41:52.150101 [info ] [MainThread]: 
[0m16:41:52.151121 [error] [MainThread]:   Database Error in model fact_sales_transactions_incremental (models\mart\facts\fact_sales_transactions_incremental.sql)
  000904 (42000): SQL compilation error: error line 6 at position 20
  invalid identifier 'DBT_INTERNAL_SOURCE.ITEM_ID'
  compiled code at target\run\epicaldemo\models\mart\facts\fact_sales_transactions_incremental.sql
[0m16:41:52.152103 [info ] [MainThread]: 
[0m16:41:52.152103 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:41:52.153629 [debug] [MainThread]: Command `dbt run` failed at 16:41:52.153629 after 6.98 seconds
[0m16:41:52.153629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001606B812E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001606B812F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001606B812290>]}
[0m16:41:52.154649 [debug] [MainThread]: Flushing usage events
[0m16:41:52.834551 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:42:31.976734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146F297D710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146F2975450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146F2976610>]}


============================== 16:42:31.980735 | d0eb244d-7f5f-4c5a-8a56-3673aad3cabb ==============================
[0m16:42:31.980735 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:42:31.981734 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -s fact_sales_transactions_incremental', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:42:32.391400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0eb244d-7f5f-4c5a-8a56-3673aad3cabb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146F3DC1F10>]}
[0m16:42:32.430532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd0eb244d-7f5f-4c5a-8a56-3673aad3cabb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146F3DC2B50>]}
[0m16:42:32.431523 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m16:42:32.731394 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:42:32.911165 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:42:32.911165 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:42:32.917819 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m16:42:32.952976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd0eb244d-7f5f-4c5a-8a56-3673aad3cabb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146F43AEFD0>]}
[0m16:42:33.025197 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m16:42:33.029196 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m16:42:33.048968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd0eb244d-7f5f-4c5a-8a56-3673aad3cabb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146F4705590>]}
[0m16:42:33.049984 [info ] [MainThread]: Found 14 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m16:42:33.049984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0eb244d-7f5f-4c5a-8a56-3673aad3cabb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146F43DC110>]}
[0m16:42:33.051989 [info ] [MainThread]: 
[0m16:42:33.051989 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:42:33.052972 [info ] [MainThread]: 
[0m16:42:33.053501 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:42:33.054533 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m16:42:33.129785 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m16:42:33.129785 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m16:42:33.130792 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:42:34.292997 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.162 seconds
[0m16:42:34.299007 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m16:42:34.308515 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:42:34.308515 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:42:34.309517 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:42:34.971421 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.663 seconds
[0m16:42:34.976141 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:42:34.976141 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m16:42:35.178408 [debug] [ThreadPool]: SQL status: SUCCESS 15 in 0.202 seconds
[0m16:42:35.180038 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:42:35.181109 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:42:35.324472 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.143 seconds
[0m16:42:35.329482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0eb244d-7f5f-4c5a-8a56-3673aad3cabb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146F40A7290>]}
[0m16:42:35.333996 [debug] [Thread-1 (]: Began running node model.epicaldemo.fact_sales_transactions_incremental
[0m16:42:35.333996 [info ] [Thread-1 (]: 1 of 1 START sql incremental model broman_analytics.fact_sales_transactions_incremental  [RUN]
[0m16:42:35.334998 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.fact_sales_transactions_incremental'
[0m16:42:35.335999 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.fact_sales_transactions_incremental
[0m16:42:35.349261 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.fact_sales_transactions_incremental"
[0m16:42:35.351198 [debug] [Thread-1 (]: Began executing node model.epicaldemo.fact_sales_transactions_incremental
[0m16:42:35.393385 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m16:42:35.394402 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
create or replace  temporary view EPICALDEMO.broman_analytics.fact_sales_transactions_incremental__dbt_tmp
  
   as (
    

WITH

sales AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__transactions

    
    WHERE UPDATED_AT >= (SELECT MAX(UPDATED_AT) FROM EPICALDEMO.broman_analytics.fact_sales_transactions_incremental)
    
),

items AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__items
),

stores AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__stores
),

customers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_salesforce__customers
),

final AS (
    SELECT
        -- Identifiers
        sales.id
        ,sales.transaction_date_id
        ,sales.updated_at
        ,CONVERT_TIMEZONE('Europe/Stockholm', CURRENT_TIMESTAMP()) AS loaded_at

        ,CASE
            WHEN sales."SKU" IS NULL THEN -2 -- SKU is missing FROM Source
            WHEN items."item_id" IS NULL THEN -1 -- SKU is not known FROM Source
            ELSE items."item_id" -- Use item_id FROM Dim based on SKU
         END AS item_id

        ,CASE
            WHEN sales."Store" IS NULL THEN -2
            WHEN stores."store_key" IS NULL THEN -1
            ELSE stores."store_key"
         END AS store_key

        ,CASE
            WHEN sales."Customer Number" IS NULL THEN -2
            WHEN customers."customer_id" IS NULL THEN -1
            ELSE customers."customer_id"
         END AS customer_id

        -- Metrics
        ,sales."Qty"
        ,sales."Unit Price"
        ,sales."Sales Amount"
        ,sales."Unit Cost"
        ,sales."Cost"
        ,sales."Margin"
    FROM sales
    LEFT JOIN items ON items."SKU" = sales."SKU"
    LEFT JOIN stores ON stores."Store" = sales."Store" AND sales.transaction_date_id >= stores."valid_from" AND sales.transaction_date_id < stores."valid_to"
    LEFT JOIN customers ON customers."Customer Number" = sales."Customer Number"
)

SELECT * FROM final
  );
[0m16:42:35.395393 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:42:36.403938 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.009 seconds
[0m16:42:36.410937 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m16:42:36.411928 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
describe table EPICALDEMO.broman_analytics.fact_sales_transactions_incremental__dbt_tmp
[0m16:42:36.535433 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.123 seconds
[0m16:42:36.538428 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m16:42:36.539370 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
describe table EPICALDEMO.broman_analytics.fact_sales_transactions_incremental
[0m16:42:36.666978 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.127 seconds
[0m16:42:36.674064 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m16:42:36.675067 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."FACT_SALES_TRANSACTIONS_INCREMENTAL"
[0m16:42:36.817986 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.143 seconds
[0m16:42:36.841257 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.fact_sales_transactions_incremental"
[0m16:42:36.844879 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m16:42:36.844879 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
-- back compat for old kwarg name
  
  begin;
[0m16:42:36.986202 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.141 seconds
[0m16:42:36.987210 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m16:42:36.988217 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
merge into EPICALDEMO.broman_analytics.fact_sales_transactions_incremental as DBT_INTERNAL_DEST
        using EPICALDEMO.broman_analytics.fact_sales_transactions_incremental__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.transaction_date_id = DBT_INTERNAL_DEST.transaction_date_id
                ) and (
                    DBT_INTERNAL_SOURCE.item_id = DBT_INTERNAL_DEST.item_id
                ) and (
                    DBT_INTERNAL_SOURCE.store_key = DBT_INTERNAL_DEST.store_key
                ) and (
                    DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
                )

    
    when matched then update set
        "ID" = DBT_INTERNAL_SOURCE."ID","TRANSACTION_DATE_ID" = DBT_INTERNAL_SOURCE."TRANSACTION_DATE_ID","UPDATED_AT" = DBT_INTERNAL_SOURCE."UPDATED_AT","LOADED_AT" = DBT_INTERNAL_SOURCE."LOADED_AT","item_id" = DBT_INTERNAL_SOURCE."item_id","store_key" = DBT_INTERNAL_SOURCE."store_key","customer_id" = DBT_INTERNAL_SOURCE."customer_id","Qty" = DBT_INTERNAL_SOURCE."Qty","Unit Price" = DBT_INTERNAL_SOURCE."Unit Price","Sales Amount" = DBT_INTERNAL_SOURCE."Sales Amount","Unit Cost" = DBT_INTERNAL_SOURCE."Unit Cost","Cost" = DBT_INTERNAL_SOURCE."Cost","Margin" = DBT_INTERNAL_SOURCE."Margin"
    

    when not matched then insert
        ("ID", "TRANSACTION_DATE_ID", "UPDATED_AT", "LOADED_AT", "item_id", "store_key", "customer_id", "Qty", "Unit Price", "Sales Amount", "Unit Cost", "Cost", "Margin")
    values
        ("ID", "TRANSACTION_DATE_ID", "UPDATED_AT", "LOADED_AT", "item_id", "store_key", "customer_id", "Qty", "Unit Price", "Sales Amount", "Unit Cost", "Cost", "Margin")

;
[0m16:42:37.260633 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bd00f2-0004-ce9e-0000-d2e90002d8b2
[0m16:42:37.261642 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 21 at position 65
invalid identifier '"item_id"'
[0m16:42:37.265177 [debug] [Thread-1 (]: Database Error in model fact_sales_transactions_incremental (models\mart\facts\fact_sales_transactions_incremental.sql)
  000904 (42000): SQL compilation error: error line 21 at position 65
  invalid identifier '"item_id"'
  compiled code at target\run\epicaldemo\models\mart\facts\fact_sales_transactions_incremental.sql
[0m16:42:37.266177 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0eb244d-7f5f-4c5a-8a56-3673aad3cabb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146F29E8710>]}
[0m16:42:37.267178 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model broman_analytics.fact_sales_transactions_incremental  [[31mERROR[0m in 1.93s]
[0m16:42:37.268183 [debug] [Thread-1 (]: Finished running node model.epicaldemo.fact_sales_transactions_incremental
[0m16:42:37.269168 [debug] [Thread-7 (]: Marking all children of 'model.epicaldemo.fact_sales_transactions_incremental' to be skipped because of status 'error'.  Reason: Database Error in model fact_sales_transactions_incremental (models\mart\facts\fact_sales_transactions_incremental.sql)
  000904 (42000): SQL compilation error: error line 21 at position 65
  invalid identifier '"item_id"'
  compiled code at target\run\epicaldemo\models\mart\facts\fact_sales_transactions_incremental.sql.
[0m16:42:37.271183 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:42:37.272172 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m16:42:37.272172 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m16:42:37.487269 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m16:42:37.487269 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m16:42:37.738177 [debug] [MainThread]: Connection 'model.epicaldemo.fact_sales_transactions_incremental' was left open.
[0m16:42:37.738177 [debug] [MainThread]: On model.epicaldemo.fact_sales_transactions_incremental: Close
[0m16:42:37.970120 [info ] [MainThread]: 
[0m16:42:37.972127 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 4.92 seconds (4.92s).
[0m16:42:37.974648 [debug] [MainThread]: Command end result
[0m16:42:37.998186 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m16:42:38.001180 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m16:42:38.006787 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m16:42:38.007691 [info ] [MainThread]: 
[0m16:42:38.007691 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:42:38.008690 [info ] [MainThread]: 
[0m16:42:38.009691 [error] [MainThread]:   Database Error in model fact_sales_transactions_incremental (models\mart\facts\fact_sales_transactions_incremental.sql)
  000904 (42000): SQL compilation error: error line 21 at position 65
  invalid identifier '"item_id"'
  compiled code at target\run\epicaldemo\models\mart\facts\fact_sales_transactions_incremental.sql
[0m16:42:38.009691 [info ] [MainThread]: 
[0m16:42:38.010694 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:42:38.012708 [debug] [MainThread]: Command `dbt run` failed at 16:42:38.011691 after 6.10 seconds
[0m16:42:38.013234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146F29C43D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146ED212E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146F2651C50>]}
[0m16:42:38.014256 [debug] [MainThread]: Flushing usage events
[0m16:42:38.665806 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:46:35.402587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DF3279890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DF3273490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DF3271F50>]}


============================== 16:46:35.406116 | da9a4fb5-a400-45f3-8899-9ffbc29110b2 ==============================
[0m16:46:35.406116 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:46:35.407124 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s stores_snapshot', 'send_anonymous_usage_stats': 'True'}
[0m16:46:35.812603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da9a4fb5-a400-45f3-8899-9ffbc29110b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DF441BB10>]}
[0m16:46:35.854253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da9a4fb5-a400-45f3-8899-9ffbc29110b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DF44315D0>]}
[0m16:46:35.856784 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m16:46:36.149814 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:46:36.331805 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:46:36.332805 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:46:36.337344 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m16:46:36.373470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da9a4fb5-a400-45f3-8899-9ffbc29110b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DF4C14150>]}
[0m16:46:36.444768 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m16:46:36.449217 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m16:46:36.469279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da9a4fb5-a400-45f3-8899-9ffbc29110b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DF4E02B90>]}
[0m16:46:36.469279 [info ] [MainThread]: Found 1 snapshot, 14 models, 8 sources, 1 exposure, 476 macros
[0m16:46:36.470297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da9a4fb5-a400-45f3-8899-9ffbc29110b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DF4E0A650>]}
[0m16:46:36.472296 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:46:36.473287 [debug] [MainThread]: Command end result
[0m16:46:36.493358 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m16:46:36.496886 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m16:46:36.499899 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m16:46:36.501903 [debug] [MainThread]: Command `dbt run` succeeded at 16:46:36.500885 after 1.16 seconds
[0m16:46:36.501903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DF32C5910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DF2B4DC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DF4CF4E90>]}
[0m16:46:36.502886 [debug] [MainThread]: Flushing usage events
[0m16:46:37.302444 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:46:56.302385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224C2295D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224C2294C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224C2297D10>]}


============================== 16:46:56.306921 | cca7a858-d3f0-4844-bf83-b894b1924d21 ==============================
[0m16:46:56.306921 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:46:56.307924 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m16:46:56.700749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cca7a858-d3f0-4844-bf83-b894b1924d21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224C22B5C10>]}
[0m16:46:56.740876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cca7a858-d3f0-4844-bf83-b894b1924d21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224C35AE790>]}
[0m16:46:56.743157 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m16:46:57.040687 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:46:57.228802 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:46:57.229801 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:46:57.235817 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m16:46:57.271032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cca7a858-d3f0-4844-bf83-b894b1924d21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224C3D13150>]}
[0m16:46:57.347233 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m16:46:57.352183 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m16:46:57.381442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cca7a858-d3f0-4844-bf83-b894b1924d21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224C39BA850>]}
[0m16:46:57.382444 [info ] [MainThread]: Found 1 snapshot, 14 models, 8 sources, 1 exposure, 476 macros
[0m16:46:57.383445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cca7a858-d3f0-4844-bf83-b894b1924d21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224C39FF810>]}
[0m16:46:57.384443 [info ] [MainThread]: 
[0m16:46:57.385948 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:46:57.386953 [info ] [MainThread]: 
[0m16:46:57.386953 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:46:57.388961 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m16:46:57.464177 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m16:46:57.464177 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m16:46:57.465680 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:46:58.525763 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.061 seconds
[0m16:46:58.528268 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_EPICALDEMO, now create_EPICALDEMO_broman_analytics)
[0m16:46:58.528268 [debug] [ThreadPool]: Creating schema "database: "EPICALDEMO"
schema: "broman_analytics"
"
[0m16:46:58.532269 [debug] [ThreadPool]: Using snowflake connection "create_EPICALDEMO_broman_analytics"
[0m16:46:58.533268 [debug] [ThreadPool]: On create_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "create_EPICALDEMO_broman_analytics"} */
create schema if not exists EPICALDEMO.broman_analytics
[0m16:46:58.708991 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.176 seconds
[0m16:46:58.713999 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m16:46:58.724533 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:46:58.725529 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:46:58.726045 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:46:59.608563 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.883 seconds
[0m16:46:59.612549 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:46:59.612549 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m16:46:59.768417 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.155 seconds
[0m16:46:59.770416 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:46:59.770416 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:46:59.907709 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.137 seconds
[0m16:46:59.909713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cca7a858-d3f0-4844-bf83-b894b1924d21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224C22B70D0>]}
[0m16:46:59.914712 [debug] [Thread-1 (]: Began running node snapshot.epicaldemo.stores_snapshot
[0m16:46:59.915713 [info ] [Thread-1 (]: 1 of 1 START snapshot broman_analytics.stores_snapshot ......................... [RUN]
[0m16:46:59.916234 [debug] [Thread-1 (]: Acquiring new snowflake connection 'snapshot.epicaldemo.stores_snapshot'
[0m16:46:59.917243 [debug] [Thread-1 (]: Began compiling node snapshot.epicaldemo.stores_snapshot
[0m16:46:59.924241 [debug] [Thread-1 (]: Began executing node snapshot.epicaldemo.stores_snapshot
[0m16:46:59.990640 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m16:46:59.991639 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id,
        modified as dbt_updated_at,
        modified as dbt_valid_from,
        
  
  coalesce(nullif(modified, modified), to_date('9999-12-31'))
  as dbt_valid_to
from (
        select * from EPICALDEMO.d365_fo.store
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m16:46:59.992631 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:47:00.869954 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.878 seconds
[0m16:47:00.874954 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m16:47:00.875953 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m16:47:01.026092 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.150 seconds
[0m16:47:01.026092 [warn ] [Thread-1 (]: Data type of snapshot table timestamp columns (TIMESTAMP_NTZ) doesn't match derived column 'updated_at' (DATE). Please update snapshot config 'updated_at'.
[0m16:47:01.028020 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.epicaldemo.stores_snapshot"
[0m16:47:01.031321 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m16:47:01.032352 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
create or replace transient table EPICALDEMO.broman_analytics.stores_snapshot
    

    
    as (
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id,
        modified as dbt_updated_at,
        modified as dbt_valid_from,
        
  
  coalesce(nullif(modified, modified), to_date('9999-12-31'))
  as dbt_valid_to
from (
        select * from EPICALDEMO.d365_fo.store
    ) sbq



    )
;
[0m16:47:02.474720 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.442 seconds
[0m16:47:02.493795 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cca7a858-d3f0-4844-bf83-b894b1924d21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224C430F690>]}
[0m16:47:02.494799 [info ] [Thread-1 (]: 1 of 1 OK snapshotted broman_analytics.stores_snapshot ......................... [[32mSUCCESS 1[0m in 2.58s]
[0m16:47:02.495784 [debug] [Thread-1 (]: Finished running node snapshot.epicaldemo.stores_snapshot
[0m16:47:02.497952 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:47:02.497952 [debug] [MainThread]: Connection 'create_EPICALDEMO_broman_analytics' was left open.
[0m16:47:02.498953 [debug] [MainThread]: On create_EPICALDEMO_broman_analytics: Close
[0m16:47:03.127566 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m16:47:03.127566 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m16:47:03.342794 [debug] [MainThread]: Connection 'snapshot.epicaldemo.stores_snapshot' was left open.
[0m16:47:03.343832 [debug] [MainThread]: On snapshot.epicaldemo.stores_snapshot: Close
[0m16:47:03.559958 [info ] [MainThread]: 
[0m16:47:03.559958 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 6.17 seconds (6.17s).
[0m16:47:03.561140 [debug] [MainThread]: Command end result
[0m16:47:03.581846 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m16:47:03.584805 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m16:47:03.590022 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m16:47:03.591030 [info ] [MainThread]: 
[0m16:47:03.592033 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:47:03.593013 [info ] [MainThread]: 
[0m16:47:03.594015 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:47:03.596571 [debug] [MainThread]: Command `dbt snapshot` succeeded at 16:47:03.595536 after 7.36 seconds
[0m16:47:03.596571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224C22D7FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224BEFDD010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224BC6F3090>]}
[0m16:47:03.597545 [debug] [MainThread]: Flushing usage events
[0m16:47:04.378395 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:47:47.139573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C7E667BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C7E667710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C7E667990>]}


============================== 16:47:47.143582 | d743ab0c-0b60-40b9-a034-05ac016b7b5a ==============================
[0m16:47:47.143582 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:47:47.144572 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -s stg_d365_fo__categories', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:47:47.534623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd743ab0c-0b60-40b9-a034-05ac016b7b5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C7F8C1210>]}
[0m16:47:47.573754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd743ab0c-0b60-40b9-a034-05ac016b7b5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C7D04F990>]}
[0m16:47:47.575366 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m16:47:47.867166 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:47:48.063487 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:47:48.064487 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:47:48.069016 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m16:47:48.104140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd743ab0c-0b60-40b9-a034-05ac016b7b5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C0010C790>]}
[0m16:47:48.175422 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m16:47:48.179367 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m16:47:48.198450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd743ab0c-0b60-40b9-a034-05ac016b7b5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C7FDC2850>]}
[0m16:47:48.199436 [info ] [MainThread]: Found 1 snapshot, 14 models, 8 sources, 1 exposure, 476 macros
[0m16:47:48.200465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd743ab0c-0b60-40b9-a034-05ac016b7b5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C7FD73250>]}
[0m16:47:48.201476 [info ] [MainThread]: 
[0m16:47:48.202389 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:47:48.202389 [info ] [MainThread]: 
[0m16:47:48.203387 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:47:48.204400 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m16:47:48.295515 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m16:47:48.295515 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m16:47:48.296448 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:47:49.312012 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.015 seconds
[0m16:47:49.318513 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m16:47:49.330025 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:47:49.331025 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:47:49.332027 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:47:49.933652 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.602 seconds
[0m16:47:49.938199 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:47:49.939202 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m16:47:50.066538 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.126 seconds
[0m16:47:50.067536 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:47:50.068554 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:47:50.204090 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.136 seconds
[0m16:47:50.207614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd743ab0c-0b60-40b9-a034-05ac016b7b5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C00229A90>]}
[0m16:47:50.212384 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__categories
[0m16:47:50.212384 [info ] [Thread-1 (]: 1 of 1 START sql view model broman_analytics.stg_d365_fo__categories ........... [RUN]
[0m16:47:50.213392 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__categories'
[0m16:47:50.213392 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__categories
[0m16:47:50.219934 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__categories"
[0m16:47:50.232024 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__categories
[0m16:47:50.259230 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__categories"
[0m16:47:50.263235 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__categories"
[0m16:47:50.264236 [debug] [Thread-1 (]: On model.epicaldemo.stg_d365_fo__categories: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__categories"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__categories
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.category
),

final AS (
    SELECT
        id AS category_id
        ,INITCAP(name) AS "Category"
        ,managerid AS manager_id
    FROM source
)

SELECT * FROM final
  );
[0m16:47:50.264236 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:47:51.165440 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.901 seconds
[0m16:47:51.182973 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd743ab0c-0b60-40b9-a034-05ac016b7b5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C005F7650>]}
[0m16:47:51.183983 [info ] [Thread-1 (]: 1 of 1 OK created sql view model broman_analytics.stg_d365_fo__categories ...... [[32mSUCCESS 1[0m in 0.97s]
[0m16:47:51.185597 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__categories
[0m16:47:51.187530 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:47:51.187530 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m16:47:51.188514 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m16:47:51.613133 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m16:47:51.613133 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m16:47:51.868015 [debug] [MainThread]: Connection 'model.epicaldemo.stg_d365_fo__categories' was left open.
[0m16:47:51.869013 [debug] [MainThread]: On model.epicaldemo.stg_d365_fo__categories: Close
[0m16:47:52.109899 [info ] [MainThread]: 
[0m16:47:52.110899 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.91 seconds (3.91s).
[0m16:47:52.112015 [debug] [MainThread]: Command end result
[0m16:47:52.135560 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m16:47:52.139569 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m16:47:52.147084 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m16:47:52.148086 [info ] [MainThread]: 
[0m16:47:52.149084 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:47:52.149084 [info ] [MainThread]: 
[0m16:47:52.150084 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:47:52.151082 [debug] [MainThread]: Command `dbt run` succeeded at 16:47:52.151082 after 5.07 seconds
[0m16:47:52.152084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C7E6C5D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C7E6B5150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C78924F10>]}
[0m16:47:52.152084 [debug] [MainThread]: Flushing usage events
[0m16:47:52.871981 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:48:00.885586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F3A27A050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F3A271D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F3A2703D0>]}


============================== 16:48:00.889099 | 2cc914dd-39d0-4a91-b603-63a668c7d8f9 ==============================
[0m16:48:00.889099 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:48:00.890099 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s stg_d365_fo__dates', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:48:01.284044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2cc914dd-39d0-4a91-b603-63a668c7d8f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F3B4E3B10>]}
[0m16:48:01.324009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2cc914dd-39d0-4a91-b603-63a668c7d8f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F3B5AD050>]}
[0m16:48:01.325599 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m16:48:01.624234 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:48:01.812442 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:48:01.813442 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:48:01.817986 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m16:48:01.852835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2cc914dd-39d0-4a91-b603-63a668c7d8f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F3B45A290>]}
[0m16:48:01.926495 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m16:48:01.930503 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m16:48:01.949517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2cc914dd-39d0-4a91-b603-63a668c7d8f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F3BC14E90>]}
[0m16:48:01.950529 [info ] [MainThread]: Found 1 snapshot, 14 models, 8 sources, 1 exposure, 476 macros
[0m16:48:01.951509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cc914dd-39d0-4a91-b603-63a668c7d8f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F3B49B250>]}
[0m16:48:01.952511 [info ] [MainThread]: 
[0m16:48:01.953529 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:48:01.954510 [info ] [MainThread]: 
[0m16:48:01.954510 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:48:01.955511 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m16:48:02.049625 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m16:48:02.049625 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m16:48:02.050617 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:48:02.983798 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.934 seconds
[0m16:48:02.989327 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m16:48:02.998827 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:48:02.999827 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:48:02.999827 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:48:03.887427 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.888 seconds
[0m16:48:03.891427 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:48:03.892427 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m16:48:04.113984 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.221 seconds
[0m16:48:04.116494 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:48:04.117503 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:48:04.286892 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.169 seconds
[0m16:48:04.289891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cc914dd-39d0-4a91-b603-63a668c7d8f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F3B47C0D0>]}
[0m16:48:04.293892 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__dates
[0m16:48:04.295452 [info ] [Thread-1 (]: 1 of 1 START sql view model broman_analytics.stg_d365_fo__dates ................ [RUN]
[0m16:48:04.296456 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__dates'
[0m16:48:04.296456 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__dates
[0m16:48:04.302530 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__dates"
[0m16:48:04.303457 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__dates
[0m16:48:04.329131 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__dates"
[0m16:48:04.331125 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__dates"
[0m16:48:04.331125 [debug] [Thread-1 (]: On model.epicaldemo.stg_d365_fo__dates: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__dates"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__dates
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.date
),

final AS (
    SELECT
        id AS date_id
        ,date AS "Date"
        ,year AS "Year"
        ,yearmonth AS "Year Month"
        ,LEFT(id::TEXT, 4) || '-' || RIGHT(id::TEXT, 2) AS "Year Month Number"
        ,monthnumber AS "Month Number"
        ,quarter AS "Quarter"
        ,quarternumber AS "Quarter Number"
        ,monthname AS "Month"
        ,LEFT(monthname,3) AS "Month Short"
    FROM source
)

SELECT * FROM final
  );
[0m16:48:04.332134 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:48:05.212533 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.880 seconds
[0m16:48:05.236659 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cc914dd-39d0-4a91-b603-63a668c7d8f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F3C2F3010>]}
[0m16:48:05.237674 [info ] [Thread-1 (]: 1 of 1 OK created sql view model broman_analytics.stg_d365_fo__dates ........... [[32mSUCCESS 1[0m in 0.94s]
[0m16:48:05.238676 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__dates
[0m16:48:05.240661 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:48:05.240661 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m16:48:05.240661 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m16:48:05.474130 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m16:48:05.474130 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m16:48:05.679594 [debug] [MainThread]: Connection 'model.epicaldemo.stg_d365_fo__dates' was left open.
[0m16:48:05.680593 [debug] [MainThread]: On model.epicaldemo.stg_d365_fo__dates: Close
[0m16:48:05.898869 [info ] [MainThread]: 
[0m16:48:05.899878 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.94 seconds (3.94s).
[0m16:48:05.900869 [debug] [MainThread]: Command end result
[0m16:48:05.922443 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m16:48:05.925962 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m16:48:05.930968 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m16:48:05.931965 [info ] [MainThread]: 
[0m16:48:05.932981 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:48:05.933986 [info ] [MainThread]: 
[0m16:48:05.933986 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:48:05.935490 [debug] [MainThread]: Command `dbt run` succeeded at 16:48:05.935490 after 5.11 seconds
[0m16:48:05.935490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F3A2C6050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F39EA0E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F3467CB10>]}
[0m16:48:05.936510 [debug] [MainThread]: Flushing usage events
[0m16:48:06.680210 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:48:33.277234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C1507D510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C1507D5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C1507E090>]}


============================== 16:48:33.280225 | e4cca608-ea35-4bb5-9ae3-915bc9975457 ==============================
[0m16:48:33.280225 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:48:33.282226 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -s stg_d365_fo__items', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:48:33.656514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e4cca608-ea35-4bb5-9ae3-915bc9975457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C162E5190>]}
[0m16:48:33.696637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e4cca608-ea35-4bb5-9ae3-915bc9975457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C150E6A50>]}
[0m16:48:33.698087 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m16:48:33.989918 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:48:34.185205 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:48:34.186218 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:48:34.192220 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m16:48:34.228873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e4cca608-ea35-4bb5-9ae3-915bc9975457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C16B02F10>]}
[0m16:48:34.304249 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m16:48:34.307708 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m16:48:34.328757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e4cca608-ea35-4bb5-9ae3-915bc9975457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C167B7A90>]}
[0m16:48:34.329760 [info ] [MainThread]: Found 1 snapshot, 14 models, 8 sources, 1 exposure, 476 macros
[0m16:48:34.329760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4cca608-ea35-4bb5-9ae3-915bc9975457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C13A4C590>]}
[0m16:48:34.331759 [info ] [MainThread]: 
[0m16:48:34.331759 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:48:34.332759 [info ] [MainThread]: 
[0m16:48:34.333761 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:48:34.333761 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m16:48:34.417029 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m16:48:34.418029 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m16:48:34.419021 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:48:35.417535 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.999 seconds
[0m16:48:35.422543 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m16:48:35.432056 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:48:35.432056 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:48:35.433059 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:48:36.117121 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.684 seconds
[0m16:48:36.121136 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:48:36.122165 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m16:48:36.270307 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.148 seconds
[0m16:48:36.271305 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:48:36.272305 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:48:36.415315 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.143 seconds
[0m16:48:36.417672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4cca608-ea35-4bb5-9ae3-915bc9975457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C16369050>]}
[0m16:48:36.423013 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__items
[0m16:48:36.424019 [info ] [Thread-1 (]: 1 of 1 START sql view model broman_analytics.stg_d365_fo__items ................ [RUN]
[0m16:48:36.424019 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__items'
[0m16:48:36.424019 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__items
[0m16:48:36.430555 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__items"
[0m16:48:36.432547 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__items
[0m16:48:36.456586 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__items"
[0m16:48:36.468430 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__items"
[0m16:48:36.469451 [debug] [Thread-1 (]: On model.epicaldemo.stg_d365_fo__items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__items"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__items
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.item
),

final AS (
    SELECT
        id AS item_id
        ,name AS "Item"
        ,COALESCE(brand, 'Missing') AS "Brand"
        ,categoryid AS category_id
        ,COALESCE(flavor, 'Missing') AS "Flavor"
        ,sku AS "SKU"
    FROM source
)

SELECT * FROM final
  );
[0m16:48:36.470429 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:48:37.402957 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.933 seconds
[0m16:48:37.419311 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4cca608-ea35-4bb5-9ae3-915bc9975457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C162AAF90>]}
[0m16:48:37.420255 [info ] [Thread-1 (]: 1 of 1 OK created sql view model broman_analytics.stg_d365_fo__items ........... [[32mSUCCESS 1[0m in 0.99s]
[0m16:48:37.420255 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__items
[0m16:48:37.422256 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:48:37.423319 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m16:48:37.423319 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m16:48:37.646983 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m16:48:37.647999 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m16:48:37.872366 [debug] [MainThread]: Connection 'model.epicaldemo.stg_d365_fo__items' was left open.
[0m16:48:37.873365 [debug] [MainThread]: On model.epicaldemo.stg_d365_fo__items: Close
[0m16:48:38.110975 [info ] [MainThread]: 
[0m16:48:38.111974 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.78 seconds (3.78s).
[0m16:48:38.112986 [debug] [MainThread]: Command end result
[0m16:48:38.138565 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m16:48:38.142583 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m16:48:38.149118 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m16:48:38.150120 [info ] [MainThread]: 
[0m16:48:38.151120 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:48:38.151120 [info ] [MainThread]: 
[0m16:48:38.152120 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:48:38.154120 [debug] [MainThread]: Command `dbt run` succeeded at 16:48:38.153119 after 4.94 seconds
[0m16:48:38.154120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C150D2310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C1494DB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C0F324E90>]}
[0m16:48:38.155129 [debug] [MainThread]: Flushing usage events
[0m16:48:38.847409 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:48:44.662223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002601886BE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026018871FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026018873F90>]}


============================== 16:48:44.665752 | d81028ca-5db0-4f56-90d9-b687a17b49ff ==============================
[0m16:48:44.665752 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:48:44.666760 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -s stg_d365_fo__managers', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:48:45.068460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd81028ca-5db0-4f56-90d9-b687a17b49ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002601726DAD0>]}
[0m16:48:45.107584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd81028ca-5db0-4f56-90d9-b687a17b49ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002601724F990>]}
[0m16:48:45.109590 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m16:48:45.399917 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:48:45.577498 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:48:45.578498 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:48:45.583498 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m16:48:45.618613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd81028ca-5db0-4f56-90d9-b687a17b49ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002601A2AB0D0>]}
[0m16:48:45.690869 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m16:48:45.695375 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m16:48:45.713928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd81028ca-5db0-4f56-90d9-b687a17b49ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026019FC1D90>]}
[0m16:48:45.715433 [info ] [MainThread]: Found 1 snapshot, 14 models, 8 sources, 1 exposure, 476 macros
[0m16:48:45.716437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd81028ca-5db0-4f56-90d9-b687a17b49ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026019F73250>]}
[0m16:48:45.717442 [info ] [MainThread]: 
[0m16:48:45.718454 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:48:45.719438 [info ] [MainThread]: 
[0m16:48:45.719438 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:48:45.720455 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m16:48:45.802233 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m16:48:45.802233 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m16:48:45.803240 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:48:46.657664 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.854 seconds
[0m16:48:46.662671 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m16:48:46.671197 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:48:46.671197 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:48:46.672196 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:48:47.547440 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.876 seconds
[0m16:48:47.552956 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:48:47.553956 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m16:48:47.739537 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.185 seconds
[0m16:48:47.740537 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:48:47.741537 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:48:47.972223 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.230 seconds
[0m16:48:47.974238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd81028ca-5db0-4f56-90d9-b687a17b49ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026019F73250>]}
[0m16:48:47.979532 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__managers
[0m16:48:47.980541 [info ] [Thread-1 (]: 1 of 1 START sql view model broman_analytics.stg_d365_fo__managers ............. [RUN]
[0m16:48:47.981532 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__managers'
[0m16:48:47.981532 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__managers
[0m16:48:47.987606 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__managers"
[0m16:48:47.989594 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__managers
[0m16:48:48.013677 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__managers"
[0m16:48:48.016219 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__managers"
[0m16:48:48.016219 [debug] [Thread-1 (]: On model.epicaldemo.stg_d365_fo__managers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__managers"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__managers
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.manager
),

final AS (
    SELECT
        id AS manager_id
        ,firstname || ' ' || lastname AS "Manager"
    FROM source
)

SELECT * FROM final
  );
[0m16:48:48.017219 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:48:49.181116 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.163 seconds
[0m16:48:49.202181 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd81028ca-5db0-4f56-90d9-b687a17b49ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026019B119D0>]}
[0m16:48:49.203184 [info ] [Thread-1 (]: 1 of 1 OK created sql view model broman_analytics.stg_d365_fo__managers ........ [[32mSUCCESS 1[0m in 1.22s]
[0m16:48:49.204173 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__managers
[0m16:48:49.206413 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:48:49.206413 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m16:48:49.207412 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m16:48:49.463433 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m16:48:49.464415 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m16:48:49.681428 [debug] [MainThread]: Connection 'model.epicaldemo.stg_d365_fo__managers' was left open.
[0m16:48:49.681428 [debug] [MainThread]: On model.epicaldemo.stg_d365_fo__managers: Close
[0m16:48:49.918243 [info ] [MainThread]: 
[0m16:48:49.919225 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.20 seconds (4.20s).
[0m16:48:49.920216 [debug] [MainThread]: Command end result
[0m16:48:49.942273 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m16:48:49.945273 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m16:48:49.950331 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m16:48:49.951837 [info ] [MainThread]: 
[0m16:48:49.952845 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:48:49.952845 [info ] [MainThread]: 
[0m16:48:49.953842 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:48:49.955349 [debug] [MainThread]: Command `dbt run` succeeded at 16:48:49.955349 after 5.36 seconds
[0m16:48:49.956357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026012B24F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026012C72E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026012C72210>]}
[0m16:48:49.957354 [debug] [MainThread]: Flushing usage events
[0m16:48:50.649114 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:48:56.622256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225C3F7D9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225C3F7D4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225C3DB4E50>]}


============================== 16:48:56.625768 | 0a844d66-757c-4929-b99b-6d2b50ab3571 ==============================
[0m16:48:56.625768 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:48:56.626773 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s stg_d365_fo__stores', 'send_anonymous_usage_stats': 'True'}
[0m16:48:57.032100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a844d66-757c-4929-b99b-6d2b50ab3571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225C53E3D10>]}
[0m16:48:57.073715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a844d66-757c-4929-b99b-6d2b50ab3571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225C5331AD0>]}
[0m16:48:57.076227 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m16:48:57.379303 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:48:57.566148 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:48:57.567151 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:48:57.572147 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m16:48:57.607246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a844d66-757c-4929-b99b-6d2b50ab3571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225C5914050>]}
[0m16:48:57.680174 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m16:48:57.683178 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m16:48:57.702757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a844d66-757c-4929-b99b-6d2b50ab3571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225C58F3B10>]}
[0m16:48:57.703757 [info ] [MainThread]: Found 1 snapshot, 14 models, 8 sources, 1 exposure, 476 macros
[0m16:48:57.703757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a844d66-757c-4929-b99b-6d2b50ab3571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225C58BE390>]}
[0m16:48:57.706271 [info ] [MainThread]: 
[0m16:48:57.706271 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:48:57.707268 [info ] [MainThread]: 
[0m16:48:57.707268 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:48:57.708269 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m16:48:57.789908 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m16:48:57.790905 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m16:48:57.790905 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:48:58.878240 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.087 seconds
[0m16:48:58.883238 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m16:48:58.893257 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:48:58.893257 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:48:58.894256 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:48:59.822224 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.928 seconds
[0m16:48:59.825737 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:48:59.827222 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m16:49:00.008737 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.181 seconds
[0m16:49:00.010661 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:49:00.011654 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:49:00.156293 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.144 seconds
[0m16:49:00.158802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a844d66-757c-4929-b99b-6d2b50ab3571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225C5D2B110>]}
[0m16:49:00.163874 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__stores
[0m16:49:00.165434 [info ] [Thread-1 (]: 1 of 1 START sql view model broman_analytics.stg_d365_fo__stores ............... [RUN]
[0m16:49:00.166392 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__stores'
[0m16:49:00.166392 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__stores
[0m16:49:00.173393 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__stores"
[0m16:49:00.174406 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__stores
[0m16:49:00.199960 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__stores"
[0m16:49:00.202053 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__stores"
[0m16:49:00.203063 [debug] [Thread-1 (]: On model.epicaldemo.stg_d365_fo__stores: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__stores"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__stores
  
   as (
    WITH

stores_snapshots AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stores_snapshot
),

final AS (
    SELECT
        -- Identifiers
        id AS store_id

        -- SCD2 Fields
        ,dbt_scd_id
        ,ROW_NUMBER() OVER (ORDER BY id ASC, dbt_valid_from ASC) AS store_key
        ,CASE WHEN dbt_valid_to = '9999-12-31' THEN 1 ELSE 0 END AS is_current
        ,modified AS "modified"
        ,CAST(TO_CHAR(dbt_valid_from::DATE, 'YYYYMMDD') AS INTEGER) AS valid_from
        ,CAST(TO_CHAR(dbt_valid_to::DATE, 'YYYYMMDD') AS INTEGER) AS valid_to

        -- Attributes
        ,name AS "Store"
        ,SPLIT_PART(location, ',', 1) AS "Store State"
        ,SPLIT_PART(location, ',', 2) AS "Store City"
        ,latitude AS "Lat"
        ,longitude AS "Lon"
        ,onlinepresence AS "Online Presence"
    FROM stores_snapshots
)

SELECT * FROM final
  );
[0m16:49:00.203063 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:49:01.225186 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.021 seconds
[0m16:49:01.240633 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a844d66-757c-4929-b99b-6d2b50ab3571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225C642B810>]}
[0m16:49:01.241633 [info ] [Thread-1 (]: 1 of 1 OK created sql view model broman_analytics.stg_d365_fo__stores .......... [[32mSUCCESS 1[0m in 1.07s]
[0m16:49:01.242636 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__stores
[0m16:49:01.245145 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:49:01.245145 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m16:49:01.246150 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m16:49:01.561280 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m16:49:01.562287 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m16:49:01.787767 [debug] [MainThread]: Connection 'model.epicaldemo.stg_d365_fo__stores' was left open.
[0m16:49:01.788761 [debug] [MainThread]: On model.epicaldemo.stg_d365_fo__stores: Close
[0m16:49:02.023261 [info ] [MainThread]: 
[0m16:49:02.023261 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.32 seconds (4.32s).
[0m16:49:02.025255 [debug] [MainThread]: Command end result
[0m16:49:02.045314 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m16:49:02.048830 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m16:49:02.055420 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m16:49:02.056339 [info ] [MainThread]: 
[0m16:49:02.057342 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:49:02.058344 [info ] [MainThread]: 
[0m16:49:02.058855 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:49:02.059859 [debug] [MainThread]: Command `dbt run` succeeded at 16:49:02.059859 after 5.50 seconds
[0m16:49:02.059859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225C3F75C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225BE861250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225BE812E10>]}
[0m16:49:02.060877 [debug] [MainThread]: Flushing usage events
[0m16:49:02.862184 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:49:10.704889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000124D367D1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000124D367D7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000124D367D110>]}


============================== 16:49:10.708894 | e692006f-3469-4558-977e-45648f1e4e8a ==============================
[0m16:49:10.708894 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:49:10.709895 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -s stg_d365_fo__transactions', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:49:11.135553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e692006f-3469-4558-977e-45648f1e4e8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000124D4969CD0>]}
[0m16:49:11.177124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e692006f-3469-4558-977e-45648f1e4e8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000124D204F910>]}
[0m16:49:11.179130 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m16:49:11.497609 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:49:11.690093 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:49:11.691093 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:49:11.695602 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m16:49:11.739788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e692006f-3469-4558-977e-45648f1e4e8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000124D50B2F10>]}
[0m16:49:11.815010 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m16:49:11.818929 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m16:49:11.838978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e692006f-3469-4558-977e-45648f1e4e8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000124D5200750>]}
[0m16:49:11.838978 [info ] [MainThread]: Found 1 snapshot, 14 models, 8 sources, 1 exposure, 476 macros
[0m16:49:11.839956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e692006f-3469-4558-977e-45648f1e4e8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000124D4968510>]}
[0m16:49:11.841960 [info ] [MainThread]: 
[0m16:49:11.841960 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:49:11.842954 [info ] [MainThread]: 
[0m16:49:11.842954 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:49:11.843957 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m16:49:11.964000 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m16:49:11.964000 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m16:49:11.965007 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:49:12.905448 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.940 seconds
[0m16:49:12.911460 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m16:49:12.921994 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:49:12.922978 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:49:12.923976 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:49:13.693874 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.771 seconds
[0m16:49:13.698417 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:49:13.698417 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m16:49:13.859117 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.159 seconds
[0m16:49:13.861117 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:49:13.861117 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:49:13.983262 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.121 seconds
[0m16:49:13.985776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e692006f-3469-4558-977e-45648f1e4e8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000124D510DA50>]}
[0m16:49:13.990768 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__transactions
[0m16:49:13.991776 [info ] [Thread-1 (]: 1 of 1 START sql view model broman_analytics.stg_d365_fo__transactions ......... [RUN]
[0m16:49:13.992779 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__transactions'
[0m16:49:13.992779 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__transactions
[0m16:49:13.999321 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__transactions"
[0m16:49:14.000320 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__transactions
[0m16:49:14.024932 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__transactions"
[0m16:49:14.026890 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__transactions"
[0m16:49:14.027892 [debug] [Thread-1 (]: On model.epicaldemo.stg_d365_fo__transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__transactions"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__transactions
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.transactions
),

final AS (
    SELECT
        -- Identifiers
        id
        ,updated_at
        ,CAST(TO_CHAR(transaction_date::DATE, 'YYYYMMDD') AS INTEGER) AS transaction_date_id
        ,sku AS "SKU"
        ,store AS "Store"
        ,customernumber AS "Customer Number"

        -- Metrics
        ,quantity AS "Qty"
        ,unitprice::NUMERIC(10,2) AS "Unit Price"
        ,(quantity * unitprice)::NUMERIC(10,2) AS "Sales Amount"
        ,unitcost::NUMERIC(10,2) AS "Unit Cost"
        ,(quantity * unitcost)::NUMERIC(10,2) AS "Cost"
        ,(quantity * unitprice)::NUMERIC(10,2) - (quantity * unitcost)::NUMERIC(10,2) AS "Margin"
    FROM source
)

SELECT * FROM final
  );
[0m16:49:14.027892 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:49:15.170560 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.142 seconds
[0m16:49:15.187794 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e692006f-3469-4558-977e-45648f1e4e8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000124D36827D0>]}
[0m16:49:15.188796 [info ] [Thread-1 (]: 1 of 1 OK created sql view model broman_analytics.stg_d365_fo__transactions .... [[32mSUCCESS 1[0m in 1.19s]
[0m16:49:15.189798 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__transactions
[0m16:49:15.191797 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:49:15.191797 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m16:49:15.192805 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m16:49:15.437030 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m16:49:15.437030 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m16:49:15.650629 [debug] [MainThread]: Connection 'model.epicaldemo.stg_d365_fo__transactions' was left open.
[0m16:49:15.650629 [debug] [MainThread]: On model.epicaldemo.stg_d365_fo__transactions: Close
[0m16:49:15.884009 [info ] [MainThread]: 
[0m16:49:15.885048 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.04 seconds (4.04s).
[0m16:49:15.886053 [debug] [MainThread]: Command end result
[0m16:49:15.907124 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m16:49:15.909128 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m16:49:15.915130 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m16:49:15.915637 [info ] [MainThread]: 
[0m16:49:15.916641 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:49:15.917645 [info ] [MainThread]: 
[0m16:49:15.917645 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:49:15.919659 [debug] [MainThread]: Command `dbt run` succeeded at 16:49:15.918642 after 5.28 seconds
[0m16:49:15.919659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000124D3395A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000124CDAC1250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000124D21B9750>]}
[0m16:49:15.920641 [debug] [MainThread]: Flushing usage events
[0m16:49:16.537144 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:50:25.619448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACB40732D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACB4073050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACB4073510>]}


============================== 16:50:25.622447 | 3631fe96-c47b-4d91-82d4-f2ba15619bf5 ==============================
[0m16:50:25.622447 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:50:25.623455 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -s stg_d365_fo__stores', 'send_anonymous_usage_stats': 'True'}
[0m16:50:26.025877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3631fe96-c47b-4d91-82d4-f2ba15619bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACB4070A90>]}
[0m16:50:26.066541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3631fe96-c47b-4d91-82d4-f2ba15619bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACB2A4F9D0>]}
[0m16:50:26.067532 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m16:50:26.357498 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:50:26.546685 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:50:26.546685 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:50:26.552683 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m16:50:26.590802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3631fe96-c47b-4d91-82d4-f2ba15619bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACB525E150>]}
[0m16:50:26.667333 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m16:50:26.672335 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m16:50:26.692377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3631fe96-c47b-4d91-82d4-f2ba15619bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACB57BD250>]}
[0m16:50:26.692377 [info ] [MainThread]: Found 1 snapshot, 14 models, 8 sources, 1 exposure, 476 macros
[0m16:50:26.693377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3631fe96-c47b-4d91-82d4-f2ba15619bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACB40A16D0>]}
[0m16:50:26.694883 [info ] [MainThread]: 
[0m16:50:26.695902 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:50:26.696889 [info ] [MainThread]: 
[0m16:50:26.696889 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:50:26.697887 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m16:50:26.780679 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m16:50:26.781690 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m16:50:26.782241 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:50:28.196548 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.415 seconds
[0m16:50:28.202709 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m16:50:28.211426 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:50:28.211426 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:50:28.212384 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:50:29.155975 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.944 seconds
[0m16:50:29.159967 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:50:29.160967 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m16:50:29.327125 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.165 seconds
[0m16:50:29.329115 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:50:29.329115 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:50:29.468823 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.139 seconds
[0m16:50:29.470893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3631fe96-c47b-4d91-82d4-f2ba15619bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACB5A084D0>]}
[0m16:50:29.476216 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__stores
[0m16:50:29.477208 [info ] [Thread-1 (]: 1 of 1 START sql view model broman_analytics.stg_d365_fo__stores ............... [RUN]
[0m16:50:29.478208 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__stores'
[0m16:50:29.479221 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__stores
[0m16:50:29.485729 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__stores"
[0m16:50:29.486729 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__stores
[0m16:50:29.514645 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__stores"
[0m16:50:29.516650 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__stores"
[0m16:50:29.517654 [debug] [Thread-1 (]: On model.epicaldemo.stg_d365_fo__stores: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__stores"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__stores
  
   as (
    WITH

stores_snapshots AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stores_snapshot
),

final AS (
    SELECT
        -- Identifiers
        id AS store_id

        -- SCD2 Fields
        ,dbt_scd_id
        ,ROW_NUMBER() OVER (ORDER BY id ASC, dbt_valid_from ASC) AS store_key
        ,CASE WHEN dbt_valid_to = '9999-12-31' THEN 1 ELSE 0 END AS is_current
        ,modified
        ,CAST(TO_CHAR(dbt_valid_from::DATE, 'YYYYMMDD') AS INTEGER) AS valid_from
        ,CAST(TO_CHAR(dbt_valid_to::DATE, 'YYYYMMDD') AS INTEGER) AS valid_to

        -- Attributes
        ,name AS "Store"
        ,SPLIT_PART(location, ',', 1) AS "Store State"
        ,SPLIT_PART(location, ',', 2) AS "Store City"
        ,latitude AS "Lat"
        ,longitude AS "Lon"
        ,onlinepresence AS "Online Presence"
    FROM stores_snapshots
)

SELECT * FROM final
  );
[0m16:50:29.518670 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:50:30.466235 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.948 seconds
[0m16:50:30.485542 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3631fe96-c47b-4d91-82d4-f2ba15619bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACB5BE3810>]}
[0m16:50:30.486569 [info ] [Thread-1 (]: 1 of 1 OK created sql view model broman_analytics.stg_d365_fo__stores .......... [[32mSUCCESS 1[0m in 1.01s]
[0m16:50:30.487560 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__stores
[0m16:50:30.489549 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:50:30.490638 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m16:50:30.491554 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m16:50:30.806880 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m16:50:30.808801 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m16:50:31.169593 [debug] [MainThread]: Connection 'model.epicaldemo.stg_d365_fo__stores' was left open.
[0m16:50:31.170562 [debug] [MainThread]: On model.epicaldemo.stg_d365_fo__stores: Close
[0m16:50:31.456573 [info ] [MainThread]: 
[0m16:50:31.457856 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.76 seconds (4.76s).
[0m16:50:31.458972 [debug] [MainThread]: Command end result
[0m16:50:31.481048 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m16:50:31.483029 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m16:50:31.488622 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m16:50:31.489553 [info ] [MainThread]: 
[0m16:50:31.489553 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:50:31.490548 [info ] [MainThread]: 
[0m16:50:31.490548 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:50:31.492915 [debug] [MainThread]: Command `dbt run` succeeded at 16:50:31.492915 after 5.93 seconds
[0m16:50:31.493913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACAE47CB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACB3CB5410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACB3CB5290>]}
[0m16:50:31.494914 [debug] [MainThread]: Flushing usage events
[0m16:50:32.300013 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:52:46.485227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001731AE7D710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001731AE71DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001731AE71210>]}


============================== 16:52:46.489238 | b0c1f06e-09e7-4a9c-84f8-06fe862d4d12 ==============================
[0m16:52:46.489238 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:52:46.490238 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s stg_d365_fo__customers', 'send_anonymous_usage_stats': 'True'}
[0m16:52:46.877534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0c1f06e-09e7-4a9c-84f8-06fe862d4d12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017316AE81D0>]}
[0m16:52:46.916658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b0c1f06e-09e7-4a9c-84f8-06fe862d4d12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001731984FB10>]}
[0m16:52:46.917649 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m16:52:47.211199 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:52:47.392589 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:52:47.392589 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:52:47.398107 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m16:52:47.431707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0c1f06e-09e7-4a9c-84f8-06fe862d4d12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001731C8B2F10>]}
[0m16:52:47.505539 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m16:52:47.509543 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m16:52:47.528606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0c1f06e-09e7-4a9c-84f8-06fe862d4d12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001731CA0BB50>]}
[0m16:52:47.529606 [info ] [MainThread]: Found 1 snapshot, 14 models, 8 sources, 1 exposure, 476 macros
[0m16:52:47.530604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0c1f06e-09e7-4a9c-84f8-06fe862d4d12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001731C167B50>]}
[0m16:52:47.530604 [warn ] [MainThread]: The selection criterion 'stg_d365_fo__customers' does not match any enabled nodes
[0m16:52:47.532607 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:52:47.534113 [debug] [MainThread]: Command end result
[0m16:52:47.555643 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m16:52:47.558648 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m16:52:47.561644 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m16:52:47.562644 [debug] [MainThread]: Command `dbt run` succeeded at 16:52:47.562644 after 1.14 seconds
[0m16:52:47.564154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001731AEB8BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001731AEB9350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173152F3010>]}
[0m16:52:47.564154 [debug] [MainThread]: Flushing usage events
[0m16:52:48.389367 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:52:58.480927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213BA57A210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213BA5BBA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213BA5B9710>]}


============================== 16:52:58.484422 | 940114f6-9e6b-4c8f-99f8-97c5e6456c39 ==============================
[0m16:52:58.484422 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:52:58.485426 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -s stg_salesforce__customers', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:52:58.866392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '940114f6-9e6b-4c8f-99f8-97c5e6456c39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213BA573490>]}
[0m16:52:58.905520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '940114f6-9e6b-4c8f-99f8-97c5e6456c39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213B8D4F910>]}
[0m16:52:58.907514 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m16:52:59.220471 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:52:59.399681 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:52:59.400681 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:52:59.406590 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m16:52:59.441550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '940114f6-9e6b-4c8f-99f8-97c5e6456c39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213BBA50710>]}
[0m16:52:59.516265 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m16:52:59.520267 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m16:52:59.540294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '940114f6-9e6b-4c8f-99f8-97c5e6456c39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213BBEBDC90>]}
[0m16:52:59.541294 [info ] [MainThread]: Found 1 snapshot, 14 models, 8 sources, 1 exposure, 476 macros
[0m16:52:59.542353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '940114f6-9e6b-4c8f-99f8-97c5e6456c39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213BB9C3250>]}
[0m16:52:59.544862 [info ] [MainThread]: 
[0m16:52:59.544862 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:52:59.545788 [info ] [MainThread]: 
[0m16:52:59.546806 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:52:59.547801 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m16:52:59.630581 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m16:52:59.631582 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m16:52:59.632573 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:53:00.680266 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.048 seconds
[0m16:53:00.685775 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m16:53:00.695316 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:53:00.695316 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:53:00.695316 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:53:01.446765 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.751 seconds
[0m16:53:01.451764 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:53:01.451764 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m16:53:01.624489 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.172 seconds
[0m16:53:01.626510 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:53:01.627500 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:53:01.765929 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.138 seconds
[0m16:53:01.768917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '940114f6-9e6b-4c8f-99f8-97c5e6456c39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213BC2E3B10>]}
[0m16:53:01.772929 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_salesforce__customers
[0m16:53:01.772929 [info ] [Thread-1 (]: 1 of 1 START sql view model broman_analytics.stg_salesforce__customers ......... [RUN]
[0m16:53:01.773917 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_salesforce__customers'
[0m16:53:01.773917 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_salesforce__customers
[0m16:53:01.781066 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_salesforce__customers"
[0m16:53:01.782067 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_salesforce__customers
[0m16:53:01.820234 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.stg_salesforce__customers"
[0m16:53:01.822232 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.stg_salesforce__customers"
[0m16:53:01.823286 [debug] [Thread-1 (]: On model.epicaldemo.stg_salesforce__customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_salesforce__customers"} */
create or replace   view EPICALDEMO.broman_analytics.stg_salesforce__customers
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.salesforce.customer
),

final AS (
    SELECT
        id AS customer_id
        ,customernumber AS "Customer Number"
        ,age AS "Customer Age"

        ,CASE
            WHEN age < 20 THEN '< 20'
            WHEN age >= 20 AND age < 30 THEN '20 - 30'
            WHEN age >= 30 AND age < 50 THEN '30 - 50'
            WHEN age >= 50 AND age < 60 THEN '50 - 60'
            ELSE '60+'
         END AS "Customer Age Group"

        ,CASE
            WHEN age < 20 THEN 1
            WHEN age >= 20 AND age < 30 THEN 2
            WHEN age >= 30 AND age < 50 THEN 3
            WHEN age >= 50 AND age < 60 THEN 4
            ELSE 5
         END AS customer_age_group_sort

        ,state AS "Customer State"
    FROM source
)

SELECT * FROM final
  );
[0m16:53:01.824237 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:53:02.833226 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.009 seconds
[0m16:53:02.849299 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '940114f6-9e6b-4c8f-99f8-97c5e6456c39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213BBEB4450>]}
[0m16:53:02.850299 [info ] [Thread-1 (]: 1 of 1 OK created sql view model broman_analytics.stg_salesforce__customers .... [[32mSUCCESS 1[0m in 1.07s]
[0m16:53:02.851291 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_salesforce__customers
[0m16:53:02.852304 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:53:02.853879 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m16:53:02.853879 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m16:53:03.085408 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m16:53:03.086416 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m16:53:03.300655 [debug] [MainThread]: Connection 'model.epicaldemo.stg_salesforce__customers' was left open.
[0m16:53:03.301651 [debug] [MainThread]: On model.epicaldemo.stg_salesforce__customers: Close
[0m16:53:03.718964 [info ] [MainThread]: 
[0m16:53:03.720947 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.17 seconds (4.17s).
[0m16:53:03.721885 [debug] [MainThread]: Command end result
[0m16:53:03.748212 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m16:53:03.750275 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m16:53:03.756045 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m16:53:03.757055 [info ] [MainThread]: 
[0m16:53:03.758045 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:53:03.759045 [info ] [MainThread]: 
[0m16:53:03.760044 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:53:03.761049 [debug] [MainThread]: Command `dbt run` succeeded at 16:53:03.760044 after 5.34 seconds
[0m16:53:03.761049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213B4E61250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213B4A24E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213BA56B490>]}
[0m16:53:03.762049 [debug] [MainThread]: Flushing usage events
[0m16:53:04.417384 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:53:17.975825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C0627D810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C0627C9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C0627D750>]}


============================== 16:53:17.979905 | 466a7bc7-85b5-4270-ba59-5db5f285d271 ==============================
[0m16:53:17.979905 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:53:17.980933 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s stg_inriver__item_attributes', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:53:18.386487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '466a7bc7-85b5-4270-ba59-5db5f285d271', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C075688D0>]}
[0m16:53:18.426615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '466a7bc7-85b5-4270-ba59-5db5f285d271', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C04C4FA10>]}
[0m16:53:18.428606 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m16:53:18.732151 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:53:18.920977 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:53:18.921978 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:53:18.927495 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m16:53:18.962309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '466a7bc7-85b5-4270-ba59-5db5f285d271', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C07CE4790>]}
[0m16:53:19.036604 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m16:53:19.041594 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m16:53:19.066734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '466a7bc7-85b5-4270-ba59-5db5f285d271', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C079D8250>]}
[0m16:53:19.067816 [info ] [MainThread]: Found 1 snapshot, 14 models, 8 sources, 1 exposure, 476 macros
[0m16:53:19.068780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '466a7bc7-85b5-4270-ba59-5db5f285d271', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C07550D10>]}
[0m16:53:19.069830 [info ] [MainThread]: 
[0m16:53:19.071431 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:53:19.071431 [info ] [MainThread]: 
[0m16:53:19.072439 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:53:19.073959 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m16:53:19.166022 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m16:53:19.167020 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m16:53:19.167020 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:53:20.249556 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.083 seconds
[0m16:53:20.256071 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m16:53:20.265607 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:53:20.265607 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:53:20.266613 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:53:21.044154 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.778 seconds
[0m16:53:21.048165 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:53:21.049166 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m16:53:21.242297 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.193 seconds
[0m16:53:21.244809 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:53:21.244809 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:53:21.385009 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.140 seconds
[0m16:53:21.388009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '466a7bc7-85b5-4270-ba59-5db5f285d271', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C07CDF250>]}
[0m16:53:21.392010 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_inriver__item_attributes
[0m16:53:21.394009 [info ] [Thread-1 (]: 1 of 1 START sql view model broman_analytics.stg_inriver__item_attributes ...... [RUN]
[0m16:53:21.395504 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_inriver__item_attributes'
[0m16:53:21.396505 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_inriver__item_attributes
[0m16:53:21.402504 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_inriver__item_attributes"
[0m16:53:21.405015 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_inriver__item_attributes
[0m16:53:21.432066 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.stg_inriver__item_attributes"
[0m16:53:21.434062 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.stg_inriver__item_attributes"
[0m16:53:21.435434 [debug] [Thread-1 (]: On model.epicaldemo.stg_inriver__item_attributes: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_inriver__item_attributes"} */
create or replace   view EPICALDEMO.broman_analytics.stg_inriver__item_attributes
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.inriver.item_attributes
),

final AS (
    SELECT
        id AS item_attributes_id
        ,sku AS "SKU"
        ,COALESCE(crunch_level, 'Missing') AS "Crunch Level"
        ,COALESCE(snack_time, 'Missing') AS "Snack Time"
    FROM source
)

SELECT * FROM final
  );
[0m16:53:21.436440 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:53:22.388758 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.952 seconds
[0m16:53:22.407955 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '466a7bc7-85b5-4270-ba59-5db5f285d271', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C081FAC90>]}
[0m16:53:22.409955 [info ] [Thread-1 (]: 1 of 1 OK created sql view model broman_analytics.stg_inriver__item_attributes . [[32mSUCCESS 1[0m in 1.01s]
[0m16:53:22.410901 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_inriver__item_attributes
[0m16:53:22.412898 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:53:22.412898 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m16:53:22.413904 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m16:53:22.613890 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m16:53:22.614832 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m16:53:23.066319 [debug] [MainThread]: Connection 'model.epicaldemo.stg_inriver__item_attributes' was left open.
[0m16:53:23.067321 [debug] [MainThread]: On model.epicaldemo.stg_inriver__item_attributes: Close
[0m16:53:23.272257 [info ] [MainThread]: 
[0m16:53:23.272257 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.20 seconds (4.20s).
[0m16:53:23.273784 [debug] [MainThread]: Command end result
[0m16:53:23.296855 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m16:53:23.299856 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m16:53:23.308909 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m16:53:23.309916 [info ] [MainThread]: 
[0m16:53:23.310920 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:53:23.310920 [info ] [MainThread]: 
[0m16:53:23.311910 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:53:23.312911 [debug] [MainThread]: Command `dbt run` succeeded at 16:53:23.312911 after 5.40 seconds
[0m16:53:23.313929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C062B5690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C062B5410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C006C1250>]}
[0m16:53:23.314448 [debug] [MainThread]: Flushing usage events
[0m16:53:23.975926 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:54:03.158133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000125A3C79610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000125A3C79CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000125A3C79AD0>]}


============================== 16:54:03.162139 | 28a077fc-9ad3-4a50-a58b-728b9395499d ==============================
[0m16:54:03.162139 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:54:03.162139 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s fact_sales_transactions_incremental', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:54:03.632389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '28a077fc-9ad3-4a50-a58b-728b9395499d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000125A4EC11D0>]}
[0m16:54:03.675051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '28a077fc-9ad3-4a50-a58b-728b9395499d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000125A4FAE790>]}
[0m16:54:03.677061 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m16:54:04.010719 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:54:04.246232 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:54:04.247232 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:54:04.252228 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m16:54:04.295445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '28a077fc-9ad3-4a50-a58b-728b9395499d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000125A53F3350>]}
[0m16:54:04.377230 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m16:54:04.381222 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m16:54:04.403772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '28a077fc-9ad3-4a50-a58b-728b9395499d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000125A5805390>]}
[0m16:54:04.405002 [info ] [MainThread]: Found 1 snapshot, 14 models, 8 sources, 1 exposure, 476 macros
[0m16:54:04.406004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28a077fc-9ad3-4a50-a58b-728b9395499d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000125A4EE2590>]}
[0m16:54:04.407995 [info ] [MainThread]: 
[0m16:54:04.408997 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:54:04.408997 [info ] [MainThread]: 
[0m16:54:04.409996 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:54:04.410997 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m16:54:04.501228 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m16:54:04.502228 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m16:54:04.502228 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:54:05.562344 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.060 seconds
[0m16:54:05.568870 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m16:54:05.580270 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:54:05.580270 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:54:05.581261 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:54:06.392044 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.810 seconds
[0m16:54:06.396561 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:54:06.396561 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m16:54:06.566496 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.169 seconds
[0m16:54:06.570496 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:54:06.571497 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:54:06.699224 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.126 seconds
[0m16:54:06.703727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28a077fc-9ad3-4a50-a58b-728b9395499d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000125A5829DD0>]}
[0m16:54:06.709736 [debug] [Thread-1 (]: Began running node model.epicaldemo.fact_sales_transactions_incremental
[0m16:54:06.710736 [info ] [Thread-1 (]: 1 of 1 START sql incremental model broman_analytics.fact_sales_transactions_incremental  [RUN]
[0m16:54:06.711737 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.fact_sales_transactions_incremental'
[0m16:54:06.712736 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.fact_sales_transactions_incremental
[0m16:54:06.724796 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.fact_sales_transactions_incremental"
[0m16:54:06.726791 [debug] [Thread-1 (]: Began executing node model.epicaldemo.fact_sales_transactions_incremental
[0m16:54:06.778483 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.fact_sales_transactions_incremental"
[0m16:54:06.781496 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m16:54:06.782536 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
create or replace transient table EPICALDEMO.broman_analytics.fact_sales_transactions_incremental
    

    
    as (

WITH

sales AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__transactions

    
),

items AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__items
),

stores AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__stores
),

customers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_salesforce__customers
),

final AS (
    SELECT
        -- Identifiers
        sales.id
        ,sales.transaction_date_id
        ,sales.updated_at
        ,CONVERT_TIMEZONE('Europe/Stockholm', CURRENT_TIMESTAMP()) AS loaded_at

        ,CASE
            WHEN sales."SKU" IS NULL THEN -2 -- SKU is missing FROM Source
            WHEN items."item_id" IS NULL THEN -1 -- SKU is not known FROM Source
            ELSE items."item_id" -- Use item_id FROM Dim based on SKU
         END AS item_id

        ,CASE
            WHEN sales."Store" IS NULL THEN -2
            WHEN stores."store_key" IS NULL THEN -1
            ELSE stores."store_key"
         END AS store_key

        ,CASE
            WHEN sales."Customer Number" IS NULL THEN -2
            WHEN customers."customer_id" IS NULL THEN -1
            ELSE customers."customer_id"
         END AS customer_id

        -- Metrics
        ,sales."Qty"
        ,sales."Unit Price"
        ,sales."Sales Amount"
        ,sales."Unit Cost"
        ,sales."Cost"
        ,sales."Margin"
    FROM sales
    LEFT JOIN items ON items."SKU" = sales."SKU"
    LEFT JOIN stores ON stores."Store" = sales."Store" AND sales.transaction_date_id >= stores."valid_from" AND sales.transaction_date_id < stores."valid_to"
    LEFT JOIN customers ON customers."Customer Number" = sales."Customer Number"
)

SELECT * FROM final
    )
;
[0m16:54:06.782536 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:54:07.589726 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bd00fe-0004-ce47-0000-d2e90002fb0a
[0m16:54:07.590727 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 45 at position 17
invalid identifier 'ITEMS."item_id"'
[0m16:54:07.594247 [debug] [Thread-1 (]: Database Error in model fact_sales_transactions_incremental (models\mart\facts\fact_sales_transactions_incremental.sql)
  000904 (42000): SQL compilation error: error line 45 at position 17
  invalid identifier 'ITEMS."item_id"'
  compiled code at target\run\epicaldemo\models\mart\facts\fact_sales_transactions_incremental.sql
[0m16:54:07.595264 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28a077fc-9ad3-4a50-a58b-728b9395499d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000125A5BF9110>]}
[0m16:54:07.596262 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model broman_analytics.fact_sales_transactions_incremental  [[31mERROR[0m in 0.88s]
[0m16:54:07.597265 [debug] [Thread-1 (]: Finished running node model.epicaldemo.fact_sales_transactions_incremental
[0m16:54:07.598264 [debug] [Thread-7 (]: Marking all children of 'model.epicaldemo.fact_sales_transactions_incremental' to be skipped because of status 'error'.  Reason: Database Error in model fact_sales_transactions_incremental (models\mart\facts\fact_sales_transactions_incremental.sql)
  000904 (42000): SQL compilation error: error line 45 at position 17
  invalid identifier 'ITEMS."item_id"'
  compiled code at target\run\epicaldemo\models\mart\facts\fact_sales_transactions_incremental.sql.
[0m16:54:07.601270 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:54:07.601270 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m16:54:07.602255 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m16:54:07.857632 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m16:54:07.857632 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m16:54:08.090453 [debug] [MainThread]: Connection 'model.epicaldemo.fact_sales_transactions_incremental' was left open.
[0m16:54:08.091438 [debug] [MainThread]: On model.epicaldemo.fact_sales_transactions_incremental: Close
[0m16:54:08.352587 [info ] [MainThread]: 
[0m16:54:08.354106 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 3.94 seconds (3.94s).
[0m16:54:08.355112 [debug] [MainThread]: Command end result
[0m16:54:08.388671 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m16:54:08.392216 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m16:54:08.400757 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m16:54:08.401751 [info ] [MainThread]: 
[0m16:54:08.402747 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:54:08.403748 [info ] [MainThread]: 
[0m16:54:08.403748 [error] [MainThread]:   Database Error in model fact_sales_transactions_incremental (models\mart\facts\fact_sales_transactions_incremental.sql)
  000904 (42000): SQL compilation error: error line 45 at position 17
  invalid identifier 'ITEMS."item_id"'
  compiled code at target\run\epicaldemo\models\mart\facts\fact_sales_transactions_incremental.sql
[0m16:54:08.405247 [info ] [MainThread]: 
[0m16:54:08.405247 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:54:08.407254 [debug] [MainThread]: Command `dbt run` failed at 16:54:08.407254 after 5.31 seconds
[0m16:54:08.408257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001259E072E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000125A3CC64D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000125A3C73150>]}
[0m16:54:08.409274 [debug] [MainThread]: Flushing usage events
[0m16:54:09.148000 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:55:27.195398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C783732D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C78371250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C783739D0>]}


============================== 16:55:27.207911 | 26524b80-d14d-4122-8986-25bad9296e01 ==============================
[0m16:55:27.207911 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:55:27.208905 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s fact_sales_transactions_incremental', 'send_anonymous_usage_stats': 'True'}
[0m16:55:30.114792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '26524b80-d14d-4122-8986-25bad9296e01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C7837B490>]}
[0m16:55:30.155354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '26524b80-d14d-4122-8986-25bad9296e01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C79731450>]}
[0m16:55:30.165096 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m16:55:30.572186 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:55:30.769451 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:55:30.770450 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:55:30.775963 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m16:55:30.811522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '26524b80-d14d-4122-8986-25bad9296e01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C7979B8D0>]}
[0m16:55:30.885121 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m16:55:30.901787 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m16:55:31.130258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '26524b80-d14d-4122-8986-25bad9296e01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C7A123E90>]}
[0m16:55:31.131264 [info ] [MainThread]: Found 1 snapshot, 14 models, 8 sources, 1 exposure, 476 macros
[0m16:55:31.132264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26524b80-d14d-4122-8986-25bad9296e01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C7A104B50>]}
[0m16:55:31.133779 [info ] [MainThread]: 
[0m16:55:31.133779 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:55:31.134784 [info ] [MainThread]: 
[0m16:55:31.135788 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:55:31.136788 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m16:55:33.927252 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m16:55:33.927252 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m16:55:33.928255 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:35.369385 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.441 seconds
[0m16:55:35.374846 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m16:55:35.385377 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:55:35.386359 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:55:35.398147 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:36.019572 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.622 seconds
[0m16:55:36.025084 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:55:36.026088 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m16:55:36.167221 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.141 seconds
[0m16:55:36.169212 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:55:36.170223 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:55:36.307260 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.136 seconds
[0m16:55:36.310273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26524b80-d14d-4122-8986-25bad9296e01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C79A69210>]}
[0m16:55:36.315742 [debug] [Thread-1 (]: Began running node model.epicaldemo.fact_sales_transactions_incremental
[0m16:55:36.315742 [info ] [Thread-1 (]: 1 of 1 START sql incremental model broman_analytics.fact_sales_transactions_incremental  [RUN]
[0m16:55:36.317766 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.fact_sales_transactions_incremental'
[0m16:55:36.317766 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.fact_sales_transactions_incremental
[0m16:55:36.332286 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.fact_sales_transactions_incremental"
[0m16:55:36.333284 [debug] [Thread-1 (]: Began executing node model.epicaldemo.fact_sales_transactions_incremental
[0m16:55:36.390748 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.fact_sales_transactions_incremental"
[0m16:55:36.394357 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m16:55:36.395277 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
create or replace transient table EPICALDEMO.broman_analytics.fact_sales_transactions_incremental
    

    
    as (

WITH

sales AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__transactions

    
),

items AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__items
),

stores AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__stores
),

customers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_salesforce__customers
),

final AS (
    SELECT
        -- Identifiers
        sales.id
        ,sales.transaction_date_id
        ,sales.updated_at
        ,CONVERT_TIMEZONE('Europe/Stockholm', CURRENT_TIMESTAMP()) AS loaded_at

        ,CASE
            WHEN sales.sku IS NULL THEN -2 -- SKU is missing FROM Source
            WHEN items.item_id IS NULL THEN -1 -- SKU is not known FROM Source
            ELSE items.item_id -- Use item_id FROM Dim based on SKU
         END AS item_id

        ,CASE
            WHEN sales."Store" IS NULL THEN -2
            WHEN stores.store_key IS NULL THEN -1
            ELSE stores.store_key
         END AS store_key

        ,CASE
            WHEN sales."Customer Number" IS NULL THEN -2
            WHEN customers.customer_id IS NULL THEN -1
            ELSE customers.customer_id
         END AS customer_id

        -- Metrics
        ,sales."Qty"
        ,sales."Unit Price"
        ,sales."Sales Amount"
        ,sales."Unit Cost"
        ,sales."Cost"
        ,sales."Margin"
    FROM sales
    LEFT JOIN items ON items."SKU" = sales."SKU"
    LEFT JOIN stores ON stores."Store" = sales."Store" AND sales.transaction_date_id >= stores.valid_from AND sales.transaction_date_id < stores.valid_to
    LEFT JOIN customers ON customers."Customer Number" = sales."Customer Number"
)

SELECT * FROM final
    )
;
[0m16:55:36.395277 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:55:38.251624 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.856 seconds
[0m16:55:38.261658 [debug] [Thread-1 (]: Applying DROP to: EPICALDEMO.broman_analytics.fact_sales_transactions_incremental__dbt_tmp
[0m16:55:38.269171 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m16:55:38.270171 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
drop view if exists EPICALDEMO.broman_analytics.fact_sales_transactions_incremental__dbt_tmp cascade
[0m16:55:38.393204 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.122 seconds
[0m16:55:38.418230 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26524b80-d14d-4122-8986-25bad9296e01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C7A498B10>]}
[0m16:55:38.420230 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model broman_analytics.fact_sales_transactions_incremental  [[32mSUCCESS 1[0m in 2.09s]
[0m16:55:38.421238 [debug] [Thread-1 (]: Finished running node model.epicaldemo.fact_sales_transactions_incremental
[0m16:55:38.423232 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:55:38.423232 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m16:55:38.424448 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m16:55:38.653603 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m16:55:38.654613 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m16:55:38.890353 [debug] [MainThread]: Connection 'model.epicaldemo.fact_sales_transactions_incremental' was left open.
[0m16:55:38.891355 [debug] [MainThread]: On model.epicaldemo.fact_sales_transactions_incremental: Close
[0m16:55:39.100148 [info ] [MainThread]: 
[0m16:55:39.102142 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 7.96 seconds (7.96s).
[0m16:55:39.103138 [debug] [MainThread]: Command end result
[0m16:55:39.124416 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m16:55:39.127407 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m16:55:39.132415 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m16:55:39.133413 [info ] [MainThread]: 
[0m16:55:39.134677 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:55:39.134677 [info ] [MainThread]: 
[0m16:55:39.135676 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:55:39.136674 [debug] [MainThread]: Command `dbt run` succeeded at 16:55:39.136674 after 12.02 seconds
[0m16:55:39.137676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C783C5FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C781B4850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C781B4B10>]}
[0m16:55:39.138674 [debug] [MainThread]: Flushing usage events
[0m16:55:39.813567 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:55:44.506517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CCED7E450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CCEDB5250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CCED7DE50>]}


============================== 16:55:44.510525 | 4844c30a-db32-4d28-a4a7-7d7d91f272b6 ==============================
[0m16:55:44.510525 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:55:44.511516 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s fact_sales_transactions_incremental', 'send_anonymous_usage_stats': 'True'}
[0m16:55:44.909441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4844c30a-db32-4d28-a4a7-7d7d91f272b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CD019BB50>]}
[0m16:55:44.950153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4844c30a-db32-4d28-a4a7-7d7d91f272b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CD0131390>]}
[0m16:55:44.953145 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m16:55:45.247607 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:55:45.443287 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:55:45.444244 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:55:45.449244 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m16:55:45.485832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4844c30a-db32-4d28-a4a7-7d7d91f272b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CD0A0D9D0>]}
[0m16:55:45.561090 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m16:55:45.565622 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m16:55:45.584659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4844c30a-db32-4d28-a4a7-7d7d91f272b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CD0B05750>]}
[0m16:55:45.585668 [info ] [MainThread]: Found 1 snapshot, 14 models, 8 sources, 1 exposure, 476 macros
[0m16:55:45.586657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4844c30a-db32-4d28-a4a7-7d7d91f272b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CD04B1650>]}
[0m16:55:45.588663 [info ] [MainThread]: 
[0m16:55:45.588663 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:55:45.589662 [info ] [MainThread]: 
[0m16:55:45.590662 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:55:45.591665 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m16:55:45.672145 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m16:55:45.673144 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m16:55:45.673667 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:46.426868 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.753 seconds
[0m16:55:46.431868 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m16:55:46.441448 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:55:46.441448 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:55:46.442473 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:47.017894 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.575 seconds
[0m16:55:47.021893 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:55:47.021893 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m16:55:47.183095 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.160 seconds
[0m16:55:47.184622 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:55:47.185623 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:55:47.310558 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.124 seconds
[0m16:55:47.313160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4844c30a-db32-4d28-a4a7-7d7d91f272b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CD04B1650>]}
[0m16:55:47.318091 [debug] [Thread-1 (]: Began running node model.epicaldemo.fact_sales_transactions_incremental
[0m16:55:47.319101 [info ] [Thread-1 (]: 1 of 1 START sql incremental model broman_analytics.fact_sales_transactions_incremental  [RUN]
[0m16:55:47.320092 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.fact_sales_transactions_incremental'
[0m16:55:47.320092 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.fact_sales_transactions_incremental
[0m16:55:47.333155 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.fact_sales_transactions_incremental"
[0m16:55:47.335163 [debug] [Thread-1 (]: Began executing node model.epicaldemo.fact_sales_transactions_incremental
[0m16:55:47.376709 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m16:55:47.376709 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
create or replace  temporary view EPICALDEMO.broman_analytics.fact_sales_transactions_incremental__dbt_tmp
  
   as (
    

WITH

sales AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__transactions

    
    WHERE UPDATED_AT >= (SELECT MAX(UPDATED_AT) FROM EPICALDEMO.broman_analytics.fact_sales_transactions_incremental)
    
),

items AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__items
),

stores AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__stores
),

customers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_salesforce__customers
),

final AS (
    SELECT
        -- Identifiers
        sales.id
        ,sales.transaction_date_id
        ,sales.updated_at
        ,CONVERT_TIMEZONE('Europe/Stockholm', CURRENT_TIMESTAMP()) AS loaded_at

        ,CASE
            WHEN sales.sku IS NULL THEN -2 -- SKU is missing FROM Source
            WHEN items.item_id IS NULL THEN -1 -- SKU is not known FROM Source
            ELSE items.item_id -- Use item_id FROM Dim based on SKU
         END AS item_id

        ,CASE
            WHEN sales."Store" IS NULL THEN -2
            WHEN stores.store_key IS NULL THEN -1
            ELSE stores.store_key
         END AS store_key

        ,CASE
            WHEN sales."Customer Number" IS NULL THEN -2
            WHEN customers.customer_id IS NULL THEN -1
            ELSE customers.customer_id
         END AS customer_id

        -- Metrics
        ,sales."Qty"
        ,sales."Unit Price"
        ,sales."Sales Amount"
        ,sales."Unit Cost"
        ,sales."Cost"
        ,sales."Margin"
    FROM sales
    LEFT JOIN items ON items."SKU" = sales."SKU"
    LEFT JOIN stores ON stores."Store" = sales."Store" AND sales.transaction_date_id >= stores.valid_from AND sales.transaction_date_id < stores.valid_to
    LEFT JOIN customers ON customers."Customer Number" = sales."Customer Number"
)

SELECT * FROM final
  );
[0m16:55:47.377711 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:55:48.409652 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.032 seconds
[0m16:55:48.416175 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m16:55:48.417175 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
describe table EPICALDEMO.broman_analytics.fact_sales_transactions_incremental__dbt_tmp
[0m16:55:48.577747 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.159 seconds
[0m16:55:48.580751 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m16:55:48.581756 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
describe table EPICALDEMO.broman_analytics.fact_sales_transactions_incremental
[0m16:55:48.716873 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.134 seconds
[0m16:55:48.724409 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m16:55:48.725400 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."FACT_SALES_TRANSACTIONS_INCREMENTAL"
[0m16:55:48.856004 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.130 seconds
[0m16:55:48.880601 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.fact_sales_transactions_incremental"
[0m16:55:48.883110 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m16:55:48.883110 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
-- back compat for old kwarg name
  
  begin;
[0m16:55:49.035214 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.152 seconds
[0m16:55:49.036210 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m16:55:49.036210 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
merge into EPICALDEMO.broman_analytics.fact_sales_transactions_incremental as DBT_INTERNAL_DEST
        using EPICALDEMO.broman_analytics.fact_sales_transactions_incremental__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.transaction_date_id = DBT_INTERNAL_DEST.transaction_date_id
                ) and (
                    DBT_INTERNAL_SOURCE.item_id = DBT_INTERNAL_DEST.item_id
                ) and (
                    DBT_INTERNAL_SOURCE.store_key = DBT_INTERNAL_DEST.store_key
                ) and (
                    DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
                )

    
    when matched then update set
        "ID" = DBT_INTERNAL_SOURCE."ID","TRANSACTION_DATE_ID" = DBT_INTERNAL_SOURCE."TRANSACTION_DATE_ID","UPDATED_AT" = DBT_INTERNAL_SOURCE."UPDATED_AT","LOADED_AT" = DBT_INTERNAL_SOURCE."LOADED_AT","ITEM_ID" = DBT_INTERNAL_SOURCE."ITEM_ID","STORE_KEY" = DBT_INTERNAL_SOURCE."STORE_KEY","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","Qty" = DBT_INTERNAL_SOURCE."Qty","Unit Price" = DBT_INTERNAL_SOURCE."Unit Price","Sales Amount" = DBT_INTERNAL_SOURCE."Sales Amount","Unit Cost" = DBT_INTERNAL_SOURCE."Unit Cost","Cost" = DBT_INTERNAL_SOURCE."Cost","Margin" = DBT_INTERNAL_SOURCE."Margin"
    

    when not matched then insert
        ("ID", "TRANSACTION_DATE_ID", "UPDATED_AT", "LOADED_AT", "ITEM_ID", "STORE_KEY", "CUSTOMER_ID", "Qty", "Unit Price", "Sales Amount", "Unit Cost", "Cost", "Margin")
    values
        ("ID", "TRANSACTION_DATE_ID", "UPDATED_AT", "LOADED_AT", "ITEM_ID", "STORE_KEY", "CUSTOMER_ID", "Qty", "Unit Price", "Sales Amount", "Unit Cost", "Cost", "Margin")

;
[0m16:55:50.281067 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.244 seconds
[0m16:55:50.282083 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m16:55:50.282083 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
COMMIT
[0m16:55:50.570393 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.288 seconds
[0m16:55:50.577906 [debug] [Thread-1 (]: Applying DROP to: EPICALDEMO.broman_analytics.fact_sales_transactions_incremental__dbt_tmp
[0m16:55:50.584416 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m16:55:50.584416 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
drop view if exists EPICALDEMO.broman_analytics.fact_sales_transactions_incremental__dbt_tmp cascade
[0m16:55:50.765999 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.180 seconds
[0m16:55:50.781527 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4844c30a-db32-4d28-a4a7-7d7d91f272b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CD01ABD50>]}
[0m16:55:50.782540 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model broman_analytics.fact_sales_transactions_incremental  [[32mSUCCESS 1[0m in 3.46s]
[0m16:55:50.784032 [debug] [Thread-1 (]: Finished running node model.epicaldemo.fact_sales_transactions_incremental
[0m16:55:50.786039 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:55:50.786039 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m16:55:50.787052 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m16:55:50.999639 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m16:55:50.999639 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m16:55:51.243956 [debug] [MainThread]: Connection 'model.epicaldemo.fact_sales_transactions_incremental' was left open.
[0m16:55:51.244961 [debug] [MainThread]: On model.epicaldemo.fact_sales_transactions_incremental: Close
[0m16:55:51.461823 [info ] [MainThread]: 
[0m16:55:51.463336 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 5.87 seconds (5.87s).
[0m16:55:51.464343 [debug] [MainThread]: Command end result
[0m16:55:51.506192 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m16:55:51.510192 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m16:55:51.518713 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m16:55:51.519714 [info ] [MainThread]: 
[0m16:55:51.520719 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:55:51.521712 [info ] [MainThread]: 
[0m16:55:51.521712 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:55:51.524237 [debug] [MainThread]: Command `dbt run` succeeded at 16:55:51.524237 after 7.08 seconds
[0m16:55:51.525237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CCEDDBE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CCEDDBF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CCEA51A10>]}
[0m16:55:51.526242 [debug] [MainThread]: Flushing usage events
[0m16:55:52.098252 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:59:18.804255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001938D36F650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001938D36F0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001938D36EF90>]}


============================== 18:59:18.814109 | 73a83ee9-3b89-410e-b13e-fbbca82efbcb ==============================
[0m18:59:18.814109 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:59:18.814109 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'c:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'profiles_dir': 'c:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:59:18.998196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73a83ee9-3b89-410e-b13e-fbbca82efbcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001938D3DF610>]}
[0m18:59:19.149542 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m18:59:19.149542 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m18:59:19.149542 [debug] [MainThread]: Command `cli deps` succeeded at 18:59:19.149542 after 0.47 seconds
[0m18:59:19.157550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001938D378150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001938D3B7950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001938D1AC310>]}
[0m18:59:19.157550 [debug] [MainThread]: Flushing usage events
[0m18:59:19.651287 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:12:22.605438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001716F072410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001716F071DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001716F070F10>]}


============================== 19:12:22.621139 | 58b9083e-038c-4964-b494-61544963ead3 ==============================
[0m19:12:22.621139 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:12:22.621139 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -s fact_sales_transactions_incremental', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:12:29.825984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58b9083e-038c-4964-b494-61544963ead3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017170217ED0>]}
[0m19:12:29.888028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '58b9083e-038c-4964-b494-61544963ead3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171702319D0>]}
[0m19:12:29.905341 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m19:12:30.752460 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:12:33.532862 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:12:33.532862 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:12:33.541303 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m19:12:33.613421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '58b9083e-038c-4964-b494-61544963ead3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017170B14750>]}
[0m19:12:33.736337 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m19:12:33.767621 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m19:12:34.248117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '58b9083e-038c-4964-b494-61544963ead3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171702E2CD0>]}
[0m19:12:34.251992 [info ] [MainThread]: Found 1 snapshot, 14 models, 8 sources, 1 exposure, 476 macros
[0m19:12:34.251992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58b9083e-038c-4964-b494-61544963ead3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017170350D10>]}
[0m19:12:34.256716 [info ] [MainThread]: 
[0m19:12:34.256716 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:12:34.260355 [info ] [MainThread]: 
[0m19:12:34.260355 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:12:34.262566 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m19:12:42.657546 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m19:12:42.657546 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m19:12:42.657546 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:12:43.994445 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.335 seconds
[0m19:12:44.010087 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m19:12:44.041676 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m19:12:44.041676 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m19:12:44.041676 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:12:44.295003 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.262 seconds
[0m19:12:44.310531 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m19:12:44.310531 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m19:12:44.420542 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.108 seconds
[0m19:12:44.420542 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m19:12:44.436064 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m19:12:44.499871 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.064 seconds
[0m19:12:44.499871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58b9083e-038c-4964-b494-61544963ead3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017170F74E50>]}
[0m19:12:44.549331 [debug] [Thread-1 (]: Began running node model.epicaldemo.fact_sales_transactions_incremental
[0m19:12:44.549331 [info ] [Thread-1 (]: 1 of 1 START sql incremental model broman_analytics.fact_sales_transactions_incremental  [RUN]
[0m19:12:44.549331 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.fact_sales_transactions_incremental'
[0m19:12:44.549331 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.fact_sales_transactions_incremental
[0m19:12:44.588868 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.fact_sales_transactions_incremental"
[0m19:12:44.588868 [debug] [Thread-1 (]: Began executing node model.epicaldemo.fact_sales_transactions_incremental
[0m19:12:44.655007 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m19:12:44.655007 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
create or replace  temporary view EPICALDEMO.broman_analytics.fact_sales_transactions_incremental__dbt_tmp
  
   as (
    

WITH

sales AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__transactions

    
    WHERE UPDATED_AT >= (SELECT MAX(UPDATED_AT) FROM EPICALDEMO.broman_analytics.fact_sales_transactions_incremental)
    
),

items AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__items
),

stores AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__stores
),

customers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_salesforce__customers
),

final AS (
    SELECT
        -- Identifiers
        sales.id
        ,sales.transaction_date_id
        ,sales.updated_at
        ,CONVERT_TIMEZONE('Europe/Stockholm', CURRENT_TIMESTAMP()) AS loaded_at

        ,CASE
            WHEN sales.sku IS NULL THEN -2 -- SKU is missing FROM Source
            WHEN items.item_id IS NULL THEN -1 -- SKU is not known FROM Source
            ELSE items.item_id -- Use item_id FROM Dim based on SKU
         END AS item_id

        ,CASE
            WHEN sales."Store" IS NULL THEN -2
            WHEN stores.store_key IS NULL THEN -1
            ELSE stores.store_key
         END AS store_key

        ,CASE
            WHEN sales."Customer Number" IS NULL THEN -2
            WHEN customers.customer_id IS NULL THEN -1
            ELSE customers.customer_id
         END AS customer_id

        -- Metrics
        ,sales."Qty"
        ,sales."Unit Price"
        ,sales."Sales Amount"
        ,sales."Unit Cost"
        ,sales."Cost"
        ,sales."Margin"
    FROM sales
    LEFT JOIN items ON items."SKU" = sales."SKU"
    LEFT JOIN stores ON stores."Store" = sales."Store" AND sales.transaction_date_id >= stores.valid_from AND sales.transaction_date_id < stores.valid_to
    LEFT JOIN customers ON customers."Customer Number" = sales."Customer Number"
)

SELECT * FROM final
  );
[0m19:12:44.655007 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:12:45.266551 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.611 seconds
[0m19:12:45.282260 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m19:12:45.282260 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
describe table EPICALDEMO.broman_analytics.fact_sales_transactions_incremental__dbt_tmp
[0m19:12:45.352937 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.069 seconds
[0m19:12:45.354115 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m19:12:45.354115 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
describe table EPICALDEMO.broman_analytics.fact_sales_transactions_incremental
[0m19:12:45.404432 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.051 seconds
[0m19:12:45.421808 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m19:12:45.421808 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."FACT_SALES_TRANSACTIONS_INCREMENTAL"
[0m19:12:45.480380 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.051 seconds
[0m19:12:45.539440 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.fact_sales_transactions_incremental"
[0m19:12:45.542711 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m19:12:45.542711 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
-- back compat for old kwarg name
  
  begin;
[0m19:12:45.621064 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.078 seconds
[0m19:12:45.621064 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m19:12:45.621064 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
merge into EPICALDEMO.broman_analytics.fact_sales_transactions_incremental as DBT_INTERNAL_DEST
        using EPICALDEMO.broman_analytics.fact_sales_transactions_incremental__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.transaction_date_id = DBT_INTERNAL_DEST.transaction_date_id
                ) and (
                    DBT_INTERNAL_SOURCE.item_id = DBT_INTERNAL_DEST.item_id
                ) and (
                    DBT_INTERNAL_SOURCE.store_key = DBT_INTERNAL_DEST.store_key
                ) and (
                    DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
                )

    
    when matched then update set
        "ID" = DBT_INTERNAL_SOURCE."ID","TRANSACTION_DATE_ID" = DBT_INTERNAL_SOURCE."TRANSACTION_DATE_ID","UPDATED_AT" = DBT_INTERNAL_SOURCE."UPDATED_AT","LOADED_AT" = DBT_INTERNAL_SOURCE."LOADED_AT","ITEM_ID" = DBT_INTERNAL_SOURCE."ITEM_ID","STORE_KEY" = DBT_INTERNAL_SOURCE."STORE_KEY","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","Qty" = DBT_INTERNAL_SOURCE."Qty","Unit Price" = DBT_INTERNAL_SOURCE."Unit Price","Sales Amount" = DBT_INTERNAL_SOURCE."Sales Amount","Unit Cost" = DBT_INTERNAL_SOURCE."Unit Cost","Cost" = DBT_INTERNAL_SOURCE."Cost","Margin" = DBT_INTERNAL_SOURCE."Margin"
    

    when not matched then insert
        ("ID", "TRANSACTION_DATE_ID", "UPDATED_AT", "LOADED_AT", "ITEM_ID", "STORE_KEY", "CUSTOMER_ID", "Qty", "Unit Price", "Sales Amount", "Unit Cost", "Cost", "Margin")
    values
        ("ID", "TRANSACTION_DATE_ID", "UPDATED_AT", "LOADED_AT", "ITEM_ID", "STORE_KEY", "CUSTOMER_ID", "Qty", "Unit Price", "Sales Amount", "Unit Cost", "Cost", "Margin")

;
[0m19:12:46.932129 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.303 seconds
[0m19:12:46.934279 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m19:12:46.937796 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
COMMIT
[0m19:12:47.102755 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.164 seconds
[0m19:12:47.111966 [debug] [Thread-1 (]: Applying DROP to: EPICALDEMO.broman_analytics.fact_sales_transactions_incremental__dbt_tmp
[0m19:12:47.127614 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m19:12:47.127614 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
drop view if exists EPICALDEMO.broman_analytics.fact_sales_transactions_incremental__dbt_tmp cascade
[0m19:12:47.254984 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.114 seconds
[0m19:12:47.320670 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58b9083e-038c-4964-b494-61544963ead3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017171633810>]}
[0m19:12:47.328187 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model broman_analytics.fact_sales_transactions_incremental  [[32mSUCCESS 0[0m in 2.74s]
[0m19:12:47.328187 [debug] [Thread-1 (]: Finished running node model.epicaldemo.fact_sales_transactions_incremental
[0m19:12:47.336565 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:12:47.339868 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m19:12:47.341155 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m19:12:47.403466 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m19:12:47.403466 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m19:12:47.470140 [debug] [MainThread]: Connection 'model.epicaldemo.fact_sales_transactions_incremental' was left open.
[0m19:12:47.472206 [debug] [MainThread]: On model.epicaldemo.fact_sales_transactions_incremental: Close
[0m19:12:47.537909 [info ] [MainThread]: 
[0m19:12:47.537909 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 13.28 seconds (13.28s).
[0m19:12:47.544152 [debug] [MainThread]: Command end result
[0m19:12:47.588040 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m19:12:47.588040 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m19:12:47.603127 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m19:12:47.603127 [info ] [MainThread]: 
[0m19:12:47.603127 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:12:47.603127 [info ] [MainThread]: 
[0m19:12:47.608646 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:12:47.608646 [debug] [MainThread]: Command `dbt run` succeeded at 19:12:47.608646 after 25.22 seconds
[0m19:12:47.608646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001716DA53FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017169472E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017169472110>]}
[0m19:12:47.608646 [debug] [MainThread]: Flushing usage events
[0m19:12:48.330145 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:16:22.434089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002053BE71050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002053BE710D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002053BE73A10>]}


============================== 19:16:22.450810 | 275538f3-2b56-4d95-860f-4e2b31fc8d40 ==============================
[0m19:16:22.450810 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:16:22.452846 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -s fact_sales_transactions_incremental', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:16:27.307669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '275538f3-2b56-4d95-860f-4e2b31fc8d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002053BE8D310>]}
[0m19:16:27.361265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '275538f3-2b56-4d95-860f-4e2b31fc8d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002053D01BD10>]}
[0m19:16:27.386548 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m19:16:28.156692 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:16:30.647815 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:16:30.647815 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:16:30.663509 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m19:16:30.726431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '275538f3-2b56-4d95-860f-4e2b31fc8d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002053D8B2E50>]}
[0m19:16:30.828903 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m19:16:30.861170 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m19:16:31.297579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '275538f3-2b56-4d95-860f-4e2b31fc8d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002053D150910>]}
[0m19:16:31.301484 [info ] [MainThread]: Found 1 snapshot, 14 models, 8 sources, 1 exposure, 476 macros
[0m19:16:31.303520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '275538f3-2b56-4d95-860f-4e2b31fc8d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002053D80AE10>]}
[0m19:16:31.305146 [info ] [MainThread]: 
[0m19:16:31.305146 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:16:31.305146 [info ] [MainThread]: 
[0m19:16:31.308628 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:16:31.310637 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m19:16:35.633087 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m19:16:35.633087 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m19:16:35.633087 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:16:36.446365 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.806 seconds
[0m19:16:36.462460 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m19:16:36.500304 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m19:16:36.501459 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m19:16:36.502610 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:16:36.713610 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.223 seconds
[0m19:16:36.736822 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m19:16:36.737973 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m19:16:36.823907 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.085 seconds
[0m19:16:36.823907 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m19:16:36.823907 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m19:16:36.886474 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.064 seconds
[0m19:16:36.901981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '275538f3-2b56-4d95-860f-4e2b31fc8d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002053D573F50>]}
[0m19:16:36.917643 [debug] [Thread-1 (]: Began running node model.epicaldemo.fact_sales_transactions_incremental
[0m19:16:36.917643 [info ] [Thread-1 (]: 1 of 1 START sql incremental model broman_analytics.fact_sales_transactions_incremental  [RUN]
[0m19:16:36.917643 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.fact_sales_transactions_incremental'
[0m19:16:36.928555 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.fact_sales_transactions_incremental
[0m19:16:36.965668 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.fact_sales_transactions_incremental"
[0m19:16:36.965668 [debug] [Thread-1 (]: Began executing node model.epicaldemo.fact_sales_transactions_incremental
[0m19:16:37.030556 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.fact_sales_transactions_incremental"
[0m19:16:37.056350 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m19:16:37.056350 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
create or replace transient table EPICALDEMO.broman_analytics.fact_sales_transactions_incremental
    

    
    as (

WITH

sales AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__transactions

    
),

items AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__items
),

stores AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__stores
),

customers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_salesforce__customers
),

final AS (
    SELECT
        -- Identifiers
        sales.id
        ,sales.transaction_date_id
        ,sales.updated_at
        ,CONVERT_TIMEZONE('Europe/Stockholm', CURRENT_TIMESTAMP()) AS loaded_at

        ,CASE
            WHEN sales.sku IS NULL THEN -2 -- SKU is missing FROM Source
            WHEN items.item_id IS NULL THEN -1 -- SKU is not known FROM Source
            ELSE items.item_id -- Use item_id FROM Dim based on SKU
         END AS item_id

        ,CASE
            WHEN sales."Store" IS NULL THEN -2
            WHEN stores.store_key IS NULL THEN -1
            ELSE stores.store_key
         END AS store_key

        ,CASE
            WHEN sales."Customer Number" IS NULL THEN -2
            WHEN customers.customer_id IS NULL THEN -1
            ELSE customers.customer_id
         END AS customer_id

        -- Metrics
        ,sales."Qty"
        ,sales."Unit Price"
        ,sales."Sales Amount"
        ,sales."Unit Cost"
        ,sales."Cost"
        ,sales."Margin"
    FROM sales
    LEFT JOIN items ON items."SKU" = sales."SKU"
    LEFT JOIN stores ON stores."Store" = sales."Store" AND sales.transaction_date_id >= stores.valid_from AND sales.transaction_date_id < stores.valid_to
    LEFT JOIN customers ON customers."Customer Number" = sales."Customer Number"
)

SELECT * FROM final
    )
;
[0m19:16:37.061867 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:16:38.421661 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.361 seconds
[0m19:16:38.421661 [debug] [Thread-1 (]: Applying DROP to: EPICALDEMO.broman_analytics.fact_sales_transactions_incremental__dbt_tmp
[0m19:16:38.437283 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m19:16:38.437283 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
drop view if exists EPICALDEMO.broman_analytics.fact_sales_transactions_incremental__dbt_tmp cascade
[0m19:16:38.484598 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.055 seconds
[0m19:16:38.531921 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '275538f3-2b56-4d95-860f-4e2b31fc8d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002053DFD90D0>]}
[0m19:16:38.531921 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model broman_analytics.fact_sales_transactions_incremental  [[32mSUCCESS 1[0m in 1.61s]
[0m19:16:38.531921 [debug] [Thread-1 (]: Finished running node model.epicaldemo.fact_sales_transactions_incremental
[0m19:16:38.531921 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:16:38.531921 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m19:16:38.531921 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m19:16:38.591716 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m19:16:38.591716 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m19:16:38.659274 [debug] [MainThread]: Connection 'model.epicaldemo.fact_sales_transactions_incremental' was left open.
[0m19:16:38.659274 [debug] [MainThread]: On model.epicaldemo.fact_sales_transactions_incremental: Close
[0m19:16:38.711258 [info ] [MainThread]: 
[0m19:16:38.711258 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 7.40 seconds (7.40s).
[0m19:16:38.723707 [debug] [MainThread]: Command end result
[0m19:16:38.774551 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m19:16:38.782991 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m19:16:38.790300 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m19:16:38.790890 [info ] [MainThread]: 
[0m19:16:38.790890 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:16:38.790890 [info ] [MainThread]: 
[0m19:16:38.790890 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:16:38.790890 [debug] [MainThread]: Command `dbt run` succeeded at 19:16:38.790890 after 16.49 seconds
[0m19:16:38.797465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002053BEB7710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002053BEB5150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002053BAB4F10>]}
[0m19:16:38.797465 [debug] [MainThread]: Flushing usage events
[0m19:16:39.545958 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:17:11.633541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B27C479590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B27C4794D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B27C479B90>]}


============================== 19:17:11.633541 | 4f013032-cbe5-486b-8d0b-7f9a1169d40a ==============================
[0m19:17:11.633541 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:17:11.633541 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -s fact_sales_transactions_incremental', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:17:12.278204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f013032-cbe5-486b-8d0b-7f9a1169d40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B27C48D390>]}
[0m19:17:12.337297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f013032-cbe5-486b-8d0b-7f9a1169d40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B27AE57850>]}
[0m19:17:12.337297 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m19:17:12.820958 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:17:13.120744 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:17:13.120744 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:17:13.127304 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m19:17:13.197031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f013032-cbe5-486b-8d0b-7f9a1169d40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B27DDDF990>]}
[0m19:17:13.295404 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m19:17:13.295404 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m19:17:13.328525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f013032-cbe5-486b-8d0b-7f9a1169d40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B27DCFEB10>]}
[0m19:17:13.328525 [info ] [MainThread]: Found 1 snapshot, 14 models, 8 sources, 1 exposure, 476 macros
[0m19:17:13.341698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f013032-cbe5-486b-8d0b-7f9a1169d40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B27DDD2950>]}
[0m19:17:13.343040 [info ] [MainThread]: 
[0m19:17:13.343040 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:17:13.343040 [info ] [MainThread]: 
[0m19:17:13.348074 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:17:13.350135 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m19:17:13.480355 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m19:17:13.495912 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m19:17:13.496538 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:17:14.127553 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.632 seconds
[0m19:17:14.144378 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m19:17:14.177704 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m19:17:14.177704 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m19:17:14.177704 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:17:14.611367 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.438 seconds
[0m19:17:14.627925 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m19:17:14.627925 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m19:17:14.725736 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.089 seconds
[0m19:17:14.726926 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m19:17:14.726926 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m19:17:14.799313 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.064 seconds
[0m19:17:14.804327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f013032-cbe5-486b-8d0b-7f9a1169d40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B27DCB78D0>]}
[0m19:17:14.804327 [debug] [Thread-1 (]: Began running node model.epicaldemo.fact_sales_transactions_incremental
[0m19:17:14.819971 [info ] [Thread-1 (]: 1 of 1 START sql incremental model broman_analytics.fact_sales_transactions_incremental  [RUN]
[0m19:17:14.824000 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.fact_sales_transactions_incremental'
[0m19:17:14.824000 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.fact_sales_transactions_incremental
[0m19:17:14.865046 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.fact_sales_transactions_incremental"
[0m19:17:14.868367 [debug] [Thread-1 (]: Began executing node model.epicaldemo.fact_sales_transactions_incremental
[0m19:17:14.926750 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m19:17:14.926750 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
create or replace  temporary view EPICALDEMO.broman_analytics.fact_sales_transactions_incremental__dbt_tmp
  
   as (
    

WITH

sales AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__transactions

    
    WHERE UPDATED_AT >= (SELECT MAX(UPDATED_AT) FROM EPICALDEMO.broman_analytics.fact_sales_transactions_incremental)
    
),

items AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__items
),

stores AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__stores
),

customers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_salesforce__customers
),

final AS (
    SELECT
        -- Identifiers
        sales.id
        ,sales.transaction_date_id
        ,sales.updated_at
        ,CONVERT_TIMEZONE('Europe/Stockholm', CURRENT_TIMESTAMP()) AS loaded_at

        ,CASE
            WHEN sales.sku IS NULL THEN -2 -- SKU is missing FROM Source
            WHEN items.item_id IS NULL THEN -1 -- SKU is not known FROM Source
            ELSE items.item_id -- Use item_id FROM Dim based on SKU
         END AS item_id

        ,CASE
            WHEN sales."Store" IS NULL THEN -2
            WHEN stores.store_key IS NULL THEN -1
            ELSE stores.store_key
         END AS store_key

        ,CASE
            WHEN sales."Customer Number" IS NULL THEN -2
            WHEN customers.customer_id IS NULL THEN -1
            ELSE customers.customer_id
         END AS customer_id

        -- Metrics
        ,sales."Qty"
        ,sales."Unit Price"
        ,sales."Sales Amount"
        ,sales."Unit Cost"
        ,sales."Cost"
        ,sales."Margin"
    FROM sales
    LEFT JOIN items ON items."SKU" = sales."SKU"
    LEFT JOIN stores ON stores."Store" = sales."Store" AND sales.transaction_date_id >= stores.valid_from AND sales.transaction_date_id < stores.valid_to
    LEFT JOIN customers ON customers."Customer Number" = sales."Customer Number"
)

SELECT * FROM final
  );
[0m19:17:14.926750 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:17:15.444376 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.515 seconds
[0m19:17:15.460813 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m19:17:15.460813 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
describe table EPICALDEMO.broman_analytics.fact_sales_transactions_incremental__dbt_tmp
[0m19:17:15.547208 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.077 seconds
[0m19:17:15.559645 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m19:17:15.560544 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
describe table EPICALDEMO.broman_analytics.fact_sales_transactions_incremental
[0m19:17:15.627854 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.072 seconds
[0m19:17:15.656313 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m19:17:15.656313 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."FACT_SALES_TRANSACTIONS_INCREMENTAL"
[0m19:17:15.703092 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.047 seconds
[0m19:17:15.776901 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.fact_sales_transactions_incremental"
[0m19:17:15.776901 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m19:17:15.776901 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
-- back compat for old kwarg name
  
  begin;
[0m19:17:15.859837 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.073 seconds
[0m19:17:15.859837 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m19:17:15.859837 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
merge into EPICALDEMO.broman_analytics.fact_sales_transactions_incremental as DBT_INTERNAL_DEST
        using EPICALDEMO.broman_analytics.fact_sales_transactions_incremental__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.transaction_date_id = DBT_INTERNAL_DEST.transaction_date_id
                ) and (
                    DBT_INTERNAL_SOURCE.item_id = DBT_INTERNAL_DEST.item_id
                ) and (
                    DBT_INTERNAL_SOURCE.store_key = DBT_INTERNAL_DEST.store_key
                ) and (
                    DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
                )

    
    when matched then update set
        "ID" = DBT_INTERNAL_SOURCE."ID","TRANSACTION_DATE_ID" = DBT_INTERNAL_SOURCE."TRANSACTION_DATE_ID","UPDATED_AT" = DBT_INTERNAL_SOURCE."UPDATED_AT","LOADED_AT" = DBT_INTERNAL_SOURCE."LOADED_AT","ITEM_ID" = DBT_INTERNAL_SOURCE."ITEM_ID","STORE_KEY" = DBT_INTERNAL_SOURCE."STORE_KEY","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","Qty" = DBT_INTERNAL_SOURCE."Qty","Unit Price" = DBT_INTERNAL_SOURCE."Unit Price","Sales Amount" = DBT_INTERNAL_SOURCE."Sales Amount","Unit Cost" = DBT_INTERNAL_SOURCE."Unit Cost","Cost" = DBT_INTERNAL_SOURCE."Cost","Margin" = DBT_INTERNAL_SOURCE."Margin"
    

    when not matched then insert
        ("ID", "TRANSACTION_DATE_ID", "UPDATED_AT", "LOADED_AT", "ITEM_ID", "STORE_KEY", "CUSTOMER_ID", "Qty", "Unit Price", "Sales Amount", "Unit Cost", "Cost", "Margin")
    values
        ("ID", "TRANSACTION_DATE_ID", "UPDATED_AT", "LOADED_AT", "ITEM_ID", "STORE_KEY", "CUSTOMER_ID", "Qty", "Unit Price", "Sales Amount", "Unit Cost", "Cost", "Margin")

;
[0m19:17:17.431898 [debug] [Thread-1 (]: SQL status: SUCCESS 70 in 1.573 seconds
[0m19:17:17.431898 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m19:17:17.431898 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
COMMIT
[0m19:17:17.635494 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.194 seconds
[0m19:17:17.651198 [debug] [Thread-1 (]: Applying DROP to: EPICALDEMO.broman_analytics.fact_sales_transactions_incremental__dbt_tmp
[0m19:17:17.667032 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m19:17:17.667032 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
drop view if exists EPICALDEMO.broman_analytics.fact_sales_transactions_incremental__dbt_tmp cascade
[0m19:17:17.759532 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.081 seconds
[0m19:17:17.804902 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f013032-cbe5-486b-8d0b-7f9a1169d40a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B27D7CDC50>]}
[0m19:17:17.804902 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model broman_analytics.fact_sales_transactions_incremental  [[32mSUCCESS 70[0m in 2.98s]
[0m19:17:17.816883 [debug] [Thread-1 (]: Finished running node model.epicaldemo.fact_sales_transactions_incremental
[0m19:17:17.816883 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:17:17.819907 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m19:17:17.819907 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m19:17:17.878564 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m19:17:17.878564 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m19:17:18.150018 [debug] [MainThread]: Connection 'model.epicaldemo.fact_sales_transactions_incremental' was left open.
[0m19:17:18.150018 [debug] [MainThread]: On model.epicaldemo.fact_sales_transactions_incremental: Close
[0m19:17:18.212953 [info ] [MainThread]: 
[0m19:17:18.212953 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 4.86 seconds (4.86s).
[0m19:17:18.212953 [debug] [MainThread]: Command end result
[0m19:17:18.260843 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m19:17:18.260843 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m19:17:18.268886 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m19:17:18.268886 [info ] [MainThread]: 
[0m19:17:18.275259 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:17:18.275259 [info ] [MainThread]: 
[0m19:17:18.277488 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:17:18.278857 [debug] [MainThread]: Command `dbt run` succeeded at 19:17:18.278857 after 6.73 seconds
[0m19:17:18.278857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B27AFA9E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B27C4D7DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2768D5150>]}
[0m19:17:18.278857 [debug] [MainThread]: Flushing usage events
[0m19:17:18.760363 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:18:47.841032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026064772E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026064771D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026064773290>]}


============================== 19:18:47.861109 | 897353d7-ce38-4da3-804c-2acf9f0479f6 ==============================
[0m19:18:47.861109 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:18:47.862277 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -s fact_sales_transactions_incremental', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:18:53.224903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '897353d7-ce38-4da3-804c-2acf9f0479f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260647B5490>]}
[0m19:18:53.287838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '897353d7-ce38-4da3-804c-2acf9f0479f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026065B31690>]}
[0m19:18:53.319172 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m19:18:54.070494 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:18:56.359415 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:18:56.359415 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:18:56.359415 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m19:18:56.426445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '897353d7-ce38-4da3-804c-2acf9f0479f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026065BC1510>]}
[0m19:18:56.526173 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m19:18:56.573022 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m19:18:56.999296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '897353d7-ce38-4da3-804c-2acf9f0479f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260662B7E10>]}
[0m19:18:56.999296 [info ] [MainThread]: Found 1 snapshot, 14 models, 8 sources, 1 exposure, 476 macros
[0m19:18:56.999296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '897353d7-ce38-4da3-804c-2acf9f0479f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260634A9750>]}
[0m19:18:56.999296 [info ] [MainThread]: 
[0m19:18:56.999296 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:18:57.013731 [info ] [MainThread]: 
[0m19:18:57.015331 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:18:57.015331 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m19:19:00.474441 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m19:19:00.474441 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m19:19:00.474441 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:19:01.232002 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.759 seconds
[0m19:19:01.232002 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m19:19:01.247659 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m19:19:01.247659 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m19:19:01.247659 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:19:01.720995 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.477 seconds
[0m19:19:01.736614 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m19:19:01.736614 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m19:19:01.847026 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.105 seconds
[0m19:19:01.847026 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m19:19:01.847026 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m19:19:01.926384 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.065 seconds
[0m19:19:01.926384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '897353d7-ce38-4da3-804c-2acf9f0479f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002606314EBD0>]}
[0m19:19:01.943353 [debug] [Thread-1 (]: Began running node model.epicaldemo.fact_sales_transactions_incremental
[0m19:19:01.943353 [info ] [Thread-1 (]: 1 of 1 START sql incremental model broman_analytics.fact_sales_transactions_incremental  [RUN]
[0m19:19:01.943353 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.fact_sales_transactions_incremental'
[0m19:19:01.949258 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.fact_sales_transactions_incremental
[0m19:19:01.970792 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.fact_sales_transactions_incremental"
[0m19:19:01.970792 [debug] [Thread-1 (]: Began executing node model.epicaldemo.fact_sales_transactions_incremental
[0m19:19:02.038402 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m19:19:02.038402 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
create or replace  temporary view EPICALDEMO.broman_analytics.fact_sales_transactions_incremental__dbt_tmp
  
   as (
    

WITH

sales AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__transactions

    
    WHERE UPDATED_AT >= (SELECT MAX(UPDATED_AT) FROM EPICALDEMO.broman_analytics.fact_sales_transactions_incremental)
    
),

items AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__items
),

stores AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__stores
),

customers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_salesforce__customers
),

final AS (
    SELECT
        -- Identifiers
        sales.id
        ,sales.transaction_date_id
        ,sales.updated_at
        ,CONVERT_TIMEZONE('Europe/Stockholm', CURRENT_TIMESTAMP()) AS loaded_at

        ,CASE
            WHEN sales.sku IS NULL THEN -2 -- SKU is missing FROM Source
            WHEN items.item_id IS NULL THEN -1 -- SKU is not known FROM Source
            ELSE items.item_id -- Use item_id FROM Dim based on SKU
         END AS item_id

        ,CASE
            WHEN sales."Store" IS NULL THEN -2
            WHEN stores.store_key IS NULL THEN -1
            ELSE stores.store_key
         END AS store_key

        ,CASE
            WHEN sales."Customer Number" IS NULL THEN -2
            WHEN customers.customer_id IS NULL THEN -1
            ELSE customers.customer_id
         END AS customer_id

        -- Metrics
        ,sales."Qty"
        ,sales."Unit Price"
        ,sales."Sales Amount"
        ,sales."Unit Cost"
        ,sales."Cost"
        ,sales."Margin"
    FROM sales
    LEFT JOIN items ON items."SKU" = sales."SKU"
    LEFT JOIN stores ON stores."Store" = sales."Store" AND sales.transaction_date_id >= stores.valid_from AND sales.transaction_date_id < stores.valid_to
    LEFT JOIN customers ON customers."Customer Number" = sales."Customer Number"
)

SELECT * FROM final
  );
[0m19:19:02.038402 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:19:03.023677 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.980 seconds
[0m19:19:03.035989 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m19:19:03.035989 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
describe table EPICALDEMO.broman_analytics.fact_sales_transactions_incremental__dbt_tmp
[0m19:19:03.084108 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.049 seconds
[0m19:19:03.100351 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m19:19:03.102432 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
describe table EPICALDEMO.broman_analytics.fact_sales_transactions_incremental
[0m19:19:03.146740 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.056 seconds
[0m19:19:03.162377 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m19:19:03.162377 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."FACT_SALES_TRANSACTIONS_INCREMENTAL"
[0m19:19:03.209684 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.049 seconds
[0m19:19:03.256879 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.fact_sales_transactions_incremental"
[0m19:19:03.262500 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m19:19:03.262500 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
-- back compat for old kwarg name
  
  begin;
[0m19:19:03.336353 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.072 seconds
[0m19:19:03.336353 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m19:19:03.336353 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
merge into EPICALDEMO.broman_analytics.fact_sales_transactions_incremental as DBT_INTERNAL_DEST
        using EPICALDEMO.broman_analytics.fact_sales_transactions_incremental__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.transaction_date_id = DBT_INTERNAL_DEST.transaction_date_id
                ) and (
                    DBT_INTERNAL_SOURCE.item_id = DBT_INTERNAL_DEST.item_id
                ) and (
                    DBT_INTERNAL_SOURCE.store_key = DBT_INTERNAL_DEST.store_key
                ) and (
                    DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
                )

    
    when matched then update set
        "ID" = DBT_INTERNAL_SOURCE."ID","TRANSACTION_DATE_ID" = DBT_INTERNAL_SOURCE."TRANSACTION_DATE_ID","UPDATED_AT" = DBT_INTERNAL_SOURCE."UPDATED_AT","LOADED_AT" = DBT_INTERNAL_SOURCE."LOADED_AT","ITEM_ID" = DBT_INTERNAL_SOURCE."ITEM_ID","STORE_KEY" = DBT_INTERNAL_SOURCE."STORE_KEY","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","Qty" = DBT_INTERNAL_SOURCE."Qty","Unit Price" = DBT_INTERNAL_SOURCE."Unit Price","Sales Amount" = DBT_INTERNAL_SOURCE."Sales Amount","Unit Cost" = DBT_INTERNAL_SOURCE."Unit Cost","Cost" = DBT_INTERNAL_SOURCE."Cost","Margin" = DBT_INTERNAL_SOURCE."Margin"
    

    when not matched then insert
        ("ID", "TRANSACTION_DATE_ID", "UPDATED_AT", "LOADED_AT", "ITEM_ID", "STORE_KEY", "CUSTOMER_ID", "Qty", "Unit Price", "Sales Amount", "Unit Cost", "Cost", "Margin")
    values
        ("ID", "TRANSACTION_DATE_ID", "UPDATED_AT", "LOADED_AT", "ITEM_ID", "STORE_KEY", "CUSTOMER_ID", "Qty", "Unit Price", "Sales Amount", "Unit Cost", "Cost", "Margin")

;
[0m19:19:04.479995 [debug] [Thread-1 (]: SQL status: SUCCESS 6 in 1.152 seconds
[0m19:19:04.495619 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m19:19:04.495619 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
COMMIT
[0m19:19:04.745487 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.253 seconds
[0m19:19:04.761047 [debug] [Thread-1 (]: Applying DROP to: EPICALDEMO.broman_analytics.fact_sales_transactions_incremental__dbt_tmp
[0m19:19:04.761047 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m19:19:04.761047 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
drop view if exists EPICALDEMO.broman_analytics.fact_sales_transactions_incremental__dbt_tmp cascade
[0m19:19:04.888318 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.114 seconds
[0m19:19:04.950180 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '897353d7-ce38-4da3-804c-2acf9f0479f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026066CC2150>]}
[0m19:19:04.950180 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model broman_analytics.fact_sales_transactions_incremental  [[32mSUCCESS 6[0m in 2.98s]
[0m19:19:04.950180 [debug] [Thread-1 (]: Finished running node model.epicaldemo.fact_sales_transactions_incremental
[0m19:19:04.962238 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:19:04.962238 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m19:19:04.966250 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m19:19:05.159711 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m19:19:05.159711 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m19:19:05.215620 [debug] [MainThread]: Connection 'model.epicaldemo.fact_sales_transactions_incremental' was left open.
[0m19:19:05.215620 [debug] [MainThread]: On model.epicaldemo.fact_sales_transactions_incremental: Close
[0m19:19:05.293712 [info ] [MainThread]: 
[0m19:19:05.293712 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 8.28 seconds (8.28s).
[0m19:19:05.293712 [debug] [MainThread]: Command end result
[0m19:19:05.337225 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m19:19:05.337225 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m19:19:05.352102 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m19:19:05.353177 [info ] [MainThread]: 
[0m19:19:05.354209 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:19:05.355228 [info ] [MainThread]: 
[0m19:19:05.356251 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:19:05.357307 [debug] [MainThread]: Command `dbt run` succeeded at 19:19:05.357307 after 17.67 seconds
[0m19:19:05.358342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260647D3D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002605F012E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002605F012190>]}
[0m19:19:05.359385 [debug] [MainThread]: Flushing usage events
[0m19:19:05.844172 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:20:13.484919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228B326B310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228B3273D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228B32721D0>]}


============================== 19:20:13.499930 | cbdb0db8-f6dc-47a2-b28b-d34f0ffc4ddb ==============================
[0m19:20:13.499930 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:20:13.499930 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -s fact_sales_transactions_incremental', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:20:14.146327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cbdb0db8-f6dc-47a2-b28b-d34f0ffc4ddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228B3272D50>]}
[0m19:20:14.193222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cbdb0db8-f6dc-47a2-b28b-d34f0ffc4ddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228B4531590>]}
[0m19:20:14.208855 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m19:20:14.640854 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:20:14.930162 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:20:14.930162 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:20:14.938234 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m19:20:14.979940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cbdb0db8-f6dc-47a2-b28b-d34f0ffc4ddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228B4B7B3D0>]}
[0m19:20:15.096672 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m19:20:15.099052 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m19:20:15.130288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cbdb0db8-f6dc-47a2-b28b-d34f0ffc4ddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228B480FF90>]}
[0m19:20:15.132184 [info ] [MainThread]: Found 1 snapshot, 14 models, 8 sources, 1 exposure, 476 macros
[0m19:20:15.132184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cbdb0db8-f6dc-47a2-b28b-d34f0ffc4ddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228B4B08610>]}
[0m19:20:15.132184 [info ] [MainThread]: 
[0m19:20:15.132184 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:20:15.139856 [info ] [MainThread]: 
[0m19:20:15.142223 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:20:15.144462 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m19:20:15.242355 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m19:20:15.242355 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m19:20:15.242355 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:20:15.789519 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.546 seconds
[0m19:20:15.805217 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m19:20:15.820915 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m19:20:15.836540 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m19:20:15.836540 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:20:16.394177 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.566 seconds
[0m19:20:16.409798 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m19:20:16.409798 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m19:20:16.508673 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.089 seconds
[0m19:20:16.516747 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m19:20:16.516747 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m19:20:16.579493 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.063 seconds
[0m19:20:16.594504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cbdb0db8-f6dc-47a2-b28b-d34f0ffc4ddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228B4F2B110>]}
[0m19:20:16.594504 [debug] [Thread-1 (]: Began running node model.epicaldemo.fact_sales_transactions_incremental
[0m19:20:16.610144 [info ] [Thread-1 (]: 1 of 1 START sql incremental model broman_analytics.fact_sales_transactions_incremental  [RUN]
[0m19:20:16.610144 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.fact_sales_transactions_incremental'
[0m19:20:16.610144 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.fact_sales_transactions_incremental
[0m19:20:16.649523 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.fact_sales_transactions_incremental"
[0m19:20:16.649523 [debug] [Thread-1 (]: Began executing node model.epicaldemo.fact_sales_transactions_incremental
[0m19:20:16.732066 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m19:20:16.732066 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
create or replace  temporary view EPICALDEMO.broman_analytics.fact_sales_transactions_incremental__dbt_tmp
  
   as (
    

WITH

sales AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__transactions

    
    WHERE UPDATED_AT >= (SELECT MAX(UPDATED_AT) FROM EPICALDEMO.broman_analytics.fact_sales_transactions_incremental)
    
),

items AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__items
),

stores AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__stores
),

customers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_salesforce__customers
),

final AS (
    SELECT
        -- Identifiers
        sales.id
        ,sales.transaction_date_id
        ,sales.updated_at
        ,CONVERT_TIMEZONE('Europe/Stockholm', CURRENT_TIMESTAMP()) AS loaded_at

        ,CASE
            WHEN sales.sku IS NULL THEN -2 -- SKU is missing FROM Source
            WHEN items.item_id IS NULL THEN -1 -- SKU is not known FROM Source
            ELSE items.item_id -- Use item_id FROM Dim based on SKU
         END AS item_id

        ,CASE
            WHEN sales."Store" IS NULL THEN -2
            WHEN stores.store_key IS NULL THEN -1
            ELSE stores.store_key
         END AS store_key

        ,CASE
            WHEN sales."Customer Number" IS NULL THEN -2
            WHEN customers.customer_id IS NULL THEN -1
            ELSE customers.customer_id
         END AS customer_id

        -- Metrics
        ,sales."Qty"
        ,sales."Unit Price"
        ,sales."Sales Amount"
        ,sales."Unit Cost"
        ,sales."Cost"
        ,sales."Margin"
    FROM sales
    LEFT JOIN items ON items."SKU" = sales."SKU"
    LEFT JOIN stores ON stores."Store" = sales."Store" AND sales.transaction_date_id >= stores.valid_from AND sales.transaction_date_id < stores.valid_to
    LEFT JOIN customers ON customers."Customer Number" = sales."Customer Number"
)

SELECT * FROM final
  );
[0m19:20:16.744638 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:20:17.445951 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.706 seconds
[0m19:20:17.475717 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m19:20:17.475717 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
describe table EPICALDEMO.broman_analytics.fact_sales_transactions_incremental__dbt_tmp
[0m19:20:17.552992 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.075 seconds
[0m19:20:17.552992 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m19:20:17.566716 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
describe table EPICALDEMO.broman_analytics.fact_sales_transactions_incremental
[0m19:20:17.614445 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.053 seconds
[0m19:20:17.629951 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m19:20:17.646096 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."FACT_SALES_TRANSACTIONS_INCREMENTAL"
[0m19:20:17.694310 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.046 seconds
[0m19:20:17.756252 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.fact_sales_transactions_incremental"
[0m19:20:17.771958 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m19:20:17.771958 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
-- back compat for old kwarg name
  
  begin;
[0m19:20:17.834967 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.067 seconds
[0m19:20:17.846480 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m19:20:17.846480 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
merge into EPICALDEMO.broman_analytics.fact_sales_transactions_incremental as DBT_INTERNAL_DEST
        using EPICALDEMO.broman_analytics.fact_sales_transactions_incremental__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.transaction_date_id = DBT_INTERNAL_DEST.transaction_date_id
                ) and (
                    DBT_INTERNAL_SOURCE.item_id = DBT_INTERNAL_DEST.item_id
                ) and (
                    DBT_INTERNAL_SOURCE.store_key = DBT_INTERNAL_DEST.store_key
                ) and (
                    DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
                )

    
    when matched then update set
        "ID" = DBT_INTERNAL_SOURCE."ID","TRANSACTION_DATE_ID" = DBT_INTERNAL_SOURCE."TRANSACTION_DATE_ID","UPDATED_AT" = DBT_INTERNAL_SOURCE."UPDATED_AT","LOADED_AT" = DBT_INTERNAL_SOURCE."LOADED_AT","ITEM_ID" = DBT_INTERNAL_SOURCE."ITEM_ID","STORE_KEY" = DBT_INTERNAL_SOURCE."STORE_KEY","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","Qty" = DBT_INTERNAL_SOURCE."Qty","Unit Price" = DBT_INTERNAL_SOURCE."Unit Price","Sales Amount" = DBT_INTERNAL_SOURCE."Sales Amount","Unit Cost" = DBT_INTERNAL_SOURCE."Unit Cost","Cost" = DBT_INTERNAL_SOURCE."Cost","Margin" = DBT_INTERNAL_SOURCE."Margin"
    

    when not matched then insert
        ("ID", "TRANSACTION_DATE_ID", "UPDATED_AT", "LOADED_AT", "ITEM_ID", "STORE_KEY", "CUSTOMER_ID", "Qty", "Unit Price", "Sales Amount", "Unit Cost", "Cost", "Margin")
    values
        ("ID", "TRANSACTION_DATE_ID", "UPDATED_AT", "LOADED_AT", "ITEM_ID", "STORE_KEY", "CUSTOMER_ID", "Qty", "Unit Price", "Sales Amount", "Unit Cost", "Cost", "Margin")

;
[0m19:20:18.996801 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.157 seconds
[0m19:20:18.996801 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m19:20:18.996801 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
COMMIT
[0m19:20:19.288952 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.282 seconds
[0m19:20:19.304567 [debug] [Thread-1 (]: Applying DROP to: EPICALDEMO.broman_analytics.fact_sales_transactions_incremental__dbt_tmp
[0m19:20:19.320190 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m19:20:19.320190 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
drop view if exists EPICALDEMO.broman_analytics.fact_sales_transactions_incremental__dbt_tmp cascade
[0m19:20:19.399464 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.076 seconds
[0m19:20:19.448795 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbdb0db8-f6dc-47a2-b28b-d34f0ffc4ddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228B52F66D0>]}
[0m19:20:19.462957 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model broman_analytics.fact_sales_transactions_incremental  [[32mSUCCESS 1[0m in 2.84s]
[0m19:20:19.462957 [debug] [Thread-1 (]: Finished running node model.epicaldemo.fact_sales_transactions_incremental
[0m19:20:19.462957 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:20:19.462957 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m19:20:19.462957 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m19:20:19.525454 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m19:20:19.525454 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m19:20:19.582021 [debug] [MainThread]: Connection 'model.epicaldemo.fact_sales_transactions_incremental' was left open.
[0m19:20:19.597623 [debug] [MainThread]: On model.epicaldemo.fact_sales_transactions_incremental: Close
[0m19:20:19.660779 [info ] [MainThread]: 
[0m19:20:19.660779 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 4.52 seconds (4.52s).
[0m19:20:19.660779 [debug] [MainThread]: Command end result
[0m19:20:19.724583 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m19:20:19.724583 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m19:20:19.741058 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m19:20:19.741058 [info ] [MainThread]: 
[0m19:20:19.741058 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:20:19.741058 [info ] [MainThread]: 
[0m19:20:19.748617 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:20:19.751817 [debug] [MainThread]: Command `dbt run` succeeded at 19:20:19.748617 after 6.37 seconds
[0m19:20:19.751817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228B29ADD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228B32D7FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228B2EB4AD0>]}
[0m19:20:19.751817 [debug] [MainThread]: Flushing usage events
[0m19:20:20.162365 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:21:10.910129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D444995050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D444D4F550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D444CB4C10>]}


============================== 19:21:10.925744 | 1b103301-2ece-4ca8-a694-964892fcb6b2 ==============================
[0m19:21:10.925744 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:21:10.925744 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:21:11.603947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b103301-2ece-4ca8-a694-964892fcb6b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D44629B510>]}
[0m19:21:11.658346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b103301-2ece-4ca8-a694-964892fcb6b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D443A57890>]}
[0m19:21:11.659612 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m19:21:12.170108 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:21:12.461152 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:21:12.461152 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:21:12.476762 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m19:21:12.538614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b103301-2ece-4ca8-a694-964892fcb6b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D446AB3AD0>]}
[0m19:21:12.651095 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m19:21:12.657107 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m19:21:12.806943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b103301-2ece-4ca8-a694-964892fcb6b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D446D57F50>]}
[0m19:21:12.806943 [info ] [MainThread]: Found 1 snapshot, 14 models, 8 sources, 1 exposure, 476 macros
[0m19:21:12.822598 [info ] [MainThread]: 
[0m19:21:12.822598 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:21:12.830020 [info ] [MainThread]: 
[0m19:21:12.831302 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:21:12.838718 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m19:21:12.945584 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m19:21:12.945584 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m19:21:12.945584 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:21:13.425331 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.475 seconds
[0m19:21:13.425331 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m19:21:13.457123 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m19:21:13.457123 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m19:21:13.457123 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:21:13.708353 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.243 seconds
[0m19:21:13.708353 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m19:21:13.708353 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m19:21:13.786927 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.079 seconds
[0m19:21:13.802555 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m19:21:13.802555 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m19:21:13.852317 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.048 seconds
[0m19:21:13.865705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b103301-2ece-4ca8-a694-964892fcb6b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D446A05B10>]}
[0m19:21:13.870394 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__categories
[0m19:21:13.882305 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_d365_fo__dates
[0m19:21:13.884402 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_d365_fo__items
[0m19:21:13.885765 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_d365_fo__managers
[0m19:21:13.886809 [info ] [Thread-1 (]: 1 of 15 START sql view model broman_analytics.stg_d365_fo__categories .......... [RUN]
[0m19:21:13.890047 [info ] [Thread-2 (]: 2 of 15 START sql view model broman_analytics.stg_d365_fo__dates ............... [RUN]
[0m19:21:13.891745 [info ] [Thread-3 (]: 3 of 15 START sql view model broman_analytics.stg_d365_fo__items ............... [RUN]
[0m19:21:13.891745 [info ] [Thread-4 (]: 4 of 15 START sql view model broman_analytics.stg_d365_fo__managers ............ [RUN]
[0m19:21:13.906919 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__categories'
[0m19:21:13.906919 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__dates'
[0m19:21:13.912564 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__items'
[0m19:21:13.912564 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__managers'
[0m19:21:13.912564 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__categories
[0m19:21:13.912564 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_d365_fo__dates
[0m19:21:13.912564 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_d365_fo__items
[0m19:21:13.912564 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_d365_fo__managers
[0m19:21:13.928501 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__categories"
[0m19:21:13.936847 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__dates"
[0m19:21:13.942119 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__items"
[0m19:21:13.952718 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__managers"
[0m19:21:13.955822 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__categories
[0m19:21:13.957214 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_d365_fo__dates
[0m19:21:13.985375 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_d365_fo__items
[0m19:21:13.993745 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__categories"
[0m19:21:14.001815 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_d365_fo__managers
[0m19:21:14.001815 [debug] [Thread-2 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__dates"
[0m19:21:14.010184 [debug] [Thread-3 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__items"
[0m19:21:14.018821 [debug] [Thread-4 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__managers"
[0m19:21:14.020950 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__categories"
[0m19:21:14.023045 [debug] [Thread-3 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__items"
[0m19:21:14.025147 [debug] [Thread-2 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__dates"
[0m19:21:14.025209 [debug] [Thread-1 (]: On model.epicaldemo.stg_d365_fo__categories: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__categories"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__categories
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.category
),

final AS (
    SELECT
        id AS category_id
        ,INITCAP(name) AS "Category"
        ,managerid AS manager_id
    FROM source
)

SELECT * FROM final
  );
[0m19:21:14.026310 [debug] [Thread-3 (]: On model.epicaldemo.stg_d365_fo__items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__items"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__items
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.item
),

final AS (
    SELECT
        id AS item_id
        ,name AS "Item"
        ,COALESCE(brand, 'Missing') AS "Brand"
        ,categoryid AS category_id
        ,COALESCE(flavor, 'Missing') AS "Flavor"
        ,sku AS "SKU"
    FROM source
)

SELECT * FROM final
  );
[0m19:21:14.027322 [debug] [Thread-2 (]: On model.epicaldemo.stg_d365_fo__dates: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__dates"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__dates
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.date
),

final AS (
    SELECT
        id AS date_id
        ,date AS "Date"
        ,year AS "Year"
        ,yearmonth AS "Year Month"
        ,LEFT(id::TEXT, 4) || '-' || RIGHT(id::TEXT, 2) AS "Year Month Number"
        ,monthnumber AS "Month Number"
        ,quarter AS "Quarter"
        ,quarternumber AS "Quarter Number"
        ,monthname AS "Month"
        ,LEFT(monthname,3) AS "Month Short"
    FROM source
)

SELECT * FROM final
  );
[0m19:21:14.027322 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:21:14.028632 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:21:14.029646 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:21:14.029646 [debug] [Thread-4 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__managers"
[0m19:21:14.029646 [debug] [Thread-4 (]: On model.epicaldemo.stg_d365_fo__managers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__managers"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__managers
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.manager
),

final AS (
    SELECT
        id AS manager_id
        ,firstname || ' ' || lastname AS "Manager"
    FROM source
)

SELECT * FROM final
  );
[0m19:21:14.029646 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:21:14.591862 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.567 seconds
[0m19:21:14.591862 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.558 seconds
[0m19:21:14.638785 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.614 seconds
[0m19:21:14.638785 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.614 seconds
[0m19:21:14.638785 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b103301-2ece-4ca8-a694-964892fcb6b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4462AB550>]}
[0m19:21:14.638785 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b103301-2ece-4ca8-a694-964892fcb6b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4474BFD90>]}
[0m19:21:14.648854 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b103301-2ece-4ca8-a694-964892fcb6b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4474F7B50>]}
[0m19:21:14.655672 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b103301-2ece-4ca8-a694-964892fcb6b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D447183A90>]}
[0m19:21:14.657964 [info ] [Thread-3 (]: 3 of 15 OK created sql view model broman_analytics.stg_d365_fo__items .......... [[32mSUCCESS 1[0m in 0.72s]
[0m19:21:14.660102 [info ] [Thread-4 (]: 4 of 15 OK created sql view model broman_analytics.stg_d365_fo__managers ....... [[32mSUCCESS 1[0m in 0.73s]
[0m19:21:14.661943 [info ] [Thread-1 (]: 1 of 15 OK created sql view model broman_analytics.stg_d365_fo__categories ..... [[32mSUCCESS 1[0m in 0.74s]
[0m19:21:14.663841 [info ] [Thread-2 (]: 2 of 15 OK created sql view model broman_analytics.stg_d365_fo__dates .......... [[32mSUCCESS 1[0m in 0.75s]
[0m19:21:14.665615 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_d365_fo__items
[0m19:21:14.667941 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_d365_fo__managers
[0m19:21:14.669473 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__categories
[0m19:21:14.671997 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_d365_fo__dates
[0m19:21:14.671997 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_d365_fo__transactions
[0m19:21:14.671997 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_inriver__item_attributes
[0m19:21:14.671997 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_salesforce__customers
[0m19:21:14.671997 [debug] [Thread-2 (]: Began running node snapshot.epicaldemo.stores_snapshot
[0m19:21:14.671997 [info ] [Thread-3 (]: 5 of 15 START sql view model broman_analytics.stg_d365_fo__transactions ........ [RUN]
[0m19:21:14.680276 [info ] [Thread-4 (]: 6 of 15 START sql view model broman_analytics.stg_inriver__item_attributes ..... [RUN]
[0m19:21:14.680276 [info ] [Thread-1 (]: 7 of 15 START sql view model broman_analytics.stg_salesforce__customers ........ [RUN]
[0m19:21:14.680276 [info ] [Thread-2 (]: 8 of 15 START snapshot broman_analytics.stores_snapshot ........................ [RUN]
[0m19:21:14.680276 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__items, now model.epicaldemo.stg_d365_fo__transactions)
[0m19:21:14.680276 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__managers, now model.epicaldemo.stg_inriver__item_attributes)
[0m19:21:14.680276 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__categories, now model.epicaldemo.stg_salesforce__customers)
[0m19:21:14.680276 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__dates, now snapshot.epicaldemo.stores_snapshot)
[0m19:21:14.680276 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_d365_fo__transactions
[0m19:21:14.688244 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_inriver__item_attributes
[0m19:21:14.688244 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_salesforce__customers
[0m19:21:14.690274 [debug] [Thread-2 (]: Began compiling node snapshot.epicaldemo.stores_snapshot
[0m19:21:14.690274 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__transactions"
[0m19:21:14.697343 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_inriver__item_attributes"
[0m19:21:14.698445 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_salesforce__customers"
[0m19:21:14.704463 [debug] [Thread-2 (]: Began executing node snapshot.epicaldemo.stores_snapshot
[0m19:21:14.707094 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_d365_fo__transactions
[0m19:21:14.720047 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_inriver__item_attributes
[0m19:21:14.753169 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_salesforce__customers
[0m19:21:14.754789 [debug] [Thread-2 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m19:21:14.754789 [debug] [Thread-3 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__transactions"
[0m19:21:14.769720 [debug] [Thread-4 (]: Writing runtime sql for node "model.epicaldemo.stg_inriver__item_attributes"
[0m19:21:14.769720 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.stg_salesforce__customers"
[0m19:21:14.777749 [debug] [Thread-2 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
[0m19:21:14.779377 [debug] [Thread-3 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__transactions"
[0m19:21:14.779377 [debug] [Thread-4 (]: Using snowflake connection "model.epicaldemo.stg_inriver__item_attributes"
[0m19:21:14.786894 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.stg_salesforce__customers"
[0m19:21:14.786894 [debug] [Thread-3 (]: On model.epicaldemo.stg_d365_fo__transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__transactions"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__transactions
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.transactions
),

final AS (
    SELECT
        -- Identifiers
        id
        ,updated_at
        ,CAST(TO_CHAR(transaction_date::DATE, 'YYYYMMDD') AS INTEGER) AS transaction_date_id
        ,sku AS "SKU"
        ,store AS "Store"
        ,customernumber AS "Customer Number"

        -- Metrics
        ,quantity AS "Qty"
        ,unitprice::NUMERIC(10,2) AS "Unit Price"
        ,(quantity * unitprice)::NUMERIC(10,2) AS "Sales Amount"
        ,unitcost::NUMERIC(10,2) AS "Unit Cost"
        ,(quantity * unitcost)::NUMERIC(10,2) AS "Cost"
        ,(quantity * unitprice)::NUMERIC(10,2) - (quantity * unitcost)::NUMERIC(10,2) AS "Margin"
    FROM source
)

SELECT * FROM final
  );
[0m19:21:14.786894 [debug] [Thread-4 (]: On model.epicaldemo.stg_inriver__item_attributes: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_inriver__item_attributes"} */
create or replace   view EPICALDEMO.broman_analytics.stg_inriver__item_attributes
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.inriver.item_attributes
),

final AS (
    SELECT
        id AS item_attributes_id
        ,sku AS "SKU"
        ,COALESCE(crunch_level, 'Missing') AS "Crunch Level"
        ,COALESCE(snack_time, 'Missing') AS "Snack Time"
    FROM source
)

SELECT * FROM final
  );
[0m19:21:14.786894 [debug] [Thread-1 (]: On model.epicaldemo.stg_salesforce__customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_salesforce__customers"} */
create or replace   view EPICALDEMO.broman_analytics.stg_salesforce__customers
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.salesforce.customer
),

final AS (
    SELECT
        id AS customer_id
        ,customernumber AS "Customer Number"
        ,age AS "Customer Age"

        ,CASE
            WHEN age < 20 THEN '< 20'
            WHEN age >= 20 AND age < 30 THEN '20 - 30'
            WHEN age >= 30 AND age < 50 THEN '30 - 50'
            WHEN age >= 50 AND age < 60 THEN '50 - 60'
            ELSE '60+'
         END AS "Customer Age Group"

        ,CASE
            WHEN age < 20 THEN 1
            WHEN age >= 20 AND age < 30 THEN 2
            WHEN age >= 30 AND age < 50 THEN 3
            WHEN age >= 50 AND age < 60 THEN 4
            ELSE 5
         END AS customer_age_group_sort

        ,state AS "Customer State"
    FROM source
)

SELECT * FROM final
  );
[0m19:21:14.826679 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.049 seconds
[0m19:21:14.889646 [debug] [Thread-2 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m19:21:14.889646 [debug] [Thread-2 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
create or replace temporary table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp"
as (
    
    
    with snapshot_query as (

        select * from EPICALDEMO.d365_fo.store

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            
  
  coalesce(nullif(modified, modified), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            modified as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.modified)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.modified)
        )
    )

    select * from insertions
    union all
    select * from updates

    )
;
[0m19:21:14.944184 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.147 seconds
[0m19:21:14.944344 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b103301-2ece-4ca8-a694-964892fcb6b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4474F7490>]}
[0m19:21:14.949424 [info ] [Thread-1 (]: 7 of 15 OK created sql view model broman_analytics.stg_salesforce__customers ... [[32mSUCCESS 1[0m in 0.26s]
[0m19:21:14.949424 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_salesforce__customers
[0m19:21:14.949424 [debug] [Thread-1 (]: Began running node model.epicaldemo.dim_dates
[0m19:21:14.949424 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.161 seconds
[0m19:21:14.949424 [info ] [Thread-1 (]: 9 of 15 START sql table model broman_analytics.dim_dates ....................... [RUN]
[0m19:21:14.959874 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b103301-2ece-4ca8-a694-964892fcb6b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D44740B010>]}
[0m19:21:14.960443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_salesforce__customers, now model.epicaldemo.dim_dates)
[0m19:21:14.960443 [info ] [Thread-4 (]: 6 of 15 OK created sql view model broman_analytics.stg_inriver__item_attributes  [[32mSUCCESS 1[0m in 0.28s]
[0m19:21:14.962670 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.dim_dates
[0m19:21:14.962670 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_inriver__item_attributes
[0m19:21:14.966298 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.dim_dates"
[0m19:21:14.966298 [debug] [Thread-4 (]: Began running node model.epicaldemo.dim_customers
[0m19:21:14.970633 [info ] [Thread-4 (]: 10 of 15 START sql table model broman_analytics.dim_customers .................. [RUN]
[0m19:21:14.970633 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_inriver__item_attributes, now model.epicaldemo.dim_customers)
[0m19:21:14.970633 [debug] [Thread-1 (]: Began executing node model.epicaldemo.dim_dates
[0m19:21:14.973207 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.dim_customers
[0m19:21:14.988396 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.dim_dates"
[0m19:21:14.997968 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.dim_customers"
[0m19:21:14.997968 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.dim_dates"
[0m19:21:14.997968 [debug] [Thread-1 (]: On model.epicaldemo.dim_dates: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_dates"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_dates
    

    
    as (with

dates AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__dates
),

final AS (
    SELECT
        date_id
        ,"Date"
        ,"Year"
        ,"Year Month"
        ,"Year Month Number"
        ,"Month Number"
        ,"Quarter"
        ,"Quarter Number"
        ,"Month"
        ,"Month Short"
    FROM dates
)

SELECT * FROM final
    )
;
[0m19:21:15.002957 [debug] [Thread-4 (]: Began executing node model.epicaldemo.dim_customers
[0m19:21:15.004232 [debug] [Thread-4 (]: Writing runtime sql for node "model.epicaldemo.dim_customers"
[0m19:21:15.004232 [debug] [Thread-4 (]: Using snowflake connection "model.epicaldemo.dim_customers"
[0m19:21:15.004232 [debug] [Thread-4 (]: On model.epicaldemo.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_customers"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_customers
    

    
    as (WITH

customers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_salesforce__customers
),

final AS (
    SELECT
        customer_id
        ,"Customer Number"
        ,"Customer Age"
        ,"Customer Age Group"
        ,customer_age_group_sort
        ,"Customer State"
    FROM customers
)

SELECT * FROM final
    )
;
[0m19:21:15.085906 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.294 seconds
[0m19:21:15.085906 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b103301-2ece-4ca8-a694-964892fcb6b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D44789F750>]}
[0m19:21:15.085906 [info ] [Thread-3 (]: 5 of 15 OK created sql view model broman_analytics.stg_d365_fo__transactions ... [[32mSUCCESS 1[0m in 0.41s]
[0m19:21:15.085906 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_d365_fo__transactions
[0m19:21:15.085906 [debug] [Thread-3 (]: Began running node model.epicaldemo.dim_items
[0m19:21:15.101571 [info ] [Thread-3 (]: 11 of 15 START sql table model broman_analytics.dim_items ...................... [RUN]
[0m19:21:15.101571 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__transactions, now model.epicaldemo.dim_items)
[0m19:21:15.101571 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.dim_items
[0m19:21:15.109606 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.dim_items"
[0m19:21:15.117759 [debug] [Thread-3 (]: Began executing node model.epicaldemo.dim_items
[0m19:21:15.135029 [debug] [Thread-3 (]: Writing runtime sql for node "model.epicaldemo.dim_items"
[0m19:21:15.141694 [debug] [Thread-3 (]: Using snowflake connection "model.epicaldemo.dim_items"
[0m19:21:15.141694 [debug] [Thread-3 (]: On model.epicaldemo.dim_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_items"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_items
    

    
    as (with

items AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__items
),

item_attributes AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_inriver__item_attributes
),

categories AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__categories
),

managers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__managers
),

unknown AS (
    SELECT
        -1 AS item_id
        ,'Unknown' AS "SKU"
        ,'Unknown' AS "Item"
        ,'Missing' AS "Brand"
        ,'Missing' AS "Flavor"
        ,'Missing' AS "Crunch Level"
        ,'Missing' AS "Snack Time"
        ,'Missing' AS "Category"
        ,'Missing' AS "Manager"
),

missing AS (
    SELECT
        -2 AS item_id
        ,'Missing' AS "SKU"
        ,'Missing' AS "Item"
        ,'Missing' AS "Brand"
        ,'Missing' AS "Flavor"
        ,'Missing' AS "Crunch Level"
        ,'Missing' AS "Snack Time"
        ,'Missing' AS "Category"
        ,'Missing' AS "Manager"
),

final AS (
    SELECT
        items.item_id
        ,items."SKU"
        ,items."Item"
        ,items."Brand"
        ,items."Flavor"
        ,COALESCE(item_attributes."Crunch Level", 'Missing') AS "Crunch Level"
        ,COALESCE(item_attributes."Snack Time", 'Missing') AS "Snack Time"
        ,categories."Category"
        ,managers."Manager"
    FROM items
    LEFT JOIN item_attributes ON item_attributes."SKU" = items."SKU"
    LEFT JOIN categories ON categories.category_id = items.category_id
    LEFT JOIN managers ON managers.manager_id = categories.manager_id

    UNION

    SELECT * FROM unknown

    UNION

    SELECT * FROM missing
)

SELECT * FROM final
    )
;
[0m19:21:15.610979 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.715 seconds
[0m19:21:15.610979 [debug] [Thread-2 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m19:21:15.626655 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.618 seconds
[0m19:21:15.626655 [debug] [Thread-2 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp"
[0m19:21:15.626655 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b103301-2ece-4ca8-a694-964892fcb6b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D44789DAD0>]}
[0m19:21:15.626655 [info ] [Thread-4 (]: 10 of 15 OK created sql table model broman_analytics.dim_customers ............. [[32mSUCCESS 1[0m in 0.66s]
[0m19:21:15.642229 [debug] [Thread-4 (]: Finished running node model.epicaldemo.dim_customers
[0m19:21:15.703616 [debug] [Thread-2 (]: SQL status: SUCCESS 13 in 0.071 seconds
[0m19:21:15.720186 [debug] [Thread-2 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m19:21:15.720186 [debug] [Thread-2 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
[0m19:21:15.759928 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.039 seconds
[0m19:21:15.768013 [debug] [Thread-2 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m19:21:15.768013 [debug] [Thread-2 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp"
[0m19:21:15.838682 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.835 seconds
[0m19:21:15.838682 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b103301-2ece-4ca8-a694-964892fcb6b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D44789E650>]}
[0m19:21:15.838682 [info ] [Thread-1 (]: 9 of 15 OK created sql table model broman_analytics.dim_dates .................. [[32mSUCCESS 1[0m in 0.88s]
[0m19:21:15.838682 [debug] [Thread-2 (]: SQL status: SUCCESS 13 in 0.076 seconds
[0m19:21:15.851773 [debug] [Thread-1 (]: Finished running node model.epicaldemo.dim_dates
[0m19:21:15.863291 [debug] [Thread-2 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m19:21:15.863291 [debug] [Thread-2 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
[0m19:21:15.920257 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.056 seconds
[0m19:21:15.943779 [debug] [Thread-2 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m19:21:15.943779 [debug] [Thread-2 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp"
[0m19:21:16.013313 [debug] [Thread-2 (]: SQL status: SUCCESS 13 in 0.061 seconds
[0m19:21:16.033589 [debug] [Thread-2 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m19:21:16.033589 [debug] [Thread-2 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from EPICALDEMO.d365_fo.store

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            
  
  coalesce(nullif(modified, modified), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            modified as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.modified)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.modified)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m19:21:16.222209 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.183 seconds
[0m19:21:16.237823 [debug] [Thread-2 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m19:21:16.237823 [debug] [Thread-2 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m19:21:16.285515 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.049 seconds
[0m19:21:16.285515 [warn ] [Thread-2 (]: Data type of snapshot table timestamp columns (TIMESTAMP_NTZ) doesn't match derived column 'updated_at' (DATE). Please update snapshot config 'updated_at'.
[0m19:21:16.301161 [debug] [Thread-2 (]: Writing runtime sql for node "snapshot.epicaldemo.stores_snapshot"
[0m19:21:16.304991 [debug] [Thread-2 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m19:21:16.304991 [debug] [Thread-2 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
BEGIN
[0m19:21:16.352925 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.058 seconds
[0m19:21:16.369189 [debug] [Thread-2 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m19:21:16.370025 [debug] [Thread-2 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
merge into "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT" as DBT_INTERNAL_DEST
    using "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
	
	
	and ((DBT_INTERNAL_DEST.dbt_valid_to = to_date('9999-12-31'))
 or DBT_INTERNAL_DEST.dbt_valid_to is null)

     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("ID", "NAME", "LOCATION", "LATITUDE", "LONGITUDE", "ONLINEPRESENCE", "MODIFIED", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("ID", "NAME", "LOCATION", "LATITUDE", "LONGITUDE", "ONLINEPRESENCE", "MODIFIED", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m19:21:16.472393 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.332 seconds
[0m19:21:16.472393 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b103301-2ece-4ca8-a694-964892fcb6b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D447917DD0>]}
[0m19:21:16.472393 [info ] [Thread-3 (]: 11 of 15 OK created sql table model broman_analytics.dim_items ................. [[32mSUCCESS 1[0m in 1.37s]
[0m19:21:16.472393 [debug] [Thread-3 (]: Finished running node model.epicaldemo.dim_items
[0m19:21:16.813454 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.450 seconds
[0m19:21:16.813454 [debug] [Thread-2 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m19:21:16.813454 [debug] [Thread-2 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
COMMIT
[0m19:21:17.041577 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.218 seconds
[0m19:21:17.055469 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b103301-2ece-4ca8-a694-964892fcb6b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D447887C90>]}
[0m19:21:17.055469 [info ] [Thread-2 (]: 8 of 15 OK snapshotted broman_analytics.stores_snapshot ........................ [[32mSUCCESS 0[0m in 2.38s]
[0m19:21:17.055469 [debug] [Thread-2 (]: Finished running node snapshot.epicaldemo.stores_snapshot
[0m19:21:17.065546 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_d365_fo__stores
[0m19:21:17.065546 [info ] [Thread-4 (]: 12 of 15 START sql view model broman_analytics.stg_d365_fo__stores ............. [RUN]
[0m19:21:17.065546 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.dim_customers, now model.epicaldemo.stg_d365_fo__stores)
[0m19:21:17.073164 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_d365_fo__stores
[0m19:21:17.081423 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__stores"
[0m19:21:17.085598 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_d365_fo__stores
[0m19:21:17.088255 [debug] [Thread-4 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__stores"
[0m19:21:17.097273 [debug] [Thread-4 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__stores"
[0m19:21:17.098935 [debug] [Thread-4 (]: On model.epicaldemo.stg_d365_fo__stores: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__stores"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__stores
  
   as (
    WITH

stores_snapshots AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stores_snapshot
),

final AS (
    SELECT
        -- Identifiers
        id AS store_id

        -- SCD2 Fields
        ,dbt_scd_id
        ,ROW_NUMBER() OVER (ORDER BY id ASC, dbt_valid_from ASC) AS store_key
        ,CASE WHEN dbt_valid_to = '9999-12-31' THEN 1 ELSE 0 END AS is_current
        ,modified
        ,CAST(TO_CHAR(dbt_valid_from::DATE, 'YYYYMMDD') AS INTEGER) AS valid_from
        ,CAST(TO_CHAR(dbt_valid_to::DATE, 'YYYYMMDD') AS INTEGER) AS valid_to

        -- Attributes
        ,name AS "Store"
        ,SPLIT_PART(location, ',', 1) AS "Store State"
        ,SPLIT_PART(location, ',', 2) AS "Store City"
        ,latitude AS "Lat"
        ,longitude AS "Lon"
        ,onlinepresence AS "Online Presence"
    FROM stores_snapshots
)

SELECT * FROM final
  );
[0m19:21:17.456467 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.356 seconds
[0m19:21:17.456467 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b103301-2ece-4ca8-a694-964892fcb6b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D44791C710>]}
[0m19:21:17.456467 [info ] [Thread-4 (]: 12 of 15 OK created sql view model broman_analytics.stg_d365_fo__stores ........ [[32mSUCCESS 1[0m in 0.39s]
[0m19:21:17.456467 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_d365_fo__stores
[0m19:21:17.469059 [debug] [Thread-3 (]: Began running node model.epicaldemo.dim_stores
[0m19:21:17.469059 [debug] [Thread-2 (]: Began running node model.epicaldemo.fact_sales_transactions
[0m19:21:17.469059 [debug] [Thread-1 (]: Began running node model.epicaldemo.fact_sales_transactions_incremental
[0m19:21:17.469059 [info ] [Thread-3 (]: 13 of 15 START sql table model broman_analytics.dim_stores ..................... [RUN]
[0m19:21:17.469059 [info ] [Thread-2 (]: 14 of 15 START sql table model broman_analytics.fact_sales_transactions ........ [RUN]
[0m19:21:17.479350 [info ] [Thread-1 (]: 15 of 15 START sql incremental model broman_analytics.fact_sales_transactions_incremental  [RUN]
[0m19:21:17.483447 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.dim_items, now model.epicaldemo.dim_stores)
[0m19:21:17.485653 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly snapshot.epicaldemo.stores_snapshot, now model.epicaldemo.fact_sales_transactions)
[0m19:21:17.488208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.dim_dates, now model.epicaldemo.fact_sales_transactions_incremental)
[0m19:21:17.490589 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.dim_stores
[0m19:21:17.490589 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.fact_sales_transactions
[0m19:21:17.490589 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.fact_sales_transactions_incremental
[0m19:21:17.502289 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.dim_stores"
[0m19:21:17.505955 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.fact_sales_transactions"
[0m19:21:17.521820 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.fact_sales_transactions_incremental"
[0m19:21:17.521820 [debug] [Thread-3 (]: Began executing node model.epicaldemo.dim_stores
[0m19:21:17.542107 [debug] [Thread-3 (]: Writing runtime sql for node "model.epicaldemo.dim_stores"
[0m19:21:17.544431 [debug] [Thread-3 (]: Using snowflake connection "model.epicaldemo.dim_stores"
[0m19:21:17.544431 [debug] [Thread-2 (]: Began executing node model.epicaldemo.fact_sales_transactions
[0m19:21:17.544431 [debug] [Thread-3 (]: On model.epicaldemo.dim_stores: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_stores"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_stores
    

    
    as (WITH

store AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__stores
),

final AS (
    SELECT
        store_key
        ,store_id
        ,is_current
        ,"Store"
        ,"Store State"
        ,"Store City"
        ,"Lat"
        ,"Lon"
        ,"Online Presence"
        --,"modified"
        ,valid_from
        ,valid_to
    FROM store
)

SELECT * FROM final
    )
;
[0m19:21:17.552096 [debug] [Thread-1 (]: Began executing node model.epicaldemo.fact_sales_transactions_incremental
[0m19:21:17.559860 [debug] [Thread-2 (]: Writing runtime sql for node "model.epicaldemo.fact_sales_transactions"
[0m19:21:17.592470 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m19:21:17.592470 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
create or replace  temporary view EPICALDEMO.broman_analytics.fact_sales_transactions_incremental__dbt_tmp
  
   as (
    

WITH

sales AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__transactions

    
    WHERE UPDATED_AT >= (SELECT MAX(UPDATED_AT) FROM EPICALDEMO.broman_analytics.fact_sales_transactions_incremental)
    
),

items AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__items
),

stores AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__stores
),

customers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_salesforce__customers
),

final AS (
    SELECT
        -- Identifiers
        sales.id
        ,sales.transaction_date_id
        ,sales.updated_at
        ,CONVERT_TIMEZONE('Europe/Stockholm', CURRENT_TIMESTAMP()) AS loaded_at

        ,CASE
            WHEN sales.sku IS NULL THEN -2 -- SKU is missing FROM Source
            WHEN items.item_id IS NULL THEN -1 -- SKU is not known FROM Source
            ELSE items.item_id -- Use item_id FROM Dim based on SKU
         END AS item_id

        ,CASE
            WHEN sales."Store" IS NULL THEN -2
            WHEN stores.store_key IS NULL THEN -1
            ELSE stores.store_key
         END AS store_key

        ,CASE
            WHEN sales."Customer Number" IS NULL THEN -2
            WHEN customers.customer_id IS NULL THEN -1
            ELSE customers.customer_id
         END AS customer_id

        -- Metrics
        ,sales."Qty"
        ,sales."Unit Price"
        ,sales."Sales Amount"
        ,sales."Unit Cost"
        ,sales."Cost"
        ,sales."Margin"
    FROM sales
    LEFT JOIN items ON items."SKU" = sales."SKU"
    LEFT JOIN stores ON stores."Store" = sales."Store" AND sales.transaction_date_id >= stores.valid_from AND sales.transaction_date_id < stores.valid_to
    LEFT JOIN customers ON customers."Customer Number" = sales."Customer Number"
)

SELECT * FROM final
  );
[0m19:21:17.592470 [debug] [Thread-2 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions"
[0m19:21:17.608118 [debug] [Thread-2 (]: On model.epicaldemo.fact_sales_transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions"} */
create or replace transient table EPICALDEMO.broman_analytics.fact_sales_transactions
    

    
    as (WITH

sales AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__transactions
),

items AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__items
),

stores AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__stores
),

customers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_salesforce__customers
),

final AS (
    SELECT
        -- Identifiers
        sales."date_id"

        ,CASE
            WHEN sales."SKU" IS NULL THEN -2 -- SKU is missing FROM Source
            WHEN items."item_id" IS NULL THEN -1 -- SKU is not known FROM Source
            ELSE items."item_id" -- Use item_id FROM Dim based on SKU
         END AS "item_id"

        ,CASE
            WHEN sales."Store" IS NULL THEN -2
            WHEN stores."store_key" IS NULL THEN -1
            ELSE stores."store_key"
         END AS "store_key"

        ,CASE
            WHEN sales."Customer Number" IS NULL THEN -2
            WHEN customers."customer_id" IS NULL THEN -1
            ELSE customers."customer_id"
         END AS "customer_id"

        -- Metrics
        ,sales."Qty"
        ,sales."Unit Price"
        ,sales."Sales Amount"
        ,sales."Unit Cost"
        ,sales."Cost"
        ,sales."Margin"
    FROM sales
    LEFT JOIN items ON items."SKU" = sales."SKU"
    LEFT JOIN stores ON stores."Store" = sales."Store" AND sales."date_id" >= stores."valid_from" AND sales."date_id" < stores."valid_to"
    LEFT JOIN customers ON customers."Customer Number" = sales."Customer Number"
)

SELECT * FROM final
    )
;
[0m19:21:17.969549 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.372 seconds
[0m19:21:17.969549 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m19:21:17.969549 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
describe table EPICALDEMO.broman_analytics.fact_sales_transactions_incremental__dbt_tmp
[0m19:21:18.016452 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01bd0191-0004-ce6d-0000-d2e900030d6e
[0m19:21:18.016452 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 34 at position 8
invalid identifier 'SALES."date_id"'
[0m19:21:18.016452 [debug] [Thread-2 (]: Database Error in model fact_sales_transactions (models\mart\facts\fact_sales_transactions.sql)
  000904 (42000): SQL compilation error: error line 34 at position 8
  invalid identifier 'SALES."date_id"'
  compiled code at target\run\epicaldemo\models\mart\facts\fact_sales_transactions.sql
[0m19:21:18.016452 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b103301-2ece-4ca8-a694-964892fcb6b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4478F53D0>]}
[0m19:21:18.016452 [error] [Thread-2 (]: 14 of 15 ERROR creating sql table model broman_analytics.fact_sales_transactions  [[31mERROR[0m in 0.53s]
[0m19:21:18.016452 [debug] [Thread-2 (]: Finished running node model.epicaldemo.fact_sales_transactions
[0m19:21:18.016452 [debug] [Thread-7 (]: Marking all children of 'model.epicaldemo.fact_sales_transactions' to be skipped because of status 'error'.  Reason: Database Error in model fact_sales_transactions (models\mart\facts\fact_sales_transactions.sql)
  000904 (42000): SQL compilation error: error line 34 at position 8
  invalid identifier 'SALES."date_id"'
  compiled code at target\run\epicaldemo\models\mart\facts\fact_sales_transactions.sql.
[0m19:21:18.032064 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.059 seconds
[0m19:21:18.032064 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m19:21:18.032064 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
describe table EPICALDEMO.broman_analytics.fact_sales_transactions_incremental
[0m19:21:18.103961 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.059 seconds
[0m19:21:18.120421 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m19:21:18.120421 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."FACT_SALES_TRANSACTIONS_INCREMENTAL"
[0m19:21:18.157588 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.044 seconds
[0m19:21:18.231201 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.fact_sales_transactions_incremental"
[0m19:21:18.231201 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m19:21:18.231201 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
-- back compat for old kwarg name
  
  begin;
[0m19:21:18.278691 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.715 seconds
[0m19:21:18.278691 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b103301-2ece-4ca8-a694-964892fcb6b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4474E4BD0>]}
[0m19:21:18.278691 [info ] [Thread-3 (]: 13 of 15 OK created sql table model broman_analytics.dim_stores ................ [[32mSUCCESS 1[0m in 0.80s]
[0m19:21:18.278691 [debug] [Thread-3 (]: Finished running node model.epicaldemo.dim_stores
[0m19:21:18.278691 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.048 seconds
[0m19:21:18.278691 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m19:21:18.278691 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
merge into EPICALDEMO.broman_analytics.fact_sales_transactions_incremental as DBT_INTERNAL_DEST
        using EPICALDEMO.broman_analytics.fact_sales_transactions_incremental__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.transaction_date_id = DBT_INTERNAL_DEST.transaction_date_id
                ) and (
                    DBT_INTERNAL_SOURCE.item_id = DBT_INTERNAL_DEST.item_id
                ) and (
                    DBT_INTERNAL_SOURCE.store_key = DBT_INTERNAL_DEST.store_key
                ) and (
                    DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
                )

    
    when matched then update set
        "ID" = DBT_INTERNAL_SOURCE."ID","TRANSACTION_DATE_ID" = DBT_INTERNAL_SOURCE."TRANSACTION_DATE_ID","UPDATED_AT" = DBT_INTERNAL_SOURCE."UPDATED_AT","LOADED_AT" = DBT_INTERNAL_SOURCE."LOADED_AT","ITEM_ID" = DBT_INTERNAL_SOURCE."ITEM_ID","STORE_KEY" = DBT_INTERNAL_SOURCE."STORE_KEY","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","Qty" = DBT_INTERNAL_SOURCE."Qty","Unit Price" = DBT_INTERNAL_SOURCE."Unit Price","Sales Amount" = DBT_INTERNAL_SOURCE."Sales Amount","Unit Cost" = DBT_INTERNAL_SOURCE."Unit Cost","Cost" = DBT_INTERNAL_SOURCE."Cost","Margin" = DBT_INTERNAL_SOURCE."Margin"
    

    when not matched then insert
        ("ID", "TRANSACTION_DATE_ID", "UPDATED_AT", "LOADED_AT", "ITEM_ID", "STORE_KEY", "CUSTOMER_ID", "Qty", "Unit Price", "Sales Amount", "Unit Cost", "Cost", "Margin")
    values
        ("ID", "TRANSACTION_DATE_ID", "UPDATED_AT", "LOADED_AT", "ITEM_ID", "STORE_KEY", "CUSTOMER_ID", "Qty", "Unit Price", "Sales Amount", "Unit Cost", "Cost", "Margin")

;
[0m19:21:19.389620 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.112 seconds
[0m19:21:19.405194 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m19:21:19.405194 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
COMMIT
[0m19:21:19.594871 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.197 seconds
[0m19:21:19.633819 [debug] [Thread-1 (]: Applying DROP to: EPICALDEMO.broman_analytics.fact_sales_transactions_incremental__dbt_tmp
[0m19:21:19.642112 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions_incremental"
[0m19:21:19.642112 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions_incremental: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions_incremental"} */
drop view if exists EPICALDEMO.broman_analytics.fact_sales_transactions_incremental__dbt_tmp cascade
[0m19:21:19.732997 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.094 seconds
[0m19:21:19.748564 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b103301-2ece-4ca8-a694-964892fcb6b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D44796A410>]}
[0m19:21:19.748564 [info ] [Thread-1 (]: 15 of 15 OK created sql incremental model broman_analytics.fact_sales_transactions_incremental  [[32mSUCCESS 1[0m in 2.26s]
[0m19:21:19.757752 [debug] [Thread-1 (]: Finished running node model.epicaldemo.fact_sales_transactions_incremental
[0m19:21:19.762272 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:21:19.764301 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m19:21:19.766213 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m19:21:19.820545 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m19:21:19.820545 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m19:21:19.885346 [debug] [MainThread]: Connection 'model.epicaldemo.fact_sales_transactions_incremental' was left open.
[0m19:21:19.885346 [debug] [MainThread]: On model.epicaldemo.fact_sales_transactions_incremental: Close
[0m19:21:19.948183 [debug] [MainThread]: Connection 'model.epicaldemo.fact_sales_transactions' was left open.
[0m19:21:19.948183 [debug] [MainThread]: On model.epicaldemo.fact_sales_transactions: Close
[0m19:21:20.011305 [debug] [MainThread]: Connection 'model.epicaldemo.dim_stores' was left open.
[0m19:21:20.011305 [debug] [MainThread]: On model.epicaldemo.dim_stores: Close
[0m19:21:20.074425 [debug] [MainThread]: Connection 'model.epicaldemo.stg_d365_fo__stores' was left open.
[0m19:21:20.074425 [debug] [MainThread]: On model.epicaldemo.stg_d365_fo__stores: Close
[0m19:21:20.137003 [info ] [MainThread]: 
[0m19:21:20.137003 [info ] [MainThread]: Finished running 1 incremental model, 1 snapshot, 5 table models, 8 view models in 0 hours 0 minutes and 7.31 seconds (7.31s).
[0m19:21:20.152565 [debug] [MainThread]: Command end result
[0m19:21:20.305367 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m19:21:20.308082 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m19:21:20.325468 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m19:21:20.325468 [info ] [MainThread]: 
[0m19:21:20.325468 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:21:20.325468 [info ] [MainThread]: 
[0m19:21:20.325468 [error] [MainThread]:   Database Error in model fact_sales_transactions (models\mart\facts\fact_sales_transactions.sql)
  000904 (42000): SQL compilation error: error line 34 at position 8
  invalid identifier 'SALES."date_id"'
  compiled code at target\run\epicaldemo\models\mart\facts\fact_sales_transactions.sql
[0m19:21:20.325468 [info ] [MainThread]: 
[0m19:21:20.335812 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=1 SKIP=0 TOTAL=15
[0m19:21:20.335812 [debug] [MainThread]: Command `dbt build` failed at 19:21:20.335812 after 9.53 seconds
[0m19:21:20.335812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4461C0D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D43F4F3050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D44506B010>]}
[0m19:21:20.342653 [debug] [MainThread]: Flushing usage events
[0m19:21:20.873822 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:22:00.552686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F84097A0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F840886E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F840887950>]}


============================== 19:22:00.560219 | 3fd8d54e-c373-4ef7-b1fa-9466a263e379 ==============================
[0m19:22:00.560219 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:22:00.560219 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:22:01.329985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3fd8d54e-c373-4ef7-b1fa-9466a263e379', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F84096BB90>]}
[0m19:22:01.387455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3fd8d54e-c373-4ef7-b1fa-9466a263e379', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F841D320D0>]}
[0m19:22:01.387455 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m19:22:01.918882 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:22:02.202224 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:22:02.202224 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:22:02.217871 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m19:22:02.269594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3fd8d54e-c373-4ef7-b1fa-9466a263e379', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F842016110>]}
[0m19:22:02.368787 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m19:22:02.384431 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m19:22:02.431440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3fd8d54e-c373-4ef7-b1fa-9466a263e379', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F84284F090>]}
[0m19:22:02.431440 [info ] [MainThread]: Found 1 snapshot, 13 models, 8 sources, 1 exposure, 476 macros
[0m19:22:02.436027 [info ] [MainThread]: 
[0m19:22:02.436027 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:22:02.441145 [info ] [MainThread]: 
[0m19:22:02.442591 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:22:02.447821 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m19:22:02.574236 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m19:22:02.574236 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m19:22:02.574236 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:22:03.094803 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.520 seconds
[0m19:22:03.094803 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m19:22:03.125996 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m19:22:03.125996 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m19:22:03.125996 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:22:03.598294 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.462 seconds
[0m19:22:03.598294 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m19:22:03.598294 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m19:22:03.708285 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.101 seconds
[0m19:22:03.708285 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m19:22:03.708285 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m19:22:03.786949 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.069 seconds
[0m19:22:03.786949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fd8d54e-c373-4ef7-b1fa-9466a263e379', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F84284F790>]}
[0m19:22:03.802577 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__categories
[0m19:22:03.802577 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_d365_fo__dates
[0m19:22:03.802577 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_d365_fo__items
[0m19:22:03.802577 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_d365_fo__managers
[0m19:22:03.802577 [info ] [Thread-1 (]: 1 of 14 START sql view model broman_analytics.stg_d365_fo__categories .......... [RUN]
[0m19:22:03.802577 [info ] [Thread-2 (]: 2 of 14 START sql view model broman_analytics.stg_d365_fo__dates ............... [RUN]
[0m19:22:03.802577 [info ] [Thread-3 (]: 3 of 14 START sql view model broman_analytics.stg_d365_fo__items ............... [RUN]
[0m19:22:03.802577 [info ] [Thread-4 (]: 4 of 14 START sql view model broman_analytics.stg_d365_fo__managers ............ [RUN]
[0m19:22:03.802577 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__categories'
[0m19:22:03.802577 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__dates'
[0m19:22:03.802577 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__items'
[0m19:22:03.802577 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__managers'
[0m19:22:03.802577 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__categories
[0m19:22:03.818207 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_d365_fo__dates
[0m19:22:03.819734 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_d365_fo__items
[0m19:22:03.819734 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_d365_fo__managers
[0m19:22:03.826353 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__categories"
[0m19:22:03.826353 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__dates"
[0m19:22:03.836141 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__items"
[0m19:22:03.836141 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__managers"
[0m19:22:03.836141 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__categories
[0m19:22:03.836141 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_d365_fo__dates
[0m19:22:03.850637 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_d365_fo__items
[0m19:22:03.869711 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__categories"
[0m19:22:03.869711 [debug] [Thread-2 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__dates"
[0m19:22:03.869711 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_d365_fo__managers
[0m19:22:03.884696 [debug] [Thread-3 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__items"
[0m19:22:03.885872 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__categories"
[0m19:22:03.885872 [debug] [Thread-4 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__managers"
[0m19:22:03.885872 [debug] [Thread-2 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__dates"
[0m19:22:03.885872 [debug] [Thread-1 (]: On model.epicaldemo.stg_d365_fo__categories: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__categories"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__categories
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.category
),

final AS (
    SELECT
        id AS category_id
        ,INITCAP(name) AS "Category"
        ,managerid AS manager_id
    FROM source
)

SELECT * FROM final
  );
[0m19:22:03.885872 [debug] [Thread-3 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__items"
[0m19:22:03.885872 [debug] [Thread-2 (]: On model.epicaldemo.stg_d365_fo__dates: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__dates"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__dates
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.date
),

final AS (
    SELECT
        id AS date_id
        ,date AS "Date"
        ,year AS "Year"
        ,yearmonth AS "Year Month"
        ,LEFT(id::TEXT, 4) || '-' || RIGHT(id::TEXT, 2) AS "Year Month Number"
        ,monthnumber AS "Month Number"
        ,quarter AS "Quarter"
        ,quarternumber AS "Quarter Number"
        ,monthname AS "Month"
        ,LEFT(monthname,3) AS "Month Short"
    FROM source
)

SELECT * FROM final
  );
[0m19:22:03.885872 [debug] [Thread-4 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__managers"
[0m19:22:03.898878 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:22:03.898878 [debug] [Thread-3 (]: On model.epicaldemo.stg_d365_fo__items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__items"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__items
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.item
),

final AS (
    SELECT
        id AS item_id
        ,name AS "Item"
        ,COALESCE(brand, 'Missing') AS "Brand"
        ,categoryid AS category_id
        ,COALESCE(flavor, 'Missing') AS "Flavor"
        ,sku AS "SKU"
    FROM source
)

SELECT * FROM final
  );
[0m19:22:03.898878 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:22:03.901437 [debug] [Thread-4 (]: On model.epicaldemo.stg_d365_fo__managers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__managers"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__managers
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.manager
),

final AS (
    SELECT
        id AS manager_id
        ,firstname || ' ' || lastname AS "Manager"
    FROM source
)

SELECT * FROM final
  );
[0m19:22:03.901437 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:22:03.906973 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:22:04.332655 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.440 seconds
[0m19:22:04.348280 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.450 seconds
[0m19:22:04.396314 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.499 seconds
[0m19:22:04.396314 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fd8d54e-c373-4ef7-b1fa-9466a263e379', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F842C7EC10>]}
[0m19:22:04.401174 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fd8d54e-c373-4ef7-b1fa-9466a263e379', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F842C7DD50>]}
[0m19:22:04.401174 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fd8d54e-c373-4ef7-b1fa-9466a263e379', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8430BD750>]}
[0m19:22:04.401174 [info ] [Thread-4 (]: 4 of 14 OK created sql view model broman_analytics.stg_d365_fo__managers ....... [[32mSUCCESS 1[0m in 0.59s]
[0m19:22:04.401174 [info ] [Thread-2 (]: 2 of 14 OK created sql view model broman_analytics.stg_d365_fo__dates .......... [[32mSUCCESS 1[0m in 0.60s]
[0m19:22:04.401174 [info ] [Thread-1 (]: 1 of 14 OK created sql view model broman_analytics.stg_d365_fo__categories ..... [[32mSUCCESS 1[0m in 0.59s]
[0m19:22:04.401174 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_d365_fo__managers
[0m19:22:04.401174 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_d365_fo__dates
[0m19:22:04.401174 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__categories
[0m19:22:04.401174 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_d365_fo__transactions
[0m19:22:04.401174 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_inriver__item_attributes
[0m19:22:04.412189 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_salesforce__customers
[0m19:22:04.413901 [info ] [Thread-4 (]: 5 of 14 START sql view model broman_analytics.stg_d365_fo__transactions ........ [RUN]
[0m19:22:04.413901 [info ] [Thread-2 (]: 6 of 14 START sql view model broman_analytics.stg_inriver__item_attributes ..... [RUN]
[0m19:22:04.413901 [info ] [Thread-1 (]: 7 of 14 START sql view model broman_analytics.stg_salesforce__customers ........ [RUN]
[0m19:22:04.413901 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__managers, now model.epicaldemo.stg_d365_fo__transactions)
[0m19:22:04.417824 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__dates, now model.epicaldemo.stg_inriver__item_attributes)
[0m19:22:04.418957 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__categories, now model.epicaldemo.stg_salesforce__customers)
[0m19:22:04.419511 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_d365_fo__transactions
[0m19:22:04.419511 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_inriver__item_attributes
[0m19:22:04.421141 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_salesforce__customers
[0m19:22:04.421141 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__transactions"
[0m19:22:04.428825 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_inriver__item_attributes"
[0m19:22:04.430320 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_salesforce__customers"
[0m19:22:04.430320 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_d365_fo__transactions
[0m19:22:04.437804 [debug] [Thread-4 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__transactions"
[0m19:22:04.437804 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_inriver__item_attributes
[0m19:22:04.437804 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_salesforce__customers
[0m19:22:04.437804 [debug] [Thread-2 (]: Writing runtime sql for node "model.epicaldemo.stg_inriver__item_attributes"
[0m19:22:04.445680 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.stg_salesforce__customers"
[0m19:22:04.445680 [debug] [Thread-4 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__transactions"
[0m19:22:04.451028 [debug] [Thread-2 (]: Using snowflake connection "model.epicaldemo.stg_inriver__item_attributes"
[0m19:22:04.453392 [debug] [Thread-4 (]: On model.epicaldemo.stg_d365_fo__transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__transactions"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__transactions
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.transactions
),

final AS (
    SELECT
        -- Identifiers
        id
        ,updated_at
        ,CAST(TO_CHAR(transaction_date::DATE, 'YYYYMMDD') AS INTEGER) AS transaction_date_id
        ,sku AS "SKU"
        ,store AS "Store"
        ,customernumber AS "Customer Number"

        -- Metrics
        ,quantity AS "Qty"
        ,unitprice::NUMERIC(10,2) AS "Unit Price"
        ,(quantity * unitprice)::NUMERIC(10,2) AS "Sales Amount"
        ,unitcost::NUMERIC(10,2) AS "Unit Cost"
        ,(quantity * unitcost)::NUMERIC(10,2) AS "Cost"
        ,(quantity * unitprice)::NUMERIC(10,2) - (quantity * unitcost)::NUMERIC(10,2) AS "Margin"
    FROM source
)

SELECT * FROM final
  );
[0m19:22:04.453392 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.stg_salesforce__customers"
[0m19:22:04.453392 [debug] [Thread-2 (]: On model.epicaldemo.stg_inriver__item_attributes: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_inriver__item_attributes"} */
create or replace   view EPICALDEMO.broman_analytics.stg_inriver__item_attributes
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.inriver.item_attributes
),

final AS (
    SELECT
        id AS item_attributes_id
        ,sku AS "SKU"
        ,COALESCE(crunch_level, 'Missing') AS "Crunch Level"
        ,COALESCE(snack_time, 'Missing') AS "Snack Time"
    FROM source
)

SELECT * FROM final
  );
[0m19:22:04.453392 [debug] [Thread-1 (]: On model.epicaldemo.stg_salesforce__customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_salesforce__customers"} */
create or replace   view EPICALDEMO.broman_analytics.stg_salesforce__customers
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.salesforce.customer
),

final AS (
    SELECT
        id AS customer_id
        ,customernumber AS "Customer Number"
        ,age AS "Customer Age"

        ,CASE
            WHEN age < 20 THEN '< 20'
            WHEN age >= 20 AND age < 30 THEN '20 - 30'
            WHEN age >= 30 AND age < 50 THEN '30 - 50'
            WHEN age >= 50 AND age < 60 THEN '50 - 60'
            ELSE '60+'
         END AS "Customer Age Group"

        ,CASE
            WHEN age < 20 THEN 1
            WHEN age >= 20 AND age < 30 THEN 2
            WHEN age >= 30 AND age < 50 THEN 3
            WHEN age >= 50 AND age < 60 THEN 4
            ELSE 5
         END AS customer_age_group_sort

        ,state AS "Customer State"
    FROM source
)

SELECT * FROM final
  );
[0m19:22:04.508289 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.607 seconds
[0m19:22:04.508289 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fd8d54e-c373-4ef7-b1fa-9466a263e379', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F842CE6CD0>]}
[0m19:22:04.516301 [info ] [Thread-3 (]: 3 of 14 OK created sql view model broman_analytics.stg_d365_fo__items .......... [[32mSUCCESS 1[0m in 0.71s]
[0m19:22:04.516301 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_d365_fo__items
[0m19:22:04.516301 [debug] [Thread-3 (]: Began running node snapshot.epicaldemo.stores_snapshot
[0m19:22:04.516301 [info ] [Thread-3 (]: 8 of 14 START snapshot broman_analytics.stores_snapshot ........................ [RUN]
[0m19:22:04.516301 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__items, now snapshot.epicaldemo.stores_snapshot)
[0m19:22:04.516301 [debug] [Thread-3 (]: Began compiling node snapshot.epicaldemo.stores_snapshot
[0m19:22:04.524421 [debug] [Thread-3 (]: Began executing node snapshot.epicaldemo.stores_snapshot
[0m19:22:04.585673 [debug] [Thread-3 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m19:22:04.585673 [debug] [Thread-3 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
[0m19:22:04.608730 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.151 seconds
[0m19:22:04.608730 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fd8d54e-c373-4ef7-b1fa-9466a263e379', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F84317D650>]}
[0m19:22:04.618002 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.159 seconds
[0m19:22:04.618002 [info ] [Thread-1 (]: 7 of 14 OK created sql view model broman_analytics.stg_salesforce__customers ... [[32mSUCCESS 1[0m in 0.19s]
[0m19:22:04.624928 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fd8d54e-c373-4ef7-b1fa-9466a263e379', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F843170510>]}
[0m19:22:04.624928 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_salesforce__customers
[0m19:22:04.624928 [info ] [Thread-2 (]: 6 of 14 OK created sql view model broman_analytics.stg_inriver__item_attributes  [[32mSUCCESS 1[0m in 0.21s]
[0m19:22:04.624928 [debug] [Thread-1 (]: Began running node model.epicaldemo.dim_dates
[0m19:22:04.631667 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_inriver__item_attributes
[0m19:22:04.633188 [info ] [Thread-1 (]: 9 of 14 START sql table model broman_analytics.dim_dates ....................... [RUN]
[0m19:22:04.634507 [debug] [Thread-2 (]: Began running node model.epicaldemo.dim_customers
[0m19:22:04.636753 [debug] [Thread-3 (]: SQL status: SUCCESS 11 in 0.048 seconds
[0m19:22:04.636753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_salesforce__customers, now model.epicaldemo.dim_dates)
[0m19:22:04.636753 [info ] [Thread-2 (]: 10 of 14 START sql table model broman_analytics.dim_customers .................. [RUN]
[0m19:22:04.700904 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.dim_dates
[0m19:22:04.700904 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.246 seconds
[0m19:22:04.717930 [debug] [Thread-3 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m19:22:04.717930 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_inriver__item_attributes, now model.epicaldemo.dim_customers)
[0m19:22:04.717930 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.dim_dates"
[0m19:22:04.726759 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fd8d54e-c373-4ef7-b1fa-9466a263e379', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F84301B590>]}
[0m19:22:04.727813 [debug] [Thread-3 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
create or replace temporary table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp"
as (
    
    
    with snapshot_query as (

        select * from EPICALDEMO.d365_fo.store

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            
  
  coalesce(nullif(modified, modified), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            modified as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.modified)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.modified)
        )
    )

    select * from insertions
    union all
    select * from updates

    )
;
[0m19:22:04.728870 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.dim_customers
[0m19:22:04.730955 [info ] [Thread-4 (]: 5 of 14 OK created sql view model broman_analytics.stg_d365_fo__transactions ... [[32mSUCCESS 1[0m in 0.31s]
[0m19:22:04.731981 [debug] [Thread-1 (]: Began executing node model.epicaldemo.dim_dates
[0m19:22:04.735151 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.dim_customers"
[0m19:22:04.735151 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_d365_fo__transactions
[0m19:22:04.766642 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.dim_dates"
[0m19:22:04.770096 [debug] [Thread-4 (]: Began running node model.epicaldemo.dim_items
[0m19:22:04.770423 [debug] [Thread-2 (]: Began executing node model.epicaldemo.dim_customers
[0m19:22:04.773505 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.dim_dates"
[0m19:22:04.770423 [info ] [Thread-4 (]: 11 of 14 START sql table model broman_analytics.dim_items ...................... [RUN]
[0m19:22:04.774696 [debug] [Thread-2 (]: Writing runtime sql for node "model.epicaldemo.dim_customers"
[0m19:22:04.774696 [debug] [Thread-1 (]: On model.epicaldemo.dim_dates: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_dates"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_dates
    

    
    as (with

dates AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__dates
),

final AS (
    SELECT
        date_id
        ,"Date"
        ,"Year"
        ,"Year Month"
        ,"Year Month Number"
        ,"Month Number"
        ,"Quarter"
        ,"Quarter Number"
        ,"Month"
        ,"Month Short"
    FROM dates
)

SELECT * FROM final
    )
;
[0m19:22:04.774696 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__transactions, now model.epicaldemo.dim_items)
[0m19:22:04.774696 [debug] [Thread-2 (]: Using snowflake connection "model.epicaldemo.dim_customers"
[0m19:22:04.774696 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.dim_items
[0m19:22:04.786309 [debug] [Thread-2 (]: On model.epicaldemo.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_customers"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_customers
    

    
    as (WITH

customers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_salesforce__customers
),

final AS (
    SELECT
        customer_id
        ,"Customer Number"
        ,"Customer Age"
        ,"Customer Age Group"
        ,customer_age_group_sort
        ,"Customer State"
    FROM customers
)

SELECT * FROM final
    )
;
[0m19:22:04.786687 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.dim_items"
[0m19:22:04.792901 [debug] [Thread-4 (]: Began executing node model.epicaldemo.dim_items
[0m19:22:04.792901 [debug] [Thread-4 (]: Writing runtime sql for node "model.epicaldemo.dim_items"
[0m19:22:04.800999 [debug] [Thread-4 (]: Using snowflake connection "model.epicaldemo.dim_items"
[0m19:22:04.800999 [debug] [Thread-4 (]: On model.epicaldemo.dim_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_items"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_items
    

    
    as (with

items AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__items
),

item_attributes AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_inriver__item_attributes
),

categories AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__categories
),

managers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__managers
),

unknown AS (
    SELECT
        -1 AS item_id
        ,'Unknown' AS "SKU"
        ,'Unknown' AS "Item"
        ,'Missing' AS "Brand"
        ,'Missing' AS "Flavor"
        ,'Missing' AS "Crunch Level"
        ,'Missing' AS "Snack Time"
        ,'Missing' AS "Category"
        ,'Missing' AS "Manager"
),

missing AS (
    SELECT
        -2 AS item_id
        ,'Missing' AS "SKU"
        ,'Missing' AS "Item"
        ,'Missing' AS "Brand"
        ,'Missing' AS "Flavor"
        ,'Missing' AS "Crunch Level"
        ,'Missing' AS "Snack Time"
        ,'Missing' AS "Category"
        ,'Missing' AS "Manager"
),

final AS (
    SELECT
        items.item_id
        ,items."SKU"
        ,items."Item"
        ,items."Brand"
        ,items."Flavor"
        ,COALESCE(item_attributes."Crunch Level", 'Missing') AS "Crunch Level"
        ,COALESCE(item_attributes."Snack Time", 'Missing') AS "Snack Time"
        ,categories."Category"
        ,managers."Manager"
    FROM items
    LEFT JOIN item_attributes ON item_attributes."SKU" = items."SKU"
    LEFT JOIN categories ON categories.category_id = items.category_id
    LEFT JOIN managers ON managers.manager_id = categories.manager_id

    UNION

    SELECT * FROM unknown

    UNION

    SELECT * FROM missing
)

SELECT * FROM final
    )
;
[0m19:22:05.484334 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.752 seconds
[0m19:22:05.484910 [debug] [Thread-3 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m19:22:05.492424 [debug] [Thread-3 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp"
[0m19:22:05.500761 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.724 seconds
[0m19:22:05.500761 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.714 seconds
[0m19:22:05.500761 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fd8d54e-c373-4ef7-b1fa-9466a263e379', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8431A4210>]}
[0m19:22:05.500761 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fd8d54e-c373-4ef7-b1fa-9466a263e379', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F843144BD0>]}
[0m19:22:05.516378 [info ] [Thread-1 (]: 9 of 14 OK created sql table model broman_analytics.dim_dates .................. [[32mSUCCESS 1[0m in 0.86s]
[0m19:22:05.516378 [info ] [Thread-2 (]: 10 of 14 OK created sql table model broman_analytics.dim_customers ............. [[32mSUCCESS 1[0m in 0.78s]
[0m19:22:05.519315 [debug] [Thread-1 (]: Finished running node model.epicaldemo.dim_dates
[0m19:22:05.519315 [debug] [Thread-2 (]: Finished running node model.epicaldemo.dim_customers
[0m19:22:05.565923 [debug] [Thread-3 (]: SQL status: SUCCESS 13 in 0.072 seconds
[0m19:22:05.568290 [debug] [Thread-3 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m19:22:05.580314 [debug] [Thread-3 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
[0m19:22:05.644725 [debug] [Thread-3 (]: SQL status: SUCCESS 11 in 0.063 seconds
[0m19:22:05.644725 [debug] [Thread-3 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m19:22:05.644725 [debug] [Thread-3 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp"
[0m19:22:05.731350 [debug] [Thread-3 (]: SQL status: SUCCESS 13 in 0.087 seconds
[0m19:22:05.746997 [debug] [Thread-3 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m19:22:05.746997 [debug] [Thread-3 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
[0m19:22:05.794484 [debug] [Thread-3 (]: SQL status: SUCCESS 11 in 0.054 seconds
[0m19:22:05.810108 [debug] [Thread-3 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m19:22:05.810108 [debug] [Thread-3 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp"
[0m19:22:05.873055 [debug] [Thread-3 (]: SQL status: SUCCESS 13 in 0.058 seconds
[0m19:22:05.919963 [debug] [Thread-3 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m19:22:05.919963 [debug] [Thread-3 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from EPICALDEMO.d365_fo.store

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            
  
  coalesce(nullif(modified, modified), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            modified as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.modified)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.modified)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m19:22:06.032071 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 0.106 seconds
[0m19:22:06.047086 [debug] [Thread-3 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m19:22:06.048271 [debug] [Thread-3 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m19:22:06.094353 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.293 seconds
[0m19:22:06.094353 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fd8d54e-c373-4ef7-b1fa-9466a263e379', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F843A78AD0>]}
[0m19:22:06.094353 [info ] [Thread-4 (]: 11 of 14 OK created sql table model broman_analytics.dim_items ................. [[32mSUCCESS 1[0m in 1.32s]
[0m19:22:06.094353 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 0.054 seconds
[0m19:22:06.094353 [debug] [Thread-4 (]: Finished running node model.epicaldemo.dim_items
[0m19:22:06.094353 [warn ] [Thread-3 (]: Data type of snapshot table timestamp columns (TIMESTAMP_NTZ) doesn't match derived column 'updated_at' (DATE). Please update snapshot config 'updated_at'.
[0m19:22:06.094353 [debug] [Thread-3 (]: Writing runtime sql for node "snapshot.epicaldemo.stores_snapshot"
[0m19:22:06.111706 [debug] [Thread-3 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m19:22:06.113003 [debug] [Thread-3 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
BEGIN
[0m19:22:06.184446 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.072 seconds
[0m19:22:06.184446 [debug] [Thread-3 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m19:22:06.184446 [debug] [Thread-3 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
merge into "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT" as DBT_INTERNAL_DEST
    using "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
	
	
	and ((DBT_INTERNAL_DEST.dbt_valid_to = to_date('9999-12-31'))
 or DBT_INTERNAL_DEST.dbt_valid_to is null)

     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("ID", "NAME", "LOCATION", "LATITUDE", "LONGITUDE", "ONLINEPRESENCE", "MODIFIED", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("ID", "NAME", "LOCATION", "LATITUDE", "LONGITUDE", "ONLINEPRESENCE", "MODIFIED", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m19:22:06.596555 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 0.415 seconds
[0m19:22:06.596555 [debug] [Thread-3 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m19:22:06.596555 [debug] [Thread-3 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
COMMIT
[0m19:22:06.910895 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.301 seconds
[0m19:22:06.910895 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fd8d54e-c373-4ef7-b1fa-9466a263e379', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F843A73E10>]}
[0m19:22:06.910895 [info ] [Thread-3 (]: 8 of 14 OK snapshotted broman_analytics.stores_snapshot ........................ [[32mSUCCESS 0[0m in 2.39s]
[0m19:22:06.910895 [debug] [Thread-3 (]: Finished running node snapshot.epicaldemo.stores_snapshot
[0m19:22:06.927897 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__stores
[0m19:22:06.937952 [info ] [Thread-1 (]: 12 of 14 START sql view model broman_analytics.stg_d365_fo__stores ............. [RUN]
[0m19:22:06.937952 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.dim_dates, now model.epicaldemo.stg_d365_fo__stores)
[0m19:22:06.941994 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__stores
[0m19:22:06.945230 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__stores"
[0m19:22:06.950309 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__stores
[0m19:22:06.952681 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__stores"
[0m19:22:06.958914 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__stores"
[0m19:22:06.958914 [debug] [Thread-1 (]: On model.epicaldemo.stg_d365_fo__stores: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__stores"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__stores
  
   as (
    WITH

stores_snapshots AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stores_snapshot
),

final AS (
    SELECT
        -- Identifiers
        id AS store_id

        -- SCD2 Fields
        ,dbt_scd_id
        ,ROW_NUMBER() OVER (ORDER BY id ASC, dbt_valid_from ASC) AS store_key
        ,CASE WHEN dbt_valid_to = '9999-12-31' THEN 1 ELSE 0 END AS is_current
        ,modified
        ,CAST(TO_CHAR(dbt_valid_from::DATE, 'YYYYMMDD') AS INTEGER) AS valid_from
        ,CAST(TO_CHAR(dbt_valid_to::DATE, 'YYYYMMDD') AS INTEGER) AS valid_to

        -- Attributes
        ,name AS "Store"
        ,SPLIT_PART(location, ',', 1) AS "Store State"
        ,SPLIT_PART(location, ',', 2) AS "Store City"
        ,latitude AS "Lat"
        ,longitude AS "Lon"
        ,onlinepresence AS "Online Presence"
    FROM stores_snapshots
)

SELECT * FROM final
  );
[0m19:22:07.220699 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.259 seconds
[0m19:22:07.220699 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fd8d54e-c373-4ef7-b1fa-9466a263e379', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F843A60050>]}
[0m19:22:07.220699 [info ] [Thread-1 (]: 12 of 14 OK created sql view model broman_analytics.stg_d365_fo__stores ........ [[32mSUCCESS 1[0m in 0.28s]
[0m19:22:07.220699 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__stores
[0m19:22:07.220699 [debug] [Thread-4 (]: Began running node model.epicaldemo.dim_stores
[0m19:22:07.220699 [debug] [Thread-3 (]: Began running node model.epicaldemo.fact_sales_transactions
[0m19:22:07.220699 [info ] [Thread-4 (]: 13 of 14 START sql table model broman_analytics.dim_stores ..................... [RUN]
[0m19:22:07.220699 [info ] [Thread-3 (]: 14 of 14 START sql incremental model broman_analytics.fact_sales_transactions .. [RUN]
[0m19:22:07.233171 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.dim_items, now model.epicaldemo.dim_stores)
[0m19:22:07.233171 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly snapshot.epicaldemo.stores_snapshot, now model.epicaldemo.fact_sales_transactions)
[0m19:22:07.235502 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.dim_stores
[0m19:22:07.235502 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.fact_sales_transactions
[0m19:22:07.241520 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.dim_stores"
[0m19:22:07.249547 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.fact_sales_transactions"
[0m19:22:07.249547 [debug] [Thread-4 (]: Began executing node model.epicaldemo.dim_stores
[0m19:22:07.257579 [debug] [Thread-4 (]: Writing runtime sql for node "model.epicaldemo.dim_stores"
[0m19:22:07.257579 [debug] [Thread-3 (]: Began executing node model.epicaldemo.fact_sales_transactions
[0m19:22:07.284201 [debug] [Thread-4 (]: Using snowflake connection "model.epicaldemo.dim_stores"
[0m19:22:07.300456 [debug] [Thread-3 (]: Writing runtime sql for node "model.epicaldemo.fact_sales_transactions"
[0m19:22:07.300456 [debug] [Thread-4 (]: On model.epicaldemo.dim_stores: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_stores"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_stores
    

    
    as (WITH

store AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__stores
),

final AS (
    SELECT
        store_key
        ,store_id
        ,is_current
        ,"Store"
        ,"Store State"
        ,"Store City"
        ,"Lat"
        ,"Lon"
        ,"Online Presence"
        --,"modified"
        ,valid_from
        ,valid_to
    FROM store
)

SELECT * FROM final
    )
;
[0m19:22:07.300456 [debug] [Thread-3 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions"
[0m19:22:07.300456 [debug] [Thread-3 (]: On model.epicaldemo.fact_sales_transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions"} */
create or replace transient table EPICALDEMO.broman_analytics.fact_sales_transactions
    

    
    as (

WITH

sales AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__transactions

    
),

items AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__items
),

stores AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__stores
),

customers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_salesforce__customers
),

final AS (
    SELECT
        -- Identifiers
        sales.id
        ,sales.transaction_date_id
        ,sales.updated_at
        ,CONVERT_TIMEZONE('Europe/Stockholm', CURRENT_TIMESTAMP()) AS loaded_at

        ,CASE
            WHEN sales.sku IS NULL THEN -2 -- SKU is missing FROM Source
            WHEN items.item_id IS NULL THEN -1 -- SKU is not known FROM Source
            ELSE items.item_id -- Use item_id FROM Dim based on SKU
         END AS item_id

        ,CASE
            WHEN sales."Store" IS NULL THEN -2
            WHEN stores.store_key IS NULL THEN -1
            ELSE stores.store_key
         END AS store_key

        ,CASE
            WHEN sales."Customer Number" IS NULL THEN -2
            WHEN customers.customer_id IS NULL THEN -1
            ELSE customers.customer_id
         END AS customer_id

        -- Metrics
        ,sales."Qty"
        ,sales."Unit Price"
        ,sales."Sales Amount"
        ,sales."Unit Cost"
        ,sales."Cost"
        ,sales."Margin"
    FROM sales
    LEFT JOIN items ON items."SKU" = sales."SKU"
    LEFT JOIN stores ON stores."Store" = sales."Store" AND sales.transaction_date_id >= stores.valid_from AND sales.transaction_date_id < stores.valid_to
    LEFT JOIN customers ON customers."Customer Number" = sales."Customer Number"
)

SELECT * FROM final
    )
;
[0m19:22:08.032488 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.729 seconds
[0m19:22:08.032488 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fd8d54e-c373-4ef7-b1fa-9466a263e379', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F84319B650>]}
[0m19:22:08.032488 [info ] [Thread-4 (]: 13 of 14 OK created sql table model broman_analytics.dim_stores ................ [[32mSUCCESS 1[0m in 0.80s]
[0m19:22:08.048613 [debug] [Thread-4 (]: Finished running node model.epicaldemo.dim_stores
[0m19:22:08.346693 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.045 seconds
[0m19:22:08.362317 [debug] [Thread-3 (]: Applying DROP to: EPICALDEMO.broman_analytics.fact_sales_transactions__dbt_tmp
[0m19:22:08.372844 [debug] [Thread-3 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions"
[0m19:22:08.372844 [debug] [Thread-3 (]: On model.epicaldemo.fact_sales_transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions"} */
drop view if exists EPICALDEMO.broman_analytics.fact_sales_transactions__dbt_tmp cascade
[0m19:22:08.440887 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.070 seconds
[0m19:22:08.440887 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fd8d54e-c373-4ef7-b1fa-9466a263e379', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F843119950>]}
[0m19:22:08.456516 [info ] [Thread-3 (]: 14 of 14 OK created sql incremental model broman_analytics.fact_sales_transactions  [[32mSUCCESS 1[0m in 1.21s]
[0m19:22:08.456516 [debug] [Thread-3 (]: Finished running node model.epicaldemo.fact_sales_transactions
[0m19:22:08.456516 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:22:08.456516 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m19:22:08.456516 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m19:22:08.549937 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m19:22:08.549937 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m19:22:08.599926 [debug] [MainThread]: Connection 'model.epicaldemo.stg_d365_fo__stores' was left open.
[0m19:22:08.599926 [debug] [MainThread]: On model.epicaldemo.stg_d365_fo__stores: Close
[0m19:22:08.682018 [debug] [MainThread]: Connection 'model.epicaldemo.dim_customers' was left open.
[0m19:22:08.683136 [debug] [MainThread]: On model.epicaldemo.dim_customers: Close
[0m19:22:08.742076 [debug] [MainThread]: Connection 'model.epicaldemo.fact_sales_transactions' was left open.
[0m19:22:08.742076 [debug] [MainThread]: On model.epicaldemo.fact_sales_transactions: Close
[0m19:22:08.804489 [debug] [MainThread]: Connection 'model.epicaldemo.dim_stores' was left open.
[0m19:22:08.820111 [debug] [MainThread]: On model.epicaldemo.dim_stores: Close
[0m19:22:08.883050 [info ] [MainThread]: 
[0m19:22:08.883050 [info ] [MainThread]: Finished running 1 incremental model, 1 snapshot, 4 table models, 8 view models in 0 hours 0 minutes and 6.44 seconds (6.44s).
[0m19:22:08.883050 [debug] [MainThread]: Command end result
[0m19:22:08.961584 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m19:22:08.966251 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m19:22:08.989290 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m19:22:08.989290 [info ] [MainThread]: 
[0m19:22:08.997320 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:22:08.997320 [info ] [MainThread]: 
[0m19:22:08.997320 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m19:22:09.005654 [debug] [MainThread]: Command `dbt build` succeeded at 19:22:09.005654 after 8.54 seconds
[0m19:22:09.007543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F83B21CA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F83B293050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F83B292FD0>]}
[0m19:22:09.008760 [debug] [MainThread]: Flushing usage events
[0m19:22:09.502826 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:23:01.703788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEF647F050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEF647C790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEF4FA9D90>]}


============================== 19:23:01.703788 | 6b1c351f-bd73-4c31-9257-a4a0c4975039 ==============================
[0m19:23:01.703788 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:23:01.710943 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:23:02.299983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b1c351f-bd73-4c31-9257-a4a0c4975039', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEF769F090>]}
[0m19:23:02.362389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b1c351f-bd73-4c31-9257-a4a0c4975039', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEF4E57890>]}
[0m19:23:02.372660 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m19:23:02.877612 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:23:03.175959 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:23:03.175959 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:23:03.191606 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m19:23:03.254705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b1c351f-bd73-4c31-9257-a4a0c4975039', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEF6471390>]}
[0m19:23:03.379214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b1c351f-bd73-4c31-9257-a4a0c4975039', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEF7BCD850>]}
[0m19:23:03.382732 [info ] [MainThread]: Found 1 snapshot, 13 models, 8 sources, 1 exposure, 476 macros
[0m19:23:03.382732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b1c351f-bd73-4c31-9257-a4a0c4975039', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEF7BFE990>]}
[0m19:23:03.382732 [info ] [MainThread]: 
[0m19:23:03.382732 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:23:03.390465 [info ] [MainThread]: 
[0m19:23:03.390465 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:23:03.397765 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m19:23:03.533684 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m19:23:03.533684 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m19:23:03.533684 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:23:04.052987 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.520 seconds
[0m19:23:04.065501 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m19:23:04.069026 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m19:23:04.165458 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.100 seconds
[0m19:23:04.165458 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m19:23:04.165458 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m19:23:04.228967 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.054 seconds
[0m19:23:04.236988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b1c351f-bd73-4c31-9257-a4a0c4975039', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEF7EB2950>]}
[0m19:23:04.247621 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__categories
[0m19:23:04.247621 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_d365_fo__dates
[0m19:23:04.247621 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_d365_fo__items
[0m19:23:04.247621 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_d365_fo__managers
[0m19:23:04.247621 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__categories'
[0m19:23:04.247621 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__dates'
[0m19:23:04.247621 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__items'
[0m19:23:04.260628 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__managers'
[0m19:23:04.260628 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__categories
[0m19:23:04.260628 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_d365_fo__dates
[0m19:23:04.260628 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_d365_fo__items
[0m19:23:04.265638 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_d365_fo__managers
[0m19:23:04.265638 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__categories"
[0m19:23:04.276645 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__dates"
[0m19:23:04.276645 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__items"
[0m19:23:04.276645 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__managers"
[0m19:23:04.276645 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__categories
[0m19:23:04.276645 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_d365_fo__dates
[0m19:23:04.276645 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__categories
[0m19:23:04.276645 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_d365_fo__items
[0m19:23:04.292276 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_d365_fo__dates
[0m19:23:04.292276 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_d365_fo__managers
[0m19:23:04.292276 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__transactions
[0m19:23:04.292276 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_d365_fo__items
[0m19:23:04.292276 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_inriver__item_attributes
[0m19:23:04.292276 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_d365_fo__managers
[0m19:23:04.292276 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__categories, now model.epicaldemo.stg_d365_fo__transactions)
[0m19:23:04.292276 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_salesforce__customers
[0m19:23:04.292276 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__dates, now model.epicaldemo.stg_inriver__item_attributes)
[0m19:23:04.292276 [debug] [Thread-4 (]: Began running node snapshot.epicaldemo.stores_snapshot
[0m19:23:04.292276 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__transactions
[0m19:23:04.292276 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__items, now model.epicaldemo.stg_salesforce__customers)
[0m19:23:04.292276 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_inriver__item_attributes
[0m19:23:04.292276 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__managers, now snapshot.epicaldemo.stores_snapshot)
[0m19:23:04.307906 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__transactions"
[0m19:23:04.307906 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_salesforce__customers
[0m19:23:04.307906 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_inriver__item_attributes"
[0m19:23:04.307906 [debug] [Thread-4 (]: Began compiling node snapshot.epicaldemo.stores_snapshot
[0m19:23:04.307906 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_salesforce__customers"
[0m19:23:04.307906 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__transactions
[0m19:23:04.323540 [debug] [Thread-4 (]: Began executing node snapshot.epicaldemo.stores_snapshot
[0m19:23:04.323540 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_inriver__item_attributes
[0m19:23:04.323540 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__transactions
[0m19:23:04.323540 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_salesforce__customers
[0m19:23:04.323540 [debug] [Thread-4 (]: Finished running node snapshot.epicaldemo.stores_snapshot
[0m19:23:04.323540 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_inriver__item_attributes
[0m19:23:04.323540 [debug] [Thread-1 (]: Began running node model.epicaldemo.dim_dates
[0m19:23:04.323540 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_salesforce__customers
[0m19:23:04.323540 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_d365_fo__stores
[0m19:23:04.339157 [debug] [Thread-2 (]: Began running node model.epicaldemo.dim_items
[0m19:23:04.339157 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__transactions, now model.epicaldemo.dim_dates)
[0m19:23:04.339157 [debug] [Thread-3 (]: Began running node model.epicaldemo.dim_customers
[0m19:23:04.339157 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly snapshot.epicaldemo.stores_snapshot, now model.epicaldemo.stg_d365_fo__stores)
[0m19:23:04.339157 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_inriver__item_attributes, now model.epicaldemo.dim_items)
[0m19:23:04.339157 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.dim_dates
[0m19:23:04.339157 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_salesforce__customers, now model.epicaldemo.dim_customers)
[0m19:23:04.339157 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_d365_fo__stores
[0m19:23:04.339157 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.dim_items
[0m19:23:04.339157 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.dim_dates"
[0m19:23:04.339157 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.dim_customers
[0m19:23:04.339157 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__stores"
[0m19:23:04.354832 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.dim_items"
[0m19:23:04.354832 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.dim_customers"
[0m19:23:04.354832 [debug] [Thread-1 (]: Began executing node model.epicaldemo.dim_dates
[0m19:23:04.354832 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_d365_fo__stores
[0m19:23:04.354832 [debug] [Thread-2 (]: Began executing node model.epicaldemo.dim_items
[0m19:23:04.354832 [debug] [Thread-3 (]: Began executing node model.epicaldemo.dim_customers
[0m19:23:04.354832 [debug] [Thread-1 (]: Finished running node model.epicaldemo.dim_dates
[0m19:23:04.354832 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_d365_fo__stores
[0m19:23:04.354832 [debug] [Thread-2 (]: Finished running node model.epicaldemo.dim_items
[0m19:23:04.365843 [debug] [Thread-3 (]: Finished running node model.epicaldemo.dim_customers
[0m19:23:04.365843 [debug] [Thread-1 (]: Began running node model.epicaldemo.dim_stores
[0m19:23:04.365843 [debug] [Thread-4 (]: Began running node model.epicaldemo.fact_sales_transactions
[0m19:23:04.365843 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.dim_dates, now model.epicaldemo.dim_stores)
[0m19:23:04.370891 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__stores, now model.epicaldemo.fact_sales_transactions)
[0m19:23:04.370891 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.dim_stores
[0m19:23:04.370891 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.fact_sales_transactions
[0m19:23:04.370891 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.dim_stores"
[0m19:23:04.370891 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.fact_sales_transactions"
[0m19:23:04.387786 [debug] [Thread-1 (]: Began executing node model.epicaldemo.dim_stores
[0m19:23:04.388790 [debug] [Thread-1 (]: Finished running node model.epicaldemo.dim_stores
[0m19:23:04.389822 [debug] [Thread-4 (]: Began executing node model.epicaldemo.fact_sales_transactions
[0m19:23:04.390855 [debug] [Thread-4 (]: Finished running node model.epicaldemo.fact_sales_transactions
[0m19:23:04.393109 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:23:04.394188 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m19:23:04.395232 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m19:23:04.450019 [debug] [MainThread]: Connection 'model.epicaldemo.dim_stores' was properly closed.
[0m19:23:04.450019 [debug] [MainThread]: Connection 'model.epicaldemo.dim_items' was properly closed.
[0m19:23:04.450019 [debug] [MainThread]: Connection 'model.epicaldemo.dim_customers' was properly closed.
[0m19:23:04.463071 [debug] [MainThread]: Connection 'model.epicaldemo.fact_sales_transactions' was properly closed.
[0m19:23:04.466084 [debug] [MainThread]: Command end result
[0m19:23:04.591535 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m19:23:04.591535 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m19:23:04.618447 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m19:23:05.640570 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m19:23:05.646829 [info ] [MainThread]: Building catalog
[0m19:23:05.672468 [debug] [ThreadPool]: Acquiring new snowflake connection 'EPICALDEMO.information_schema'
[0m19:23:05.712900 [debug] [ThreadPool]: Using snowflake connection "EPICALDEMO.information_schema"
[0m19:23:05.720913 [debug] [ThreadPool]: On EPICALDEMO.information_schema: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "EPICALDEMO.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from EPICALDEMO.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'manager' and upper("table_name") = upper('manager')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stores_snapshot' and upper("table_name") = upper('stores_snapshot')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__items' and upper("table_name") = upper('stg_d365_fo__items')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__dates' and upper("table_name") = upper('stg_d365_fo__dates')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_items' and upper("table_name") = upper('dim_items')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'fact_sales_transactions' and upper("table_name") = upper('fact_sales_transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_stores' and upper("table_name") = upper('dim_stores')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__categories' and upper("table_name") = upper('stg_d365_fo__categories')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__stores' and upper("table_name") = upper('stg_d365_fo__stores')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'transactions' and upper("table_name") = upper('transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_dates' and upper("table_name") = upper('dim_dates')

                )
             or 
                (
                    
    "table_schema" ilike 'inriver' and upper("table_schema") = upper('inriver')

                    and 
    "table_name" ilike 'item_attributes' and upper("table_name") = upper('item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_salesforce__customers' and upper("table_name") = upper('stg_salesforce__customers')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'category' and upper("table_name") = upper('category')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__managers' and upper("table_name") = upper('stg_d365_fo__managers')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_customers' and upper("table_name") = upper('dim_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'salesforce' and upper("table_schema") = upper('salesforce')

                    and 
    "table_name" ilike 'customer' and upper("table_name") = upper('customer')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'date' and upper("table_name") = upper('date')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_inriver__item_attributes' and upper("table_name") = upper('stg_inriver__item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__transactions' and upper("table_name") = upper('stg_d365_fo__transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'store' and upper("table_name") = upper('store')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'item' and upper("table_name") = upper('item')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from EPICALDEMO.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'manager' and upper("table_name") = upper('manager')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stores_snapshot' and upper("table_name") = upper('stores_snapshot')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__items' and upper("table_name") = upper('stg_d365_fo__items')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__dates' and upper("table_name") = upper('stg_d365_fo__dates')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_items' and upper("table_name") = upper('dim_items')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'fact_sales_transactions' and upper("table_name") = upper('fact_sales_transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_stores' and upper("table_name") = upper('dim_stores')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__categories' and upper("table_name") = upper('stg_d365_fo__categories')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__stores' and upper("table_name") = upper('stg_d365_fo__stores')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'transactions' and upper("table_name") = upper('transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_dates' and upper("table_name") = upper('dim_dates')

                )
             or 
                (
                    
    "table_schema" ilike 'inriver' and upper("table_schema") = upper('inriver')

                    and 
    "table_name" ilike 'item_attributes' and upper("table_name") = upper('item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_salesforce__customers' and upper("table_name") = upper('stg_salesforce__customers')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'category' and upper("table_name") = upper('category')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__managers' and upper("table_name") = upper('stg_d365_fo__managers')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_customers' and upper("table_name") = upper('dim_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'salesforce' and upper("table_schema") = upper('salesforce')

                    and 
    "table_name" ilike 'customer' and upper("table_name") = upper('customer')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'date' and upper("table_name") = upper('date')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_inriver__item_attributes' and upper("table_name") = upper('stg_inriver__item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__transactions' and upper("table_name") = upper('stg_d365_fo__transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'store' and upper("table_name") = upper('store')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'item' and upper("table_name") = upper('item')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m19:23:05.720913 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:23:16.658438 [debug] [ThreadPool]: SQL status: SUCCESS 160 in 10.935 seconds
[0m19:23:17.428452 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\catalog.json
[0m19:23:17.457057 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m19:23:17.465078 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m19:23:17.465078 [info ] [MainThread]: Catalog written to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\catalog.json
[0m19:23:17.465078 [debug] [MainThread]: Command `dbt docs generate` succeeded at 19:23:17.465078 after 15.86 seconds
[0m19:23:17.465078 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m19:23:17.465078 [debug] [MainThread]: Connection 'EPICALDEMO.information_schema' was left open.
[0m19:23:17.465078 [debug] [MainThread]: On EPICALDEMO.information_schema: Close
[0m19:23:17.526617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEF64C4A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEF64BB690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEF5BCCF50>]}
[0m19:23:17.526617 [debug] [MainThread]: Flushing usage events
[0m19:23:17.925557 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:23:25.767570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BAC278710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BABEB4C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BAC2796D0>]}


============================== 19:23:25.767570 | f4bf974b-7957-45f4-8d04-fccbf7f2c08d ==============================
[0m19:23:25.767570 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:23:25.783194 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:23:26.442305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4bf974b-7957-45f4-8d04-fccbf7f2c08d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BAD3FE0D0>]}
[0m19:23:26.489194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4bf974b-7957-45f4-8d04-fccbf7f2c08d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BAD5B2990>]}
[0m19:33:37.402676 [error] [MainThread]: Encountered an error:

[0m19:33:37.481730 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m19:33:37.497348 [debug] [MainThread]: Command `dbt docs serve` failed at 19:33:37.497348 after 611.86 seconds
[0m19:33:37.497348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BAC26B250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BAC271190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BAC272590>]}
[0m19:33:37.497348 [debug] [MainThread]: Flushing usage events
[0m19:33:37.938006 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:59:34.154148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000151A2073E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001519D676650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000151A1D9D350>]}


============================== 19:59:34.154148 | 27795841-edc1-409b-bf3d-88656ccbfd8e ==============================
[0m19:59:34.154148 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:59:34.154148 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'c:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'c:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:59:34.304196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27795841-edc1-409b-bf3d-88656ccbfd8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000151A211DAD0>]}
[0m19:59:34.572252 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m19:59:34.572252 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m19:59:34.572252 [debug] [MainThread]: Command `cli deps` succeeded at 19:59:34.572252 after 0.58 seconds
[0m19:59:34.572252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000151A2078290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000151A0AA0E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000151A2181FD0>]}
[0m19:59:34.572252 [debug] [MainThread]: Flushing usage events
[0m19:59:34.994853 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:25:15.138100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001804F56F890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001804F56F310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001804F56F5D0>]}


============================== 11:25:15.142608 | c9469c34-c68b-4274-8760-f8094e108417 ==============================
[0m11:25:15.142608 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:25:15.143609 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'c:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'debug': 'False', 'warn_error': 'None', 'log_path': 'c:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m11:25:15.241168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c9469c34-c68b-4274-8760-f8094e108417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001804FA1D9D0>]}
[0m11:25:15.351784 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:25:15.353776 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:25:15.355777 [debug] [MainThread]: Command `cli deps` succeeded at 11:25:15.355777 after 0.29 seconds
[0m11:25:15.355777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001804F578050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001804F5B7910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001804F5B7B10>]}
[0m11:25:15.356776 [debug] [MainThread]: Flushing usage events
[0m11:25:15.883696 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:03:31.419100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017166578990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017166579890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171665792D0>]}


============================== 13:03:31.435108 | ce31fc0c-cd90-4a50-9cfd-b38f4005067d ==============================
[0m13:03:31.435108 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:03:31.437110 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:03:34.677856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce31fc0c-cd90-4a50-9cfd-b38f4005067d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017167930A50>]}
[0m13:03:34.719859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce31fc0c-cd90-4a50-9cfd-b38f4005067d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017164D4FAD0>]}
[0m13:03:34.730294 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m13:03:35.242164 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:03:36.649567 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:03:36.650575 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:03:36.659575 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m13:03:36.711580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce31fc0c-cd90-4a50-9cfd-b38f4005067d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017167FB2ED0>]}
[0m13:03:36.950079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce31fc0c-cd90-4a50-9cfd-b38f4005067d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017168313F90>]}
[0m13:03:36.950079 [info ] [MainThread]: Found 1 snapshot, 13 models, 8 sources, 1 exposure, 476 macros
[0m13:03:36.951093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce31fc0c-cd90-4a50-9cfd-b38f4005067d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017167F35B10>]}
[0m13:03:36.954087 [info ] [MainThread]: 
[0m13:03:36.955087 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:03:36.956099 [info ] [MainThread]: 
[0m13:03:36.957079 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:03:36.963079 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m13:03:39.539904 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m13:03:39.540904 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m13:03:39.541895 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:03:41.895591 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 2.354 seconds
[0m13:03:41.899590 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m13:03:41.900590 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m13:03:42.129563 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.228 seconds
[0m13:03:42.131564 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m13:03:42.131564 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m13:03:42.233108 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.100 seconds
[0m13:03:42.238116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce31fc0c-cd90-4a50-9cfd-b38f4005067d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017165ECCA10>]}
[0m13:03:42.246116 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__categories
[0m13:03:42.247108 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_d365_fo__dates
[0m13:03:42.247108 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_d365_fo__items
[0m13:03:42.248117 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_d365_fo__managers
[0m13:03:42.249116 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__categories'
[0m13:03:42.251109 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__dates'
[0m13:03:42.251109 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__items'
[0m13:03:42.253109 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__managers'
[0m13:03:42.253109 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__categories
[0m13:03:42.254109 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_d365_fo__dates
[0m13:03:42.254109 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_d365_fo__items
[0m13:03:42.255125 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_d365_fo__managers
[0m13:03:42.263108 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__categories"
[0m13:03:42.266109 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__dates"
[0m13:03:42.270108 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__items"
[0m13:03:42.272107 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__managers"
[0m13:03:42.277109 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__categories
[0m13:03:42.279109 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__categories
[0m13:03:42.279109 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_d365_fo__managers
[0m13:03:42.280109 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_d365_fo__dates
[0m13:03:42.280109 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__transactions
[0m13:03:42.281109 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_d365_fo__items
[0m13:03:42.282109 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_d365_fo__managers
[0m13:03:42.283109 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_d365_fo__dates
[0m13:03:42.283109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__categories, now model.epicaldemo.stg_d365_fo__transactions)
[0m13:03:42.285129 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_d365_fo__items
[0m13:03:42.285129 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_inriver__item_attributes
[0m13:03:42.286108 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_salesforce__customers
[0m13:03:42.287109 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__transactions
[0m13:03:42.287109 [debug] [Thread-3 (]: Began running node snapshot.epicaldemo.stores_snapshot
[0m13:03:42.288109 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__managers, now model.epicaldemo.stg_inriver__item_attributes)
[0m13:03:42.289109 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__dates, now model.epicaldemo.stg_salesforce__customers)
[0m13:03:42.292109 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__transactions"
[0m13:03:42.293108 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__items, now snapshot.epicaldemo.stores_snapshot)
[0m13:03:42.293108 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_inriver__item_attributes
[0m13:03:42.294110 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_salesforce__customers
[0m13:03:42.295109 [debug] [Thread-3 (]: Began compiling node snapshot.epicaldemo.stores_snapshot
[0m13:03:42.298109 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_inriver__item_attributes"
[0m13:03:42.302117 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_salesforce__customers"
[0m13:03:42.302117 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__transactions
[0m13:03:42.306108 [debug] [Thread-3 (]: Began executing node snapshot.epicaldemo.stores_snapshot
[0m13:03:42.308109 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__transactions
[0m13:03:42.309112 [debug] [Thread-3 (]: Finished running node snapshot.epicaldemo.stores_snapshot
[0m13:03:42.309112 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_inriver__item_attributes
[0m13:03:42.310108 [debug] [Thread-1 (]: Began running node model.epicaldemo.dim_dates
[0m13:03:42.310108 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_salesforce__customers
[0m13:03:42.311118 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_d365_fo__stores
[0m13:03:42.312113 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_inriver__item_attributes
[0m13:03:42.313134 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__transactions, now model.epicaldemo.dim_dates)
[0m13:03:42.313134 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_salesforce__customers
[0m13:03:42.314115 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly snapshot.epicaldemo.stores_snapshot, now model.epicaldemo.stg_d365_fo__stores)
[0m13:03:42.315113 [debug] [Thread-4 (]: Began running node model.epicaldemo.dim_items
[0m13:03:42.316116 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.dim_dates
[0m13:03:42.316116 [debug] [Thread-2 (]: Began running node model.epicaldemo.dim_customers
[0m13:03:42.317114 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_d365_fo__stores
[0m13:03:42.317114 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_inriver__item_attributes, now model.epicaldemo.dim_items)
[0m13:03:42.321126 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.dim_dates"
[0m13:03:42.321126 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_salesforce__customers, now model.epicaldemo.dim_customers)
[0m13:03:42.324114 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__stores"
[0m13:03:42.324114 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.dim_items
[0m13:03:42.325619 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.dim_customers
[0m13:03:42.330624 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.dim_items"
[0m13:03:42.335624 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.dim_customers"
[0m13:03:42.336625 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_d365_fo__stores
[0m13:03:42.336625 [debug] [Thread-1 (]: Began executing node model.epicaldemo.dim_dates
[0m13:03:42.338624 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_d365_fo__stores
[0m13:03:42.339625 [debug] [Thread-4 (]: Began executing node model.epicaldemo.dim_items
[0m13:03:42.339625 [debug] [Thread-2 (]: Began executing node model.epicaldemo.dim_customers
[0m13:03:42.340625 [debug] [Thread-1 (]: Finished running node model.epicaldemo.dim_dates
[0m13:03:42.341624 [debug] [Thread-3 (]: Began running node model.epicaldemo.dim_stores
[0m13:03:42.341624 [debug] [Thread-4 (]: Finished running node model.epicaldemo.dim_items
[0m13:03:42.342629 [debug] [Thread-2 (]: Finished running node model.epicaldemo.dim_customers
[0m13:03:42.343625 [debug] [Thread-1 (]: Began running node model.epicaldemo.fact_sales_transactions
[0m13:03:42.344624 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__stores, now model.epicaldemo.dim_stores)
[0m13:03:42.345624 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.dim_dates, now model.epicaldemo.fact_sales_transactions)
[0m13:03:42.345624 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.dim_stores
[0m13:03:42.346624 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.fact_sales_transactions
[0m13:03:42.350623 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.dim_stores"
[0m13:03:42.363624 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.fact_sales_transactions"
[0m13:03:42.365624 [debug] [Thread-3 (]: Began executing node model.epicaldemo.dim_stores
[0m13:03:42.366624 [debug] [Thread-3 (]: Finished running node model.epicaldemo.dim_stores
[0m13:03:42.367624 [debug] [Thread-1 (]: Began executing node model.epicaldemo.fact_sales_transactions
[0m13:03:42.369623 [debug] [Thread-1 (]: Finished running node model.epicaldemo.fact_sales_transactions
[0m13:03:42.371627 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:03:42.371627 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m13:03:42.372624 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m13:03:42.524146 [debug] [MainThread]: Connection 'model.epicaldemo.fact_sales_transactions' was properly closed.
[0m13:03:42.525664 [debug] [MainThread]: Connection 'model.epicaldemo.dim_customers' was properly closed.
[0m13:03:42.526675 [debug] [MainThread]: Connection 'model.epicaldemo.dim_stores' was properly closed.
[0m13:03:42.526675 [debug] [MainThread]: Connection 'model.epicaldemo.dim_items' was properly closed.
[0m13:03:42.529676 [debug] [MainThread]: Command end result
[0m13:03:42.643026 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m13:03:42.662025 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m13:03:42.670026 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m13:03:42.957638 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m13:03:42.958628 [info ] [MainThread]: Building catalog
[0m13:03:42.971627 [debug] [ThreadPool]: Acquiring new snowflake connection 'EPICALDEMO.information_schema'
[0m13:03:42.991636 [debug] [ThreadPool]: Using snowflake connection "EPICALDEMO.information_schema"
[0m13:03:42.993627 [debug] [ThreadPool]: On EPICALDEMO.information_schema: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "EPICALDEMO.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from EPICALDEMO.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stores_snapshot' and upper("table_name") = upper('stores_snapshot')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'transactions' and upper("table_name") = upper('transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__dates' and upper("table_name") = upper('stg_d365_fo__dates')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'date' and upper("table_name") = upper('date')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_items' and upper("table_name") = upper('dim_items')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__transactions' and upper("table_name") = upper('stg_d365_fo__transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_stores' and upper("table_name") = upper('dim_stores')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_customers' and upper("table_name") = upper('dim_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'fact_sales_transactions' and upper("table_name") = upper('fact_sales_transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_inriver__item_attributes' and upper("table_name") = upper('stg_inriver__item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'category' and upper("table_name") = upper('category')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'manager' and upper("table_name") = upper('manager')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__stores' and upper("table_name") = upper('stg_d365_fo__stores')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__items' and upper("table_name") = upper('stg_d365_fo__items')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__managers' and upper("table_name") = upper('stg_d365_fo__managers')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'store' and upper("table_name") = upper('store')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_salesforce__customers' and upper("table_name") = upper('stg_salesforce__customers')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'item' and upper("table_name") = upper('item')

                )
             or 
                (
                    
    "table_schema" ilike 'salesforce' and upper("table_schema") = upper('salesforce')

                    and 
    "table_name" ilike 'customer' and upper("table_name") = upper('customer')

                )
             or 
                (
                    
    "table_schema" ilike 'inriver' and upper("table_schema") = upper('inriver')

                    and 
    "table_name" ilike 'item_attributes' and upper("table_name") = upper('item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_dates' and upper("table_name") = upper('dim_dates')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__categories' and upper("table_name") = upper('stg_d365_fo__categories')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from EPICALDEMO.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stores_snapshot' and upper("table_name") = upper('stores_snapshot')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'transactions' and upper("table_name") = upper('transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__dates' and upper("table_name") = upper('stg_d365_fo__dates')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'date' and upper("table_name") = upper('date')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_items' and upper("table_name") = upper('dim_items')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__transactions' and upper("table_name") = upper('stg_d365_fo__transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_stores' and upper("table_name") = upper('dim_stores')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_customers' and upper("table_name") = upper('dim_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'fact_sales_transactions' and upper("table_name") = upper('fact_sales_transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_inriver__item_attributes' and upper("table_name") = upper('stg_inriver__item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'category' and upper("table_name") = upper('category')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'manager' and upper("table_name") = upper('manager')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__stores' and upper("table_name") = upper('stg_d365_fo__stores')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__items' and upper("table_name") = upper('stg_d365_fo__items')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__managers' and upper("table_name") = upper('stg_d365_fo__managers')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'store' and upper("table_name") = upper('store')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_salesforce__customers' and upper("table_name") = upper('stg_salesforce__customers')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'item' and upper("table_name") = upper('item')

                )
             or 
                (
                    
    "table_schema" ilike 'salesforce' and upper("table_schema") = upper('salesforce')

                    and 
    "table_name" ilike 'customer' and upper("table_name") = upper('customer')

                )
             or 
                (
                    
    "table_schema" ilike 'inriver' and upper("table_schema") = upper('inriver')

                    and 
    "table_name" ilike 'item_attributes' and upper("table_name") = upper('item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_dates' and upper("table_name") = upper('dim_dates')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__categories' and upper("table_name") = upper('stg_d365_fo__categories')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m13:03:42.994650 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:03:54.083286 [debug] [ThreadPool]: SQL status: SUCCESS 160 in 11.089 seconds
[0m13:03:55.263337 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\catalog.json
[0m13:03:55.288334 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m13:03:55.292335 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m13:03:55.293334 [info ] [MainThread]: Catalog written to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\catalog.json
[0m13:03:55.295334 [debug] [MainThread]: Command `dbt docs generate` succeeded at 13:03:55.295334 after 23.98 seconds
[0m13:03:55.296334 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m13:03:55.297333 [debug] [MainThread]: Connection 'EPICALDEMO.information_schema' was left open.
[0m13:03:55.297333 [debug] [MainThread]: On EPICALDEMO.information_schema: Close
[0m13:03:55.952584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171627EBBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017162A14B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017168219590>]}
[0m13:03:55.953584 [debug] [MainThread]: Flushing usage events
[0m13:03:56.471391 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:09:00.240935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A1C87CE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A1C87D950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A1C87D410>]}


============================== 13:09:00.243935 | ab755d2d-d00e-48c3-bc52-90c11492652f ==============================
[0m13:09:00.243935 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:09:00.244934 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:09:00.629558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab755d2d-d00e-48c3-bc52-90c11492652f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A1C8A49D0>]}
[0m13:09:00.668589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ab755d2d-d00e-48c3-bc52-90c11492652f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A1DA2D990>]}
[0m13:11:54.202308 [error] [MainThread]: Encountered an error:

[0m13:11:54.227309 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m13:11:54.231309 [debug] [MainThread]: Command `dbt docs serve` failed at 13:11:54.231309 after 174.05 seconds
[0m13:11:54.232319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A1A470A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A1C86B2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A1DB555D0>]}
[0m13:11:54.233309 [debug] [MainThread]: Flushing usage events
[0m13:11:54.796366 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:12:51.356101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FC05782D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FC05796D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FC0579650>]}


============================== 13:12:51.359102 | 53d05f64-94ed-483f-8017-d5811e1abd02 ==============================
[0m13:12:51.359102 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:12:51.360100 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:12:51.754256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53d05f64-94ed-483f-8017-d5811e1abd02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FC05BDB50>]}
[0m13:12:51.794248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '53d05f64-94ed-483f-8017-d5811e1abd02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FBED4F950>]}
[0m13:46:54.118871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002944516BF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029445173D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029445172890>]}


============================== 13:46:54.131890 | 91d9c667-79a5-4e35-bd4c-f568769dfb9d ==============================
[0m13:46:54.131890 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:46:54.132890 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s stg_d365_fo__dates', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:46:56.775991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91d9c667-79a5-4e35-bd4c-f568769dfb9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294465A9D90>]}
[0m13:46:56.817007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91d9c667-79a5-4e35-bd4c-f568769dfb9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294465315D0>]}
[0m13:46:56.825999 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m13:46:57.263730 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:46:58.519172 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:46:58.520173 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:46:58.526174 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m13:46:58.564693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91d9c667-79a5-4e35-bd4c-f568769dfb9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002944659B190>]}
[0m13:46:58.642209 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m13:46:58.662211 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m13:46:58.863633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91d9c667-79a5-4e35-bd4c-f568769dfb9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002944680B490>]}
[0m13:46:58.864633 [info ] [MainThread]: Found 13 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m13:46:58.865635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91d9c667-79a5-4e35-bd4c-f568769dfb9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294451B8D10>]}
[0m13:46:58.867642 [info ] [MainThread]: 
[0m13:46:58.867642 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:46:58.868637 [info ] [MainThread]: 
[0m13:46:58.868637 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:46:58.870638 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m13:47:01.332984 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m13:47:01.333985 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m13:47:01.333985 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:02.469339 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.135 seconds
[0m13:47:02.475341 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m13:47:02.484337 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m13:47:02.485338 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m13:47:02.485338 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:02.954030 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.468 seconds
[0m13:47:02.958018 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m13:47:02.959020 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m13:47:03.093929 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.134 seconds
[0m13:47:03.095939 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m13:47:03.096936 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m13:47:03.204456 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.107 seconds
[0m13:47:03.208455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91d9c667-79a5-4e35-bd4c-f568769dfb9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029446A73010>]}
[0m13:47:03.215455 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__dates
[0m13:47:03.216456 [info ] [Thread-1 (]: 1 of 1 START sql view model broman_analytics.stg_d365_fo__dates ................ [RUN]
[0m13:47:03.216456 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__dates'
[0m13:47:03.217460 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__dates
[0m13:47:03.223469 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__dates"
[0m13:47:03.225467 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__dates
[0m13:47:03.249984 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__dates"
[0m13:47:03.253985 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__dates"
[0m13:47:03.258196 [debug] [Thread-1 (]: On model.epicaldemo.stg_d365_fo__dates: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__dates"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__dates
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.date
),

final AS (
    SELECT
        id AS date_id
        ,date AS "Date"
        ,year AS "Year"
        ,yearmonth AS "Year Month"
        ,LEFT(id::TEXT, 4) || '-' || RIGHT(id::TEXT, 2) AS "Year Month Number"
        ,TO_CHAR(TO_DATE(id::string, 'YYYYMMDD'), 'YYYY-MM') AS "Test"
        ,monthnumber AS "Month Number"
        ,quarter AS "Quarter"
        ,quarternumber AS "Quarter Number"
        ,monthname AS "Month"
        ,LEFT(monthname,3) AS "Month Short"
    FROM source
)

SELECT * FROM final
  );
[0m13:47:03.259194 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:47:04.011378 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.752 seconds
[0m13:47:04.036926 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91d9c667-79a5-4e35-bd4c-f568769dfb9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294465AAD10>]}
[0m13:47:04.037935 [info ] [Thread-1 (]: 1 of 1 OK created sql view model broman_analytics.stg_d365_fo__dates ........... [[32mSUCCESS 1[0m in 0.81s]
[0m13:47:04.038922 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__dates
[0m13:47:04.040921 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:47:04.040921 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m13:47:04.041923 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m13:47:04.197285 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m13:47:04.197285 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m13:47:04.354385 [debug] [MainThread]: Connection 'model.epicaldemo.stg_d365_fo__dates' was left open.
[0m13:47:04.354385 [debug] [MainThread]: On model.epicaldemo.stg_d365_fo__dates: Close
[0m13:47:04.546683 [info ] [MainThread]: 
[0m13:47:04.547682 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.68 seconds (5.68s).
[0m13:47:04.549698 [debug] [MainThread]: Command end result
[0m13:47:04.570685 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m13:47:04.574685 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m13:47:04.582686 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m13:47:04.583684 [info ] [MainThread]: 
[0m13:47:04.584693 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:47:04.585689 [info ] [MainThread]: 
[0m13:47:04.586687 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:47:04.587694 [debug] [MainThread]: Command `dbt run` succeeded at 13:47:04.587694 after 10.56 seconds
[0m13:47:04.588701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029444E4DB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002943FA61250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002943FA12E10>]}
[0m13:47:04.589690 [debug] [MainThread]: Flushing usage events
[0m13:47:05.091307 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:47:10.299974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DEA17D390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DEA17D610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DEA17E7D0>]}


============================== 13:47:10.303963 | 423b0cc0-9edc-4d73-bde6-0f58eb338b73 ==============================
[0m13:47:10.303963 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:47:10.304962 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -s stg_d365_fo__dates', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:47:10.735669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '423b0cc0-9edc-4d73-bde6-0f58eb338b73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DEA1B7E90>]}
[0m13:47:10.776206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '423b0cc0-9edc-4d73-bde6-0f58eb338b73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DE8B4FAD0>]}
[0m13:47:10.777206 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m13:47:11.087988 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:47:11.282091 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:47:11.282091 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:47:11.288090 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m13:47:11.346186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '423b0cc0-9edc-4d73-bde6-0f58eb338b73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DEBB14210>]}
[0m13:47:11.427190 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m13:47:11.432191 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m13:47:11.452734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '423b0cc0-9edc-4d73-bde6-0f58eb338b73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DEBF00210>]}
[0m13:47:11.453736 [info ] [MainThread]: Found 13 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m13:47:11.454741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '423b0cc0-9edc-4d73-bde6-0f58eb338b73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DE6FD9D50>]}
[0m13:47:11.456750 [info ] [MainThread]: 
[0m13:47:11.456750 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:47:11.457731 [info ] [MainThread]: 
[0m13:47:11.458732 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:47:11.459732 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m13:47:11.548291 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m13:47:11.549291 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m13:47:11.550283 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:12.114104 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.564 seconds
[0m13:47:12.120100 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m13:47:12.129099 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m13:47:12.130099 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m13:47:12.130099 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:12.755722 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.625 seconds
[0m13:47:12.759723 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m13:47:12.759723 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m13:47:12.905982 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.146 seconds
[0m13:47:12.907981 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m13:47:12.908979 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m13:47:13.012752 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.103 seconds
[0m13:47:13.016762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '423b0cc0-9edc-4d73-bde6-0f58eb338b73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DEBBB1450>]}
[0m13:47:13.020755 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__dates
[0m13:47:13.021754 [info ] [Thread-1 (]: 1 of 1 START sql view model broman_analytics.stg_d365_fo__dates ................ [RUN]
[0m13:47:13.022755 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__dates'
[0m13:47:13.022755 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__dates
[0m13:47:13.028788 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__dates"
[0m13:47:13.029783 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__dates
[0m13:47:13.054297 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__dates"
[0m13:47:13.056292 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__dates"
[0m13:47:13.057290 [debug] [Thread-1 (]: On model.epicaldemo.stg_d365_fo__dates: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__dates"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__dates
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.date
),

final AS (
    SELECT
        id AS date_id
        ,date AS "Date"
        ,year AS "Year"
        ,yearmonth AS "Year Month"
        ,TO_CHAR(TO_DATE(id::string, 'YYYYMMDD'), 'YYYY-MM') AS "Year Month Number"
        ,monthnumber AS "Month Number"
        ,quarter AS "Quarter"
        ,quarternumber AS "Quarter Number"
        ,monthname AS "Month"
        ,LEFT(monthname,3) AS "Month Short"
    FROM source
)

SELECT * FROM final
  );
[0m13:47:13.058290 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:47:13.953854 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.896 seconds
[0m13:47:13.973853 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '423b0cc0-9edc-4d73-bde6-0f58eb338b73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DEC39C910>]}
[0m13:47:13.974852 [info ] [Thread-1 (]: 1 of 1 OK created sql view model broman_analytics.stg_d365_fo__dates ........... [[32mSUCCESS 1[0m in 0.95s]
[0m13:47:13.975855 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__dates
[0m13:47:13.977855 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:47:13.977855 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m13:47:13.977855 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m13:47:14.131776 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m13:47:14.132783 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m13:47:14.283956 [debug] [MainThread]: Connection 'model.epicaldemo.stg_d365_fo__dates' was left open.
[0m13:47:14.284956 [debug] [MainThread]: On model.epicaldemo.stg_d365_fo__dates: Close
[0m13:47:14.439233 [info ] [MainThread]: 
[0m13:47:14.440235 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.98 seconds (2.98s).
[0m13:47:14.441271 [debug] [MainThread]: Command end result
[0m13:47:14.462277 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m13:47:14.465280 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m13:47:14.471270 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m13:47:14.472276 [info ] [MainThread]: 
[0m13:47:14.473274 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:47:14.474272 [info ] [MainThread]: 
[0m13:47:14.475270 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:47:14.476270 [debug] [MainThread]: Command `dbt run` succeeded at 13:47:14.476270 after 4.24 seconds
[0m13:47:14.477287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DEA1B5B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DE9EBE390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DE4624E90>]}
[0m13:47:14.478276 [debug] [MainThread]: Flushing usage events
[0m13:47:14.991460 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:47:51.910343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B241172790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B241171D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B241173110>]}


============================== 13:47:51.913352 | 658cfcc8-d4a4-413b-addb-251ae74984e2 ==============================
[0m13:47:51.913352 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:47:51.914343 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -s dim_dates', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:47:52.372555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '658cfcc8-d4a4-413b-addb-251ae74984e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B24116B7D0>]}
[0m13:47:52.414556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '658cfcc8-d4a4-413b-addb-251ae74984e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2411E5310>]}
[0m13:47:52.415547 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m13:47:52.729892 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:47:52.925971 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:47:52.925971 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:47:52.931971 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m13:47:52.969490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '658cfcc8-d4a4-413b-addb-251ae74984e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B242BB2F10>]}
[0m13:47:53.050496 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m13:47:53.054495 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m13:47:53.075005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '658cfcc8-d4a4-413b-addb-251ae74984e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B242BDF610>]}
[0m13:47:53.075005 [info ] [MainThread]: Found 13 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m13:47:53.076004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '658cfcc8-d4a4-413b-addb-251ae74984e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B23DFD9B10>]}
[0m13:47:53.078002 [info ] [MainThread]: 
[0m13:47:53.079002 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:47:53.079002 [info ] [MainThread]: 
[0m13:47:53.080013 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:47:53.081005 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m13:47:53.171546 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m13:47:53.171546 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m13:47:53.172546 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:54.140755 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.968 seconds
[0m13:47:54.146755 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m13:47:54.155759 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m13:47:54.156759 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m13:47:54.156759 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:54.800511 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.644 seconds
[0m13:47:54.804519 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m13:47:54.804519 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m13:47:54.917817 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.112 seconds
[0m13:47:54.919810 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m13:47:54.920806 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m13:47:55.032457 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.111 seconds
[0m13:47:55.035456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '658cfcc8-d4a4-413b-addb-251ae74984e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2432FA3D0>]}
[0m13:47:55.042457 [debug] [Thread-1 (]: Began running node model.epicaldemo.dim_dates
[0m13:47:55.042457 [info ] [Thread-1 (]: 1 of 1 START sql table model broman_analytics.dim_dates ........................ [RUN]
[0m13:47:55.043458 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.dim_dates'
[0m13:47:55.044470 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.dim_dates
[0m13:47:55.050457 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.dim_dates"
[0m13:47:55.052461 [debug] [Thread-1 (]: Began executing node model.epicaldemo.dim_dates
[0m13:47:55.082975 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.dim_dates"
[0m13:47:55.084977 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.dim_dates"
[0m13:47:55.085977 [debug] [Thread-1 (]: On model.epicaldemo.dim_dates: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_dates"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_dates
    

    
    as (WITH

dates AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__dates
),

final AS (
    SELECT
        date_id
        ,"Date"
        ,"Year"
        ,"Year Month"
        ,"Year Month Number"
        ,"Month Number"
        ,"Quarter"
        ,"Quarter Number"
        ,"Month"
        ,"Month Short"
    FROM dates
)

SELECT * FROM final
    )
;
[0m13:47:55.086979 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:47:56.341062 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.254 seconds
[0m13:47:56.360077 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '658cfcc8-d4a4-413b-addb-251ae74984e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B242817ED0>]}
[0m13:47:56.361076 [info ] [Thread-1 (]: 1 of 1 OK created sql table model broman_analytics.dim_dates ................... [[32mSUCCESS 1[0m in 1.32s]
[0m13:47:56.362083 [debug] [Thread-1 (]: Finished running node model.epicaldemo.dim_dates
[0m13:47:56.364084 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:47:56.364084 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m13:47:56.364084 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m13:47:56.522734 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m13:47:56.523735 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m13:47:56.700508 [debug] [MainThread]: Connection 'model.epicaldemo.dim_dates' was left open.
[0m13:47:56.700508 [debug] [MainThread]: On model.epicaldemo.dim_dates: Close
[0m13:47:56.867597 [info ] [MainThread]: 
[0m13:47:56.867597 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.79 seconds (3.79s).
[0m13:47:56.869588 [debug] [MainThread]: Command end result
[0m13:47:56.900137 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m13:47:56.907586 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m13:47:56.919794 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m13:47:56.922050 [info ] [MainThread]: 
[0m13:47:56.925052 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:47:56.926055 [info ] [MainThread]: 
[0m13:47:56.928047 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:47:56.930055 [debug] [MainThread]: Command `dbt run` succeeded at 13:47:56.929046 after 5.08 seconds
[0m13:47:56.930055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B240E51D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B23BA1CB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B240EBA590>]}
[0m13:47:56.931066 [debug] [MainThread]: Flushing usage events
[0m13:47:57.457505 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:00:16.319891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015891D6BD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015891D73A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015891D70310>]}


============================== 14:00:16.323891 | 4eda36ac-1ed7-490a-b448-8f9a8d799390 ==============================
[0m14:00:16.323891 [info ] [MainThread]: Running with dbt=1.9.4
[0m14:00:16.324892 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -s stg_d365_fo__dates', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:00:16.727817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4eda36ac-1ed7-490a-b448-8f9a8d799390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015893466A10>]}
[0m14:00:16.770817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4eda36ac-1ed7-490a-b448-8f9a8d799390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158930FE190>]}
[0m14:00:16.771817 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m14:00:17.091478 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m14:00:17.280293 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:00:17.280293 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:00:17.286294 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m14:00:17.324384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4eda36ac-1ed7-490a-b448-8f9a8d799390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015891704C50>]}
[0m14:00:17.398383 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m14:00:17.414387 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m14:00:17.435637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4eda36ac-1ed7-490a-b448-8f9a8d799390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158936BA250>]}
[0m14:00:17.436645 [info ] [MainThread]: Found 13 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m14:00:17.437635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4eda36ac-1ed7-490a-b448-8f9a8d799390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158931E0C90>]}
[0m14:00:17.438650 [info ] [MainThread]: 
[0m14:00:17.439651 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:00:17.439651 [info ] [MainThread]: 
[0m14:00:17.440635 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:00:17.441636 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m14:00:17.528166 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m14:00:17.529166 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m14:00:17.529166 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:00:18.364326 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.835 seconds
[0m14:00:18.371633 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m14:00:18.382637 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m14:00:18.382637 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m14:00:18.384132 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:00:19.049533 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.666 seconds
[0m14:00:19.053519 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m14:00:19.054510 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m14:00:19.215933 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.161 seconds
[0m14:00:19.218452 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m14:00:19.218452 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m14:00:19.320997 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.102 seconds
[0m14:00:19.324987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4eda36ac-1ed7-490a-b448-8f9a8d799390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015893B0A090>]}
[0m14:00:19.331995 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__dates
[0m14:00:19.331995 [info ] [Thread-1 (]: 1 of 1 START sql view model broman_analytics.stg_d365_fo__dates ................ [RUN]
[0m14:00:19.332989 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__dates'
[0m14:00:19.333988 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__dates
[0m14:00:19.339995 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__dates"
[0m14:00:19.340995 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__dates
[0m14:00:19.364987 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__dates"
[0m14:00:19.367988 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__dates"
[0m14:00:19.368987 [debug] [Thread-1 (]: On model.epicaldemo.stg_d365_fo__dates: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__dates"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__dates
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.date
),

final AS (
    SELECT
        id AS date_id
        ,date AS "Date"
        ,year AS "Year"
        ,yearmonth AS "Year Month"
        ,TO_CHAR(TO_DATE(id::string, 'YYYYMMDD'), 'YYYY-MM') AS "Year Month Number"
        ,DATEDIFF(MONTH, DATE_TRUNC('MONTH', CURRENT_DATE), DATE_TRUNC('MONTH', date)) AS month_offset
        ,monthnumber AS "Month Number"
        ,quarter AS "Quarter"
        ,quarternumber AS "Quarter Number"
        ,monthname AS "Month"
        ,LEFT(monthname,3) AS "Month Short"
    FROM source
)

SELECT * FROM final
  );
[0m14:00:19.370988 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:00:20.128795 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.758 seconds
[0m14:00:20.161201 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4eda36ac-1ed7-490a-b448-8f9a8d799390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015893E733D0>]}
[0m14:00:20.162197 [info ] [Thread-1 (]: 1 of 1 OK created sql view model broman_analytics.stg_d365_fo__dates ........... [[32mSUCCESS 1[0m in 0.81s]
[0m14:00:20.163234 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__dates
[0m14:00:20.164194 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:00:20.165207 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m14:00:20.165207 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m14:00:20.319679 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m14:00:20.319679 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m14:00:20.472749 [debug] [MainThread]: Connection 'model.epicaldemo.stg_d365_fo__dates' was left open.
[0m14:00:20.472749 [debug] [MainThread]: On model.epicaldemo.stg_d365_fo__dates: Close
[0m14:00:20.626232 [info ] [MainThread]: 
[0m14:00:20.627223 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.19 seconds (3.19s).
[0m14:00:20.628223 [debug] [MainThread]: Command end result
[0m14:00:20.650222 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m14:00:20.654223 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m14:00:20.659231 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m14:00:20.660224 [info ] [MainThread]: 
[0m14:00:20.661224 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:00:20.661224 [info ] [MainThread]: 
[0m14:00:20.662223 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:00:20.663224 [debug] [MainThread]: Command `dbt run` succeeded at 14:00:20.663224 after 4.40 seconds
[0m14:00:20.663224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001589033F550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001588C61CB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015891BB5350>]}
[0m14:00:20.664224 [debug] [MainThread]: Flushing usage events
[0m14:00:21.187259 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:00:24.990715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBCD370410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBCD371DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBCD372210>]}


============================== 14:00:24.994703 | bce5422a-5f90-4c75-9713-373f75749ce4 ==============================
[0m14:00:24.994703 [info ] [MainThread]: Running with dbt=1.9.4
[0m14:00:24.995720 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -s dim_dates', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:00:25.406803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bce5422a-5f90-4c75-9713-373f75749ce4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBCD38D290>]}
[0m14:00:25.450331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bce5422a-5f90-4c75-9713-373f75749ce4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBCE731790>]}
[0m14:00:25.451328 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m14:00:25.761027 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m14:00:25.955106 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:00:25.956106 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:00:25.961107 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m14:00:25.998106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bce5422a-5f90-4c75-9713-373f75749ce4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBCEDDAD50>]}
[0m14:00:26.072651 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m14:00:26.077643 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m14:00:26.097701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bce5422a-5f90-4c75-9713-373f75749ce4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBCED09310>]}
[0m14:00:26.098644 [info ] [MainThread]: Found 13 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m14:00:26.099653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bce5422a-5f90-4c75-9713-373f75749ce4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBCEA50CD0>]}
[0m14:00:26.100646 [info ] [MainThread]: 
[0m14:00:26.101661 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:00:26.101661 [info ] [MainThread]: 
[0m14:00:26.102643 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:00:26.103644 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m14:00:26.190166 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m14:00:26.190166 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m14:00:26.191166 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:00:26.737855 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.547 seconds
[0m14:00:26.746854 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m14:00:26.756854 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m14:00:26.757855 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m14:00:26.757855 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:00:27.231718 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.473 seconds
[0m14:00:27.235719 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m14:00:27.235719 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m14:00:27.373993 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.137 seconds
[0m14:00:27.376000 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m14:00:27.376000 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m14:00:27.484135 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.108 seconds
[0m14:00:27.488145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bce5422a-5f90-4c75-9713-373f75749ce4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBCD3B69D0>]}
[0m14:00:27.492144 [debug] [Thread-1 (]: Began running node model.epicaldemo.dim_dates
[0m14:00:27.493134 [info ] [Thread-1 (]: 1 of 1 START sql table model broman_analytics.dim_dates ........................ [RUN]
[0m14:00:27.494135 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.dim_dates'
[0m14:00:27.494135 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.dim_dates
[0m14:00:27.502146 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.dim_dates"
[0m14:00:27.503133 [debug] [Thread-1 (]: Began executing node model.epicaldemo.dim_dates
[0m14:00:27.537656 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.dim_dates"
[0m14:00:27.540656 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.dim_dates"
[0m14:00:27.542661 [debug] [Thread-1 (]: On model.epicaldemo.dim_dates: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_dates"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_dates
    

    
    as (WITH

dates AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__dates
),

final AS (
    SELECT
        date_id
        ,"Date"
        ,"Year"
        ,"Year Month"
        ,"Year Month Number"
        ,month_offset
        ,"Month Number"
        ,"Quarter"
        ,"Quarter Number"
        ,"Month"
        ,"Month Short"
    FROM dates
)

SELECT * FROM final
    )
;
[0m14:00:27.543655 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:00:28.874690 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.331 seconds
[0m14:00:28.893695 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bce5422a-5f90-4c75-9713-373f75749ce4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBCEA17AD0>]}
[0m14:00:28.894676 [info ] [Thread-1 (]: 1 of 1 OK created sql table model broman_analytics.dim_dates ................... [[32mSUCCESS 1[0m in 1.40s]
[0m14:00:28.895677 [debug] [Thread-1 (]: Finished running node model.epicaldemo.dim_dates
[0m14:00:28.897676 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:00:28.898680 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m14:00:28.898680 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m14:00:29.053824 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m14:00:29.054824 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m14:00:29.206674 [debug] [MainThread]: Connection 'model.epicaldemo.dim_dates' was left open.
[0m14:00:29.206674 [debug] [MainThread]: On model.epicaldemo.dim_dates: Close
[0m14:00:29.364556 [info ] [MainThread]: 
[0m14:00:29.365545 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.26 seconds (3.26s).
[0m14:00:29.366544 [debug] [MainThread]: Command end result
[0m14:00:29.387556 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m14:00:29.390545 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m14:00:29.396561 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m14:00:29.397549 [info ] [MainThread]: 
[0m14:00:29.397549 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:00:29.398548 [info ] [MainThread]: 
[0m14:00:29.399548 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:00:29.401554 [debug] [MainThread]: Command `dbt run` succeeded at 14:00:29.401554 after 4.48 seconds
[0m14:00:29.402553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBCD3C59D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBC7C61210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBC7824F50>]}
[0m14:00:29.403546 [debug] [MainThread]: Flushing usage events
[0m14:00:29.910918 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:11:39.559094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5BD5D8310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5C1D8CC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5C1D8FC50>]}


============================== 14:11:39.571103 | 91a291c2-2fc2-4b4c-b3ee-667de144e3bf ==============================
[0m14:11:39.571103 [info ] [MainThread]: Running with dbt=1.9.4
[0m14:11:39.572102 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:11:42.039540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91a291c2-2fc2-4b4c-b3ee-667de144e3bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5C1D7B650>]}
[0m14:11:42.080531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91a291c2-2fc2-4b4c-b3ee-667de144e3bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5C315E790>]}
[0m14:11:42.088540 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m14:11:42.485504 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m14:11:43.578417 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:11:43.579418 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:11:43.584418 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m14:11:43.620413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91a291c2-2fc2-4b4c-b3ee-667de144e3bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5C34B2850>]}
[0m14:11:43.698015 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m14:11:43.715016 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m14:11:43.910680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91a291c2-2fc2-4b4c-b3ee-667de144e3bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5C36F7B90>]}
[0m14:11:43.910680 [info ] [MainThread]: Found 13 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m14:11:43.911680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91a291c2-2fc2-4b4c-b3ee-667de144e3bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5C31C1A10>]}
[0m14:11:43.913686 [info ] [MainThread]: 
[0m14:11:43.914691 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:11:43.914691 [info ] [MainThread]: 
[0m14:11:43.915675 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:11:43.916675 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m14:11:46.245835 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m14:11:46.245835 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m14:11:46.246816 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:11:47.157548 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.911 seconds
[0m14:11:47.164538 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m14:11:47.173537 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m14:11:47.174537 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m14:11:47.174537 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:11:48.071491 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.896 seconds
[0m14:11:48.074491 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m14:11:48.075503 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m14:11:48.244991 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 0.169 seconds
[0m14:11:48.246991 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m14:11:48.247991 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m14:11:48.352540 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.104 seconds
[0m14:11:48.355542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91a291c2-2fc2-4b4c-b3ee-667de144e3bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5C3E71750>]}
[0m14:11:48.360539 [debug] [Thread-1 (]: Began running node snapshot.epicaldemo.stores_snapshot
[0m14:11:48.360539 [info ] [Thread-1 (]: 1 of 1 START snapshot broman_analytics.stores_snapshot ......................... [RUN]
[0m14:11:48.362539 [debug] [Thread-1 (]: Acquiring new snowflake connection 'snapshot.epicaldemo.stores_snapshot'
[0m14:11:48.362539 [debug] [Thread-1 (]: Began compiling node snapshot.epicaldemo.stores_snapshot
[0m14:11:48.370540 [debug] [Thread-1 (]: Began executing node snapshot.epicaldemo.stores_snapshot
[0m14:11:48.435542 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m14:11:48.436542 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id,
        modified as dbt_updated_at,
        modified as dbt_valid_from,
        
  
  coalesce(nullif(modified, modified), to_date('9999-12-31'))
  as dbt_valid_to
from (
        select * from EPICALDEMO.d365_fo.store
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m14:11:48.436542 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:11:50.004496 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.567 seconds
[0m14:11:50.009494 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m14:11:50.009494 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m14:11:50.110784 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.100 seconds
[0m14:11:50.111782 [warn ] [Thread-1 (]: Data type of snapshot table timestamp columns (TIMESTAMP_NTZ) doesn't match derived column 'updated_at' (DATE). Please update snapshot config 'updated_at'.
[0m14:11:50.112784 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.epicaldemo.stores_snapshot"
[0m14:11:50.115784 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m14:11:50.116784 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
create or replace transient table EPICALDEMO.broman_analytics.stores_snapshot
    

    
    as (
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id,
        modified as dbt_updated_at,
        modified as dbt_valid_from,
        
  
  coalesce(nullif(modified, modified), to_date('9999-12-31'))
  as dbt_valid_to
from (
        select * from EPICALDEMO.d365_fo.store
    ) sbq



    )
;
[0m14:11:50.970265 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.853 seconds
[0m14:11:50.998264 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91a291c2-2fc2-4b4c-b3ee-667de144e3bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5C3F84510>]}
[0m14:11:50.999267 [info ] [Thread-1 (]: 1 of 1 OK snapshotted broman_analytics.stores_snapshot ......................... [[32mSUCCESS 1[0m in 2.63s]
[0m14:11:51.000282 [debug] [Thread-1 (]: Finished running node snapshot.epicaldemo.stores_snapshot
[0m14:11:51.001265 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:11:51.002267 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m14:11:51.002267 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m14:11:51.160850 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m14:11:51.160850 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m14:11:51.341888 [debug] [MainThread]: Connection 'snapshot.epicaldemo.stores_snapshot' was left open.
[0m14:11:51.342927 [debug] [MainThread]: On snapshot.epicaldemo.stores_snapshot: Close
[0m14:11:51.521089 [info ] [MainThread]: 
[0m14:11:51.522090 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 7.61 seconds (7.61s).
[0m14:11:51.523088 [debug] [MainThread]: Command end result
[0m14:11:51.547600 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m14:11:51.550597 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m14:11:51.556598 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m14:11:51.557603 [info ] [MainThread]: 
[0m14:11:51.558603 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:11:51.558603 [info ] [MainThread]: 
[0m14:11:51.559625 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:11:51.560598 [debug] [MainThread]: Command `dbt snapshot` succeeded at 14:11:51.560598 after 12.09 seconds
[0m14:11:51.561603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5C1DB6F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5BC693090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5BC612190>]}
[0m14:11:51.561603 [debug] [MainThread]: Flushing usage events
[0m14:11:52.099780 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:20:56.451821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AFCC79690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AFCC6B9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AFCC73D10>]}


============================== 14:20:56.465818 | 54e7362a-7a3a-4938-a9ba-e50c305165f7 ==============================
[0m14:20:56.465818 [info ] [MainThread]: Running with dbt=1.9.4
[0m14:20:56.466818 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:20:59.097532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54e7362a-7a3a-4938-a9ba-e50c305165f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AFDF16790>]}
[0m14:20:59.138062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '54e7362a-7a3a-4938-a9ba-e50c305165f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AFDE31510>]}
[0m14:20:59.153061 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m14:20:59.566214 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m14:21:00.679788 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:21:00.680788 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:21:00.685805 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m14:21:00.723326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '54e7362a-7a3a-4938-a9ba-e50c305165f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AFCC81710>]}
[0m14:21:00.808022 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m14:21:00.824063 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m14:21:01.037702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '54e7362a-7a3a-4938-a9ba-e50c305165f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AFE606290>]}
[0m14:21:01.038703 [info ] [MainThread]: Found 13 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m14:21:01.039701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54e7362a-7a3a-4938-a9ba-e50c305165f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AFDEC2050>]}
[0m14:21:01.041702 [info ] [MainThread]: 
[0m14:21:01.042703 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:21:01.043703 [info ] [MainThread]: 
[0m14:21:01.044703 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:21:01.045703 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m14:21:03.153138 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m14:21:03.153138 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m14:21:03.154138 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:21:04.244032 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.089 seconds
[0m14:21:04.250034 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m14:21:04.259032 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m14:21:04.259032 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m14:21:04.260032 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:21:04.909580 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.650 seconds
[0m14:21:04.913579 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m14:21:04.913579 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m14:21:05.080104 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.165 seconds
[0m14:21:05.081104 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m14:21:05.082105 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m14:21:05.203188 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.121 seconds
[0m14:21:05.207196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54e7362a-7a3a-4938-a9ba-e50c305165f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AFE7FC490>]}
[0m14:21:05.214188 [debug] [Thread-1 (]: Began running node snapshot.epicaldemo.stores_snapshot
[0m14:21:05.214188 [info ] [Thread-1 (]: 1 of 1 START snapshot broman_analytics.stores_snapshot ......................... [RUN]
[0m14:21:05.215188 [debug] [Thread-1 (]: Acquiring new snowflake connection 'snapshot.epicaldemo.stores_snapshot'
[0m14:21:05.216188 [debug] [Thread-1 (]: Began compiling node snapshot.epicaldemo.stores_snapshot
[0m14:21:05.222188 [debug] [Thread-1 (]: Began executing node snapshot.epicaldemo.stores_snapshot
[0m14:21:05.263192 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m14:21:05.264188 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
[0m14:21:05.265188 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:21:05.925390 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.661 seconds
[0m14:21:05.963389 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m14:21:05.964388 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
create or replace temporary table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp"
as (
    
    
    with snapshot_query as (

        select * from EPICALDEMO.d365_fo.store

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            
  
  coalesce(nullif(modified, modified), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            modified as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.modified)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.modified)
        )
    )

    select * from insertions
    union all
    select * from updates

    )
;
[0m14:21:07.304779 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.339 seconds
[0m14:21:07.307761 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m14:21:07.307761 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp"
[0m14:21:07.416788 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.108 seconds
[0m14:21:07.419788 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m14:21:07.419788 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
[0m14:21:07.536322 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.116 seconds
[0m14:21:07.539321 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m14:21:07.540321 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp"
[0m14:21:07.640385 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.099 seconds
[0m14:21:07.644381 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m14:21:07.644381 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
[0m14:21:07.747910 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.102 seconds
[0m14:21:07.753910 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m14:21:07.753910 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp"
[0m14:21:07.861113 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.106 seconds
[0m14:21:07.879107 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m14:21:07.880100 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from EPICALDEMO.d365_fo.store

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            
  
  coalesce(nullif(modified, modified), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            modified as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.modified)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.modified)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m14:21:08.225833 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.345 seconds
[0m14:21:08.229832 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m14:21:08.230832 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m14:21:08.336353 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.105 seconds
[0m14:21:08.337352 [warn ] [Thread-1 (]: Data type of snapshot table timestamp columns (TIMESTAMP_NTZ) doesn't match derived column 'updated_at' (DATE). Please update snapshot config 'updated_at'.
[0m14:21:08.338352 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.epicaldemo.stores_snapshot"
[0m14:21:08.350352 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m14:21:08.351354 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
BEGIN
[0m14:21:08.466867 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.115 seconds
[0m14:21:08.466867 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m14:21:08.467865 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
merge into "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT" as DBT_INTERNAL_DEST
    using "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
	
	
	and ((DBT_INTERNAL_DEST.dbt_valid_to = to_date('9999-12-31'))
 or DBT_INTERNAL_DEST.dbt_valid_to is null)

     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("ID", "NAME", "LOCATION", "LATITUDE", "LONGITUDE", "ONLINEPRESENCE", "MODIFIED", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("ID", "NAME", "LOCATION", "LATITUDE", "LONGITUDE", "ONLINEPRESENCE", "MODIFIED", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m14:21:09.264722 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.796 seconds
[0m14:21:09.264722 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m14:21:09.265724 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
COMMIT
[0m14:21:09.606442 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.340 seconds
[0m14:21:09.641438 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54e7362a-7a3a-4938-a9ba-e50c305165f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AFE604F90>]}
[0m14:21:09.642438 [info ] [Thread-1 (]: 1 of 1 OK snapshotted broman_analytics.stores_snapshot ......................... [[32mSUCCESS 10[0m in 4.41s]
[0m14:21:09.643437 [debug] [Thread-1 (]: Finished running node snapshot.epicaldemo.stores_snapshot
[0m14:21:09.645429 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:21:09.645429 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m14:21:09.646430 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m14:21:09.813472 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m14:21:09.813472 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m14:21:09.972807 [debug] [MainThread]: Connection 'snapshot.epicaldemo.stores_snapshot' was left open.
[0m14:21:09.973809 [debug] [MainThread]: On snapshot.epicaldemo.stores_snapshot: Close
[0m14:21:10.127882 [info ] [MainThread]: 
[0m14:21:10.128882 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 9.08 seconds (9.08s).
[0m14:21:10.129882 [debug] [MainThread]: Command end result
[0m14:21:10.151881 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m14:21:10.155883 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m14:21:10.161881 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m14:21:10.162881 [info ] [MainThread]: 
[0m14:21:10.163883 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:21:10.163883 [info ] [MainThread]: 
[0m14:21:10.164882 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:21:10.165882 [debug] [MainThread]: Command `dbt snapshot` succeeded at 14:21:10.165882 after 13.80 seconds
[0m14:21:10.166882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AFCCB6390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AFA755010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AF70F3090>]}
[0m14:21:10.166882 [debug] [MainThread]: Flushing usage events
[0m14:21:10.701255 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:21:17.928444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184D2D798D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184D1A05650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184D2C86750>]}


============================== 14:21:17.931443 | 3efcca81-1c98-44b9-ae89-69405ed67dc6 ==============================
[0m14:21:17.931443 [info ] [MainThread]: Running with dbt=1.9.4
[0m14:21:17.932443 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:21:18.347444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3efcca81-1c98-44b9-ae89-69405ed67dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184D40FE090>]}
[0m14:21:18.391444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3efcca81-1c98-44b9-ae89-69405ed67dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184D34DC2D0>]}
[0m14:21:18.393440 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m14:21:18.703599 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m14:21:18.894640 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:21:18.895639 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:21:18.901651 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m14:21:18.938188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3efcca81-1c98-44b9-ae89-69405ed67dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184D4714250>]}
[0m14:21:19.012729 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m14:21:19.016736 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m14:21:19.037726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3efcca81-1c98-44b9-ae89-69405ed67dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184D46E8A10>]}
[0m14:21:19.037726 [info ] [MainThread]: Found 13 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m14:21:19.038727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3efcca81-1c98-44b9-ae89-69405ed67dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184D0BD9A90>]}
[0m14:21:19.040745 [info ] [MainThread]: 
[0m14:21:19.041735 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:21:19.041735 [info ] [MainThread]: 
[0m14:21:19.042728 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:21:19.047726 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m14:21:19.128866 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m14:21:19.128866 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m14:21:19.129857 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:21:20.269657 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.140 seconds
[0m14:21:20.272646 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m14:21:20.281654 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m14:21:20.282654 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m14:21:20.282654 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:21:20.990626 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.708 seconds
[0m14:21:20.994617 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m14:21:20.995616 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m14:21:21.128122 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.132 seconds
[0m14:21:21.130122 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m14:21:21.130122 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m14:21:21.286660 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.155 seconds
[0m14:21:21.289645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3efcca81-1c98-44b9-ae89-69405ed67dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184D4B93150>]}
[0m14:21:21.294644 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__categories
[0m14:21:21.295662 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_d365_fo__dates
[0m14:21:21.296644 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_d365_fo__items
[0m14:21:21.296644 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_d365_fo__managers
[0m14:21:21.295662 [info ] [Thread-1 (]: 1 of 13 START sql view model broman_analytics.stg_d365_fo__categories .......... [RUN]
[0m14:21:21.297666 [info ] [Thread-2 (]: 2 of 13 START sql view model broman_analytics.stg_d365_fo__dates ............... [RUN]
[0m14:21:21.297666 [info ] [Thread-3 (]: 3 of 13 START sql view model broman_analytics.stg_d365_fo__items ............... [RUN]
[0m14:21:21.298648 [info ] [Thread-4 (]: 4 of 13 START sql view model broman_analytics.stg_d365_fo__managers ............ [RUN]
[0m14:21:21.299651 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__categories'
[0m14:21:21.299651 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__dates'
[0m14:21:21.300670 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__items'
[0m14:21:21.301669 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__managers'
[0m14:21:21.301669 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__categories
[0m14:21:21.302658 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_d365_fo__dates
[0m14:21:21.302658 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_d365_fo__items
[0m14:21:21.303648 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_d365_fo__managers
[0m14:21:21.309657 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__categories"
[0m14:21:21.312170 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__dates"
[0m14:21:21.315178 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__items"
[0m14:21:21.317178 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__managers"
[0m14:21:21.320180 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__categories
[0m14:21:21.344186 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__categories"
[0m14:21:21.345181 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_d365_fo__managers
[0m14:21:21.346178 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_d365_fo__dates
[0m14:21:21.346178 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_d365_fo__items
[0m14:21:21.349177 [debug] [Thread-4 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__managers"
[0m14:21:21.353193 [debug] [Thread-2 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__dates"
[0m14:21:21.354194 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__categories"
[0m14:21:21.356186 [debug] [Thread-3 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__items"
[0m14:21:21.358184 [debug] [Thread-1 (]: On model.epicaldemo.stg_d365_fo__categories: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__categories"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__categories
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.category
),

final AS (
    SELECT
        id AS category_id
        ,INITCAP(name) AS "Category"
        ,managerid AS manager_id
    FROM source
)

SELECT * FROM final
  );
[0m14:21:21.359180 [debug] [Thread-4 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__managers"
[0m14:21:21.359180 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:21:21.360178 [debug] [Thread-2 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__dates"
[0m14:21:21.361179 [debug] [Thread-4 (]: On model.epicaldemo.stg_d365_fo__managers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__managers"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__managers
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.manager
),

final AS (
    SELECT
        id AS manager_id
        ,firstname || ' ' || lastname AS "Manager"
    FROM source
)

SELECT * FROM final
  );
[0m14:21:21.362180 [debug] [Thread-3 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__items"
[0m14:21:21.364177 [debug] [Thread-2 (]: On model.epicaldemo.stg_d365_fo__dates: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__dates"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__dates
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.date
),

final AS (
    SELECT
        id AS date_id
        ,date AS "Date"
        ,year AS "Year"
        ,yearmonth AS "Year Month"
        ,TO_CHAR(TO_DATE(id::string, 'YYYYMMDD'), 'YYYY-MM') AS "Year Month Number"
        ,DATEDIFF(MONTH, DATE_TRUNC('MONTH', CURRENT_DATE), DATE_TRUNC('MONTH', date)) AS month_offset
        ,monthnumber AS "Month Number"
        ,quarter AS "Quarter"
        ,quarternumber AS "Quarter Number"
        ,monthname AS "Month"
        ,LEFT(monthname,3) AS "Month Short"
    FROM source
)

SELECT * FROM final
  );
[0m14:21:21.365178 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:21:21.366177 [debug] [Thread-3 (]: On model.epicaldemo.stg_d365_fo__items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__items"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__items
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.item
),

final AS (
    SELECT
        id AS item_id
        ,name AS "Item"
        ,COALESCE(brand, 'Missing') AS "Brand"
        ,categoryid AS category_id
        ,COALESCE(flavor, 'Missing') AS "Flavor"
        ,sku AS "SKU"
    FROM source
)

SELECT * FROM final
  );
[0m14:21:21.366177 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:21:21.368179 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:21:22.186391 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.818 seconds
[0m14:21:22.205413 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3efcca81-1c98-44b9-ae89-69405ed67dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184D41CDFD0>]}
[0m14:21:22.206408 [info ] [Thread-3 (]: 3 of 13 OK created sql view model broman_analytics.stg_d365_fo__items .......... [[32mSUCCESS 1[0m in 0.90s]
[0m14:21:22.207411 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_d365_fo__items
[0m14:21:22.208405 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_d365_fo__stores
[0m14:21:22.208405 [info ] [Thread-3 (]: 5 of 13 START sql view model broman_analytics.stg_d365_fo__stores .............. [RUN]
[0m14:21:22.209406 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__items, now model.epicaldemo.stg_d365_fo__stores)
[0m14:21:22.210406 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_d365_fo__stores
[0m14:21:22.213933 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__stores"
[0m14:21:22.218935 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_d365_fo__stores
[0m14:21:22.220934 [debug] [Thread-3 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__stores"
[0m14:21:22.223935 [debug] [Thread-3 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__stores"
[0m14:21:22.223935 [debug] [Thread-3 (]: On model.epicaldemo.stg_d365_fo__stores: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__stores"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__stores
  
   as (
    WITH

stores_snapshots AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stores_snapshot
),

final AS (
    SELECT
        -- Identifiers
        id AS store_id

        -- SCD2 Fields
        ,dbt_scd_id
        ,ROW_NUMBER() OVER (ORDER BY id ASC, dbt_valid_from ASC) AS store_key
        ,CASE WHEN dbt_valid_to = '9999-12-31' THEN 1 ELSE 0 END AS is_current
        ,modified
        ,CAST(TO_CHAR(dbt_valid_from::DATE, 'YYYYMMDD') AS INTEGER) AS valid_from
        ,CAST(TO_CHAR(dbt_valid_to::DATE, 'YYYYMMDD') AS INTEGER) AS valid_to

        -- Attributes
        ,name AS "Store"
        ,SPLIT_PART(location, ',', 1) AS "Store State"
        ,SPLIT_PART(location, ',', 2) AS "Store City"
        ,latitude AS "Lat"
        ,longitude AS "Lon"
        ,onlinepresence AS "Online Presence"
    FROM stores_snapshots
)

SELECT * FROM final
  );
[0m14:21:22.289936 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.924 seconds
[0m14:21:22.290944 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.931 seconds
[0m14:21:22.292932 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3efcca81-1c98-44b9-ae89-69405ed67dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184D5644210>]}
[0m14:21:22.294934 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3efcca81-1c98-44b9-ae89-69405ed67dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184D50FD310>]}
[0m14:21:22.295933 [info ] [Thread-4 (]: 4 of 13 OK created sql view model broman_analytics.stg_d365_fo__managers ....... [[32mSUCCESS 1[0m in 0.99s]
[0m14:21:22.295933 [info ] [Thread-1 (]: 1 of 13 OK created sql view model broman_analytics.stg_d365_fo__categories ..... [[32mSUCCESS 1[0m in 1.00s]
[0m14:21:22.296934 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_d365_fo__managers
[0m14:21:22.297939 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__categories
[0m14:21:22.297939 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_d365_fo__transactions
[0m14:21:22.298938 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_inriver__item_attributes
[0m14:21:22.298938 [info ] [Thread-4 (]: 6 of 13 START sql view model broman_analytics.stg_d365_fo__transactions ........ [RUN]
[0m14:21:22.299940 [info ] [Thread-1 (]: 7 of 13 START sql view model broman_analytics.stg_inriver__item_attributes ..... [RUN]
[0m14:21:22.300939 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__managers, now model.epicaldemo.stg_d365_fo__transactions)
[0m14:21:22.300939 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__categories, now model.epicaldemo.stg_inriver__item_attributes)
[0m14:21:22.301939 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_d365_fo__transactions
[0m14:21:22.301939 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_inriver__item_attributes
[0m14:21:22.304948 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__transactions"
[0m14:21:22.307947 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_inriver__item_attributes"
[0m14:21:22.308938 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_d365_fo__transactions
[0m14:21:22.312445 [debug] [Thread-4 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__transactions"
[0m14:21:22.313473 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_inriver__item_attributes
[0m14:21:22.316450 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.stg_inriver__item_attributes"
[0m14:21:22.318474 [debug] [Thread-4 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__transactions"
[0m14:21:22.319450 [debug] [Thread-4 (]: On model.epicaldemo.stg_d365_fo__transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__transactions"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__transactions
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.transactions
),

final AS (
    SELECT
        -- Identifiers
        id
        ,updated_at
        ,CAST(TO_CHAR(transaction_date::DATE, 'YYYYMMDD') AS INTEGER) AS transaction_date_id
        ,sku AS "SKU"
        ,store AS "Store"
        ,customernumber AS "Customer Number"

        -- Metrics
        ,quantity AS "Qty"
        ,unitprice::NUMERIC(10,2) AS "Unit Price"
        ,(quantity * unitprice)::NUMERIC(10,2) AS "Sales Amount"
        ,unitcost::NUMERIC(10,2) AS "Unit Cost"
        ,(quantity * unitcost)::NUMERIC(10,2) AS "Cost"
        ,(quantity * unitprice)::NUMERIC(10,2) - (quantity * unitcost)::NUMERIC(10,2) AS "Margin"
    FROM source
)

SELECT * FROM final
  );
[0m14:21:22.320450 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.stg_inriver__item_attributes"
[0m14:21:22.321451 [debug] [Thread-1 (]: On model.epicaldemo.stg_inriver__item_attributes: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_inriver__item_attributes"} */
create or replace   view EPICALDEMO.broman_analytics.stg_inriver__item_attributes
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.inriver.item_attributes
),

final AS (
    SELECT
        id AS item_attributes_id
        ,sku AS "SKU"
        ,COALESCE(crunch_level, 'Missing') AS "Crunch Level"
        ,COALESCE(snack_time, 'Missing') AS "Snack Time"
    FROM source
)

SELECT * FROM final
  );
[0m14:21:22.460071 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.093 seconds
[0m14:21:22.462071 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3efcca81-1c98-44b9-ae89-69405ed67dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184D4EB4590>]}
[0m14:21:22.463071 [info ] [Thread-2 (]: 2 of 13 OK created sql view model broman_analytics.stg_d365_fo__dates .......... [[32mSUCCESS 1[0m in 1.16s]
[0m14:21:22.464071 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_d365_fo__dates
[0m14:21:22.465560 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_salesforce__customers
[0m14:21:22.466565 [info ] [Thread-2 (]: 8 of 13 START sql view model broman_analytics.stg_salesforce__customers ........ [RUN]
[0m14:21:22.466565 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__dates, now model.epicaldemo.stg_salesforce__customers)
[0m14:21:22.467943 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_salesforce__customers
[0m14:21:22.470948 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_salesforce__customers"
[0m14:21:22.471948 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_salesforce__customers
[0m14:21:22.474947 [debug] [Thread-2 (]: Writing runtime sql for node "model.epicaldemo.stg_salesforce__customers"
[0m14:21:22.477949 [debug] [Thread-2 (]: Using snowflake connection "model.epicaldemo.stg_salesforce__customers"
[0m14:21:22.477949 [debug] [Thread-2 (]: On model.epicaldemo.stg_salesforce__customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_salesforce__customers"} */
create or replace   view EPICALDEMO.broman_analytics.stg_salesforce__customers
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.salesforce.customer
),

final AS (
    SELECT
        id AS customer_id
        ,customernumber AS "Customer Number"
        ,age AS "Customer Age"

        ,CASE
            WHEN age < 20 THEN '< 20'
            WHEN age >= 20 AND age < 30 THEN '20 - 30'
            WHEN age >= 30 AND age < 50 THEN '30 - 50'
            WHEN age >= 50 AND age < 60 THEN '50 - 60'
            ELSE '60+'
         END AS "Customer Age Group"

        ,CASE
            WHEN age < 20 THEN 1
            WHEN age >= 20 AND age < 30 THEN 2
            WHEN age >= 30 AND age < 50 THEN 3
            WHEN age >= 50 AND age < 60 THEN 4
            ELSE 5
         END AS customer_age_group_sort

        ,state AS "Customer State"
    FROM source
)

SELECT * FROM final
  );
[0m14:21:22.534474 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.213 seconds
[0m14:21:22.537473 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3efcca81-1c98-44b9-ae89-69405ed67dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184D5677390>]}
[0m14:21:22.538474 [info ] [Thread-1 (]: 7 of 13 OK created sql view model broman_analytics.stg_inriver__item_attributes  [[32mSUCCESS 1[0m in 0.24s]
[0m14:21:22.539475 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_inriver__item_attributes
[0m14:21:22.539475 [debug] [Thread-1 (]: Began running node model.epicaldemo.dim_dates
[0m14:21:22.540474 [info ] [Thread-1 (]: 9 of 13 START sql table model broman_analytics.dim_dates ....................... [RUN]
[0m14:21:22.541475 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_inriver__item_attributes, now model.epicaldemo.dim_dates)
[0m14:21:22.541475 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.dim_dates
[0m14:21:22.544488 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.dim_dates"
[0m14:21:22.546473 [debug] [Thread-1 (]: Began executing node model.epicaldemo.dim_dates
[0m14:21:22.567474 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.dim_dates"
[0m14:21:22.569474 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.249 seconds
[0m14:21:22.571477 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3efcca81-1c98-44b9-ae89-69405ed67dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184D419B9D0>]}
[0m14:21:22.572482 [info ] [Thread-4 (]: 6 of 13 OK created sql view model broman_analytics.stg_d365_fo__transactions ... [[32mSUCCESS 1[0m in 0.27s]
[0m14:21:22.573474 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.dim_dates"
[0m14:21:22.574476 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_d365_fo__transactions
[0m14:21:22.574476 [debug] [Thread-1 (]: On model.epicaldemo.dim_dates: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_dates"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_dates
    

    
    as (WITH

dates AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__dates
),

final AS (
    SELECT
        date_id
        ,"Date"
        ,"Year"
        ,"Year Month"
        ,"Year Month Number"
        ,month_offset
        ,"Month Number"
        ,"Quarter"
        ,"Quarter Number"
        ,"Month"
        ,"Month Short"
    FROM dates
)

SELECT * FROM final
    )
;
[0m14:21:22.575474 [debug] [Thread-4 (]: Began running node model.epicaldemo.dim_items
[0m14:21:22.576475 [info ] [Thread-4 (]: 10 of 13 START sql table model broman_analytics.dim_items ...................... [RUN]
[0m14:21:22.578475 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__transactions, now model.epicaldemo.dim_items)
[0m14:21:22.579475 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.dim_items
[0m14:21:22.583476 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.dim_items"
[0m14:21:22.585477 [debug] [Thread-4 (]: Began executing node model.epicaldemo.dim_items
[0m14:21:22.587483 [debug] [Thread-4 (]: Writing runtime sql for node "model.epicaldemo.dim_items"
[0m14:21:22.590474 [debug] [Thread-4 (]: Using snowflake connection "model.epicaldemo.dim_items"
[0m14:21:22.591486 [debug] [Thread-4 (]: On model.epicaldemo.dim_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_items"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_items
    

    
    as (WITH

items AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__items
),

item_attributes AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_inriver__item_attributes
),

categories AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__categories
),

managers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__managers
),

unknown AS (
    SELECT
        -1 AS item_id
        ,'Unknown' AS "SKU"
        ,'Unknown' AS "Item"
        ,'Missing' AS "Brand"
        ,'Missing' AS "Flavor"
        ,'Missing' AS "Crunch Level"
        ,'Missing' AS "Snack Time"
        ,'Missing' AS "Category"
        ,'Missing' AS "Manager"
),

missing AS (
    SELECT
        -2 AS item_id
        ,'Missing' AS "SKU"
        ,'Missing' AS "Item"
        ,'Missing' AS "Brand"
        ,'Missing' AS "Flavor"
        ,'Missing' AS "Crunch Level"
        ,'Missing' AS "Snack Time"
        ,'Missing' AS "Category"
        ,'Missing' AS "Manager"
),

final AS (
    SELECT
        items.item_id
        ,items."SKU"
        ,items."Item"
        ,items."Brand"
        ,items."Flavor"
        ,COALESCE(item_attributes."Crunch Level", 'Missing') AS "Crunch Level"
        ,COALESCE(item_attributes."Snack Time", 'Missing') AS "Snack Time"
        ,categories."Category"
        ,managers."Manager"
    FROM items
    LEFT JOIN item_attributes ON item_attributes."SKU" = items."SKU"
    LEFT JOIN categories ON categories.category_id = items.category_id
    LEFT JOIN managers ON managers.manager_id = categories.manager_id

    UNION

    SELECT * FROM unknown

    UNION

    SELECT * FROM missing
)

SELECT * FROM final
    )
;
[0m14:21:22.697022 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.218 seconds
[0m14:21:22.700027 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3efcca81-1c98-44b9-ae89-69405ed67dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184D5618890>]}
[0m14:21:22.701026 [info ] [Thread-2 (]: 8 of 13 OK created sql view model broman_analytics.stg_salesforce__customers ... [[32mSUCCESS 1[0m in 0.23s]
[0m14:21:22.702027 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_salesforce__customers
[0m14:21:22.703027 [debug] [Thread-2 (]: Began running node model.epicaldemo.dim_customers
[0m14:21:22.704027 [info ] [Thread-2 (]: 11 of 13 START sql table model broman_analytics.dim_customers .................. [RUN]
[0m14:21:22.705027 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_salesforce__customers, now model.epicaldemo.dim_customers)
[0m14:21:22.705027 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.dim_customers
[0m14:21:22.708027 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.dim_customers"
[0m14:21:22.710030 [debug] [Thread-2 (]: Began executing node model.epicaldemo.dim_customers
[0m14:21:22.716590 [debug] [Thread-2 (]: Writing runtime sql for node "model.epicaldemo.dim_customers"
[0m14:21:22.718590 [debug] [Thread-2 (]: Using snowflake connection "model.epicaldemo.dim_customers"
[0m14:21:22.719591 [debug] [Thread-2 (]: On model.epicaldemo.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_customers"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_customers
    

    
    as (WITH

customers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_salesforce__customers
),

final AS (
    SELECT
        customer_id
        ,"Customer Number"
        ,"Customer Age"
        ,"Customer Age Group"
        ,customer_age_group_sort
        ,"Customer State"
    FROM customers
)

SELECT * FROM final
    )
;
[0m14:21:22.975130 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.750 seconds
[0m14:21:22.978049 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3efcca81-1c98-44b9-ae89-69405ed67dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184D564E510>]}
[0m14:21:22.979049 [info ] [Thread-3 (]: 5 of 13 OK created sql view model broman_analytics.stg_d365_fo__stores ......... [[32mSUCCESS 1[0m in 0.77s]
[0m14:21:22.980054 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_d365_fo__stores
[0m14:21:22.981052 [debug] [Thread-3 (]: Began running node model.epicaldemo.dim_stores
[0m14:21:22.982049 [info ] [Thread-3 (]: 12 of 13 START sql table model broman_analytics.dim_stores ..................... [RUN]
[0m14:21:22.983053 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__stores, now model.epicaldemo.dim_stores)
[0m14:21:22.983053 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.dim_stores
[0m14:21:22.986063 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.dim_stores"
[0m14:21:22.988047 [debug] [Thread-3 (]: Began executing node model.epicaldemo.dim_stores
[0m14:21:22.990051 [debug] [Thread-3 (]: Writing runtime sql for node "model.epicaldemo.dim_stores"
[0m14:21:22.992048 [debug] [Thread-3 (]: Using snowflake connection "model.epicaldemo.dim_stores"
[0m14:21:22.993063 [debug] [Thread-3 (]: On model.epicaldemo.dim_stores: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_stores"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_stores
    

    
    as (WITH

store AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__stores
),

final AS (
    SELECT
        -- Identifiers
        store_id

        -- SCD2 Fields
        ,store_key
        ,is_current
        --,modified
        ,valid_from
        ,valid_to

        -- Attributes
        ,"Store"
        ,"Store State"
        ,"Store City"
        ,"Lat"
        ,"Lon"
        ,"Online Presence"
    FROM store
)

SELECT * FROM final
    )
;
[0m14:21:23.270520 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.695 seconds
[0m14:21:23.272503 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3efcca81-1c98-44b9-ae89-69405ed67dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184D46E8350>]}
[0m14:21:23.273494 [info ] [Thread-1 (]: 9 of 13 OK created sql table model broman_analytics.dim_dates .................. [[32mSUCCESS 1[0m in 0.73s]
[0m14:21:23.274496 [debug] [Thread-1 (]: Finished running node model.epicaldemo.dim_dates
[0m14:21:23.275512 [debug] [Thread-1 (]: Began running node model.epicaldemo.fact_sales_transactions
[0m14:21:23.275512 [info ] [Thread-1 (]: 13 of 13 START sql incremental model broman_analytics.fact_sales_transactions .. [RUN]
[0m14:21:23.276496 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.dim_dates, now model.epicaldemo.fact_sales_transactions)
[0m14:21:23.276496 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.fact_sales_transactions
[0m14:21:23.284503 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.fact_sales_transactions"
[0m14:21:23.289497 [debug] [Thread-1 (]: Began executing node model.epicaldemo.fact_sales_transactions
[0m14:21:23.320050 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions"
[0m14:21:23.320050 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions"} */
create or replace  temporary view EPICALDEMO.broman_analytics.fact_sales_transactions__dbt_tmp
  
   as (
    

WITH

sales AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__transactions

    
    WHERE UPDATED_AT >= (SELECT MAX(UPDATED_AT) FROM EPICALDEMO.broman_analytics.fact_sales_transactions)
    
),

items AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__items
),

stores AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__stores
),

customers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_salesforce__customers
),

final AS (
    SELECT
        -- Identifiers
        sales.id
        ,sales.transaction_date_id
        ,sales.updated_at
        ,CONVERT_TIMEZONE('Europe/Stockholm', CURRENT_TIMESTAMP()) AS loaded_at

        ,CASE
            WHEN sales.sku IS NULL THEN -2 -- SKU is missing FROM Source
            WHEN items.item_id IS NULL THEN -1 -- SKU is not known FROM Source
            ELSE items.item_id -- Use item_id FROM Dim based on SKU
         END AS item_id

        ,CASE
            WHEN sales."Store" IS NULL THEN -2
            WHEN stores.store_key IS NULL THEN -1
            ELSE stores.store_key
         END AS store_key

        ,CASE
            WHEN sales."Customer Number" IS NULL THEN -2
            WHEN customers.customer_id IS NULL THEN -1
            ELSE customers.customer_id
         END AS customer_id

        -- Metrics
        ,sales."Qty"
        ,sales."Unit Price"
        ,sales."Sales Amount"
        ,sales."Unit Cost"
        ,sales."Cost"
        ,sales."Margin"
    FROM sales
    LEFT JOIN items ON items."SKU" = sales."SKU"
    LEFT JOIN stores ON stores."Store" = sales."Store" AND sales.transaction_date_id >= stores.valid_from AND sales.transaction_date_id < stores.valid_to
    LEFT JOIN customers ON customers."Customer Number" = sales."Customer Number"
)

SELECT * FROM final
  );
[0m14:21:23.591123 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.871 seconds
[0m14:21:23.594130 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3efcca81-1c98-44b9-ae89-69405ed67dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184D571B210>]}
[0m14:21:23.595122 [info ] [Thread-2 (]: 11 of 13 OK created sql table model broman_analytics.dim_customers ............. [[32mSUCCESS 1[0m in 0.89s]
[0m14:21:23.596123 [debug] [Thread-2 (]: Finished running node model.epicaldemo.dim_customers
[0m14:21:23.621691 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.628 seconds
[0m14:21:23.623681 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3efcca81-1c98-44b9-ae89-69405ed67dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184D572F210>]}
[0m14:21:23.624672 [info ] [Thread-3 (]: 12 of 13 OK created sql table model broman_analytics.dim_stores ................ [[32mSUCCESS 1[0m in 0.64s]
[0m14:21:23.625673 [debug] [Thread-3 (]: Finished running node model.epicaldemo.dim_stores
[0m14:21:24.807666 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.486 seconds
[0m14:21:24.814186 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions"
[0m14:21:24.815203 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions"} */
describe table EPICALDEMO.broman_analytics.fact_sales_transactions__dbt_tmp
[0m14:21:24.923740 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.108 seconds
[0m14:21:24.927748 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions"
[0m14:21:24.928742 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions"} */
describe table EPICALDEMO.broman_analytics.fact_sales_transactions
[0m14:21:25.120437 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.191 seconds
[0m14:21:25.126436 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions"
[0m14:21:25.127436 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."FACT_SALES_TRANSACTIONS"
[0m14:21:25.219414 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.092 seconds
[0m14:21:25.245410 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.fact_sales_transactions"
[0m14:21:25.248411 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions"
[0m14:21:25.249410 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions"} */
-- back compat for old kwarg name
  
  begin;
[0m14:21:25.372924 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.123 seconds
[0m14:21:25.372924 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions"
[0m14:21:25.373924 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions"} */
merge into EPICALDEMO.broman_analytics.fact_sales_transactions as DBT_INTERNAL_DEST
        using EPICALDEMO.broman_analytics.fact_sales_transactions__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.transaction_date_id = DBT_INTERNAL_DEST.transaction_date_id
                ) and (
                    DBT_INTERNAL_SOURCE.item_id = DBT_INTERNAL_DEST.item_id
                ) and (
                    DBT_INTERNAL_SOURCE.store_key = DBT_INTERNAL_DEST.store_key
                ) and (
                    DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
                )

    
    when matched then update set
        "ID" = DBT_INTERNAL_SOURCE."ID","TRANSACTION_DATE_ID" = DBT_INTERNAL_SOURCE."TRANSACTION_DATE_ID","UPDATED_AT" = DBT_INTERNAL_SOURCE."UPDATED_AT","LOADED_AT" = DBT_INTERNAL_SOURCE."LOADED_AT","ITEM_ID" = DBT_INTERNAL_SOURCE."ITEM_ID","STORE_KEY" = DBT_INTERNAL_SOURCE."STORE_KEY","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","Qty" = DBT_INTERNAL_SOURCE."Qty","Unit Price" = DBT_INTERNAL_SOURCE."Unit Price","Sales Amount" = DBT_INTERNAL_SOURCE."Sales Amount","Unit Cost" = DBT_INTERNAL_SOURCE."Unit Cost","Cost" = DBT_INTERNAL_SOURCE."Cost","Margin" = DBT_INTERNAL_SOURCE."Margin"
    

    when not matched then insert
        ("ID", "TRANSACTION_DATE_ID", "UPDATED_AT", "LOADED_AT", "ITEM_ID", "STORE_KEY", "CUSTOMER_ID", "Qty", "Unit Price", "Sales Amount", "Unit Cost", "Cost", "Margin")
    values
        ("ID", "TRANSACTION_DATE_ID", "UPDATED_AT", "LOADED_AT", "ITEM_ID", "STORE_KEY", "CUSTOMER_ID", "Qty", "Unit Price", "Sales Amount", "Unit Cost", "Cost", "Margin")

;
[0m14:21:25.904515 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 3.313 seconds
[0m14:21:25.906516 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3efcca81-1c98-44b9-ae89-69405ed67dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184D56BB550>]}
[0m14:21:25.907516 [info ] [Thread-4 (]: 10 of 13 OK created sql table model broman_analytics.dim_items ................. [[32mSUCCESS 1[0m in 3.33s]
[0m14:21:25.908516 [debug] [Thread-4 (]: Finished running node model.epicaldemo.dim_items
[0m14:21:27.696258 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.321 seconds
[0m14:21:27.697272 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions"
[0m14:21:27.697272 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions"} */
COMMIT
[0m14:21:27.967950 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.270 seconds
[0m14:21:27.974948 [debug] [Thread-1 (]: Applying DROP to: EPICALDEMO.broman_analytics.fact_sales_transactions__dbt_tmp
[0m14:21:27.980948 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions"
[0m14:21:27.980948 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions"} */
drop view if exists EPICALDEMO.broman_analytics.fact_sales_transactions__dbt_tmp cascade
[0m14:21:28.140045 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.158 seconds
[0m14:21:28.142045 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3efcca81-1c98-44b9-ae89-69405ed67dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184D5644490>]}
[0m14:21:28.143049 [info ] [Thread-1 (]: 13 of 13 OK created sql incremental model broman_analytics.fact_sales_transactions  [[32mSUCCESS 1[0m in 4.87s]
[0m14:21:28.144049 [debug] [Thread-1 (]: Finished running node model.epicaldemo.fact_sales_transactions
[0m14:21:28.145046 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:21:28.146051 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m14:21:28.146051 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m14:21:28.297293 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m14:21:28.297293 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m14:21:28.457438 [debug] [MainThread]: Connection 'model.epicaldemo.fact_sales_transactions' was left open.
[0m14:21:28.458438 [debug] [MainThread]: On model.epicaldemo.fact_sales_transactions: Close
[0m14:21:28.616363 [debug] [MainThread]: Connection 'model.epicaldemo.dim_customers' was left open.
[0m14:21:28.617367 [debug] [MainThread]: On model.epicaldemo.dim_customers: Close
[0m14:21:28.770891 [debug] [MainThread]: Connection 'model.epicaldemo.dim_stores' was left open.
[0m14:21:28.771899 [debug] [MainThread]: On model.epicaldemo.dim_stores: Close
[0m14:21:28.920963 [debug] [MainThread]: Connection 'model.epicaldemo.dim_items' was left open.
[0m14:21:28.921961 [debug] [MainThread]: On model.epicaldemo.dim_items: Close
[0m14:21:29.078296 [info ] [MainThread]: 
[0m14:21:29.079296 [info ] [MainThread]: Finished running 1 incremental model, 4 table models, 8 view models in 0 hours 0 minutes and 10.04 seconds (10.04s).
[0m14:21:29.081296 [debug] [MainThread]: Command end result
[0m14:21:29.103300 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m14:21:29.106300 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m14:21:29.112304 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m14:21:29.113301 [info ] [MainThread]: 
[0m14:21:29.114300 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:21:29.115300 [info ] [MainThread]: 
[0m14:21:29.115300 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 TOTAL=13
[0m14:21:29.117813 [debug] [MainThread]: Command `dbt run` succeeded at 14:21:29.117813 after 11.25 seconds
[0m14:21:29.117813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184D2BB4D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184CD693090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184CD612190>]}
[0m14:21:29.118813 [debug] [MainThread]: Flushing usage events
[0m14:21:29.753083 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:28:43.375368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0F40B6610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0F40B6F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0F40B5C50>]}


============================== 14:28:43.378377 | 06fd5a7e-814a-4e4d-9981-2a2b3eda6a91 ==============================
[0m14:28:43.378377 [info ] [MainThread]: Running with dbt=1.9.4
[0m14:28:43.379375 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:28:43.850521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06fd5a7e-814a-4e4d-9981-2a2b3eda6a91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0F5316610>]}
[0m14:28:43.892521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '06fd5a7e-814a-4e4d-9981-2a2b3eda6a91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0F53AE790>]}
[0m14:28:43.893513 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m14:28:44.193709 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m14:28:44.381288 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:28:44.382287 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:28:44.387287 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m14:28:44.425282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06fd5a7e-814a-4e4d-9981-2a2b3eda6a91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0F5A77410>]}
[0m14:28:44.498447 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m14:28:44.503449 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m14:28:44.524448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06fd5a7e-814a-4e4d-9981-2a2b3eda6a91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0F57E4B10>]}
[0m14:28:44.525448 [info ] [MainThread]: Found 13 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m14:28:44.526461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06fd5a7e-814a-4e4d-9981-2a2b3eda6a91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0F5A14190>]}
[0m14:28:44.529478 [info ] [MainThread]: 
[0m14:28:44.529478 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:28:44.530474 [info ] [MainThread]: 
[0m14:28:44.531478 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:28:44.535473 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m14:28:44.612012 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m14:28:44.612012 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m14:28:44.613004 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:28:45.336740 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.724 seconds
[0m14:28:45.339739 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m14:28:45.348919 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m14:28:45.349912 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m14:28:45.350932 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:28:46.001443 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.651 seconds
[0m14:28:46.006451 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m14:28:46.007445 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m14:28:46.140778 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.133 seconds
[0m14:28:46.143292 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m14:28:46.145288 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m14:28:46.256815 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.111 seconds
[0m14:28:46.260816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06fd5a7e-814a-4e4d-9981-2a2b3eda6a91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0F6008250>]}
[0m14:28:46.265828 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__categories
[0m14:28:46.265828 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_d365_fo__dates
[0m14:28:46.266814 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_d365_fo__items
[0m14:28:46.266814 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_d365_fo__managers
[0m14:28:46.267816 [info ] [Thread-1 (]: 1 of 13 START sql view model broman_analytics.stg_d365_fo__categories .......... [RUN]
[0m14:28:46.268817 [info ] [Thread-2 (]: 2 of 13 START sql view model broman_analytics.stg_d365_fo__dates ............... [RUN]
[0m14:28:46.269815 [info ] [Thread-3 (]: 3 of 13 START sql view model broman_analytics.stg_d365_fo__items ............... [RUN]
[0m14:28:46.270815 [info ] [Thread-4 (]: 4 of 13 START sql view model broman_analytics.stg_d365_fo__managers ............ [RUN]
[0m14:28:46.271815 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__categories'
[0m14:28:46.272817 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__dates'
[0m14:28:46.272817 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__items'
[0m14:28:46.273816 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__managers'
[0m14:28:46.273816 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__categories
[0m14:28:46.274818 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_d365_fo__dates
[0m14:28:46.275818 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_d365_fo__items
[0m14:28:46.275818 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_d365_fo__managers
[0m14:28:46.284817 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__categories"
[0m14:28:46.288814 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__dates"
[0m14:28:46.290815 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__items"
[0m14:28:46.294815 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__managers"
[0m14:28:46.297816 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__categories
[0m14:28:46.297816 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_d365_fo__dates
[0m14:28:46.299102 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_d365_fo__items
[0m14:28:46.323115 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__categories"
[0m14:28:46.329117 [debug] [Thread-2 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__dates"
[0m14:28:46.330127 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_d365_fo__managers
[0m14:28:46.333131 [debug] [Thread-3 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__items"
[0m14:28:46.337116 [debug] [Thread-4 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__managers"
[0m14:28:46.337116 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__categories"
[0m14:28:46.338132 [debug] [Thread-2 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__dates"
[0m14:28:46.340118 [debug] [Thread-3 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__items"
[0m14:28:46.340118 [debug] [Thread-1 (]: On model.epicaldemo.stg_d365_fo__categories: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__categories"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__categories
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.category
),

final AS (
    SELECT
        id AS category_id
        ,INITCAP(name) AS "Category"
        ,managerid AS manager_id
    FROM source
)

SELECT * FROM final
  );
[0m14:28:46.341116 [debug] [Thread-4 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__managers"
[0m14:28:46.341116 [debug] [Thread-2 (]: On model.epicaldemo.stg_d365_fo__dates: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__dates"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__dates
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.date
),

final AS (
    SELECT
        id AS date_id
        ,date AS "Date"
        ,year AS "Year"
        ,yearmonth AS "Year Month"
        ,TO_CHAR(TO_DATE(id::string, 'YYYYMMDD'), 'YYYY-MM') AS "Year Month Number"
        ,DATEDIFF(MONTH, DATE_TRUNC('MONTH', CURRENT_DATE), DATE_TRUNC('MONTH', date)) AS month_offset
        ,monthnumber AS "Month Number"
        ,quarter AS "Quarter"
        ,quarternumber AS "Quarter Number"
        ,monthname AS "Month"
        ,LEFT(monthname,3) AS "Month Short"
    FROM source
)

SELECT * FROM final
  );
[0m14:28:46.342630 [debug] [Thread-3 (]: On model.epicaldemo.stg_d365_fo__items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__items"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__items
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.item
),

final AS (
    SELECT
        id AS item_id
        ,name AS "Item"
        ,COALESCE(brand, 'Missing') AS "Brand"
        ,categoryid AS category_id
        ,COALESCE(flavor, 'Missing') AS "Flavor"
        ,sku AS "SKU"
    FROM source
)

SELECT * FROM final
  );
[0m14:28:46.343650 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:28:46.344641 [debug] [Thread-4 (]: On model.epicaldemo.stg_d365_fo__managers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__managers"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__managers
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.manager
),

final AS (
    SELECT
        id AS manager_id
        ,firstname || ' ' || lastname AS "Manager"
    FROM source
)

SELECT * FROM final
  );
[0m14:28:46.344641 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:28:46.345642 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:28:46.346643 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:28:46.986076 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.639 seconds
[0m14:28:47.006074 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06fd5a7e-814a-4e4d-9981-2a2b3eda6a91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0F64F0210>]}
[0m14:28:47.007086 [info ] [Thread-4 (]: 4 of 13 OK created sql view model broman_analytics.stg_d365_fo__managers ....... [[32mSUCCESS 1[0m in 0.73s]
[0m14:28:47.008076 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_d365_fo__managers
[0m14:28:47.008076 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_d365_fo__stores
[0m14:28:47.009076 [info ] [Thread-4 (]: 5 of 13 START sql view model broman_analytics.stg_d365_fo__stores .............. [RUN]
[0m14:28:47.010076 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__managers, now model.epicaldemo.stg_d365_fo__stores)
[0m14:28:47.010076 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_d365_fo__stores
[0m14:28:47.014074 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__stores"
[0m14:28:47.015075 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_d365_fo__stores
[0m14:28:47.017073 [debug] [Thread-4 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__stores"
[0m14:28:47.019076 [debug] [Thread-4 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__stores"
[0m14:28:47.020075 [debug] [Thread-4 (]: On model.epicaldemo.stg_d365_fo__stores: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__stores"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__stores
  
   as (
    WITH

stores_snapshots AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stores_snapshot
),

final AS (
    SELECT
        -- Identifiers
        id AS store_id

        -- SCD2 Fields
        ,dbt_scd_id
        ,ROW_NUMBER() OVER (ORDER BY id ASC, dbt_valid_from ASC) AS store_key
        ,CASE WHEN dbt_valid_to = '9999-12-31' THEN 1 ELSE 0 END AS is_current
        ,modified
        ,CAST(TO_CHAR(dbt_valid_from::DATE, 'YYYYMMDD') AS INTEGER) AS valid_from
        ,CAST(TO_CHAR(dbt_valid_to::DATE, 'YYYYMMDD') AS INTEGER) AS valid_to

        -- Attributes
        ,name AS "Store"
        ,SPLIT_PART(location, ',', 1) AS "Store State"
        ,SPLIT_PART(location, ',', 2) AS "Store City"
        ,latitude AS "Lat"
        ,longitude AS "Lon"
        ,onlinepresence AS "Online Presence"
    FROM stores_snapshots
)

SELECT * FROM final
  );
[0m14:28:47.057646 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.713 seconds
[0m14:28:47.063649 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06fd5a7e-814a-4e4d-9981-2a2b3eda6a91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0F5C99550>]}
[0m14:28:47.067647 [info ] [Thread-2 (]: 2 of 13 OK created sql view model broman_analytics.stg_d365_fo__dates .......... [[32mSUCCESS 1[0m in 0.79s]
[0m14:28:47.071647 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_d365_fo__dates
[0m14:28:47.073651 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_d365_fo__transactions
[0m14:28:47.076646 [info ] [Thread-2 (]: 6 of 13 START sql view model broman_analytics.stg_d365_fo__transactions ........ [RUN]
[0m14:28:47.078647 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__dates, now model.epicaldemo.stg_d365_fo__transactions)
[0m14:28:47.079647 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_d365_fo__transactions
[0m14:28:47.085646 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__transactions"
[0m14:28:47.087647 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_d365_fo__transactions
[0m14:28:47.094647 [debug] [Thread-2 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__transactions"
[0m14:28:47.100651 [debug] [Thread-2 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__transactions"
[0m14:28:47.101721 [debug] [Thread-2 (]: On model.epicaldemo.stg_d365_fo__transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__transactions"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__transactions
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.transactions
),

final AS (
    SELECT
        -- Identifiers
        id
        ,updated_at
        ,CAST(TO_CHAR(transaction_date::DATE, 'YYYYMMDD') AS INTEGER) AS transaction_date_id
        ,sku AS "SKU"
        ,store AS "Store"
        ,customernumber AS "Customer Number"

        -- Metrics
        ,quantity AS "Qty"
        ,unitprice::NUMERIC(10,2) AS "Unit Price"
        ,(quantity * unitprice)::NUMERIC(10,2) AS "Sales Amount"
        ,unitcost::NUMERIC(10,2) AS "Unit Cost"
        ,(quantity * unitcost)::NUMERIC(10,2) AS "Cost"
        ,(quantity * unitprice)::NUMERIC(10,2) - (quantity * unitcost)::NUMERIC(10,2) AS "Margin"
    FROM source
)

SELECT * FROM final
  );
[0m14:28:47.123085 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.779 seconds
[0m14:28:47.127085 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06fd5a7e-814a-4e4d-9981-2a2b3eda6a91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0F6538D10>]}
[0m14:28:47.129091 [info ] [Thread-1 (]: 1 of 13 OK created sql view model broman_analytics.stg_d365_fo__categories ..... [[32mSUCCESS 1[0m in 0.86s]
[0m14:28:47.130092 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__categories
[0m14:28:47.131092 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_inriver__item_attributes
[0m14:28:47.132091 [info ] [Thread-1 (]: 7 of 13 START sql view model broman_analytics.stg_inriver__item_attributes ..... [RUN]
[0m14:28:47.133096 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__categories, now model.epicaldemo.stg_inriver__item_attributes)
[0m14:28:47.134094 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_inriver__item_attributes
[0m14:28:47.137096 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_inriver__item_attributes"
[0m14:28:47.139090 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_inriver__item_attributes
[0m14:28:47.144959 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.stg_inriver__item_attributes"
[0m14:28:47.147960 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.stg_inriver__item_attributes"
[0m14:28:47.148958 [debug] [Thread-1 (]: On model.epicaldemo.stg_inriver__item_attributes: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_inriver__item_attributes"} */
create or replace   view EPICALDEMO.broman_analytics.stg_inriver__item_attributes
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.inriver.item_attributes
),

final AS (
    SELECT
        id AS item_attributes_id
        ,sku AS "SKU"
        ,COALESCE(crunch_level, 'Missing') AS "Crunch Level"
        ,COALESCE(snack_time, 'Missing') AS "Snack Time"
    FROM source
)

SELECT * FROM final
  );
[0m14:28:47.162182 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.816 seconds
[0m14:28:47.167309 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06fd5a7e-814a-4e4d-9981-2a2b3eda6a91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0F600A250>]}
[0m14:28:47.169335 [info ] [Thread-3 (]: 3 of 13 OK created sql view model broman_analytics.stg_d365_fo__items .......... [[32mSUCCESS 1[0m in 0.89s]
[0m14:28:47.170335 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_d365_fo__items
[0m14:28:47.171678 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_salesforce__customers
[0m14:28:47.172787 [info ] [Thread-3 (]: 8 of 13 START sql view model broman_analytics.stg_salesforce__customers ........ [RUN]
[0m14:28:47.174795 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__items, now model.epicaldemo.stg_salesforce__customers)
[0m14:28:47.175794 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_salesforce__customers
[0m14:28:47.183794 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_salesforce__customers"
[0m14:28:47.185794 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_salesforce__customers
[0m14:28:47.193303 [debug] [Thread-3 (]: Writing runtime sql for node "model.epicaldemo.stg_salesforce__customers"
[0m14:28:47.196843 [debug] [Thread-3 (]: Using snowflake connection "model.epicaldemo.stg_salesforce__customers"
[0m14:28:47.198839 [debug] [Thread-3 (]: On model.epicaldemo.stg_salesforce__customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_salesforce__customers"} */
create or replace   view EPICALDEMO.broman_analytics.stg_salesforce__customers
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.salesforce.customer
),

final AS (
    SELECT
        id AS customer_id
        ,customernumber AS "Customer Number"
        ,age AS "Customer Age"

        ,CASE
            WHEN age < 20 THEN '< 20'
            WHEN age >= 20 AND age < 30 THEN '20 - 30'
            WHEN age >= 30 AND age < 50 THEN '30 - 50'
            WHEN age >= 50 AND age < 60 THEN '50 - 60'
            ELSE '60+'
         END AS "Customer Age Group"

        ,CASE
            WHEN age < 20 THEN 1
            WHEN age >= 20 AND age < 30 THEN 2
            WHEN age >= 30 AND age < 50 THEN 3
            WHEN age >= 50 AND age < 60 THEN 4
            ELSE 5
         END AS customer_age_group_sort

        ,state AS "Customer State"
    FROM source
)

SELECT * FROM final
  );
[0m14:28:47.265559 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.245 seconds
[0m14:28:47.270575 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06fd5a7e-814a-4e4d-9981-2a2b3eda6a91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0F652F0D0>]}
[0m14:28:47.272560 [info ] [Thread-4 (]: 5 of 13 OK created sql view model broman_analytics.stg_d365_fo__stores ......... [[32mSUCCESS 1[0m in 0.26s]
[0m14:28:47.273562 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_d365_fo__stores
[0m14:28:47.275561 [debug] [Thread-4 (]: Began running node model.epicaldemo.dim_dates
[0m14:28:47.277562 [info ] [Thread-4 (]: 9 of 13 START sql table model broman_analytics.dim_dates ....................... [RUN]
[0m14:28:47.280560 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__stores, now model.epicaldemo.dim_dates)
[0m14:28:47.281561 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.dim_dates
[0m14:28:47.289054 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.dim_dates"
[0m14:28:47.291058 [debug] [Thread-4 (]: Began executing node model.epicaldemo.dim_dates
[0m14:28:47.329083 [debug] [Thread-4 (]: Writing runtime sql for node "model.epicaldemo.dim_dates"
[0m14:28:47.332470 [debug] [Thread-4 (]: Using snowflake connection "model.epicaldemo.dim_dates"
[0m14:28:47.333479 [debug] [Thread-4 (]: On model.epicaldemo.dim_dates: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_dates"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_dates
    

    
    as (WITH

dates AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__dates
),

final AS (
    SELECT
        date_id
        ,"Date"
        ,"Year"
        ,"Year Month"
        ,"Year Month Number"
        ,month_offset
        ,"Month Number"
        ,"Quarter"
        ,"Quarter Number"
        ,"Month"
        ,"Month Short"
    FROM dates
)

SELECT * FROM final
    )
;
[0m14:28:47.343986 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.241 seconds
[0m14:28:47.346992 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06fd5a7e-814a-4e4d-9981-2a2b3eda6a91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0F65C2150>]}
[0m14:28:47.347992 [info ] [Thread-2 (]: 6 of 13 OK created sql view model broman_analytics.stg_d365_fo__transactions ... [[32mSUCCESS 1[0m in 0.27s]
[0m14:28:47.348994 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_d365_fo__transactions
[0m14:28:47.348994 [debug] [Thread-2 (]: Began running node model.epicaldemo.dim_stores
[0m14:28:47.349995 [info ] [Thread-2 (]: 10 of 13 START sql table model broman_analytics.dim_stores ..................... [RUN]
[0m14:28:47.350992 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__transactions, now model.epicaldemo.dim_stores)
[0m14:28:47.350992 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.dim_stores
[0m14:28:47.354992 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.dim_stores"
[0m14:28:47.355999 [debug] [Thread-2 (]: Began executing node model.epicaldemo.dim_stores
[0m14:28:47.360992 [debug] [Thread-2 (]: Writing runtime sql for node "model.epicaldemo.dim_stores"
[0m14:28:47.362992 [debug] [Thread-2 (]: Using snowflake connection "model.epicaldemo.dim_stores"
[0m14:28:47.362992 [debug] [Thread-2 (]: On model.epicaldemo.dim_stores: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_stores"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_stores
    

    
    as (WITH

store AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__stores
),

final AS (
    SELECT
        -- Identifiers
        store_id

        -- SCD2 Fields
        ,store_key
        ,is_current
        --,modified
        ,valid_from
        ,valid_to

        -- Attributes
        ,"Store"
        ,"Store State"
        ,"Store City"
        ,"Lat"
        ,"Lon"
        ,"Online Presence"
    FROM store
)

SELECT * FROM final
    )
;
[0m14:28:47.414003 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.214 seconds
[0m14:28:47.416000 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06fd5a7e-814a-4e4d-9981-2a2b3eda6a91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0F65CFA90>]}
[0m14:28:47.416994 [info ] [Thread-3 (]: 8 of 13 OK created sql view model broman_analytics.stg_salesforce__customers ... [[32mSUCCESS 1[0m in 0.24s]
[0m14:28:47.417993 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.268 seconds
[0m14:28:47.418992 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_salesforce__customers
[0m14:28:47.421011 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06fd5a7e-814a-4e4d-9981-2a2b3eda6a91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0F65B3890>]}
[0m14:28:47.421992 [debug] [Thread-3 (]: Began running node model.epicaldemo.dim_customers
[0m14:28:47.421992 [info ] [Thread-1 (]: 7 of 13 OK created sql view model broman_analytics.stg_inriver__item_attributes  [[32mSUCCESS 1[0m in 0.29s]
[0m14:28:47.422991 [info ] [Thread-3 (]: 11 of 13 START sql table model broman_analytics.dim_customers .................. [RUN]
[0m14:28:47.423991 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_inriver__item_attributes
[0m14:28:47.423991 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_salesforce__customers, now model.epicaldemo.dim_customers)
[0m14:28:47.424992 [debug] [Thread-1 (]: Began running node model.epicaldemo.fact_sales_transactions
[0m14:28:47.425993 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.dim_customers
[0m14:28:47.425993 [info ] [Thread-1 (]: 12 of 13 START sql incremental model broman_analytics.fact_sales_transactions .. [RUN]
[0m14:28:47.430001 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.dim_customers"
[0m14:28:47.430001 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_inriver__item_attributes, now model.epicaldemo.fact_sales_transactions)
[0m14:28:47.431001 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.fact_sales_transactions
[0m14:28:47.439009 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.fact_sales_transactions"
[0m14:28:47.439009 [debug] [Thread-3 (]: Began executing node model.epicaldemo.dim_customers
[0m14:28:47.442001 [debug] [Thread-3 (]: Writing runtime sql for node "model.epicaldemo.dim_customers"
[0m14:28:47.442001 [debug] [Thread-1 (]: Began executing node model.epicaldemo.fact_sales_transactions
[0m14:28:47.443507 [debug] [Thread-3 (]: Using snowflake connection "model.epicaldemo.dim_customers"
[0m14:28:47.472513 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.fact_sales_transactions"
[0m14:28:47.472513 [debug] [Thread-3 (]: On model.epicaldemo.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_customers"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_customers
    

    
    as (WITH

customers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_salesforce__customers
),

final AS (
    SELECT
        customer_id
        ,"Customer Number"
        ,"Customer Age"
        ,"Customer Age Group"
        ,customer_age_group_sort
        ,"Customer State"
    FROM customers
)

SELECT * FROM final
    )
;
[0m14:28:47.475512 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions"
[0m14:28:47.476522 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions"} */
create or replace transient table EPICALDEMO.broman_analytics.fact_sales_transactions
    

    
    as (

WITH

sales AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__transactions

    
),

items AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__items
),

stores AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__stores
),

customers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_salesforce__customers
),

final AS (
    SELECT
        -- Identifiers
        sales.id
        ,sales.transaction_date_id
        ,sales.updated_at
        ,CONVERT_TIMEZONE('Europe/Stockholm', CURRENT_TIMESTAMP()) AS loaded_at

        ,CASE
            WHEN sales.sku IS NULL THEN -2 -- SKU is missing FROM Source
            WHEN items.item_id IS NULL THEN -1 -- SKU is not known FROM Source
            ELSE items.item_id -- Use item_id FROM Dim based on SKU
         END AS item_id

        ,CASE
            WHEN sales."Store" IS NULL THEN -2
            WHEN stores.store_key IS NULL THEN -1
            ELSE stores.store_key
         END AS store_key

        ,CASE
            WHEN sales."Customer Number" IS NULL THEN -2
            WHEN customers.customer_id IS NULL THEN -1
            ELSE customers.customer_id
         END AS customer_id

        -- Metrics
        ,sales."Qty"
        ,sales."Unit Price"
        ,sales."Sales Amount"
        ,sales."Unit Cost"
        ,sales."Cost"
        ,sales."Margin"
    FROM sales
    LEFT JOIN items ON items."SKU" = sales."SKU"
    LEFT JOIN stores ON stores."Store" = sales."Store" AND sales.transaction_date_id >= stores.valid_from AND sales.transaction_date_id < stores.valid_to
    LEFT JOIN customers ON customers."Customer Number" = sales."Customer Number"
)

SELECT * FROM final
    )
;
[0m14:28:47.967669 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.603 seconds
[0m14:28:47.969670 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06fd5a7e-814a-4e4d-9981-2a2b3eda6a91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0F6583AD0>]}
[0m14:28:47.970670 [info ] [Thread-2 (]: 10 of 13 OK created sql table model broman_analytics.dim_stores ................ [[32mSUCCESS 1[0m in 0.62s]
[0m14:28:47.971669 [debug] [Thread-2 (]: Finished running node model.epicaldemo.dim_stores
[0m14:28:47.972666 [debug] [Thread-2 (]: Began running node model.epicaldemo.dim_items
[0m14:28:47.972666 [info ] [Thread-2 (]: 13 of 13 START sql table model broman_analytics.dim_items ...................... [RUN]
[0m14:28:47.973668 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.dim_stores, now model.epicaldemo.dim_items)
[0m14:28:47.973668 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.dim_items
[0m14:28:47.978670 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.dim_items"
[0m14:28:47.979687 [debug] [Thread-2 (]: Began executing node model.epicaldemo.dim_items
[0m14:28:47.983675 [debug] [Thread-2 (]: Writing runtime sql for node "model.epicaldemo.dim_items"
[0m14:28:47.985668 [debug] [Thread-2 (]: Using snowflake connection "model.epicaldemo.dim_items"
[0m14:28:47.986686 [debug] [Thread-2 (]: On model.epicaldemo.dim_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_items"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_items
    

    
    as (WITH

items AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__items
),

item_attributes AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_inriver__item_attributes
),

categories AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__categories
),

managers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__managers
),

unknown AS (
    SELECT
        -1 AS item_id
        ,'Unknown' AS "SKU"
        ,'Unknown' AS "Item"
        ,'Missing' AS "Brand"
        ,'Missing' AS "Flavor"
        ,'Missing' AS "Crunch Level"
        ,'Missing' AS "Snack Time"
        ,'Missing' AS "Category"
        ,'Missing' AS "Manager"
),

missing AS (
    SELECT
        -2 AS item_id
        ,'Missing' AS "SKU"
        ,'Missing' AS "Item"
        ,'Missing' AS "Brand"
        ,'Missing' AS "Flavor"
        ,'Missing' AS "Crunch Level"
        ,'Missing' AS "Snack Time"
        ,'Missing' AS "Category"
        ,'Missing' AS "Manager"
),

final AS (
    SELECT
        items.item_id
        ,items."SKU"
        ,items."Item"
        ,items."Brand"
        ,items."Flavor"
        ,COALESCE(item_attributes."Crunch Level", 'Missing') AS "Crunch Level"
        ,COALESCE(item_attributes."Snack Time", 'Missing') AS "Snack Time"
        ,categories."Category"
        ,managers."Manager"
    FROM items
    LEFT JOIN item_attributes ON item_attributes."SKU" = items."SKU"
    LEFT JOIN categories ON categories.category_id = items.category_id
    LEFT JOIN managers ON managers.manager_id = categories.manager_id

    UNION

    SELECT * FROM unknown

    UNION

    SELECT * FROM missing
)

SELECT * FROM final
    )
;
[0m14:28:48.108871 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.775 seconds
[0m14:28:48.111870 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06fd5a7e-814a-4e4d-9981-2a2b3eda6a91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0F65F5990>]}
[0m14:28:48.112870 [info ] [Thread-4 (]: 9 of 13 OK created sql table model broman_analytics.dim_dates .................. [[32mSUCCESS 1[0m in 0.83s]
[0m14:28:48.113869 [debug] [Thread-4 (]: Finished running node model.epicaldemo.dim_dates
[0m14:28:48.220718 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.747 seconds
[0m14:28:48.222713 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06fd5a7e-814a-4e4d-9981-2a2b3eda6a91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0F65F5A50>]}
[0m14:28:48.223704 [info ] [Thread-3 (]: 11 of 13 OK created sql table model broman_analytics.dim_customers ............. [[32mSUCCESS 1[0m in 0.80s]
[0m14:28:48.224704 [debug] [Thread-3 (]: Finished running node model.epicaldemo.dim_customers
[0m14:28:48.729597 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.251 seconds
[0m14:28:48.738594 [debug] [Thread-1 (]: Applying DROP to: EPICALDEMO.broman_analytics.fact_sales_transactions__dbt_tmp
[0m14:28:48.745107 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions"
[0m14:28:48.745107 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions"} */
drop view if exists EPICALDEMO.broman_analytics.fact_sales_transactions__dbt_tmp cascade
[0m14:28:48.847203 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.102 seconds
[0m14:28:48.850201 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06fd5a7e-814a-4e4d-9981-2a2b3eda6a91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0F5FC1950>]}
[0m14:28:48.851201 [info ] [Thread-1 (]: 12 of 13 OK created sql incremental model broman_analytics.fact_sales_transactions  [[32mSUCCESS 1[0m in 1.42s]
[0m14:28:48.851201 [debug] [Thread-1 (]: Finished running node model.epicaldemo.fact_sales_transactions
[0m14:28:49.051453 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.064 seconds
[0m14:28:49.053449 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06fd5a7e-814a-4e4d-9981-2a2b3eda6a91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0F6C49750>]}
[0m14:28:49.054449 [info ] [Thread-2 (]: 13 of 13 OK created sql table model broman_analytics.dim_items ................. [[32mSUCCESS 1[0m in 1.08s]
[0m14:28:49.055441 [debug] [Thread-2 (]: Finished running node model.epicaldemo.dim_items
[0m14:28:49.057444 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:28:49.057444 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m14:28:49.058443 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m14:28:49.395853 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m14:28:49.396853 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m14:28:49.551001 [debug] [MainThread]: Connection 'model.epicaldemo.fact_sales_transactions' was left open.
[0m14:28:49.551001 [debug] [MainThread]: On model.epicaldemo.fact_sales_transactions: Close
[0m14:28:49.698063 [debug] [MainThread]: Connection 'model.epicaldemo.dim_items' was left open.
[0m14:28:49.698063 [debug] [MainThread]: On model.epicaldemo.dim_items: Close
[0m14:28:49.853899 [debug] [MainThread]: Connection 'model.epicaldemo.dim_customers' was left open.
[0m14:28:49.854883 [debug] [MainThread]: On model.epicaldemo.dim_customers: Close
[0m14:28:50.004250 [debug] [MainThread]: Connection 'model.epicaldemo.dim_dates' was left open.
[0m14:28:50.004250 [debug] [MainThread]: On model.epicaldemo.dim_dates: Close
[0m14:28:50.160972 [info ] [MainThread]: 
[0m14:28:50.160972 [info ] [MainThread]: Finished running 1 incremental model, 4 table models, 8 view models in 0 hours 0 minutes and 5.63 seconds (5.63s).
[0m14:28:50.163970 [debug] [MainThread]: Command end result
[0m14:28:50.184970 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m14:28:50.187971 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m14:28:50.194971 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m14:28:50.195973 [info ] [MainThread]: 
[0m14:28:50.195973 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:28:50.196972 [info ] [MainThread]: 
[0m14:28:50.197972 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 TOTAL=13
[0m14:28:50.198972 [debug] [MainThread]: Command `dbt run` succeeded at 14:28:50.198972 after 6.88 seconds
[0m14:28:50.199970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0EE4F3050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0F40B74D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0F40B6E50>]}
[0m14:28:50.199970 [debug] [MainThread]: Flushing usage events
[0m14:28:50.856051 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:57:25.980407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021616470550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021616473D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021616473410>]}


============================== 15:57:25.994922 | 8916582d-7a15-4123-8828-eba1532d7e48 ==============================
[0m15:57:25.994922 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:57:25.995922 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:57:29.193405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8916582d-7a15-4123-8828-eba1532d7e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002161232F450>]}
[0m15:57:29.237463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8916582d-7a15-4123-8828-eba1532d7e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216164B5790>]}
[0m15:57:29.248505 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m15:57:29.688804 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:57:30.903345 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:57:30.904345 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:57:30.909901 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m15:57:30.946465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8916582d-7a15-4123-8828-eba1532d7e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021617EB2550>]}
[0m15:57:31.035471 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m15:57:31.054565 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m15:57:31.266663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8916582d-7a15-4123-8828-eba1532d7e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021617FFFD90>]}
[0m15:57:31.267664 [info ] [MainThread]: Found 13 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m15:57:31.267664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8916582d-7a15-4123-8828-eba1532d7e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021614E3D910>]}
[0m15:57:31.270711 [info ] [MainThread]: 
[0m15:57:31.270711 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:57:31.271699 [info ] [MainThread]: 
[0m15:57:31.272702 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:57:31.276192 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m15:57:33.507737 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m15:57:33.508742 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m15:57:33.509745 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:34.379318 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.870 seconds
[0m15:57:34.381319 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_EPICALDEMO, now create_EPICALDEMO_broman_analytics)
[0m15:57:34.382476 [debug] [ThreadPool]: Creating schema "database: "EPICALDEMO"
schema: "broman_analytics"
"
[0m15:57:34.387484 [debug] [ThreadPool]: Using snowflake connection "create_EPICALDEMO_broman_analytics"
[0m15:57:34.388010 [debug] [ThreadPool]: On create_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "create_EPICALDEMO_broman_analytics"} */
create schema if not exists EPICALDEMO.broman_analytics
[0m15:57:34.520557 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.133 seconds
[0m15:57:34.527569 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m15:57:34.539592 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m15:57:34.540592 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m15:57:34.540592 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:35.126465 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.586 seconds
[0m15:57:35.131011 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m15:57:35.132010 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m15:57:35.257636 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.125 seconds
[0m15:57:35.259174 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m15:57:35.260167 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m15:57:35.369903 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.109 seconds
[0m15:57:35.371895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8916582d-7a15-4123-8828-eba1532d7e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021617769790>]}
[0m15:57:35.380410 [debug] [Thread-1 (]: Began running node snapshot.epicaldemo.stores_snapshot
[0m15:57:35.380410 [info ] [Thread-1 (]: 1 of 1 START snapshot broman_analytics.stores_snapshot ......................... [RUN]
[0m15:57:35.381915 [debug] [Thread-1 (]: Acquiring new snowflake connection 'snapshot.epicaldemo.stores_snapshot'
[0m15:57:35.381915 [debug] [Thread-1 (]: Began compiling node snapshot.epicaldemo.stores_snapshot
[0m15:57:35.390456 [debug] [Thread-1 (]: Began executing node snapshot.epicaldemo.stores_snapshot
[0m15:57:35.462020 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m15:57:35.463021 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id,
        modified as dbt_updated_at,
        modified as dbt_valid_from,
        
  
  coalesce(nullif(modified, modified), to_date('9999-12-31'))
  as dbt_valid_to
from (
        select * from EPICALDEMO.d365_fo.store
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m15:57:35.463021 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:57:36.111396 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.648 seconds
[0m15:57:36.117899 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m15:57:36.118904 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m15:57:36.220408 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.101 seconds
[0m15:57:36.221408 [warn ] [Thread-1 (]: Data type of snapshot table timestamp columns (TIMESTAMP_NTZ) doesn't match derived column 'updated_at' (DATE). Please update snapshot config 'updated_at'.
[0m15:57:36.222409 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.epicaldemo.stores_snapshot"
[0m15:57:36.225417 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m15:57:36.225417 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
create or replace transient table EPICALDEMO.broman_analytics.stores_snapshot
    

    
    as (
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id,
        modified as dbt_updated_at,
        modified as dbt_valid_from,
        
  
  coalesce(nullif(modified, modified), to_date('9999-12-31'))
  as dbt_valid_to
from (
        select * from EPICALDEMO.d365_fo.store
    ) sbq



    )
;
[0m15:57:37.105841 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.880 seconds
[0m15:57:37.145594 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8916582d-7a15-4123-8828-eba1532d7e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021617768510>]}
[0m15:57:37.146595 [info ] [Thread-1 (]: 1 of 1 OK snapshotted broman_analytics.stores_snapshot ......................... [[32mSUCCESS 1[0m in 1.75s]
[0m15:57:37.148130 [debug] [Thread-1 (]: Finished running node snapshot.epicaldemo.stores_snapshot
[0m15:57:37.150141 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:57:37.151140 [debug] [MainThread]: Connection 'create_EPICALDEMO_broman_analytics' was left open.
[0m15:57:37.151140 [debug] [MainThread]: On create_EPICALDEMO_broman_analytics: Close
[0m15:57:37.305475 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m15:57:37.306475 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m15:57:37.450379 [debug] [MainThread]: Connection 'snapshot.epicaldemo.stores_snapshot' was left open.
[0m15:57:37.451378 [debug] [MainThread]: On snapshot.epicaldemo.stores_snapshot: Close
[0m15:57:37.605818 [info ] [MainThread]: 
[0m15:57:37.605818 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 6.33 seconds (6.33s).
[0m15:57:37.607322 [debug] [MainThread]: Command end result
[0m15:57:37.642871 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m15:57:37.645871 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m15:57:37.653386 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m15:57:37.654386 [info ] [MainThread]: 
[0m15:57:37.655385 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:57:37.656384 [info ] [MainThread]: 
[0m15:57:37.657386 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:57:37.658710 [debug] [MainThread]: Command `dbt snapshot` succeeded at 15:57:37.658710 after 11.77 seconds
[0m15:57:37.658710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021616195A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216108F3010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216160A2B10>]}
[0m15:57:37.659729 [debug] [MainThread]: Flushing usage events
[0m15:57:38.215339 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:58:28.820888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3C2E799D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3C2E6BC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3C19A9C90>]}


============================== 15:58:28.824895 | e8e2d169-abea-40a5-b1be-9cac8c567eab ==============================
[0m15:58:28.824895 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:58:28.825886 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:58:29.215807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8e2d169-abea-40a5-b1be-9cac8c567eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3C4104290>]}
[0m15:58:29.257445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e8e2d169-abea-40a5-b1be-9cac8c567eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3C2E7BF10>]}
[0m15:58:29.259459 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m15:58:29.564551 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:58:29.751171 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:58:29.752161 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:58:29.757691 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m15:58:29.794295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8e2d169-abea-40a5-b1be-9cac8c567eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3C48DBE90>]}
[0m15:58:29.867558 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m15:58:29.872579 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m15:58:29.891633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8e2d169-abea-40a5-b1be-9cac8c567eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3C4805F50>]}
[0m15:58:29.892612 [info ] [MainThread]: Found 13 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m15:58:29.893610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8e2d169-abea-40a5-b1be-9cac8c567eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3C4150050>]}
[0m15:58:29.895629 [info ] [MainThread]: 
[0m15:58:29.895629 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:58:29.897134 [info ] [MainThread]: 
[0m15:58:29.897134 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:58:29.902147 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m15:58:29.978264 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m15:58:29.978264 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m15:58:29.979270 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:58:30.749578 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.770 seconds
[0m15:58:30.752579 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m15:58:30.762117 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m15:58:30.762117 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m15:58:30.763109 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:58:31.360723 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.598 seconds
[0m15:58:31.363631 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m15:58:31.364630 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m15:58:31.497104 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.132 seconds
[0m15:58:31.499108 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m15:58:31.500109 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m15:58:31.611552 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.110 seconds
[0m15:58:31.612548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8e2d169-abea-40a5-b1be-9cac8c567eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3C4167CD0>]}
[0m15:58:31.616058 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__categories
[0m15:58:31.617563 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_d365_fo__dates
[0m15:58:31.617563 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_d365_fo__items
[0m15:58:31.618568 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_d365_fo__managers
[0m15:58:31.618568 [info ] [Thread-1 (]: 1 of 13 START sql view model broman_analytics.stg_d365_fo__categories .......... [RUN]
[0m15:58:31.619580 [info ] [Thread-2 (]: 2 of 13 START sql view model broman_analytics.stg_d365_fo__dates ............... [RUN]
[0m15:58:31.620568 [info ] [Thread-3 (]: 3 of 13 START sql view model broman_analytics.stg_d365_fo__items ............... [RUN]
[0m15:58:31.620568 [info ] [Thread-4 (]: 4 of 13 START sql view model broman_analytics.stg_d365_fo__managers ............ [RUN]
[0m15:58:31.621568 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__categories'
[0m15:58:31.621568 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__dates'
[0m15:58:31.622570 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__items'
[0m15:58:31.623570 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__managers'
[0m15:58:31.623570 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__categories
[0m15:58:31.623570 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_d365_fo__dates
[0m15:58:31.624569 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_d365_fo__items
[0m15:58:31.624569 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_d365_fo__managers
[0m15:58:31.631104 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__categories"
[0m15:58:31.634104 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__dates"
[0m15:58:31.637096 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__items"
[0m15:58:31.639612 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__managers"
[0m15:58:31.642613 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__categories
[0m15:58:31.650143 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_d365_fo__managers
[0m15:58:31.650143 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_d365_fo__dates
[0m15:58:31.670203 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__categories"
[0m15:58:31.673213 [debug] [Thread-4 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__managers"
[0m15:58:31.674211 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_d365_fo__items
[0m15:58:31.676211 [debug] [Thread-2 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__dates"
[0m15:58:31.679260 [debug] [Thread-3 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__items"
[0m15:58:31.681262 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__categories"
[0m15:58:31.681262 [debug] [Thread-1 (]: On model.epicaldemo.stg_d365_fo__categories: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__categories"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__categories
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.category
),

final AS (
    SELECT
        id AS category_id
        ,INITCAP(name) AS "Category"
        ,managerid AS manager_id
    FROM source
)

SELECT * FROM final
  );
[0m15:58:31.682260 [debug] [Thread-4 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__managers"
[0m15:58:31.684261 [debug] [Thread-2 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__dates"
[0m15:58:31.684261 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:58:31.685260 [debug] [Thread-3 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__items"
[0m15:58:31.686261 [debug] [Thread-4 (]: On model.epicaldemo.stg_d365_fo__managers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__managers"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__managers
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.manager
),

final AS (
    SELECT
        id AS manager_id
        ,firstname || ' ' || lastname AS "Manager"
    FROM source
)

SELECT * FROM final
  );
[0m15:58:31.686261 [debug] [Thread-2 (]: On model.epicaldemo.stg_d365_fo__dates: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__dates"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__dates
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.date
),

final AS (
    SELECT
        id AS date_id
        ,date AS "Date"
        ,year AS "Year"
        ,yearmonth AS "Year Month"
        ,TO_CHAR(TO_DATE(id::string, 'YYYYMMDD'), 'YYYY-MM') AS "Year Month Number"
        ,DATEDIFF(MONTH, DATE_TRUNC('MONTH', CURRENT_DATE), DATE_TRUNC('MONTH', date)) AS month_offset
        ,monthnumber AS "Month Number"
        ,quarter AS "Quarter"
        ,quarternumber AS "Quarter Number"
        ,monthname AS "Month"
        ,LEFT(monthname,3) AS "Month Short"
    FROM source
)

SELECT * FROM final
  );
[0m15:58:31.688478 [debug] [Thread-3 (]: On model.epicaldemo.stg_d365_fo__items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__items"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__items
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.item
),

final AS (
    SELECT
        id AS item_id
        ,name AS "Item"
        ,COALESCE(brand, 'Missing') AS "Brand"
        ,categoryid AS category_id
        ,COALESCE(flavor, 'Missing') AS "Flavor"
        ,sku AS "SKU"
    FROM source
)

SELECT * FROM final
  );
[0m15:58:31.689478 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:58:31.690478 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:58:31.691478 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:58:32.264273 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.580 seconds
[0m15:58:32.281339 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8e2d169-abea-40a5-b1be-9cac8c567eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3C4FF2ED0>]}
[0m15:58:32.282339 [info ] [Thread-1 (]: 1 of 13 OK created sql view model broman_analytics.stg_d365_fo__categories ..... [[32mSUCCESS 1[0m in 0.66s]
[0m15:58:32.283338 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__categories
[0m15:58:32.283338 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__stores
[0m15:58:32.284351 [info ] [Thread-1 (]: 5 of 13 START sql view model broman_analytics.stg_d365_fo__stores .............. [RUN]
[0m15:58:32.285346 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__categories, now model.epicaldemo.stg_d365_fo__stores)
[0m15:58:32.286339 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__stores
[0m15:58:32.289368 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__stores"
[0m15:58:32.291367 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__stores
[0m15:58:32.293366 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__stores"
[0m15:58:32.295368 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__stores"
[0m15:58:32.296367 [debug] [Thread-1 (]: On model.epicaldemo.stg_d365_fo__stores: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__stores"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__stores
  
   as (
    WITH

stores_snapshots AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stores_snapshot
),

final AS (
    SELECT
        -- Identifiers
        id AS store_id

        -- SCD2 Fields
        ,dbt_scd_id
        ,ROW_NUMBER() OVER (ORDER BY id ASC, dbt_valid_from ASC) AS store_key
        ,CASE WHEN dbt_valid_to = '9999-12-31' THEN 1 ELSE 0 END AS is_current
        ,modified
        ,CAST(TO_CHAR(dbt_valid_from::DATE, 'YYYYMMDD') AS INTEGER) AS valid_from
        ,CAST(TO_CHAR(dbt_valid_to::DATE, 'YYYYMMDD') AS INTEGER) AS valid_to

        -- Attributes
        ,name AS "Store"
        ,SPLIT_PART(location, ',', 1) AS "Store State"
        ,SPLIT_PART(location, ',', 2) AS "Store City"
        ,latitude AS "Lat"
        ,longitude AS "Lon"
        ,onlinepresence AS "Online Presence"
    FROM stores_snapshots
)

SELECT * FROM final
  );
[0m15:58:32.413425 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.724 seconds
[0m15:58:32.415450 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8e2d169-abea-40a5-b1be-9cac8c567eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3C5405190>]}
[0m15:58:32.416450 [info ] [Thread-4 (]: 4 of 13 OK created sql view model broman_analytics.stg_d365_fo__managers ....... [[32mSUCCESS 1[0m in 0.79s]
[0m15:58:32.417451 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_d365_fo__managers
[0m15:58:32.417451 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_d365_fo__transactions
[0m15:58:32.418492 [info ] [Thread-4 (]: 6 of 13 START sql view model broman_analytics.stg_d365_fo__transactions ........ [RUN]
[0m15:58:32.419493 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__managers, now model.epicaldemo.stg_d365_fo__transactions)
[0m15:58:32.419493 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_d365_fo__transactions
[0m15:58:32.422502 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__transactions"
[0m15:58:32.423501 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_d365_fo__transactions
[0m15:58:32.426503 [debug] [Thread-4 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__transactions"
[0m15:58:32.427493 [debug] [Thread-4 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__transactions"
[0m15:58:32.428564 [debug] [Thread-4 (]: On model.epicaldemo.stg_d365_fo__transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__transactions"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__transactions
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.d365_fo.transactions
),

final AS (
    SELECT
        -- Identifiers
        id
        ,updated_at
        ,CAST(TO_CHAR(transaction_date::DATE, 'YYYYMMDD') AS INTEGER) AS transaction_date_id
        ,sku AS "SKU"
        ,store AS "Store"
        ,customernumber AS "Customer Number"

        -- Metrics
        ,quantity AS "Qty"
        ,unitprice::NUMERIC(10,2) AS "Unit Price"
        ,(quantity * unitprice)::NUMERIC(10,2) AS "Sales Amount"
        ,unitcost::NUMERIC(10,2) AS "Unit Cost"
        ,(quantity * unitcost)::NUMERIC(10,2) AS "Cost"
        ,(quantity * unitprice)::NUMERIC(10,2) - (quantity * unitcost)::NUMERIC(10,2) AS "Margin"
    FROM source
)

SELECT * FROM final
  );
[0m15:58:32.465614 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.774 seconds
[0m15:58:32.467123 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8e2d169-abea-40a5-b1be-9cac8c567eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3C5424D10>]}
[0m15:58:32.468130 [info ] [Thread-3 (]: 3 of 13 OK created sql view model broman_analytics.stg_d365_fo__items .......... [[32mSUCCESS 1[0m in 0.84s]
[0m15:58:32.470139 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_d365_fo__items
[0m15:58:32.471133 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_inriver__item_attributes
[0m15:58:32.472128 [info ] [Thread-3 (]: 7 of 13 START sql view model broman_analytics.stg_inriver__item_attributes ..... [RUN]
[0m15:58:32.472128 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__items, now model.epicaldemo.stg_inriver__item_attributes)
[0m15:58:32.473129 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_inriver__item_attributes
[0m15:58:32.476129 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_inriver__item_attributes"
[0m15:58:32.483666 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_inriver__item_attributes
[0m15:58:32.487170 [debug] [Thread-3 (]: Writing runtime sql for node "model.epicaldemo.stg_inriver__item_attributes"
[0m15:58:32.491186 [debug] [Thread-3 (]: Using snowflake connection "model.epicaldemo.stg_inriver__item_attributes"
[0m15:58:32.492177 [debug] [Thread-3 (]: On model.epicaldemo.stg_inriver__item_attributes: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_inriver__item_attributes"} */
create or replace   view EPICALDEMO.broman_analytics.stg_inriver__item_attributes
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.inriver.item_attributes
),

final AS (
    SELECT
        id AS item_attributes_id
        ,sku AS "SKU"
        ,COALESCE(crunch_level, 'Missing') AS "Crunch Level"
        ,COALESCE(snack_time, 'Missing') AS "Snack Time"
    FROM source
)

SELECT * FROM final
  );
[0m15:58:32.529233 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.838 seconds
[0m15:58:32.531232 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8e2d169-abea-40a5-b1be-9cac8c567eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3C4DF9C90>]}
[0m15:58:32.532232 [info ] [Thread-2 (]: 2 of 13 OK created sql view model broman_analytics.stg_d365_fo__dates .......... [[32mSUCCESS 1[0m in 0.91s]
[0m15:58:32.534234 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_d365_fo__dates
[0m15:58:32.536235 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_salesforce__customers
[0m15:58:32.537231 [info ] [Thread-2 (]: 8 of 13 START sql view model broman_analytics.stg_salesforce__customers ........ [RUN]
[0m15:58:32.538298 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__dates, now model.epicaldemo.stg_salesforce__customers)
[0m15:58:32.539301 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_salesforce__customers
[0m15:58:32.544298 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_salesforce__customers"
[0m15:58:32.546298 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_salesforce__customers
[0m15:58:32.552831 [debug] [Thread-2 (]: Writing runtime sql for node "model.epicaldemo.stg_salesforce__customers"
[0m15:58:32.558331 [debug] [Thread-2 (]: Using snowflake connection "model.epicaldemo.stg_salesforce__customers"
[0m15:58:32.559332 [debug] [Thread-2 (]: On model.epicaldemo.stg_salesforce__customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_salesforce__customers"} */
create or replace   view EPICALDEMO.broman_analytics.stg_salesforce__customers
  
   as (
    WITH

source AS (
    SELECT
        *
    FROM EPICALDEMO.salesforce.customer
),

final AS (
    SELECT
        id AS customer_id
        ,customernumber AS "Customer Number"
        ,age AS "Customer Age"

        ,CASE
            WHEN age < 20 THEN '< 20'
            WHEN age >= 20 AND age < 30 THEN '20 - 30'
            WHEN age >= 30 AND age < 50 THEN '30 - 50'
            WHEN age >= 50 AND age < 60 THEN '50 - 60'
            ELSE '60+'
         END AS "Customer Age Group"

        ,CASE
            WHEN age < 20 THEN 1
            WHEN age >= 20 AND age < 30 THEN 2
            WHEN age >= 30 AND age < 50 THEN 3
            WHEN age >= 50 AND age < 60 THEN 4
            ELSE 5
         END AS customer_age_group_sort

        ,state AS "Customer State"
    FROM source
)

SELECT * FROM final
  );
[0m15:58:32.607411 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.311 seconds
[0m15:58:32.610415 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8e2d169-abea-40a5-b1be-9cac8c567eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3C5443910>]}
[0m15:58:32.611417 [info ] [Thread-1 (]: 5 of 13 OK created sql view model broman_analytics.stg_d365_fo__stores ......... [[32mSUCCESS 1[0m in 0.33s]
[0m15:58:32.612416 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__stores
[0m15:58:32.612416 [debug] [Thread-1 (]: Began running node model.epicaldemo.dim_dates
[0m15:58:32.613416 [info ] [Thread-1 (]: 9 of 13 START sql table model broman_analytics.dim_dates ....................... [RUN]
[0m15:58:32.613416 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__stores, now model.epicaldemo.dim_dates)
[0m15:58:32.614437 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.dim_dates
[0m15:58:32.617190 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.dim_dates"
[0m15:58:32.618213 [debug] [Thread-1 (]: Began executing node model.epicaldemo.dim_dates
[0m15:58:32.639225 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.dim_dates"
[0m15:58:32.641216 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.dim_dates"
[0m15:58:32.642217 [debug] [Thread-1 (]: On model.epicaldemo.dim_dates: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_dates"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_dates
    

    
    as (WITH

dates AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__dates
),

final AS (
    SELECT
        date_id
        ,"Date"
        ,"Year"
        ,"Year Month"
        ,"Year Month Number"
        ,month_offset
        ,"Month Number"
        ,"Quarter"
        ,"Quarter Number"
        ,"Month"
        ,"Month Short"
    FROM dates
)

SELECT * FROM final
    )
;
[0m15:58:32.646228 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.218 seconds
[0m15:58:32.648264 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8e2d169-abea-40a5-b1be-9cac8c567eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3C54F72D0>]}
[0m15:58:32.649268 [info ] [Thread-4 (]: 6 of 13 OK created sql view model broman_analytics.stg_d365_fo__transactions ... [[32mSUCCESS 1[0m in 0.23s]
[0m15:58:32.650266 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_d365_fo__transactions
[0m15:58:32.651266 [debug] [Thread-4 (]: Began running node model.epicaldemo.dim_stores
[0m15:58:32.651266 [info ] [Thread-4 (]: 10 of 13 START sql table model broman_analytics.dim_stores ..................... [RUN]
[0m15:58:32.653264 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__transactions, now model.epicaldemo.dim_stores)
[0m15:58:32.653264 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.dim_stores
[0m15:58:32.657265 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.dim_stores"
[0m15:58:32.658792 [debug] [Thread-4 (]: Began executing node model.epicaldemo.dim_stores
[0m15:58:32.661792 [debug] [Thread-4 (]: Writing runtime sql for node "model.epicaldemo.dim_stores"
[0m15:58:32.662793 [debug] [Thread-4 (]: Using snowflake connection "model.epicaldemo.dim_stores"
[0m15:58:32.663793 [debug] [Thread-4 (]: On model.epicaldemo.dim_stores: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_stores"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_stores
    

    
    as (WITH

store AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__stores
),

final AS (
    SELECT
        -- Identifiers
        store_id

        -- SCD2 Fields
        ,store_key
        ,is_current
        --,modified
        ,valid_from
        ,valid_to

        -- Attributes
        ,"Store"
        ,"Store State"
        ,"Store City"
        ,"Lat"
        ,"Lon"
        ,"Online Presence"
    FROM store
)

SELECT * FROM final
    )
;
[0m15:58:32.689428 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.197 seconds
[0m15:58:32.691438 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8e2d169-abea-40a5-b1be-9cac8c567eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3C41511D0>]}
[0m15:58:32.692427 [info ] [Thread-3 (]: 7 of 13 OK created sql view model broman_analytics.stg_inriver__item_attributes  [[32mSUCCESS 1[0m in 0.22s]
[0m15:58:32.693426 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_inriver__item_attributes
[0m15:58:32.693426 [debug] [Thread-3 (]: Began running node model.epicaldemo.dim_items
[0m15:58:32.694427 [info ] [Thread-3 (]: 11 of 13 START sql table model broman_analytics.dim_items ...................... [RUN]
[0m15:58:32.694427 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_inriver__item_attributes, now model.epicaldemo.dim_items)
[0m15:58:32.695429 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.dim_items
[0m15:58:32.698447 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.dim_items"
[0m15:58:32.699458 [debug] [Thread-3 (]: Began executing node model.epicaldemo.dim_items
[0m15:58:32.704449 [debug] [Thread-3 (]: Writing runtime sql for node "model.epicaldemo.dim_items"
[0m15:58:32.707448 [debug] [Thread-3 (]: Using snowflake connection "model.epicaldemo.dim_items"
[0m15:58:32.708482 [debug] [Thread-3 (]: On model.epicaldemo.dim_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_items"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_items
    

    
    as (WITH

items AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__items
),

item_attributes AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_inriver__item_attributes
),

categories AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__categories
),

managers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__managers
),

unknown AS (
    SELECT
        -1 AS item_id
        ,'Unknown' AS "SKU"
        ,'Unknown' AS "Item"
        ,'Missing' AS "Brand"
        ,'Missing' AS "Flavor"
        ,'Missing' AS "Crunch Level"
        ,'Missing' AS "Snack Time"
        ,'Missing' AS "Category"
        ,'Missing' AS "Manager"
),

missing AS (
    SELECT
        -2 AS item_id
        ,'Missing' AS "SKU"
        ,'Missing' AS "Item"
        ,'Missing' AS "Brand"
        ,'Missing' AS "Flavor"
        ,'Missing' AS "Crunch Level"
        ,'Missing' AS "Snack Time"
        ,'Missing' AS "Category"
        ,'Missing' AS "Manager"
),

final AS (
    SELECT
        items.item_id
        ,items."SKU"
        ,items."Item"
        ,items."Brand"
        ,items."Flavor"
        ,COALESCE(item_attributes."Crunch Level", 'Missing') AS "Crunch Level"
        ,COALESCE(item_attributes."Snack Time", 'Missing') AS "Snack Time"
        ,categories."Category"
        ,managers."Manager"
    FROM items
    LEFT JOIN item_attributes ON item_attributes."SKU" = items."SKU"
    LEFT JOIN categories ON categories.category_id = items.category_id
    LEFT JOIN managers ON managers.manager_id = categories.manager_id

    UNION

    SELECT * FROM unknown

    UNION

    SELECT * FROM missing
)

SELECT * FROM final
    )
;
[0m15:58:32.760606 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.200 seconds
[0m15:58:32.762607 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8e2d169-abea-40a5-b1be-9cac8c567eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3C4FFC890>]}
[0m15:58:32.763606 [info ] [Thread-2 (]: 8 of 13 OK created sql view model broman_analytics.stg_salesforce__customers ... [[32mSUCCESS 1[0m in 0.22s]
[0m15:58:32.764609 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_salesforce__customers
[0m15:58:32.765607 [debug] [Thread-2 (]: Began running node model.epicaldemo.dim_customers
[0m15:58:32.765607 [info ] [Thread-2 (]: 12 of 13 START sql table model broman_analytics.dim_customers .................. [RUN]
[0m15:58:32.765607 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_salesforce__customers, now model.epicaldemo.dim_customers)
[0m15:58:32.767113 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.dim_customers
[0m15:58:32.770126 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.dim_customers"
[0m15:58:32.772120 [debug] [Thread-2 (]: Began executing node model.epicaldemo.dim_customers
[0m15:58:32.774119 [debug] [Thread-2 (]: Writing runtime sql for node "model.epicaldemo.dim_customers"
[0m15:58:32.776119 [debug] [Thread-2 (]: Using snowflake connection "model.epicaldemo.dim_customers"
[0m15:58:32.776119 [debug] [Thread-2 (]: On model.epicaldemo.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.dim_customers"} */
create or replace transient table EPICALDEMO.broman_analytics.dim_customers
    

    
    as (WITH

customers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_salesforce__customers
),

final AS (
    SELECT
        customer_id
        ,"Customer Number"
        ,"Customer Age"
        ,"Customer Age Group"
        ,customer_age_group_sort
        ,"Customer State"
    FROM customers
)

SELECT * FROM final
    )
;
[0m15:58:33.348491 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.572 seconds
[0m15:58:33.350498 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8e2d169-abea-40a5-b1be-9cac8c567eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3C54DC7D0>]}
[0m15:58:33.351489 [info ] [Thread-2 (]: 12 of 13 OK created sql table model broman_analytics.dim_customers ............. [[32mSUCCESS 1[0m in 0.58s]
[0m15:58:33.352493 [debug] [Thread-2 (]: Finished running node model.epicaldemo.dim_customers
[0m15:58:33.353490 [debug] [Thread-2 (]: Began running node model.epicaldemo.fact_sales_transactions
[0m15:58:33.353490 [info ] [Thread-2 (]: 13 of 13 START sql incremental model broman_analytics.fact_sales_transactions .. [RUN]
[0m15:58:33.354501 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.dim_customers, now model.epicaldemo.fact_sales_transactions)
[0m15:58:33.354501 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.fact_sales_transactions
[0m15:58:33.361040 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.fact_sales_transactions"
[0m15:58:33.372538 [debug] [Thread-2 (]: Began executing node model.epicaldemo.fact_sales_transactions
[0m15:58:33.407157 [debug] [Thread-2 (]: Writing runtime sql for node "model.epicaldemo.fact_sales_transactions"
[0m15:58:33.408194 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.744 seconds
[0m15:58:33.411194 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8e2d169-abea-40a5-b1be-9cac8c567eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3C4F169D0>]}
[0m15:58:33.411194 [info ] [Thread-4 (]: 10 of 13 OK created sql table model broman_analytics.dim_stores ................ [[32mSUCCESS 1[0m in 0.76s]
[0m15:58:33.413205 [debug] [Thread-2 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions"
[0m15:58:33.413205 [debug] [Thread-4 (]: Finished running node model.epicaldemo.dim_stores
[0m15:58:33.414713 [debug] [Thread-2 (]: On model.epicaldemo.fact_sales_transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions"} */
create or replace transient table EPICALDEMO.broman_analytics.fact_sales_transactions
    

    
    as (

WITH

sales AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__transactions

    
),

items AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__items
),

stores AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__stores
),

customers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_salesforce__customers
),

final AS (
    SELECT
        -- Identifiers
        sales.id
        ,sales.transaction_date_id
        ,sales.updated_at
        ,CONVERT_TIMEZONE('Europe/Stockholm', CURRENT_TIMESTAMP()) AS loaded_at

        ,CASE
            WHEN sales.sku IS NULL THEN -2 -- SKU is missing FROM Source
            WHEN items.item_id IS NULL THEN -1 -- SKU is not known FROM Source
            ELSE items.item_id -- Use item_id FROM Dim based on SKU
         END AS item_id

        ,CASE
            WHEN sales."Store" IS NULL THEN -2
            WHEN stores.store_key IS NULL THEN -1
            ELSE stores.store_key
         END AS store_key

        ,CASE
            WHEN sales."Customer Number" IS NULL THEN -2
            WHEN customers.customer_id IS NULL THEN -1
            ELSE customers.customer_id
         END AS customer_id

        -- Metrics
        ,sales."Qty"
        ,sales."Unit Price"
        ,sales."Sales Amount"
        ,sales."Unit Cost"
        ,sales."Cost"
        ,sales."Margin"
    FROM sales
    LEFT JOIN items ON items."SKU" = sales."SKU"
    LEFT JOIN stores ON stores."Store" = sales."Store" AND sales.transaction_date_id >= stores.valid_from AND sales.transaction_date_id < stores.valid_to
    LEFT JOIN customers ON customers."Customer Number" = sales."Customer Number"
)

SELECT * FROM final
    )
;
[0m15:58:33.425228 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.783 seconds
[0m15:58:33.427759 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8e2d169-abea-40a5-b1be-9cac8c567eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3C54A08D0>]}
[0m15:58:33.427759 [info ] [Thread-1 (]: 9 of 13 OK created sql table model broman_analytics.dim_dates .................. [[32mSUCCESS 1[0m in 0.81s]
[0m15:58:33.428768 [debug] [Thread-1 (]: Finished running node model.epicaldemo.dim_dates
[0m15:58:33.923149 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.215 seconds
[0m15:58:33.925149 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8e2d169-abea-40a5-b1be-9cac8c567eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3C54519D0>]}
[0m15:58:33.926148 [info ] [Thread-3 (]: 11 of 13 OK created sql table model broman_analytics.dim_items ................. [[32mSUCCESS 1[0m in 1.23s]
[0m15:58:33.927149 [debug] [Thread-3 (]: Finished running node model.epicaldemo.dim_items
[0m15:58:34.755871 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.341 seconds
[0m15:58:34.764388 [debug] [Thread-2 (]: Applying DROP to: EPICALDEMO.broman_analytics.fact_sales_transactions__dbt_tmp
[0m15:58:34.770513 [debug] [Thread-2 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions"
[0m15:58:34.771513 [debug] [Thread-2 (]: On model.epicaldemo.fact_sales_transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions"} */
drop view if exists EPICALDEMO.broman_analytics.fact_sales_transactions__dbt_tmp cascade
[0m15:58:34.857808 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.086 seconds
[0m15:58:34.859821 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8e2d169-abea-40a5-b1be-9cac8c567eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3C550C190>]}
[0m15:58:34.860813 [info ] [Thread-2 (]: 13 of 13 OK created sql incremental model broman_analytics.fact_sales_transactions  [[32mSUCCESS 1[0m in 1.51s]
[0m15:58:34.861833 [debug] [Thread-2 (]: Finished running node model.epicaldemo.fact_sales_transactions
[0m15:58:34.862815 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:58:34.863829 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m15:58:34.863829 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m15:58:35.018645 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m15:58:35.019649 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m15:58:35.174637 [debug] [MainThread]: Connection 'model.epicaldemo.dim_dates' was left open.
[0m15:58:35.175638 [debug] [MainThread]: On model.epicaldemo.dim_dates: Close
[0m15:58:35.323426 [debug] [MainThread]: Connection 'model.epicaldemo.fact_sales_transactions' was left open.
[0m15:58:35.323426 [debug] [MainThread]: On model.epicaldemo.fact_sales_transactions: Close
[0m15:58:35.476365 [debug] [MainThread]: Connection 'model.epicaldemo.dim_items' was left open.
[0m15:58:35.477373 [debug] [MainThread]: On model.epicaldemo.dim_items: Close
[0m15:58:35.627500 [debug] [MainThread]: Connection 'model.epicaldemo.dim_stores' was left open.
[0m15:58:35.628503 [debug] [MainThread]: On model.epicaldemo.dim_stores: Close
[0m15:58:35.779939 [info ] [MainThread]: 
[0m15:58:35.780926 [info ] [MainThread]: Finished running 1 incremental model, 4 table models, 8 view models in 0 hours 0 minutes and 5.88 seconds (5.88s).
[0m15:58:35.782943 [debug] [MainThread]: Command end result
[0m15:58:35.804540 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m15:58:35.808071 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m15:58:35.814080 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m15:58:35.815080 [info ] [MainThread]: 
[0m15:58:35.815080 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:58:35.816080 [info ] [MainThread]: 
[0m15:58:35.816080 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 TOTAL=13
[0m15:58:35.817586 [debug] [MainThread]: Command `dbt run` succeeded at 15:58:35.817586 after 7.06 seconds
[0m15:58:35.818593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3C2E73090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3BD2F3090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3BD27CA90>]}
[0m15:58:35.819593 [debug] [MainThread]: Flushing usage events
[0m15:58:36.485941 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:04:38.748764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C98A70310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C98A70A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C98A73550>]}


============================== 16:04:38.760292 | 7c298540-13fa-4941-af90-b529eee90416 ==============================
[0m16:04:38.760292 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:04:38.761281 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:04:41.117155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c298540-13fa-4941-af90-b529eee90416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C99C1BE10>]}
[0m16:04:41.159206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c298540-13fa-4941-af90-b529eee90416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C9744FA10>]}
[0m16:04:41.168744 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m16:04:41.574101 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:04:42.616937 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:04:42.617945 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:04:42.623945 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m16:04:42.659566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c298540-13fa-4941-af90-b529eee90416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C9A4EC4D0>]}
[0m16:04:42.735769 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m16:04:42.750311 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m16:04:42.943423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c298540-13fa-4941-af90-b529eee90416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C9A40D490>]}
[0m16:04:42.944408 [info ] [MainThread]: Found 13 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m16:04:42.945407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c298540-13fa-4941-af90-b529eee90416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C9A1F7A10>]}
[0m16:04:42.947677 [info ] [MainThread]: 
[0m16:04:42.947677 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:04:42.948665 [info ] [MainThread]: 
[0m16:04:42.949657 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:04:42.950677 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m16:04:44.833653 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m16:04:44.833653 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m16:04:44.834654 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:04:45.747743 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.914 seconds
[0m16:04:45.753740 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m16:04:45.763290 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:04:45.763290 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:04:45.764282 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:04:46.264653 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.500 seconds
[0m16:04:46.267180 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:04:46.268181 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m16:04:46.433648 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.165 seconds
[0m16:04:46.435645 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:04:46.435645 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:04:46.554158 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.118 seconds
[0m16:04:46.558673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c298540-13fa-4941-af90-b529eee90416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C9A6A1610>]}
[0m16:04:46.562671 [debug] [Thread-1 (]: Began running node snapshot.epicaldemo.stores_snapshot
[0m16:04:46.563682 [info ] [Thread-1 (]: 1 of 1 START snapshot broman_analytics.stores_snapshot ......................... [RUN]
[0m16:04:46.564671 [debug] [Thread-1 (]: Acquiring new snowflake connection 'snapshot.epicaldemo.stores_snapshot'
[0m16:04:46.565680 [debug] [Thread-1 (]: Began compiling node snapshot.epicaldemo.stores_snapshot
[0m16:04:46.576700 [debug] [Thread-1 (]: Began executing node snapshot.epicaldemo.stores_snapshot
[0m16:04:46.628565 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m16:04:46.629566 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
[0m16:04:46.630557 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:04:47.233908 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.604 seconds
[0m16:04:47.273968 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m16:04:47.273968 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
create or replace temporary table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp"
as (
    
    
    with snapshot_query as (

        select * from EPICALDEMO.d365_fo.store

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            
  
  coalesce(nullif(modified, modified), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            modified as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.modified)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.modified)
        )
    )

    select * from insertions
    union all
    select * from updates

    )
;
[0m16:04:48.304477 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.029 seconds
[0m16:04:48.307520 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m16:04:48.308513 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp"
[0m16:04:48.437666 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.128 seconds
[0m16:04:48.440665 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m16:04:48.441665 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
[0m16:04:48.599866 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.157 seconds
[0m16:04:48.603369 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m16:04:48.603369 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp"
[0m16:04:48.728745 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.124 seconds
[0m16:04:48.732744 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m16:04:48.732744 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
[0m16:04:48.836395 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.102 seconds
[0m16:04:48.841413 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m16:04:48.842412 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp"
[0m16:04:48.929238 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.086 seconds
[0m16:04:48.946805 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m16:04:48.946805 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
select * from (
        
    
    with snapshot_query as (

        select * from EPICALDEMO.d365_fo.store

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT"
        where
            
		
		

		
                ( (dbt_valid_to = to_date('9999-12-31'))
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            
  
  coalesce(nullif(modified, modified), to_date('9999-12-31'))
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(modified as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            modified as dbt_updated_at,
            modified as dbt_valid_from,
            modified as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.dbt_valid_from < source_data.modified)
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.modified)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m16:04:49.142814 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.195 seconds
[0m16:04:49.147860 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m16:04:49.148860 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m16:04:49.251852 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.102 seconds
[0m16:04:49.251852 [warn ] [Thread-1 (]: Data type of snapshot table timestamp columns (TIMESTAMP_NTZ) doesn't match derived column 'updated_at' (DATE). Please update snapshot config 'updated_at'.
[0m16:04:49.252851 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.epicaldemo.stores_snapshot"
[0m16:04:49.254844 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m16:04:49.254844 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
BEGIN
[0m16:04:49.358014 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.102 seconds
[0m16:04:49.359014 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m16:04:49.359014 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
merge into "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT" as DBT_INTERNAL_DEST
    using "EPICALDEMO"."BROMAN_ANALYTICS"."STORES_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
	
	
	and ((DBT_INTERNAL_DEST.dbt_valid_to = to_date('9999-12-31'))
 or DBT_INTERNAL_DEST.dbt_valid_to is null)

     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("ID", "NAME", "LOCATION", "LATITUDE", "LONGITUDE", "ONLINEPRESENCE", "MODIFIED", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("ID", "NAME", "LOCATION", "LATITUDE", "LONGITUDE", "ONLINEPRESENCE", "MODIFIED", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m16:04:50.001830 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.642 seconds
[0m16:04:50.001830 [debug] [Thread-1 (]: Using snowflake connection "snapshot.epicaldemo.stores_snapshot"
[0m16:04:50.002830 [debug] [Thread-1 (]: On snapshot.epicaldemo.stores_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "snapshot.epicaldemo.stores_snapshot"} */
COMMIT
[0m16:04:50.265782 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.262 seconds
[0m16:04:50.289910 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c298540-13fa-4941-af90-b529eee90416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C986B4AD0>]}
[0m16:04:50.290911 [info ] [Thread-1 (]: 1 of 1 OK snapshotted broman_analytics.stores_snapshot ......................... [[32mSUCCESS 10[0m in 3.72s]
[0m16:04:50.291942 [debug] [Thread-1 (]: Finished running node snapshot.epicaldemo.stores_snapshot
[0m16:04:50.293913 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:04:50.293913 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m16:04:50.293913 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m16:04:50.454736 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m16:04:50.454736 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m16:04:50.611692 [debug] [MainThread]: Connection 'snapshot.epicaldemo.stores_snapshot' was left open.
[0m16:04:50.612689 [debug] [MainThread]: On snapshot.epicaldemo.stores_snapshot: Close
[0m16:04:50.771860 [info ] [MainThread]: 
[0m16:04:50.772861 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 7.82 seconds (7.82s).
[0m16:04:50.773861 [debug] [MainThread]: Command end result
[0m16:04:50.795470 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m16:04:50.798480 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m16:04:50.805567 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m16:04:50.806601 [info ] [MainThread]: 
[0m16:04:50.807571 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:04:50.808573 [info ] [MainThread]: 
[0m16:04:50.808573 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:04:50.809573 [debug] [MainThread]: Command `dbt snapshot` succeeded at 16:04:50.809573 after 12.14 seconds
[0m16:04:50.810571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C98A8F910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C98ADBF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C98AD9A90>]}
[0m16:04:50.810571 [debug] [MainThread]: Flushing usage events
[0m16:04:51.380736 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:05:39.206392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E243797D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E22AC8650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E24379310>]}


============================== 16:05:39.210400 | e4947699-132e-4713-b843-07b23ce8abe7 ==============================
[0m16:05:39.210400 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:05:39.211393 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s stg_d365_fo__stores', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:05:39.623925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e4947699-132e-4713-b843-07b23ce8abe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E257AA050>]}
[0m16:05:39.665540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e4947699-132e-4713-b843-07b23ce8abe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E22B4FB10>]}
[0m16:05:39.667544 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m16:05:39.979277 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:05:40.175957 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:05:40.176973 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:05:40.181964 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m16:05:40.219033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e4947699-132e-4713-b843-07b23ce8abe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E25DFB7D0>]}
[0m16:05:40.293154 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m16:05:40.297666 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m16:05:40.318716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e4947699-132e-4713-b843-07b23ce8abe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E257C0ED0>]}
[0m16:05:40.318716 [info ] [MainThread]: Found 13 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m16:05:40.319714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4947699-132e-4713-b843-07b23ce8abe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E257FCE50>]}
[0m16:05:40.320713 [info ] [MainThread]: 
[0m16:05:40.321729 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:05:40.321729 [info ] [MainThread]: 
[0m16:05:40.322718 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:05:40.323713 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m16:05:40.402670 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m16:05:40.402670 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m16:05:40.403669 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:05:41.142265 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.738 seconds
[0m16:05:41.147775 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m16:05:41.157279 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:05:41.158281 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:05:41.158281 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:05:41.771952 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.614 seconds
[0m16:05:41.775463 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:05:41.776482 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m16:05:41.937495 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.161 seconds
[0m16:05:41.939483 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:05:41.940485 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:05:42.051005 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.111 seconds
[0m16:05:42.053999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4947699-132e-4713-b843-07b23ce8abe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E25817790>]}
[0m16:05:42.059533 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__stores
[0m16:05:42.059533 [info ] [Thread-1 (]: 1 of 1 START sql view model broman_analytics.stg_d365_fo__stores ............... [RUN]
[0m16:05:42.060533 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__stores'
[0m16:05:42.061534 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__stores
[0m16:05:42.068080 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__stores"
[0m16:05:42.069074 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__stores
[0m16:05:42.093960 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.stg_d365_fo__stores"
[0m16:05:42.096470 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.stg_d365_fo__stores"
[0m16:05:42.096470 [debug] [Thread-1 (]: On model.epicaldemo.stg_d365_fo__stores: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.stg_d365_fo__stores"} */
create or replace   view EPICALDEMO.broman_analytics.stg_d365_fo__stores
  
   as (
    WITH

stores_snapshots AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stores_snapshot
),

final AS (
    SELECT
        -- Identifiers
        id AS store_id

        -- SCD2 Fields
        ,dbt_scd_id
        ,ROW_NUMBER() OVER (ORDER BY id ASC, dbt_valid_from ASC) AS store_key
        ,CASE WHEN dbt_valid_to = '9999-12-31' THEN 1 ELSE 0 END AS is_current
        ,modified
        ,CAST(TO_CHAR(dbt_valid_from::DATE, 'YYYYMMDD') AS INTEGER) AS valid_from
        ,CAST(TO_CHAR(dbt_valid_to::DATE, 'YYYYMMDD') AS INTEGER) AS valid_to

        -- Attributes
        ,name AS "Store"
        ,SPLIT_PART(location, ',', 1) AS "Store State"
        ,SPLIT_PART(location, ',', 2) AS "Store City"
        ,latitude AS "Lat"
        ,longitude AS "Lon"
        ,onlinepresence AS "Online Presence"
    FROM stores_snapshots
)

SELECT * FROM final
  );
[0m16:05:42.097470 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:05:42.859313 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.761 seconds
[0m16:05:42.878352 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4947699-132e-4713-b843-07b23ce8abe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E25CC1B10>]}
[0m16:05:42.879354 [info ] [Thread-1 (]: 1 of 1 OK created sql view model broman_analytics.stg_d365_fo__stores .......... [[32mSUCCESS 1[0m in 0.82s]
[0m16:05:42.880356 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__stores
[0m16:05:42.881351 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:05:42.882366 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m16:05:42.882366 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m16:05:43.036593 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m16:05:43.037576 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m16:05:43.191048 [debug] [MainThread]: Connection 'model.epicaldemo.stg_d365_fo__stores' was left open.
[0m16:05:43.191048 [debug] [MainThread]: On model.epicaldemo.stg_d365_fo__stores: Close
[0m16:05:43.342512 [info ] [MainThread]: 
[0m16:05:43.343512 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.02 seconds (3.02s).
[0m16:05:43.344513 [debug] [MainThread]: Command end result
[0m16:05:43.368611 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m16:05:43.371612 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m16:05:43.377147 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m16:05:43.378150 [info ] [MainThread]: 
[0m16:05:43.379147 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:05:43.379147 [info ] [MainThread]: 
[0m16:05:43.380148 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:05:43.381148 [debug] [MainThread]: Command `dbt run` succeeded at 16:05:43.381148 after 4.24 seconds
[0m16:05:43.381148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E241B5410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E1EC61250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E1EC12E10>]}
[0m16:05:43.382150 [debug] [MainThread]: Flushing usage events
[0m16:05:43.901509 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:08:46.229851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002192BE796D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002192BE79A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002192BE79B90>]}


============================== 16:08:46.232854 | ee87c538-a1a0-4af4-a6c0-15b487cd6483 ==============================
[0m16:08:46.232854 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:08:46.234358 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -s fact_sales_transactions', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:08:46.634926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee87c538-a1a0-4af4-a6c0-15b487cd6483', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002192D0C1BD0>]}
[0m16:08:46.675549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee87c538-a1a0-4af4-a6c0-15b487cd6483', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002192A84F9D0>]}
[0m16:08:46.677548 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m16:08:46.982026 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:08:47.174384 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:08:47.174384 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:08:47.180389 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m16:08:47.217570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee87c538-a1a0-4af4-a6c0-15b487cd6483', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002192BEC4110>]}
[0m16:08:47.292729 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m16:08:47.296776 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m16:08:47.316920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee87c538-a1a0-4af4-a6c0-15b487cd6483', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002192D8B6210>]}
[0m16:08:47.316920 [info ] [MainThread]: Found 13 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m16:08:47.317917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee87c538-a1a0-4af4-a6c0-15b487cd6483', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002192D5C23D0>]}
[0m16:08:47.319918 [info ] [MainThread]: 
[0m16:08:47.319918 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:08:47.320918 [info ] [MainThread]: 
[0m16:08:47.320918 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:08:47.321919 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m16:08:47.399164 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m16:08:47.399164 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m16:08:47.400161 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:08:48.412815 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.014 seconds
[0m16:08:48.419335 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m16:08:48.428854 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:08:48.428854 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:08:48.429857 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:08:49.055184 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.626 seconds
[0m16:08:49.058193 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:08:49.059194 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m16:08:49.232577 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.173 seconds
[0m16:08:49.234565 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:08:49.234565 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:08:49.344557 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.109 seconds
[0m16:08:49.347587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee87c538-a1a0-4af4-a6c0-15b487cd6483', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002192D5C3010>]}
[0m16:08:49.351590 [debug] [Thread-1 (]: Began running node model.epicaldemo.fact_sales_transactions
[0m16:08:49.352588 [info ] [Thread-1 (]: 1 of 1 START sql incremental model broman_analytics.fact_sales_transactions .... [RUN]
[0m16:08:49.353592 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.fact_sales_transactions'
[0m16:08:49.353592 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.fact_sales_transactions
[0m16:08:49.365467 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.fact_sales_transactions"
[0m16:08:49.366470 [debug] [Thread-1 (]: Began executing node model.epicaldemo.fact_sales_transactions
[0m16:08:49.408299 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions"
[0m16:08:49.408299 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions"} */
create or replace  temporary view EPICALDEMO.broman_analytics.fact_sales_transactions__dbt_tmp
  
   as (
    

WITH

sales AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__transactions

    
    WHERE UPDATED_AT >= (SELECT MAX(UPDATED_AT) FROM EPICALDEMO.broman_analytics.fact_sales_transactions)
    
),

items AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__items
),

stores AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__stores
),

customers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_salesforce__customers
),

final AS (
    SELECT
        -- Identifiers
        sales.id
        ,sales.transaction_date_id
        ,sales.updated_at
        ,CONVERT_TIMEZONE('Europe/Stockholm', CURRENT_TIMESTAMP()) AS loaded_at

        ,CASE
            WHEN sales.sku IS NULL THEN -2 -- SKU is missing FROM Source
            WHEN items.item_id IS NULL THEN -1 -- SKU is not known FROM Source
            ELSE items.item_id -- Use item_id FROM Dim based on SKU
         END AS item_id

        ,CASE
            WHEN sales."Store" IS NULL THEN -2
            WHEN stores.store_key IS NULL THEN -1
            ELSE stores.store_key
         END AS store_key

        ,CASE
            WHEN sales."Customer Number" IS NULL THEN -2
            WHEN customers.customer_id IS NULL THEN -1
            ELSE customers.customer_id
         END AS customer_id

        -- Metrics
        ,sales."Qty"
        ,sales."Unit Price"
        ,sales."Sales Amount"
        ,sales."Unit Cost"
        ,sales."Cost"
        ,sales."Margin"
    FROM sales
    LEFT JOIN items ON items."SKU" = sales."SKU"
    LEFT JOIN stores ON stores."Store" = sales."Store" AND sales.transaction_date_id >= stores.valid_from AND sales.transaction_date_id < stores.valid_to
    LEFT JOIN customers ON customers."Customer Number" = sales."Customer Number"
)

SELECT * FROM final
  );
[0m16:08:49.409299 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:08:50.668498 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.259 seconds
[0m16:08:50.675636 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions"
[0m16:08:50.675636 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions"} */
describe table EPICALDEMO.broman_analytics.fact_sales_transactions__dbt_tmp
[0m16:08:50.785680 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.109 seconds
[0m16:08:50.788680 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions"
[0m16:08:50.789681 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions"} */
describe table EPICALDEMO.broman_analytics.fact_sales_transactions
[0m16:08:50.902435 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.112 seconds
[0m16:08:50.909966 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions"
[0m16:08:50.910967 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."FACT_SALES_TRANSACTIONS"
[0m16:08:51.078460 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.167 seconds
[0m16:08:51.104565 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.fact_sales_transactions"
[0m16:08:51.106573 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions"
[0m16:08:51.107592 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions"} */
-- back compat for old kwarg name
  
  begin;
[0m16:08:51.231013 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.123 seconds
[0m16:08:51.232025 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions"
[0m16:08:51.232025 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions"} */
merge into EPICALDEMO.broman_analytics.fact_sales_transactions as DBT_INTERNAL_DEST
        using EPICALDEMO.broman_analytics.fact_sales_transactions__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.transaction_date_id = DBT_INTERNAL_DEST.transaction_date_id
                ) and (
                    DBT_INTERNAL_SOURCE.item_id = DBT_INTERNAL_DEST.item_id
                ) and (
                    DBT_INTERNAL_SOURCE.store_key = DBT_INTERNAL_DEST.store_key
                ) and (
                    DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
                )

    
    when matched then update set
        "ID" = DBT_INTERNAL_SOURCE."ID","TRANSACTION_DATE_ID" = DBT_INTERNAL_SOURCE."TRANSACTION_DATE_ID","UPDATED_AT" = DBT_INTERNAL_SOURCE."UPDATED_AT","LOADED_AT" = DBT_INTERNAL_SOURCE."LOADED_AT","ITEM_ID" = DBT_INTERNAL_SOURCE."ITEM_ID","STORE_KEY" = DBT_INTERNAL_SOURCE."STORE_KEY","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","Qty" = DBT_INTERNAL_SOURCE."Qty","Unit Price" = DBT_INTERNAL_SOURCE."Unit Price","Sales Amount" = DBT_INTERNAL_SOURCE."Sales Amount","Unit Cost" = DBT_INTERNAL_SOURCE."Unit Cost","Cost" = DBT_INTERNAL_SOURCE."Cost","Margin" = DBT_INTERNAL_SOURCE."Margin"
    

    when not matched then insert
        ("ID", "TRANSACTION_DATE_ID", "UPDATED_AT", "LOADED_AT", "ITEM_ID", "STORE_KEY", "CUSTOMER_ID", "Qty", "Unit Price", "Sales Amount", "Unit Cost", "Cost", "Margin")
    values
        ("ID", "TRANSACTION_DATE_ID", "UPDATED_AT", "LOADED_AT", "ITEM_ID", "STORE_KEY", "CUSTOMER_ID", "Qty", "Unit Price", "Sales Amount", "Unit Cost", "Cost", "Margin")

;
[0m16:08:52.711731 [debug] [Thread-1 (]: SQL status: SUCCESS 70 in 1.479 seconds
[0m16:08:52.712729 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions"
[0m16:08:52.713729 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions"} */
COMMIT
[0m16:08:53.048417 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.334 seconds
[0m16:08:53.055953 [debug] [Thread-1 (]: Applying DROP to: EPICALDEMO.broman_analytics.fact_sales_transactions__dbt_tmp
[0m16:08:53.061960 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions"
[0m16:08:53.061960 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions"} */
drop view if exists EPICALDEMO.broman_analytics.fact_sales_transactions__dbt_tmp cascade
[0m16:08:53.200249 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.138 seconds
[0m16:08:53.217090 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee87c538-a1a0-4af4-a6c0-15b487cd6483', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002192DEE9D10>]}
[0m16:08:53.218091 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model broman_analytics.fact_sales_transactions  [[32mSUCCESS 70[0m in 3.86s]
[0m16:08:53.219083 [debug] [Thread-1 (]: Finished running node model.epicaldemo.fact_sales_transactions
[0m16:08:53.221083 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:08:53.221083 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m16:08:53.222083 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m16:08:53.438575 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m16:08:53.438575 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m16:08:53.593087 [debug] [MainThread]: Connection 'model.epicaldemo.fact_sales_transactions' was left open.
[0m16:08:53.593087 [debug] [MainThread]: On model.epicaldemo.fact_sales_transactions: Close
[0m16:08:53.799942 [info ] [MainThread]: 
[0m16:08:53.800942 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 6.48 seconds (6.48s).
[0m16:08:53.801942 [debug] [MainThread]: Command end result
[0m16:08:53.828685 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m16:08:53.832691 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m16:08:53.840206 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m16:08:53.842206 [info ] [MainThread]: 
[0m16:08:53.843208 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:08:53.844821 [info ] [MainThread]: 
[0m16:08:53.846748 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:08:53.848749 [debug] [MainThread]: Command `dbt run` succeeded at 16:08:53.848749 after 7.68 seconds
[0m16:08:53.849754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002192A9A9950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002192BEC5ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219262C1250>]}
[0m16:08:53.851749 [debug] [MainThread]: Flushing usage events
[0m16:08:54.363608 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:11:15.123686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DB2E793D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DB2E798D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DB2E79B90>]}


============================== 16:11:15.126690 | 03d92f36-483b-4875-8e2b-0dab094b5377 ==============================
[0m16:11:15.126690 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:11:15.127689 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -s fact_sales_transactions --full-refresh', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:11:15.552257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '03d92f36-483b-4875-8e2b-0dab094b5377', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DB2EE6790>]}
[0m16:11:15.593913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '03d92f36-483b-4875-8e2b-0dab094b5377', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DB2EF0210>]}
[0m16:11:15.595424 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m16:11:15.899756 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:11:16.097061 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:11:16.098047 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:11:16.103054 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m16:11:16.139172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03d92f36-483b-4875-8e2b-0dab094b5377', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DB48AEDD0>]}
[0m16:11:16.214410 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m16:11:16.219960 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m16:11:16.238523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03d92f36-483b-4875-8e2b-0dab094b5377', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DB45E5110>]}
[0m16:11:16.239508 [info ] [MainThread]: Found 13 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m16:11:16.240517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03d92f36-483b-4875-8e2b-0dab094b5377', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DB4573550>]}
[0m16:11:16.241507 [info ] [MainThread]: 
[0m16:11:16.242523 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:11:16.242523 [info ] [MainThread]: 
[0m16:11:16.244029 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:11:16.245033 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m16:11:16.325641 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m16:11:16.326646 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m16:11:16.326646 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:11:17.165929 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.839 seconds
[0m16:11:17.170929 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m16:11:17.179971 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:11:17.180971 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:11:17.180971 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:11:17.806099 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.625 seconds
[0m16:11:17.809097 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:11:17.810101 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m16:11:18.001130 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.191 seconds
[0m16:11:18.002129 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:11:18.003632 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:11:18.100688 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.096 seconds
[0m16:11:18.104200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03d92f36-483b-4875-8e2b-0dab094b5377', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DB2EA0310>]}
[0m16:11:18.108203 [debug] [Thread-1 (]: Began running node model.epicaldemo.fact_sales_transactions
[0m16:11:18.108203 [info ] [Thread-1 (]: 1 of 1 START sql incremental model broman_analytics.fact_sales_transactions .... [RUN]
[0m16:11:18.109207 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.fact_sales_transactions'
[0m16:11:18.109207 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.fact_sales_transactions
[0m16:11:18.122229 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.fact_sales_transactions"
[0m16:11:18.123736 [debug] [Thread-1 (]: Began executing node model.epicaldemo.fact_sales_transactions
[0m16:11:18.172137 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.fact_sales_transactions"
[0m16:11:18.174663 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions"
[0m16:11:18.175647 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions"} */
create or replace transient table EPICALDEMO.broman_analytics.fact_sales_transactions
    

    
    as (

WITH

sales AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__transactions

    
),

items AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__items
),

stores AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__stores
),

customers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_salesforce__customers
),

final AS (
    SELECT
        -- Identifiers
        sales.id
        ,sales.transaction_date_id
        ,sales.updated_at
        ,CONVERT_TIMEZONE('Europe/Stockholm', CURRENT_TIMESTAMP()) AS loaded_at

        ,CASE
            WHEN sales.sku IS NULL THEN -2 -- SKU is missing FROM Source
            WHEN items.item_id IS NULL THEN -1 -- SKU is not known FROM Source
            ELSE items.item_id -- Use item_id FROM Dim based on SKU
         END AS item_id

        ,CASE
            WHEN sales."Store" IS NULL THEN -2
            WHEN stores.store_key IS NULL THEN -1
            ELSE stores.store_key
         END AS store_key

        ,CASE
            WHEN sales."Customer Number" IS NULL THEN -2
            WHEN customers.customer_id IS NULL THEN -1
            ELSE customers.customer_id
         END AS customer_id

        -- Metrics
        ,sales."Qty"
        ,sales."Unit Price"
        ,sales."Sales Amount"
        ,sales."Unit Cost"
        ,sales."Cost"
        ,sales."Margin"
    FROM sales
    LEFT JOIN items ON items."SKU" = sales."SKU"
    LEFT JOIN stores ON stores."Store" = sales."Store" AND sales.transaction_date_id >= stores.valid_from AND sales.transaction_date_id < stores.valid_to
    LEFT JOIN customers ON customers."Customer Number" = sales."Customer Number"
)

SELECT * FROM final
    )
;
[0m16:11:18.175647 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:11:19.602113 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.427 seconds
[0m16:11:19.609643 [debug] [Thread-1 (]: Applying DROP to: EPICALDEMO.broman_analytics.fact_sales_transactions__dbt_tmp
[0m16:11:19.615179 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions"
[0m16:11:19.616178 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions"} */
drop view if exists EPICALDEMO.broman_analytics.fact_sales_transactions__dbt_tmp cascade
[0m16:11:19.730659 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.114 seconds
[0m16:11:19.748710 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03d92f36-483b-4875-8e2b-0dab094b5377', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DB4FF5BD0>]}
[0m16:11:19.749709 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model broman_analytics.fact_sales_transactions  [[32mSUCCESS 1[0m in 1.64s]
[0m16:11:19.750712 [debug] [Thread-1 (]: Finished running node model.epicaldemo.fact_sales_transactions
[0m16:11:19.752704 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:11:19.752704 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m16:11:19.753711 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m16:11:19.915232 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m16:11:19.915232 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m16:11:20.076973 [debug] [MainThread]: Connection 'model.epicaldemo.fact_sales_transactions' was left open.
[0m16:11:20.077961 [debug] [MainThread]: On model.epicaldemo.fact_sales_transactions: Close
[0m16:11:20.237673 [info ] [MainThread]: 
[0m16:11:20.237673 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 3.99 seconds (3.99s).
[0m16:11:20.238663 [debug] [MainThread]: Command end result
[0m16:11:20.260746 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m16:11:20.263740 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m16:11:20.269978 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m16:11:20.270987 [info ] [MainThread]: 
[0m16:11:20.271975 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:11:20.271975 [info ] [MainThread]: 
[0m16:11:20.272978 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:11:20.273977 [debug] [MainThread]: Command `dbt run` succeeded at 16:11:20.273977 after 5.21 seconds
[0m16:11:20.275010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DAD2F2FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DB2AB4E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DB2AB5490>]}
[0m16:11:20.275010 [debug] [MainThread]: Flushing usage events
[0m16:11:20.819240 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:11:58.130023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAB3579490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAB3579990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAB35795D0>]}


============================== 16:11:58.133550 | 45267a24-5985-41ec-adee-575716223c73 ==============================
[0m16:11:58.133550 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:11:58.134561 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -s fact_sales_transactions', 'send_anonymous_usage_stats': 'True'}
[0m16:11:58.553517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '45267a24-5985-41ec-adee-575716223c73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAB358D810>]}
[0m16:11:58.595658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '45267a24-5985-41ec-adee-575716223c73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAB1D57810>]}
[0m16:11:58.597649 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m16:11:58.905044 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:11:59.092109 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:11:59.092109 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:11:59.097625 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m16:11:59.132237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45267a24-5985-41ec-adee-575716223c73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAB520A850>]}
[0m16:11:59.210019 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m16:11:59.214551 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m16:11:59.234624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45267a24-5985-41ec-adee-575716223c73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAB4EB5A50>]}
[0m16:11:59.235622 [info ] [MainThread]: Found 13 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m16:11:59.235622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45267a24-5985-41ec-adee-575716223c73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAB4EC1810>]}
[0m16:11:59.237623 [info ] [MainThread]: 
[0m16:11:59.238623 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:11:59.238623 [info ] [MainThread]: 
[0m16:11:59.239622 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:11:59.240623 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m16:11:59.320031 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m16:11:59.320031 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m16:11:59.321031 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:12:00.050527 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.730 seconds
[0m16:12:00.057055 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m16:12:00.066571 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:12:00.066571 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:12:00.067571 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:12:00.714697 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.647 seconds
[0m16:12:00.718690 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:12:00.719691 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m16:12:00.868021 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.148 seconds
[0m16:12:00.870017 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:12:00.870017 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:12:01.056827 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.186 seconds
[0m16:12:01.059815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45267a24-5985-41ec-adee-575716223c73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAB4997E10>]}
[0m16:12:01.063826 [debug] [Thread-1 (]: Began running node model.epicaldemo.fact_sales_transactions
[0m16:12:01.065205 [info ] [Thread-1 (]: 1 of 1 START sql incremental model broman_analytics.fact_sales_transactions .... [RUN]
[0m16:12:01.065205 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.fact_sales_transactions'
[0m16:12:01.066212 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.fact_sales_transactions
[0m16:12:01.078741 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.fact_sales_transactions"
[0m16:12:01.079740 [debug] [Thread-1 (]: Began executing node model.epicaldemo.fact_sales_transactions
[0m16:12:01.120523 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions"
[0m16:12:01.121810 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions"} */
create or replace  temporary view EPICALDEMO.broman_analytics.fact_sales_transactions__dbt_tmp
  
   as (
    

WITH

sales AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__transactions

    
    WHERE UPDATED_AT >= (SELECT MAX(UPDATED_AT) FROM EPICALDEMO.broman_analytics.fact_sales_transactions)
    
),

items AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__items
),

stores AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__stores
),

customers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_salesforce__customers
),

final AS (
    SELECT
        -- Identifiers
        sales.id
        ,sales.transaction_date_id
        ,sales.updated_at
        ,CONVERT_TIMEZONE('Europe/Stockholm', CURRENT_TIMESTAMP()) AS loaded_at

        ,CASE
            WHEN sales.sku IS NULL THEN -2 -- SKU is missing FROM Source
            WHEN items.item_id IS NULL THEN -1 -- SKU is not known FROM Source
            ELSE items.item_id -- Use item_id FROM Dim based on SKU
         END AS item_id

        ,CASE
            WHEN sales."Store" IS NULL THEN -2
            WHEN stores.store_key IS NULL THEN -1
            ELSE stores.store_key
         END AS store_key

        ,CASE
            WHEN sales."Customer Number" IS NULL THEN -2
            WHEN customers.customer_id IS NULL THEN -1
            ELSE customers.customer_id
         END AS customer_id

        -- Metrics
        ,sales."Qty"
        ,sales."Unit Price"
        ,sales."Sales Amount"
        ,sales."Unit Cost"
        ,sales."Cost"
        ,sales."Margin"
    FROM sales
    LEFT JOIN items ON items."SKU" = sales."SKU"
    LEFT JOIN stores ON stores."Store" = sales."Store" AND sales.transaction_date_id >= stores.valid_from AND sales.transaction_date_id < stores.valid_to
    LEFT JOIN customers ON customers."Customer Number" = sales."Customer Number"
)

SELECT * FROM final
  );
[0m16:12:01.122828 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:12:02.692788 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.570 seconds
[0m16:12:02.699323 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions"
[0m16:12:02.700330 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions"} */
describe table EPICALDEMO.broman_analytics.fact_sales_transactions__dbt_tmp
[0m16:12:02.817636 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.117 seconds
[0m16:12:02.821634 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions"
[0m16:12:02.821634 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions"} */
describe table EPICALDEMO.broman_analytics.fact_sales_transactions
[0m16:12:02.918789 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.097 seconds
[0m16:12:02.926294 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions"
[0m16:12:02.926294 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions"} */
describe table "EPICALDEMO"."BROMAN_ANALYTICS"."FACT_SALES_TRANSACTIONS"
[0m16:12:03.081923 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.155 seconds
[0m16:12:03.106986 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.fact_sales_transactions"
[0m16:12:03.108991 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions"
[0m16:12:03.109989 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions"} */
-- back compat for old kwarg name
  
  begin;
[0m16:12:03.232858 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.122 seconds
[0m16:12:03.233855 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions"
[0m16:12:03.234364 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions"} */
merge into EPICALDEMO.broman_analytics.fact_sales_transactions as DBT_INTERNAL_DEST
        using EPICALDEMO.broman_analytics.fact_sales_transactions__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.transaction_date_id = DBT_INTERNAL_DEST.transaction_date_id
                ) and (
                    DBT_INTERNAL_SOURCE.item_id = DBT_INTERNAL_DEST.item_id
                ) and (
                    DBT_INTERNAL_SOURCE.store_key = DBT_INTERNAL_DEST.store_key
                ) and (
                    DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
                )

    
    when matched then update set
        "ID" = DBT_INTERNAL_SOURCE."ID","TRANSACTION_DATE_ID" = DBT_INTERNAL_SOURCE."TRANSACTION_DATE_ID","UPDATED_AT" = DBT_INTERNAL_SOURCE."UPDATED_AT","LOADED_AT" = DBT_INTERNAL_SOURCE."LOADED_AT","ITEM_ID" = DBT_INTERNAL_SOURCE."ITEM_ID","STORE_KEY" = DBT_INTERNAL_SOURCE."STORE_KEY","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","Qty" = DBT_INTERNAL_SOURCE."Qty","Unit Price" = DBT_INTERNAL_SOURCE."Unit Price","Sales Amount" = DBT_INTERNAL_SOURCE."Sales Amount","Unit Cost" = DBT_INTERNAL_SOURCE."Unit Cost","Cost" = DBT_INTERNAL_SOURCE."Cost","Margin" = DBT_INTERNAL_SOURCE."Margin"
    

    when not matched then insert
        ("ID", "TRANSACTION_DATE_ID", "UPDATED_AT", "LOADED_AT", "ITEM_ID", "STORE_KEY", "CUSTOMER_ID", "Qty", "Unit Price", "Sales Amount", "Unit Cost", "Cost", "Margin")
    values
        ("ID", "TRANSACTION_DATE_ID", "UPDATED_AT", "LOADED_AT", "ITEM_ID", "STORE_KEY", "CUSTOMER_ID", "Qty", "Unit Price", "Sales Amount", "Unit Cost", "Cost", "Margin")

;
[0m16:12:04.979784 [debug] [Thread-1 (]: SQL status: SUCCESS 6 in 1.744 seconds
[0m16:12:04.979784 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions"
[0m16:12:04.980796 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions"} */
COMMIT
[0m16:12:05.251980 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.270 seconds
[0m16:12:05.258512 [debug] [Thread-1 (]: Applying DROP to: EPICALDEMO.broman_analytics.fact_sales_transactions__dbt_tmp
[0m16:12:05.265047 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions"
[0m16:12:05.265047 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions"} */
drop view if exists EPICALDEMO.broman_analytics.fact_sales_transactions__dbt_tmp cascade
[0m16:12:05.462454 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.197 seconds
[0m16:12:05.480479 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45267a24-5985-41ec-adee-575716223c73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAB49AA510>]}
[0m16:12:05.481479 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model broman_analytics.fact_sales_transactions  [[32mSUCCESS 6[0m in 4.41s]
[0m16:12:05.482480 [debug] [Thread-1 (]: Finished running node model.epicaldemo.fact_sales_transactions
[0m16:12:05.484529 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:12:05.484529 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m16:12:05.485530 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m16:12:05.671426 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m16:12:05.671426 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m16:12:05.849669 [debug] [MainThread]: Connection 'model.epicaldemo.fact_sales_transactions' was left open.
[0m16:12:05.850669 [debug] [MainThread]: On model.epicaldemo.fact_sales_transactions: Close
[0m16:12:06.022225 [info ] [MainThread]: 
[0m16:12:06.022225 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 6.78 seconds (6.78s).
[0m16:12:06.024739 [debug] [MainThread]: Command end result
[0m16:12:06.048808 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m16:12:06.051804 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m16:12:06.060322 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m16:12:06.061318 [info ] [MainThread]: 
[0m16:12:06.062321 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:12:06.062321 [info ] [MainThread]: 
[0m16:12:06.063826 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:12:06.065832 [debug] [MainThread]: Command `dbt run` succeeded at 16:12:06.065832 after 8.00 seconds
[0m16:12:06.066831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAB3495B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAADE93010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAB3295210>]}
[0m16:12:06.067832 [debug] [MainThread]: Flushing usage events
[0m16:12:06.608910 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:31:04.946146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021155C786D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211559820D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021155C7ACD0>]}


============================== 16:31:04.957669 | 438183f5-fc9f-4597-8209-824262d1f290 ==============================
[0m16:31:04.957669 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:31:04.958661 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:31:07.815270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '438183f5-fc9f-4597-8209-824262d1f290', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021151919290>]}
[0m16:31:07.856835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '438183f5-fc9f-4597-8209-824262d1f290', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021156E2D750>]}
[0m16:31:08.407468 [error] [MainThread]: Encountered an error:
[WinError 10048] Only one usage of each socket address (protocol/network address/port) is normally permitted
[0m16:31:08.447602 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\task\docs\serve.py", line 24, in run
    with socketserver.TCPServer((host, port), SimpleHTTPRequestHandler) as httpd:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socketserver.py", line 456, in __init__
    self.server_bind()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socketserver.py", line 472, in server_bind
    self.socket.bind(self.server_address)
OSError: [WinError 10048] Only one usage of each socket address (protocol/network address/port) is normally permitted

[0m16:31:08.450594 [debug] [MainThread]: Command `dbt docs serve` failed at 16:31:08.449596 after 3.60 seconds
[0m16:31:08.450594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021155C6B510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021155C70810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021155C72790>]}
[0m16:31:08.451594 [debug] [MainThread]: Flushing usage events
[0m16:31:08.976447 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:31:28.899350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD41078250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD41079E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD41078610>]}


============================== 16:31:28.903424 | 969cfa0d-f699-4b2c-97a3-a1a1fa0af570 ==============================
[0m16:31:28.903424 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:31:28.904423 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m16:31:29.302724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '969cfa0d-f699-4b2c-97a3-a1a1fa0af570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD41073910>]}
[0m16:31:29.344792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '969cfa0d-f699-4b2c-97a3-a1a1fa0af570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD3FA4F950>]}
[0m16:31:29.355145 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m16:31:29.748674 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:31:29.938366 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:31:29.938366 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:31:29.943881 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m16:31:29.980947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '969cfa0d-f699-4b2c-97a3-a1a1fa0af570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD42B0E450>]}
[0m16:31:30.048422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '969cfa0d-f699-4b2c-97a3-a1a1fa0af570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD427BBD90>]}
[0m16:31:30.049411 [info ] [MainThread]: Found 13 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m16:31:30.050411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '969cfa0d-f699-4b2c-97a3-a1a1fa0af570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD42A1C310>]}
[0m16:31:30.052440 [info ] [MainThread]: 
[0m16:31:30.052947 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:31:30.052947 [info ] [MainThread]: 
[0m16:31:30.053952 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:31:30.057951 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m16:31:32.235064 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:31:32.235064 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:31:32.236065 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:31:33.107358 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.872 seconds
[0m16:31:33.111358 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:31:33.112358 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m16:31:33.241298 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.128 seconds
[0m16:31:33.243300 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:31:33.244301 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:31:33.365324 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.121 seconds
[0m16:31:33.368329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '969cfa0d-f699-4b2c-97a3-a1a1fa0af570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD427C0D90>]}
[0m16:31:33.373339 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__categories
[0m16:31:33.373339 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_d365_fo__dates
[0m16:31:33.374348 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_d365_fo__items
[0m16:31:33.374348 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_d365_fo__managers
[0m16:31:33.374348 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__categories'
[0m16:31:33.375347 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__dates'
[0m16:31:33.376340 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__items'
[0m16:31:33.376340 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__managers'
[0m16:31:33.377339 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__categories
[0m16:31:33.377339 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_d365_fo__dates
[0m16:31:33.378339 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_d365_fo__items
[0m16:31:33.378339 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_d365_fo__managers
[0m16:31:33.384377 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__categories"
[0m16:31:33.387379 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__dates"
[0m16:31:33.407544 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__items"
[0m16:31:33.409549 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__managers"
[0m16:31:33.410548 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__categories
[0m16:31:33.411541 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_d365_fo__dates
[0m16:31:33.412541 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_d365_fo__items
[0m16:31:33.412541 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__categories
[0m16:31:33.412541 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_d365_fo__managers
[0m16:31:33.414009 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_d365_fo__dates
[0m16:31:33.415010 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_d365_fo__items
[0m16:31:33.415010 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__transactions
[0m16:31:33.416010 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_d365_fo__managers
[0m16:31:33.417008 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_inriver__item_attributes
[0m16:31:33.417008 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_salesforce__customers
[0m16:31:33.418009 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__categories, now model.epicaldemo.stg_d365_fo__transactions)
[0m16:31:33.418009 [debug] [Thread-4 (]: Began running node snapshot.epicaldemo.stores_snapshot
[0m16:31:33.419009 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__dates, now model.epicaldemo.stg_inriver__item_attributes)
[0m16:31:33.419009 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__items, now model.epicaldemo.stg_salesforce__customers)
[0m16:31:33.420009 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__transactions
[0m16:31:33.420009 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__managers, now snapshot.epicaldemo.stores_snapshot)
[0m16:31:33.421009 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_inriver__item_attributes
[0m16:31:33.421009 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_salesforce__customers
[0m16:31:33.424530 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__transactions"
[0m16:31:33.424530 [debug] [Thread-4 (]: Began compiling node snapshot.epicaldemo.stores_snapshot
[0m16:31:33.426526 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_inriver__item_attributes"
[0m16:31:33.429526 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_salesforce__customers"
[0m16:31:33.431525 [debug] [Thread-4 (]: Began executing node snapshot.epicaldemo.stores_snapshot
[0m16:31:33.432524 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__transactions
[0m16:31:33.433031 [debug] [Thread-4 (]: Finished running node snapshot.epicaldemo.stores_snapshot
[0m16:31:33.434037 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_inriver__item_attributes
[0m16:31:33.434037 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__transactions
[0m16:31:33.435036 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_salesforce__customers
[0m16:31:33.435036 [debug] [Thread-4 (]: Began running node model.epicaldemo.dim_dates
[0m16:31:33.436037 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_inriver__item_attributes
[0m16:31:33.436037 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__stores
[0m16:31:33.437036 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_salesforce__customers
[0m16:31:33.438037 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly snapshot.epicaldemo.stores_snapshot, now model.epicaldemo.dim_dates)
[0m16:31:33.438037 [debug] [Thread-2 (]: Began running node model.epicaldemo.dim_items
[0m16:31:33.439037 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__transactions, now model.epicaldemo.stg_d365_fo__stores)
[0m16:31:33.439037 [debug] [Thread-3 (]: Began running node model.epicaldemo.dim_customers
[0m16:31:33.440037 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.dim_dates
[0m16:31:33.440037 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_inriver__item_attributes, now model.epicaldemo.dim_items)
[0m16:31:33.441037 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__stores
[0m16:31:33.441037 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_salesforce__customers, now model.epicaldemo.dim_customers)
[0m16:31:33.443550 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.dim_dates"
[0m16:31:33.444548 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.dim_items
[0m16:31:33.446548 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__stores"
[0m16:31:33.447549 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.dim_customers
[0m16:31:33.450633 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.dim_items"
[0m16:31:33.450633 [debug] [Thread-4 (]: Began executing node model.epicaldemo.dim_dates
[0m16:31:33.453575 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.dim_customers"
[0m16:31:33.453575 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__stores
[0m16:31:33.454580 [debug] [Thread-4 (]: Finished running node model.epicaldemo.dim_dates
[0m16:31:33.455579 [debug] [Thread-2 (]: Began executing node model.epicaldemo.dim_items
[0m16:31:33.456579 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__stores
[0m16:31:33.456579 [debug] [Thread-3 (]: Began executing node model.epicaldemo.dim_customers
[0m16:31:33.457579 [debug] [Thread-2 (]: Finished running node model.epicaldemo.dim_items
[0m16:31:33.457579 [debug] [Thread-4 (]: Began running node model.epicaldemo.dim_stores
[0m16:31:33.458579 [debug] [Thread-1 (]: Began running node model.epicaldemo.fact_sales_transactions
[0m16:31:33.458579 [debug] [Thread-3 (]: Finished running node model.epicaldemo.dim_customers
[0m16:31:33.459578 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.dim_dates, now model.epicaldemo.dim_stores)
[0m16:31:33.460672 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__stores, now model.epicaldemo.fact_sales_transactions)
[0m16:31:33.460672 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.dim_stores
[0m16:31:33.460672 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.fact_sales_transactions
[0m16:31:33.464184 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.dim_stores"
[0m16:31:33.471190 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.fact_sales_transactions"
[0m16:31:33.473222 [debug] [Thread-4 (]: Began executing node model.epicaldemo.dim_stores
[0m16:31:33.473222 [debug] [Thread-1 (]: Began executing node model.epicaldemo.fact_sales_transactions
[0m16:31:33.474221 [debug] [Thread-4 (]: Finished running node model.epicaldemo.dim_stores
[0m16:31:33.474221 [debug] [Thread-1 (]: Finished running node model.epicaldemo.fact_sales_transactions
[0m16:31:33.476222 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:31:33.476222 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m16:31:33.477220 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m16:31:33.628812 [debug] [MainThread]: Connection 'model.epicaldemo.fact_sales_transactions' was properly closed.
[0m16:31:33.628812 [debug] [MainThread]: Connection 'model.epicaldemo.dim_items' was properly closed.
[0m16:31:33.629811 [debug] [MainThread]: Connection 'model.epicaldemo.dim_customers' was properly closed.
[0m16:31:33.629811 [debug] [MainThread]: Connection 'model.epicaldemo.dim_stores' was properly closed.
[0m16:31:33.632325 [debug] [MainThread]: Command end result
[0m16:31:33.705161 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m16:31:33.720699 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m16:31:33.727210 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m16:31:33.730211 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m16:31:33.731208 [info ] [MainThread]: Building catalog
[0m16:31:33.740534 [debug] [ThreadPool]: Acquiring new snowflake connection 'EPICALDEMO.information_schema'
[0m16:31:33.758582 [debug] [ThreadPool]: Using snowflake connection "EPICALDEMO.information_schema"
[0m16:31:33.759582 [debug] [ThreadPool]: On EPICALDEMO.information_schema: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "EPICALDEMO.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from EPICALDEMO.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__dates' and upper("table_name") = upper('stg_d365_fo__dates')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'item' and upper("table_name") = upper('item')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'fact_sales_transactions' and upper("table_name") = upper('fact_sales_transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'manager' and upper("table_name") = upper('manager')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__managers' and upper("table_name") = upper('stg_d365_fo__managers')

                )
             or 
                (
                    
    "table_schema" ilike 'inriver' and upper("table_schema") = upper('inriver')

                    and 
    "table_name" ilike 'item_attributes' and upper("table_name") = upper('item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_items' and upper("table_name") = upper('dim_items')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_inriver__item_attributes' and upper("table_name") = upper('stg_inriver__item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'salesforce' and upper("table_schema") = upper('salesforce')

                    and 
    "table_name" ilike 'customer' and upper("table_name") = upper('customer')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__items' and upper("table_name") = upper('stg_d365_fo__items')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__transactions' and upper("table_name") = upper('stg_d365_fo__transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_customers' and upper("table_name") = upper('dim_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'category' and upper("table_name") = upper('category')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__categories' and upper("table_name") = upper('stg_d365_fo__categories')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__stores' and upper("table_name") = upper('stg_d365_fo__stores')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'transactions' and upper("table_name") = upper('transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_dates' and upper("table_name") = upper('dim_dates')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'date' and upper("table_name") = upper('date')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'store' and upper("table_name") = upper('store')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_stores' and upper("table_name") = upper('dim_stores')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stores_snapshot' and upper("table_name") = upper('stores_snapshot')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_salesforce__customers' and upper("table_name") = upper('stg_salesforce__customers')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from EPICALDEMO.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__dates' and upper("table_name") = upper('stg_d365_fo__dates')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'item' and upper("table_name") = upper('item')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'fact_sales_transactions' and upper("table_name") = upper('fact_sales_transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'manager' and upper("table_name") = upper('manager')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__managers' and upper("table_name") = upper('stg_d365_fo__managers')

                )
             or 
                (
                    
    "table_schema" ilike 'inriver' and upper("table_schema") = upper('inriver')

                    and 
    "table_name" ilike 'item_attributes' and upper("table_name") = upper('item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_items' and upper("table_name") = upper('dim_items')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_inriver__item_attributes' and upper("table_name") = upper('stg_inriver__item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'salesforce' and upper("table_schema") = upper('salesforce')

                    and 
    "table_name" ilike 'customer' and upper("table_name") = upper('customer')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__items' and upper("table_name") = upper('stg_d365_fo__items')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__transactions' and upper("table_name") = upper('stg_d365_fo__transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_customers' and upper("table_name") = upper('dim_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'category' and upper("table_name") = upper('category')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__categories' and upper("table_name") = upper('stg_d365_fo__categories')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__stores' and upper("table_name") = upper('stg_d365_fo__stores')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'transactions' and upper("table_name") = upper('transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_dates' and upper("table_name") = upper('dim_dates')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'date' and upper("table_name") = upper('date')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'store' and upper("table_name") = upper('store')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_stores' and upper("table_name") = upper('dim_stores')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stores_snapshot' and upper("table_name") = upper('stores_snapshot')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_salesforce__customers' and upper("table_name") = upper('stg_salesforce__customers')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m16:31:33.760594 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:31:43.938543 [debug] [ThreadPool]: SQL status: SUCCESS 162 in 10.178 seconds
[0m16:31:44.273302 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\catalog.json
[0m16:31:44.293358 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m16:31:44.296359 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m16:31:44.296359 [info ] [MainThread]: Catalog written to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\catalog.json
[0m16:31:44.298368 [debug] [MainThread]: Command `dbt docs generate` succeeded at 16:31:44.297359 after 15.46 seconds
[0m16:31:44.298368 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m16:31:44.298368 [debug] [MainThread]: Connection 'EPICALDEMO.information_schema' was left open.
[0m16:31:44.299358 [debug] [MainThread]: On EPICALDEMO.information_schema: Close
[0m16:31:44.445514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD410BAF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD410BA490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD410BBCD0>]}
[0m16:31:44.445514 [debug] [MainThread]: Flushing usage events
[0m16:31:44.949073 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:31:49.036214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4283787D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4283794D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B428379190>]}


============================== 16:31:49.039211 | a8586822-0b18-4ebb-a635-bb46fed09ce0 ==============================
[0m16:31:49.039211 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:31:49.040202 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:31:49.456410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a8586822-0b18-4ebb-a635-bb46fed09ce0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B429A6D550>]}
[0m16:31:49.500042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a8586822-0b18-4ebb-a635-bb46fed09ce0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B42972D650>]}
[0m16:31:49.627676 [error] [MainThread]: Encountered an error:
[WinError 10048] Only one usage of each socket address (protocol/network address/port) is normally permitted
[0m16:31:49.630677 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\task\docs\serve.py", line 24, in run
    with socketserver.TCPServer((host, port), SimpleHTTPRequestHandler) as httpd:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socketserver.py", line 456, in __init__
    self.server_bind()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socketserver.py", line 472, in server_bind
    self.socket.bind(self.server_address)
OSError: [WinError 10048] Only one usage of each socket address (protocol/network address/port) is normally permitted

[0m16:31:49.634187 [debug] [MainThread]: Command `dbt docs serve` failed at 16:31:49.634187 after 0.66 seconds
[0m16:31:49.635193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4283CA150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B42836B3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4283713D0>]}
[0m16:31:49.636192 [debug] [MainThread]: Flushing usage events
[0m16:31:50.161341 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:32:54.670225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FACFF79350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FACFF7AE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FACFF79250>]}


============================== 16:32:54.680754 | c8b9632c-6e77-42e4-9807-8dfb71d41b43 ==============================
[0m16:32:54.680754 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:32:54.681754 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:32:57.296737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8b9632c-6e77-42e4-9807-8dfb71d41b43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FACFFBA790>]}
[0m16:32:57.340333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8b9632c-6e77-42e4-9807-8dfb71d41b43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FACEC05D10>]}
[0m16:32:57.341837 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m16:32:57.831021 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:32:59.036678 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:32:59.037678 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:32:59.043199 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m16:32:59.080726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c8b9632c-6e77-42e4-9807-8dfb71d41b43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAD1BB3B90>]}
[0m16:32:59.118815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8b9632c-6e77-42e4-9807-8dfb71d41b43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAD14A8F10>]}
[0m16:32:59.119816 [info ] [MainThread]: Found 13 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m16:32:59.120816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8b9632c-6e77-42e4-9807-8dfb71d41b43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAD1B1CB10>]}
[0m16:32:59.123329 [info ] [MainThread]: 
[0m16:32:59.123329 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:32:59.124335 [info ] [MainThread]: 
[0m16:32:59.125335 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:32:59.129335 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m16:33:01.410424 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:33:01.411931 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m16:33:01.411931 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:33:02.371653 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.959 seconds
[0m16:33:02.375805 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:33:02.376815 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m16:33:02.569646 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.193 seconds
[0m16:33:02.572713 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m16:33:02.572713 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m16:33:02.678012 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.104 seconds
[0m16:33:02.681013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8b9632c-6e77-42e4-9807-8dfb71d41b43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAD1BB3890>]}
[0m16:33:02.685354 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__categories
[0m16:33:02.686354 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_d365_fo__dates
[0m16:33:02.686354 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_d365_fo__items
[0m16:33:02.687353 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_d365_fo__managers
[0m16:33:02.687353 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__categories'
[0m16:33:02.688354 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__dates'
[0m16:33:02.688354 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__items'
[0m16:33:02.689353 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__managers'
[0m16:33:02.689353 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__categories
[0m16:33:02.690363 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_d365_fo__dates
[0m16:33:02.690363 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_d365_fo__items
[0m16:33:02.690363 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_d365_fo__managers
[0m16:33:02.697884 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__categories"
[0m16:33:02.700884 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__dates"
[0m16:33:02.704392 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__items"
[0m16:33:02.706392 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__managers"
[0m16:33:02.707393 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__categories
[0m16:33:02.708538 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_d365_fo__dates
[0m16:33:02.709544 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_d365_fo__items
[0m16:33:02.710546 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__categories
[0m16:33:02.710546 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_d365_fo__managers
[0m16:33:02.711810 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_d365_fo__dates
[0m16:33:02.712816 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_d365_fo__items
[0m16:33:02.712816 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__transactions
[0m16:33:02.713818 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_d365_fo__managers
[0m16:33:02.714820 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_inriver__item_attributes
[0m16:33:02.714820 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_salesforce__customers
[0m16:33:02.715819 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__categories, now model.epicaldemo.stg_d365_fo__transactions)
[0m16:33:02.715819 [debug] [Thread-4 (]: Began running node snapshot.epicaldemo.stores_snapshot
[0m16:33:02.716817 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__dates, now model.epicaldemo.stg_inriver__item_attributes)
[0m16:33:02.717818 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__items, now model.epicaldemo.stg_salesforce__customers)
[0m16:33:02.717818 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__transactions
[0m16:33:02.718818 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__managers, now snapshot.epicaldemo.stores_snapshot)
[0m16:33:02.718818 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_inriver__item_attributes
[0m16:33:02.719817 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_salesforce__customers
[0m16:33:02.722328 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__transactions"
[0m16:33:02.722328 [debug] [Thread-4 (]: Began compiling node snapshot.epicaldemo.stores_snapshot
[0m16:33:02.725337 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_inriver__item_attributes"
[0m16:33:02.727335 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_salesforce__customers"
[0m16:33:02.730336 [debug] [Thread-4 (]: Began executing node snapshot.epicaldemo.stores_snapshot
[0m16:33:02.730336 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__transactions
[0m16:33:02.731841 [debug] [Thread-4 (]: Finished running node snapshot.epicaldemo.stores_snapshot
[0m16:33:02.731841 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_inriver__item_attributes
[0m16:33:02.732849 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__transactions
[0m16:33:02.732849 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_salesforce__customers
[0m16:33:02.733851 [debug] [Thread-4 (]: Began running node model.epicaldemo.dim_dates
[0m16:33:02.734850 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_inriver__item_attributes
[0m16:33:02.734850 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__stores
[0m16:33:02.735849 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_salesforce__customers
[0m16:33:02.735849 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly snapshot.epicaldemo.stores_snapshot, now model.epicaldemo.dim_dates)
[0m16:33:02.736849 [debug] [Thread-2 (]: Began running node model.epicaldemo.dim_items
[0m16:33:02.737847 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__transactions, now model.epicaldemo.stg_d365_fo__stores)
[0m16:33:02.737847 [debug] [Thread-3 (]: Began running node model.epicaldemo.dim_customers
[0m16:33:02.737847 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.dim_dates
[0m16:33:02.738849 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_inriver__item_attributes, now model.epicaldemo.dim_items)
[0m16:33:02.739849 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__stores
[0m16:33:02.739849 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_salesforce__customers, now model.epicaldemo.dim_customers)
[0m16:33:02.742955 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.dim_dates"
[0m16:33:02.742955 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.dim_items
[0m16:33:02.745956 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__stores"
[0m16:33:02.746954 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.dim_customers
[0m16:33:02.749957 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.dim_items"
[0m16:33:02.750955 [debug] [Thread-4 (]: Began executing node model.epicaldemo.dim_dates
[0m16:33:02.754052 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.dim_customers"
[0m16:33:02.754052 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__stores
[0m16:33:02.755058 [debug] [Thread-4 (]: Finished running node model.epicaldemo.dim_dates
[0m16:33:02.755058 [debug] [Thread-2 (]: Began executing node model.epicaldemo.dim_items
[0m16:33:02.756049 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__stores
[0m16:33:02.757051 [debug] [Thread-3 (]: Began executing node model.epicaldemo.dim_customers
[0m16:33:02.758049 [debug] [Thread-2 (]: Finished running node model.epicaldemo.dim_items
[0m16:33:02.758049 [debug] [Thread-4 (]: Began running node model.epicaldemo.dim_stores
[0m16:33:02.759052 [debug] [Thread-1 (]: Began running node model.epicaldemo.fact_sales_transactions
[0m16:33:02.759052 [debug] [Thread-3 (]: Finished running node model.epicaldemo.dim_customers
[0m16:33:02.760049 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.dim_dates, now model.epicaldemo.dim_stores)
[0m16:33:02.760049 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__stores, now model.epicaldemo.fact_sales_transactions)
[0m16:33:02.761054 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.dim_stores
[0m16:33:02.762051 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.fact_sales_transactions
[0m16:33:02.764224 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.dim_stores"
[0m16:33:02.772736 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.fact_sales_transactions"
[0m16:33:02.774737 [debug] [Thread-4 (]: Began executing node model.epicaldemo.dim_stores
[0m16:33:02.774737 [debug] [Thread-1 (]: Began executing node model.epicaldemo.fact_sales_transactions
[0m16:33:02.775736 [debug] [Thread-4 (]: Finished running node model.epicaldemo.dim_stores
[0m16:33:02.776739 [debug] [Thread-1 (]: Finished running node model.epicaldemo.fact_sales_transactions
[0m16:33:02.777738 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:33:02.786787 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m16:33:02.786787 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m16:33:02.933270 [debug] [MainThread]: Connection 'model.epicaldemo.fact_sales_transactions' was properly closed.
[0m16:33:02.934270 [debug] [MainThread]: Connection 'model.epicaldemo.dim_items' was properly closed.
[0m16:33:02.934270 [debug] [MainThread]: Connection 'model.epicaldemo.dim_customers' was properly closed.
[0m16:33:02.935270 [debug] [MainThread]: Connection 'model.epicaldemo.dim_stores' was properly closed.
[0m16:33:02.937274 [debug] [MainThread]: Command end result
[0m16:33:03.015738 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m16:33:03.033766 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m16:33:03.040766 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m16:33:03.245077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002570816FF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002570816FB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002570816F690>]}


============================== 16:33:03.249075 | 3a04309f-d4d2-4173-a7ba-84fe2c851b6a ==============================
[0m16:33:03.249075 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:33:03.250074 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'c:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'version_check': 'True', 'debug': 'False', 'log_path': 'c:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:33:03.356601 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m16:33:03.356601 [info ] [MainThread]: Building catalog
[0m16:33:03.367115 [debug] [ThreadPool]: Acquiring new snowflake connection 'EPICALDEMO.information_schema'
[0m16:33:03.370116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a04309f-d4d2-4173-a7ba-84fe2c851b6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002570869A010>]}
[0m16:33:03.385136 [debug] [ThreadPool]: Using snowflake connection "EPICALDEMO.information_schema"
[0m16:33:03.386135 [debug] [ThreadPool]: On EPICALDEMO.information_schema: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "EPICALDEMO.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from EPICALDEMO.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__categories' and upper("table_name") = upper('stg_d365_fo__categories')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__items' and upper("table_name") = upper('stg_d365_fo__items')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_items' and upper("table_name") = upper('dim_items')

                )
             or 
                (
                    
    "table_schema" ilike 'inriver' and upper("table_schema") = upper('inriver')

                    and 
    "table_name" ilike 'item_attributes' and upper("table_name") = upper('item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'date' and upper("table_name") = upper('date')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_inriver__item_attributes' and upper("table_name") = upper('stg_inriver__item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_stores' and upper("table_name") = upper('dim_stores')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_salesforce__customers' and upper("table_name") = upper('stg_salesforce__customers')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'manager' and upper("table_name") = upper('manager')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__managers' and upper("table_name") = upper('stg_d365_fo__managers')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'transactions' and upper("table_name") = upper('transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'category' and upper("table_name") = upper('category')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_dates' and upper("table_name") = upper('dim_dates')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'item' and upper("table_name") = upper('item')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__transactions' and upper("table_name") = upper('stg_d365_fo__transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_customers' and upper("table_name") = upper('dim_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__dates' and upper("table_name") = upper('stg_d365_fo__dates')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stores_snapshot' and upper("table_name") = upper('stores_snapshot')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__stores' and upper("table_name") = upper('stg_d365_fo__stores')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'store' and upper("table_name") = upper('store')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'fact_sales_transactions' and upper("table_name") = upper('fact_sales_transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'salesforce' and upper("table_schema") = upper('salesforce')

                    and 
    "table_name" ilike 'customer' and upper("table_name") = upper('customer')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from EPICALDEMO.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__categories' and upper("table_name") = upper('stg_d365_fo__categories')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__items' and upper("table_name") = upper('stg_d365_fo__items')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_items' and upper("table_name") = upper('dim_items')

                )
             or 
                (
                    
    "table_schema" ilike 'inriver' and upper("table_schema") = upper('inriver')

                    and 
    "table_name" ilike 'item_attributes' and upper("table_name") = upper('item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'date' and upper("table_name") = upper('date')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_inriver__item_attributes' and upper("table_name") = upper('stg_inriver__item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_stores' and upper("table_name") = upper('dim_stores')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_salesforce__customers' and upper("table_name") = upper('stg_salesforce__customers')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'manager' and upper("table_name") = upper('manager')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__managers' and upper("table_name") = upper('stg_d365_fo__managers')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'transactions' and upper("table_name") = upper('transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'category' and upper("table_name") = upper('category')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_dates' and upper("table_name") = upper('dim_dates')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'item' and upper("table_name") = upper('item')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__transactions' and upper("table_name") = upper('stg_d365_fo__transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_customers' and upper("table_name") = upper('dim_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__dates' and upper("table_name") = upper('stg_d365_fo__dates')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stores_snapshot' and upper("table_name") = upper('stores_snapshot')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__stores' and upper("table_name") = upper('stg_d365_fo__stores')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'store' and upper("table_name") = upper('store')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'fact_sales_transactions' and upper("table_name") = upper('fact_sales_transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'salesforce' and upper("table_schema") = upper('salesforce')

                    and 
    "table_name" ilike 'customer' and upper("table_name") = upper('customer')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m16:33:03.387135 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:33:03.461755 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:33:03.463266 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:33:03.465265 [debug] [MainThread]: Command `cli deps` succeeded at 16:33:03.465265 after 0.30 seconds
[0m16:33:03.465265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025708178310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025708191910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025702575550>]}
[0m16:33:03.466265 [debug] [MainThread]: Flushing usage events
[0m16:33:03.990822 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:33:13.208988 [debug] [ThreadPool]: SQL status: SUCCESS 162 in 9.822 seconds
[0m16:33:13.518418 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\catalog.json
[0m16:33:13.538595 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m16:33:13.540599 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m16:33:13.542105 [info ] [MainThread]: Catalog written to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\catalog.json
[0m16:33:13.543110 [debug] [MainThread]: Command `dbt docs generate` succeeded at 16:33:13.543110 after 18.96 seconds
[0m16:33:13.544118 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m16:33:13.544118 [debug] [MainThread]: Connection 'EPICALDEMO.information_schema' was left open.
[0m16:33:13.544118 [debug] [MainThread]: On EPICALDEMO.information_schema: Close
[0m16:33:13.691705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FACFFB9410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FACFFC6090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FACF8CCE50>]}
[0m16:33:13.693073 [debug] [MainThread]: Flushing usage events
[0m16:33:14.202010 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:33:18.537835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177AD67AE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177AD678B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177AD6784D0>]}


============================== 16:33:18.541835 | 4f8231ed-e0af-4f32-a71f-52810054daf6 ==============================
[0m16:33:18.541835 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:33:18.541835 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs serve', 'send_anonymous_usage_stats': 'True'}
[0m16:33:18.940570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f8231ed-e0af-4f32-a71f-52810054daf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177AD68D690>]}
[0m16:33:18.984210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f8231ed-e0af-4f32-a71f-52810054daf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177AE87E790>]}
[0m16:35:27.312162 [error] [MainThread]: Encountered an error:

[0m16:35:27.326281 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socketserver.py", line 238, in serve_forever
    self._handle_request_noblock()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socketserver.py", line 317, in _handle_request_noblock
    self.process_request(request, client_address)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socketserver.py", line 348, in process_request
    self.finish_request(request, client_address)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socketserver.py", line 361, in finish_request
    self.RequestHandlerClass(request, client_address, self)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\http\server.py", line 671, in __init__
    super().__init__(*args, **kwargs)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socketserver.py", line 755, in __init__
    self.handle()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\http\server.py", line 436, in handle
    self.handle_one_request()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\http\server.py", line 404, in handle_one_request
    self.raw_requestline = self.rfile.readline(65537)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socket.py", line 706, in readinto
    return self._sock.recv_into(b)
           ^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m16:35:27.329284 [debug] [MainThread]: Command `dbt docs serve` failed at 16:35:27.329284 after 128.85 seconds
[0m16:35:27.330283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177AD6796D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177AD678410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177AD6BD890>]}
[0m16:35:27.330283 [debug] [MainThread]: Flushing usage events
[0m16:35:27.880334 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:44:40.288796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B4C9786D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B4C978450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B4C978410>]}


============================== 16:44:40.292803 | 3113c7bc-f6f0-4f6b-ac7e-2a522360e675 ==============================
[0m16:44:40.292803 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:44:40.293804 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:44:40.698721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3113c7bc-f6f0-4f6b-ac7e-2a522360e675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B4DD01BD0>]}
[0m16:44:40.740226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3113c7bc-f6f0-4f6b-ac7e-2a522360e675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B4DD2D450>]}
[0m16:54:27.937610 [error] [MainThread]: Encountered an error:

[0m16:54:28.046771 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socketserver.py", line 238, in serve_forever
    self._handle_request_noblock()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socketserver.py", line 317, in _handle_request_noblock
    self.process_request(request, client_address)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socketserver.py", line 348, in process_request
    self.finish_request(request, client_address)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socketserver.py", line 361, in finish_request
    self.RequestHandlerClass(request, client_address, self)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\http\server.py", line 671, in __init__
    super().__init__(*args, **kwargs)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socketserver.py", line 755, in __init__
    self.handle()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\http\server.py", line 436, in handle
    self.handle_one_request()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\http\server.py", line 404, in handle_one_request
    self.raw_requestline = self.rfile.readline(65537)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socket.py", line 706, in readinto
    return self._sock.recv_into(b)
           ^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m16:54:28.053770 [debug] [MainThread]: Command `dbt docs serve` failed at 16:54:28.052790 after 587.83 seconds
[0m16:54:28.054769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B4C9796D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B4C9BFB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B4C9BDC10>]}
[0m16:54:28.055769 [debug] [MainThread]: Flushing usage events
[0m16:54:28.649076 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:17:49.768261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021428F6EED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021428F6C990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021428F6F9D0>]}


============================== 19:17:49.768261 | 5b7b9bf0-8ec1-45c0-b451-b3caf2c5a2f0 ==============================
[0m19:17:49.768261 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:17:49.768261 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'c:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'c:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m19:17:49.877133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b7b9bf0-8ec1-45c0-b451-b3caf2c5a2f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021429433410>]}
[0m19:17:49.966625 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m19:17:49.969602 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m19:17:49.970602 [debug] [MainThread]: Command `cli deps` succeeded at 19:17:49.970602 after 0.27 seconds
[0m19:17:49.971606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021428F78190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021428F92A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021423375550>]}
[0m19:17:49.972618 [debug] [MainThread]: Flushing usage events
[0m19:17:50.438484 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:50:10.305072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB2F978210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB2F967ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB2F9BA350>]}


============================== 19:50:10.320705 | f5a340b3-4ba3-4d06-92a0-8b73eaa8f057 ==============================
[0m19:50:10.320705 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:50:10.320705 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -s fact_sales_transactions --full-refresh', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:50:12.786561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5a340b3-4ba3-4d06-92a0-8b73eaa8f057', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB3106A250>]}
[0m19:50:12.829818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5a340b3-4ba3-4d06-92a0-8b73eaa8f057', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB2E357850>]}
[0m19:50:12.845445 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m19:50:13.252718 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:50:14.260207 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:50:14.260207 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:50:14.260207 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m19:50:14.292117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5a340b3-4ba3-4d06-92a0-8b73eaa8f057', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB30D5B7D0>]}
[0m19:50:14.377438 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m19:50:14.394018 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m19:50:14.613568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5a340b3-4ba3-4d06-92a0-8b73eaa8f057', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB31704150>]}
[0m19:50:14.613568 [info ] [MainThread]: Found 13 models, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m19:50:14.613568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5a340b3-4ba3-4d06-92a0-8b73eaa8f057', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB30D58910>]}
[0m19:50:14.613568 [info ] [MainThread]: 
[0m19:50:14.613568 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:50:14.613568 [info ] [MainThread]: 
[0m19:50:14.613568 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:50:14.613568 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO'
[0m19:50:16.842835 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO"
[0m19:50:16.842835 [debug] [ThreadPool]: On list_EPICALDEMO: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO"} */
show terse schemas in database EPICALDEMO
    limit 10000
[0m19:50:16.842835 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:50:17.392969 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.547 seconds
[0m19:50:17.392969 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m19:50:17.408594 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m19:50:17.408594 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m19:50:17.408594 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:50:17.628131 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.213 seconds
[0m19:50:17.628131 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m19:50:17.628131 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m19:50:17.722272 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.095 seconds
[0m19:50:17.722272 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m19:50:17.722272 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m19:50:17.784787 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.053 seconds
[0m19:50:17.784787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5a340b3-4ba3-4d06-92a0-8b73eaa8f057', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB31314A10>]}
[0m19:50:17.793332 [debug] [Thread-1 (]: Began running node model.epicaldemo.fact_sales_transactions
[0m19:50:17.793332 [info ] [Thread-1 (]: 1 of 1 START sql incremental model broman_analytics.fact_sales_transactions .... [RUN]
[0m19:50:17.793332 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.fact_sales_transactions'
[0m19:50:17.793332 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.fact_sales_transactions
[0m19:50:17.800854 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.fact_sales_transactions"
[0m19:50:17.800854 [debug] [Thread-1 (]: Began executing node model.epicaldemo.fact_sales_transactions
[0m19:50:17.860436 [debug] [Thread-1 (]: Writing runtime sql for node "model.epicaldemo.fact_sales_transactions"
[0m19:50:17.863450 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions"
[0m19:50:17.864436 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions"} */
create or replace transient table EPICALDEMO.broman_analytics.fact_sales_transactions
    

    
    as (

WITH

sales AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__transactions

    
),

items AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__items
),

stores AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_d365_fo__stores
),

customers AS (
    SELECT
        *
    FROM EPICALDEMO.broman_analytics.stg_salesforce__customers
),

final AS (
    SELECT
        -- Identifiers
        sales.id
        ,sales.transaction_date_id
        ,sales.updated_at
        ,CONVERT_TIMEZONE('Europe/Stockholm', CURRENT_TIMESTAMP()) AS loaded_at

        ,CASE
            WHEN sales.sku IS NULL THEN -2 -- SKU is missing FROM Source
            WHEN items.item_id IS NULL THEN -1 -- SKU is not known FROM Source
            ELSE items.item_id -- Use item_id FROM Dim based on SKU
         END AS item_id

        ,CASE
            WHEN sales."Store" IS NULL THEN -2
            WHEN stores.store_key IS NULL THEN -1
            ELSE stores.store_key
         END AS store_key

        ,CASE
            WHEN sales."Customer Number" IS NULL THEN -2
            WHEN customers.customer_id IS NULL THEN -1
            ELSE customers.customer_id
         END AS customer_id

        -- Metrics
        ,sales."Qty"
        ,sales."Unit Price"
        ,sales."Sales Amount"
        ,sales."Unit Cost"
        ,sales."Cost"
        ,sales."Margin"
    FROM sales
    LEFT JOIN items ON items."SKU" = sales."SKU"
    LEFT JOIN stores ON stores."Store" = sales."Store" AND sales.transaction_date_id >= stores.valid_from AND sales.transaction_date_id < stores.valid_to
    LEFT JOIN customers ON customers."Customer Number" = sales."Customer Number"
)

SELECT * FROM final
    )
;
[0m19:50:17.865434 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:50:19.369141 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.506 seconds
[0m19:50:19.369141 [debug] [Thread-1 (]: Applying DROP to: EPICALDEMO.broman_analytics.fact_sales_transactions__dbt_tmp
[0m19:50:19.384786 [debug] [Thread-1 (]: Using snowflake connection "model.epicaldemo.fact_sales_transactions"
[0m19:50:19.384786 [debug] [Thread-1 (]: On model.epicaldemo.fact_sales_transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "node_id": "model.epicaldemo.fact_sales_transactions"} */
drop view if exists EPICALDEMO.broman_analytics.fact_sales_transactions__dbt_tmp cascade
[0m19:50:19.432071 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.058 seconds
[0m19:50:19.463333 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5a340b3-4ba3-4d06-92a0-8b73eaa8f057', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB31BE8AD0>]}
[0m19:50:19.463333 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model broman_analytics.fact_sales_transactions  [[32mSUCCESS 1[0m in 1.65s]
[0m19:50:19.463333 [debug] [Thread-1 (]: Finished running node model.epicaldemo.fact_sales_transactions
[0m19:50:19.463333 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:50:19.463333 [debug] [MainThread]: Connection 'list_EPICALDEMO' was left open.
[0m19:50:19.463333 [debug] [MainThread]: On list_EPICALDEMO: Close
[0m19:50:19.511054 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m19:50:19.511054 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m19:50:19.559983 [debug] [MainThread]: Connection 'model.epicaldemo.fact_sales_transactions' was left open.
[0m19:50:19.559983 [debug] [MainThread]: On model.epicaldemo.fact_sales_transactions: Close
[0m19:50:19.607512 [info ] [MainThread]: 
[0m19:50:19.607512 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 4.99 seconds (4.99s).
[0m19:50:19.607512 [debug] [MainThread]: Command end result
[0m19:50:19.623143 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m19:50:19.623143 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m19:50:19.642254 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m19:50:19.642984 [info ] [MainThread]: 
[0m19:50:19.644027 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:50:19.644718 [info ] [MainThread]: 
[0m19:50:19.645577 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:50:19.645577 [debug] [MainThread]: Command `dbt run` succeeded at 19:50:19.645577 after 9.43 seconds
[0m19:50:19.645577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB2A292FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB2F973610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB2F973ED0>]}
[0m19:50:19.645577 [debug] [MainThread]: Flushing usage events
[0m19:50:20.105701 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:08:08.541863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299B7B7C0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299B7B67B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299B7B67C10>]}


============================== 20:08:08.557497 | 441ed49d-2efe-433e-a400-ee4d335b9a0b ==============================
[0m20:08:08.557497 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:08:08.557497 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m20:08:10.787988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '441ed49d-2efe-433e-a400-ee4d335b9a0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299B7B80650>]}
[0m20:08:10.824873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '441ed49d-2efe-433e-a400-ee4d335b9a0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299B8F92850>]}
[0m20:08:10.835378 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m20:08:11.205348 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:08:11.398784 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:08:11.398784 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:08:11.414410 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m20:08:11.456109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '441ed49d-2efe-433e-a400-ee4d335b9a0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299B9054C50>]}
[0m20:08:11.646835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '441ed49d-2efe-433e-a400-ee4d335b9a0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299B94F4310>]}
[0m20:08:11.646835 [info ] [MainThread]: Found 13 models, 1 snapshot, 2 data tests, 8 sources, 1 exposure, 476 macros
[0m20:08:11.646835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '441ed49d-2efe-433e-a400-ee4d335b9a0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299B950CA10>]}
[0m20:08:11.646835 [info ] [MainThread]: 
[0m20:08:11.646835 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:08:11.646835 [info ] [MainThread]: 
[0m20:08:11.646835 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:08:11.666115 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m20:08:13.815057 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m20:08:13.815057 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m20:08:13.815057 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:08:14.349341 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.532 seconds
[0m20:08:14.349341 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m20:08:14.349341 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m20:08:14.446652 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.093 seconds
[0m20:08:14.448650 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m20:08:14.449653 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m20:08:14.502085 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.060 seconds
[0m20:08:14.502085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '441ed49d-2efe-433e-a400-ee4d335b9a0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299B74CC9D0>]}
[0m20:08:14.517701 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__categories
[0m20:08:14.517701 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_d365_fo__dates
[0m20:08:14.517701 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__categories'
[0m20:08:14.517701 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_d365_fo__items
[0m20:08:14.517701 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_d365_fo__managers
[0m20:08:14.517701 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__dates'
[0m20:08:14.517701 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__categories
[0m20:08:14.517701 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__items'
[0m20:08:14.517701 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__managers'
[0m20:08:14.517701 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_d365_fo__dates
[0m20:08:14.530207 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__categories"
[0m20:08:14.530207 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_d365_fo__items
[0m20:08:14.530207 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_d365_fo__managers
[0m20:08:14.533722 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__dates"
[0m20:08:14.533722 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__items"
[0m20:08:14.533722 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__managers"
[0m20:08:14.533722 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__categories
[0m20:08:14.533722 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__categories
[0m20:08:14.533722 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_d365_fo__dates
[0m20:08:14.533722 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_d365_fo__items
[0m20:08:14.533722 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__transactions
[0m20:08:14.533722 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_d365_fo__dates
[0m20:08:14.533722 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_d365_fo__managers
[0m20:08:14.533722 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_d365_fo__items
[0m20:08:14.533722 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__categories, now model.epicaldemo.stg_d365_fo__transactions)
[0m20:08:14.533722 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_inriver__item_attributes
[0m20:08:14.533722 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_d365_fo__managers
[0m20:08:14.533722 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_salesforce__customers
[0m20:08:14.533722 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__transactions
[0m20:08:14.533722 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__dates, now model.epicaldemo.stg_inriver__item_attributes)
[0m20:08:14.533722 [debug] [Thread-4 (]: Began running node snapshot.epicaldemo.stores_snapshot
[0m20:08:14.549361 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__items, now model.epicaldemo.stg_salesforce__customers)
[0m20:08:14.549361 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__transactions"
[0m20:08:14.549361 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_inriver__item_attributes
[0m20:08:14.549361 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__managers, now snapshot.epicaldemo.stores_snapshot)
[0m20:08:14.549361 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_salesforce__customers
[0m20:08:14.549361 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_inriver__item_attributes"
[0m20:08:14.549361 [debug] [Thread-4 (]: Began compiling node snapshot.epicaldemo.stores_snapshot
[0m20:08:14.549361 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__transactions
[0m20:08:14.549361 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_salesforce__customers"
[0m20:08:14.549361 [debug] [Thread-4 (]: Began executing node snapshot.epicaldemo.stores_snapshot
[0m20:08:14.549361 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__transactions
[0m20:08:14.549361 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_inriver__item_attributes
[0m20:08:14.564982 [debug] [Thread-4 (]: Finished running node snapshot.epicaldemo.stores_snapshot
[0m20:08:14.564982 [debug] [Thread-1 (]: Began running node model.epicaldemo.dim_dates
[0m20:08:14.564982 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_salesforce__customers
[0m20:08:14.564982 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_inriver__item_attributes
[0m20:08:14.564982 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_d365_fo__stores
[0m20:08:14.564982 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__transactions, now model.epicaldemo.dim_dates)
[0m20:08:14.564982 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_salesforce__customers
[0m20:08:14.564982 [debug] [Thread-2 (]: Began running node model.epicaldemo.dim_items
[0m20:08:14.564982 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly snapshot.epicaldemo.stores_snapshot, now model.epicaldemo.stg_d365_fo__stores)
[0m20:08:14.564982 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.dim_dates
[0m20:08:14.564982 [debug] [Thread-3 (]: Began running node model.epicaldemo.dim_customers
[0m20:08:14.564982 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_inriver__item_attributes, now model.epicaldemo.dim_items)
[0m20:08:14.564982 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_d365_fo__stores
[0m20:08:14.564982 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.dim_dates"
[0m20:08:14.564982 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_salesforce__customers, now model.epicaldemo.dim_customers)
[0m20:08:14.564982 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.dim_items
[0m20:08:14.564982 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__stores"
[0m20:08:14.564982 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.dim_customers
[0m20:08:14.580607 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.dim_items"
[0m20:08:14.580607 [debug] [Thread-1 (]: Began executing node model.epicaldemo.dim_dates
[0m20:08:14.580607 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.dim_customers"
[0m20:08:14.580607 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_d365_fo__stores
[0m20:08:14.580607 [debug] [Thread-1 (]: Finished running node model.epicaldemo.dim_dates
[0m20:08:14.580607 [debug] [Thread-2 (]: Began executing node model.epicaldemo.dim_items
[0m20:08:14.580607 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_d365_fo__stores
[0m20:08:14.580607 [debug] [Thread-3 (]: Began executing node model.epicaldemo.dim_customers
[0m20:08:14.591596 [debug] [Thread-2 (]: Finished running node model.epicaldemo.dim_items
[0m20:08:14.591596 [debug] [Thread-1 (]: Began running node model.epicaldemo.dim_stores
[0m20:08:14.591596 [debug] [Thread-4 (]: Began running node model.epicaldemo.fact_sales_transactions
[0m20:08:14.591596 [debug] [Thread-3 (]: Finished running node model.epicaldemo.dim_customers
[0m20:08:14.591596 [debug] [Thread-2 (]: Began running node test.epicaldemo.not_null_dim_items_item_id.9c886c9cd1
[0m20:08:14.595257 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.dim_dates, now model.epicaldemo.dim_stores)
[0m20:08:14.596262 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__stores, now model.epicaldemo.fact_sales_transactions)
[0m20:08:14.596262 [debug] [Thread-3 (]: Began running node test.epicaldemo.unique_dim_items_item_id.d6b0c82950
[0m20:08:14.596262 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.dim_items, now test.epicaldemo.not_null_dim_items_item_id.9c886c9cd1)
[0m20:08:14.596262 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.dim_stores
[0m20:08:14.596262 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.fact_sales_transactions
[0m20:08:14.596262 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.dim_customers, now test.epicaldemo.unique_dim_items_item_id.d6b0c82950)
[0m20:08:14.596262 [debug] [Thread-2 (]: Began compiling node test.epicaldemo.not_null_dim_items_item_id.9c886c9cd1
[0m20:08:14.596262 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.dim_stores"
[0m20:08:14.596262 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.fact_sales_transactions"
[0m20:08:14.611909 [debug] [Thread-3 (]: Began compiling node test.epicaldemo.unique_dim_items_item_id.d6b0c82950
[0m20:08:14.611909 [debug] [Thread-2 (]: Writing injected SQL for node "test.epicaldemo.not_null_dim_items_item_id.9c886c9cd1"
[0m20:08:14.627594 [debug] [Thread-3 (]: Writing injected SQL for node "test.epicaldemo.unique_dim_items_item_id.d6b0c82950"
[0m20:08:14.630100 [debug] [Thread-4 (]: Began executing node model.epicaldemo.fact_sales_transactions
[0m20:08:14.630100 [debug] [Thread-1 (]: Began executing node model.epicaldemo.dim_stores
[0m20:08:14.630100 [debug] [Thread-4 (]: Finished running node model.epicaldemo.fact_sales_transactions
[0m20:08:14.630100 [debug] [Thread-1 (]: Finished running node model.epicaldemo.dim_stores
[0m20:08:14.630100 [debug] [Thread-3 (]: Began executing node test.epicaldemo.unique_dim_items_item_id.d6b0c82950
[0m20:08:14.633980 [debug] [Thread-2 (]: Began executing node test.epicaldemo.not_null_dim_items_item_id.9c886c9cd1
[0m20:08:14.635222 [debug] [Thread-3 (]: Finished running node test.epicaldemo.unique_dim_items_item_id.d6b0c82950
[0m20:08:14.635222 [debug] [Thread-2 (]: Finished running node test.epicaldemo.not_null_dim_items_item_id.9c886c9cd1
[0m20:08:14.638079 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:08:14.638079 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m20:08:14.638079 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m20:08:14.693641 [debug] [MainThread]: Connection 'model.epicaldemo.dim_stores' was properly closed.
[0m20:08:14.693641 [debug] [MainThread]: Connection 'test.epicaldemo.not_null_dim_items_item_id.9c886c9cd1' was properly closed.
[0m20:08:14.694633 [debug] [MainThread]: Connection 'test.epicaldemo.unique_dim_items_item_id.d6b0c82950' was properly closed.
[0m20:08:14.694633 [debug] [MainThread]: Connection 'model.epicaldemo.fact_sales_transactions' was properly closed.
[0m20:08:14.697625 [debug] [MainThread]: Command end result
[0m20:08:14.782663 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m20:08:14.782663 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m20:08:14.798286 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m20:08:15.115514 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m20:08:15.115514 [info ] [MainThread]: Building catalog
[0m20:08:15.135802 [debug] [ThreadPool]: Acquiring new snowflake connection 'EPICALDEMO.information_schema'
[0m20:08:15.140354 [debug] [ThreadPool]: Using snowflake connection "EPICALDEMO.information_schema"
[0m20:08:15.140354 [debug] [ThreadPool]: On EPICALDEMO.information_schema: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "EPICALDEMO.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from EPICALDEMO.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_customers' and upper("table_name") = upper('dim_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__transactions' and upper("table_name") = upper('stg_d365_fo__transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'store' and upper("table_name") = upper('store')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_dates' and upper("table_name") = upper('dim_dates')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__items' and upper("table_name") = upper('stg_d365_fo__items')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'manager' and upper("table_name") = upper('manager')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_salesforce__customers' and upper("table_name") = upper('stg_salesforce__customers')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_stores' and upper("table_name") = upper('dim_stores')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'category' and upper("table_name") = upper('category')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stores_snapshot' and upper("table_name") = upper('stores_snapshot')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'fact_sales_transactions' and upper("table_name") = upper('fact_sales_transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__managers' and upper("table_name") = upper('stg_d365_fo__managers')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__dates' and upper("table_name") = upper('stg_d365_fo__dates')

                )
             or 
                (
                    
    "table_schema" ilike 'inriver' and upper("table_schema") = upper('inriver')

                    and 
    "table_name" ilike 'item_attributes' and upper("table_name") = upper('item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__categories' and upper("table_name") = upper('stg_d365_fo__categories')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_items' and upper("table_name") = upper('dim_items')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'item' and upper("table_name") = upper('item')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__stores' and upper("table_name") = upper('stg_d365_fo__stores')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'date' and upper("table_name") = upper('date')

                )
             or 
                (
                    
    "table_schema" ilike 'salesforce' and upper("table_schema") = upper('salesforce')

                    and 
    "table_name" ilike 'customer' and upper("table_name") = upper('customer')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_inriver__item_attributes' and upper("table_name") = upper('stg_inriver__item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'transactions' and upper("table_name") = upper('transactions')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from EPICALDEMO.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_customers' and upper("table_name") = upper('dim_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__transactions' and upper("table_name") = upper('stg_d365_fo__transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'store' and upper("table_name") = upper('store')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_dates' and upper("table_name") = upper('dim_dates')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__items' and upper("table_name") = upper('stg_d365_fo__items')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'manager' and upper("table_name") = upper('manager')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_salesforce__customers' and upper("table_name") = upper('stg_salesforce__customers')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_stores' and upper("table_name") = upper('dim_stores')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'category' and upper("table_name") = upper('category')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stores_snapshot' and upper("table_name") = upper('stores_snapshot')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'fact_sales_transactions' and upper("table_name") = upper('fact_sales_transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__managers' and upper("table_name") = upper('stg_d365_fo__managers')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__dates' and upper("table_name") = upper('stg_d365_fo__dates')

                )
             or 
                (
                    
    "table_schema" ilike 'inriver' and upper("table_schema") = upper('inriver')

                    and 
    "table_name" ilike 'item_attributes' and upper("table_name") = upper('item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__categories' and upper("table_name") = upper('stg_d365_fo__categories')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_items' and upper("table_name") = upper('dim_items')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'item' and upper("table_name") = upper('item')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__stores' and upper("table_name") = upper('stg_d365_fo__stores')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'date' and upper("table_name") = upper('date')

                )
             or 
                (
                    
    "table_schema" ilike 'salesforce' and upper("table_schema") = upper('salesforce')

                    and 
    "table_name" ilike 'customer' and upper("table_name") = upper('customer')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_inriver__item_attributes' and upper("table_name") = upper('stg_inriver__item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'transactions' and upper("table_name") = upper('transactions')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m20:08:15.154422 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:08:24.184268 [debug] [ThreadPool]: SQL status: SUCCESS 162 in 9.030 seconds
[0m20:08:24.313079 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\catalog.json
[0m20:08:24.344762 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m20:08:24.344762 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m20:08:24.344762 [info ] [MainThread]: Catalog written to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\catalog.json
[0m20:08:24.344762 [debug] [MainThread]: Command `dbt docs generate` succeeded at 20:08:24.344762 after 15.89 seconds
[0m20:08:24.344762 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m20:08:24.344762 [debug] [MainThread]: Connection 'EPICALDEMO.information_schema' was left open.
[0m20:08:24.344762 [debug] [MainThread]: On EPICALDEMO.information_schema: Close
[0m20:08:24.405415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299B7BC44D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299B7BC6890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000299B6805450>]}
[0m20:08:24.405415 [debug] [MainThread]: Flushing usage events
[0m20:08:24.845844 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:08:30.189999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C70F7AC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C70F79110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C70F787D0>]}


============================== 20:08:30.192997 | cd5adef1-947a-48f4-b215-a97a00f86b99 ==============================
[0m20:08:30.192997 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:08:30.193997 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs serve', 'send_anonymous_usage_stats': 'True'}
[0m20:08:30.590537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd5adef1-947a-48f4-b215-a97a00f86b99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C70F91450>]}
[0m20:08:30.641288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd5adef1-947a-48f4-b215-a97a00f86b99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C7232D590>]}
[0m20:10:44.878714 [error] [MainThread]: Encountered an error:

[0m20:10:44.895243 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socketserver.py", line 238, in serve_forever
    self._handle_request_noblock()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socketserver.py", line 317, in _handle_request_noblock
    self.process_request(request, client_address)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socketserver.py", line 348, in process_request
    self.finish_request(request, client_address)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socketserver.py", line 361, in finish_request
    self.RequestHandlerClass(request, client_address, self)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\http\server.py", line 671, in __init__
    super().__init__(*args, **kwargs)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socketserver.py", line 755, in __init__
    self.handle()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\http\server.py", line 436, in handle
    self.handle_one_request()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\http\server.py", line 404, in handle_one_request
    self.raw_requestline = self.rfile.readline(65537)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socket.py", line 706, in readinto
    return self._sock.recv_into(b)
           ^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m20:10:44.895243 [debug] [MainThread]: Command `dbt docs serve` failed at 20:10:44.895243 after 134.77 seconds
[0m20:10:44.903984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C70FBD150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C70DA2E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C70F6B590>]}
[0m20:10:44.904993 [debug] [MainThread]: Flushing usage events
[0m20:10:45.353954 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:10:53.346073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B30E78090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B30E79E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B30E78750>]}


============================== 20:10:53.349588 | 5ca29c80-afba-4591-ba87-c7acf7a0ac81 ==============================
[0m20:10:53.349588 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:10:53.349588 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:10:53.746087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ca29c80-afba-4591-ba87-c7acf7a0ac81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B320E0110>]}
[0m20:10:53.797474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ca29c80-afba-4591-ba87-c7acf7a0ac81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B31FFDCD0>]}
[0m20:17:02.785595 [error] [MainThread]: Encountered an error:

[0m20:17:02.789604 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m20:17:02.793134 [debug] [MainThread]: Command `dbt docs serve` failed at 20:17:02.793134 after 369.53 seconds
[0m20:17:02.794142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B30E6BF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B30E6B510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B30E71950>]}
[0m20:17:02.794142 [debug] [MainThread]: Flushing usage events
[0m20:17:03.254523 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:24:46.840962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001578966F250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015784B8F550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001578966FED0>]}


============================== 20:24:46.852289 | 070f9de8-2d0a-4f45-96e1-34a5e8c14a60 ==============================
[0m20:24:46.852289 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:24:46.853287 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'c:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'profiles_dir': 'c:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:24:46.971207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '070f9de8-2d0a-4f45-96e1-34a5e8c14a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157896B9110>]}
[0m20:24:47.059382 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m20:24:47.061903 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m20:24:47.063905 [debug] [MainThread]: Command `cli deps` succeeded at 20:24:47.063905 after 0.29 seconds
[0m20:24:47.063905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015783875050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015783874B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015783874D50>]}
[0m20:24:47.064909 [debug] [MainThread]: Flushing usage events
[0m20:24:47.529486 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:26:49.400362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015DD1C70390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015DD1C72C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015DD1C71D90>]}


============================== 20:26:49.400362 | 8f1bda37-b8d4-4bd2-a30b-7fcf9be8c137 ==============================
[0m20:26:49.400362 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:26:49.400362 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m20:26:49.500474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f1bda37-b8d4-4bd2-a30b-7fcf9be8c137', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015DD1C92350>]}
[0m20:26:49.583110 [debug] [MainThread]: Command `dbt clean` succeeded at 20:26:49.582777 after 0.24 seconds
[0m20:26:49.583110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015DD1CDFCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015DCC082210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015DCC103090>]}
[0m20:26:49.583110 [debug] [MainThread]: Flushing usage events
[0m20:26:50.050678 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:29:10.990161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002987C57C2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002987C57DF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002987C57C8D0>]}


============================== 20:29:11.001885 | 5cd1e987-2036-42fa-bd99-e91ed1dcda2a ==============================
[0m20:29:11.001885 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:29:11.001885 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:29:11.409754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5cd1e987-2036-42fa-bd99-e91ed1dcda2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002987C573C50>]}
[0m20:29:11.450046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5cd1e987-2036-42fa-bd99-e91ed1dcda2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002987AD4FA50>]}
[0m20:29:11.455087 [info ] [MainThread]: Registered adapter: snowflake=1.9.4
[0m20:29:11.799790 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:29:12.005537 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:29:12.005537 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:29:12.010076 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.epicaldemo.intermediate
[0m20:29:12.057711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5cd1e987-2036-42fa-bd99-e91ed1dcda2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002987D9B3510>]}
[0m20:29:12.099768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5cd1e987-2036-42fa-bd99-e91ed1dcda2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002987DEFFF10>]}
[0m20:29:12.100957 [info ] [MainThread]: Found 13 models, 2 data tests, 1 snapshot, 8 sources, 1 exposure, 476 macros
[0m20:29:12.100957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5cd1e987-2036-42fa-bd99-e91ed1dcda2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002987DEEAA90>]}
[0m20:29:12.103955 [info ] [MainThread]: 
[0m20:29:12.103955 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:29:12.104955 [info ] [MainThread]: 
[0m20:29:12.105955 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:29:12.110986 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EPICALDEMO_broman_analytics'
[0m20:29:14.216054 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m20:29:14.216054 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session set quoted_identifiers_ignore_case = false;
[0m20:29:14.220061 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:29:14.789970 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.571 seconds
[0m20:29:14.793495 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m20:29:14.793495 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
show objects in EPICALDEMO.broman_analytics
    limit 10000
    
;
[0m20:29:14.889975 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.101 seconds
[0m20:29:14.889975 [debug] [ThreadPool]: Using snowflake connection "list_EPICALDEMO_broman_analytics"
[0m20:29:14.899766 [debug] [ThreadPool]: On list_EPICALDEMO_broman_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "list_EPICALDEMO_broman_analytics"} */
alter session unset quoted_identifiers_ignore_case;
[0m20:29:14.957912 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.058 seconds
[0m20:29:14.961458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5cd1e987-2036-42fa-bd99-e91ed1dcda2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002987DA76550>]}
[0m20:29:14.965632 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_d365_fo__categories
[0m20:29:14.965632 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_d365_fo__dates
[0m20:29:14.969638 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_d365_fo__items
[0m20:29:14.969638 [debug] [Thread-4 (]: Began running node model.epicaldemo.stg_d365_fo__managers
[0m20:29:14.969638 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__categories'
[0m20:29:14.969638 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__dates'
[0m20:29:14.969638 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__items'
[0m20:29:14.969638 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.epicaldemo.stg_d365_fo__managers'
[0m20:29:14.969638 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_d365_fo__categories
[0m20:29:14.969638 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_d365_fo__dates
[0m20:29:14.969638 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_d365_fo__items
[0m20:29:14.969638 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.stg_d365_fo__managers
[0m20:29:14.981283 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__categories"
[0m20:29:14.981283 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__dates"
[0m20:29:14.981283 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__items"
[0m20:29:14.989802 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__managers"
[0m20:29:14.989802 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_d365_fo__items
[0m20:29:14.989802 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_d365_fo__items
[0m20:29:14.989802 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_d365_fo__dates
[0m20:29:14.989802 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_d365_fo__categories
[0m20:29:14.989802 [debug] [Thread-4 (]: Began executing node model.epicaldemo.stg_d365_fo__managers
[0m20:29:14.989802 [debug] [Thread-3 (]: Began running node model.epicaldemo.stg_inriver__item_attributes
[0m20:29:14.997043 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_d365_fo__dates
[0m20:29:14.997043 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_d365_fo__categories
[0m20:29:14.997043 [debug] [Thread-4 (]: Finished running node model.epicaldemo.stg_d365_fo__managers
[0m20:29:14.997043 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__items, now model.epicaldemo.stg_inriver__item_attributes)
[0m20:29:15.000050 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_netsuite__transactions
[0m20:29:15.000050 [debug] [Thread-1 (]: Began running node model.epicaldemo.stg_salesforce__customers
[0m20:29:15.000050 [debug] [Thread-4 (]: Began running node snapshot.epicaldemo.stores_snapshot
[0m20:29:15.000050 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.stg_inriver__item_attributes
[0m20:29:15.000050 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__dates, now model.epicaldemo.stg_netsuite__transactions)
[0m20:29:15.000050 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__categories, now model.epicaldemo.stg_salesforce__customers)
[0m20:29:15.000050 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__managers, now snapshot.epicaldemo.stores_snapshot)
[0m20:29:15.000050 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.stg_inriver__item_attributes"
[0m20:29:15.000050 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_netsuite__transactions
[0m20:29:15.000050 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.stg_salesforce__customers
[0m20:29:15.000050 [debug] [Thread-4 (]: Began compiling node snapshot.epicaldemo.stores_snapshot
[0m20:29:15.009794 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_netsuite__transactions"
[0m20:29:15.012827 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.stg_salesforce__customers"
[0m20:29:15.012827 [debug] [Thread-3 (]: Began executing node model.epicaldemo.stg_inriver__item_attributes
[0m20:29:15.012827 [debug] [Thread-4 (]: Began executing node snapshot.epicaldemo.stores_snapshot
[0m20:29:15.012827 [debug] [Thread-3 (]: Finished running node model.epicaldemo.stg_inriver__item_attributes
[0m20:29:15.012827 [debug] [Thread-4 (]: Finished running node snapshot.epicaldemo.stores_snapshot
[0m20:29:15.012827 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_netsuite__transactions
[0m20:29:15.019836 [debug] [Thread-3 (]: Began running node model.epicaldemo.dim_dates
[0m20:29:15.019836 [debug] [Thread-1 (]: Began executing node model.epicaldemo.stg_salesforce__customers
[0m20:29:15.019836 [debug] [Thread-4 (]: Began running node model.epicaldemo.dim_items
[0m20:29:15.019836 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_netsuite__transactions
[0m20:29:15.019836 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_inriver__item_attributes, now model.epicaldemo.dim_dates)
[0m20:29:15.019836 [debug] [Thread-1 (]: Finished running node model.epicaldemo.stg_salesforce__customers
[0m20:29:15.019836 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly snapshot.epicaldemo.stores_snapshot, now model.epicaldemo.dim_items)
[0m20:29:15.019836 [debug] [Thread-2 (]: Began running node model.epicaldemo.stg_d365_fo__stores
[0m20:29:15.019836 [debug] [Thread-3 (]: Began compiling node model.epicaldemo.dim_dates
[0m20:29:15.019836 [debug] [Thread-1 (]: Began running node model.epicaldemo.dim_customers
[0m20:29:15.019836 [debug] [Thread-4 (]: Began compiling node model.epicaldemo.dim_items
[0m20:29:15.019836 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_netsuite__transactions, now model.epicaldemo.stg_d365_fo__stores)
[0m20:29:15.028472 [debug] [Thread-3 (]: Writing injected SQL for node "model.epicaldemo.dim_dates"
[0m20:29:15.029978 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_salesforce__customers, now model.epicaldemo.dim_customers)
[0m20:29:15.029978 [debug] [Thread-4 (]: Writing injected SQL for node "model.epicaldemo.dim_items"
[0m20:29:15.029978 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.stg_d365_fo__stores
[0m20:29:15.029978 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.dim_customers
[0m20:29:15.029978 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.stg_d365_fo__stores"
[0m20:29:15.039992 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.dim_customers"
[0m20:29:15.039992 [debug] [Thread-3 (]: Began executing node model.epicaldemo.dim_dates
[0m20:29:15.039992 [debug] [Thread-4 (]: Began executing node model.epicaldemo.dim_items
[0m20:29:15.039992 [debug] [Thread-3 (]: Finished running node model.epicaldemo.dim_dates
[0m20:29:15.039992 [debug] [Thread-2 (]: Began executing node model.epicaldemo.stg_d365_fo__stores
[0m20:29:15.039992 [debug] [Thread-4 (]: Finished running node model.epicaldemo.dim_items
[0m20:29:15.039992 [debug] [Thread-1 (]: Began executing node model.epicaldemo.dim_customers
[0m20:29:15.044515 [debug] [Thread-2 (]: Finished running node model.epicaldemo.stg_d365_fo__stores
[0m20:29:15.044515 [debug] [Thread-3 (]: Began running node test.epicaldemo.not_null_dim_items_item_id.9c886c9cd1
[0m20:29:15.044515 [debug] [Thread-4 (]: Began running node test.epicaldemo.unique_dim_items_item_id.d6b0c82950
[0m20:29:15.044515 [debug] [Thread-1 (]: Finished running node model.epicaldemo.dim_customers
[0m20:29:15.044515 [debug] [Thread-2 (]: Began running node model.epicaldemo.dim_stores
[0m20:29:15.044515 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.epicaldemo.dim_dates, now test.epicaldemo.not_null_dim_items_item_id.9c886c9cd1)
[0m20:29:15.050026 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.epicaldemo.dim_items, now test.epicaldemo.unique_dim_items_item_id.d6b0c82950)
[0m20:29:15.050026 [debug] [Thread-1 (]: Began running node model.epicaldemo.fact_sales_transactions
[0m20:29:15.050026 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.epicaldemo.stg_d365_fo__stores, now model.epicaldemo.dim_stores)
[0m20:29:15.050026 [debug] [Thread-3 (]: Began compiling node test.epicaldemo.not_null_dim_items_item_id.9c886c9cd1
[0m20:29:15.050026 [debug] [Thread-4 (]: Began compiling node test.epicaldemo.unique_dim_items_item_id.d6b0c82950
[0m20:29:15.050026 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.epicaldemo.dim_customers, now model.epicaldemo.fact_sales_transactions)
[0m20:29:15.050026 [debug] [Thread-2 (]: Began compiling node model.epicaldemo.dim_stores
[0m20:29:15.064688 [debug] [Thread-3 (]: Writing injected SQL for node "test.epicaldemo.not_null_dim_items_item_id.9c886c9cd1"
[0m20:29:15.069761 [debug] [Thread-4 (]: Writing injected SQL for node "test.epicaldemo.unique_dim_items_item_id.d6b0c82950"
[0m20:29:15.069761 [debug] [Thread-1 (]: Began compiling node model.epicaldemo.fact_sales_transactions
[0m20:29:15.076203 [debug] [Thread-2 (]: Writing injected SQL for node "model.epicaldemo.dim_stores"
[0m20:29:15.079711 [debug] [Thread-1 (]: Writing injected SQL for node "model.epicaldemo.fact_sales_transactions"
[0m20:29:15.079711 [debug] [Thread-4 (]: Began executing node test.epicaldemo.unique_dim_items_item_id.d6b0c82950
[0m20:29:15.079711 [debug] [Thread-3 (]: Began executing node test.epicaldemo.not_null_dim_items_item_id.9c886c9cd1
[0m20:29:15.079711 [debug] [Thread-2 (]: Began executing node model.epicaldemo.dim_stores
[0m20:29:15.079711 [debug] [Thread-4 (]: Finished running node test.epicaldemo.unique_dim_items_item_id.d6b0c82950
[0m20:29:15.089681 [debug] [Thread-3 (]: Finished running node test.epicaldemo.not_null_dim_items_item_id.9c886c9cd1
[0m20:29:15.089681 [debug] [Thread-1 (]: Began executing node model.epicaldemo.fact_sales_transactions
[0m20:29:15.089681 [debug] [Thread-2 (]: Finished running node model.epicaldemo.dim_stores
[0m20:29:15.093191 [debug] [Thread-1 (]: Finished running node model.epicaldemo.fact_sales_transactions
[0m20:29:15.109792 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:29:15.109792 [debug] [MainThread]: Connection 'list_EPICALDEMO_broman_analytics' was left open.
[0m20:29:15.109792 [debug] [MainThread]: On list_EPICALDEMO_broman_analytics: Close
[0m20:29:15.160122 [debug] [MainThread]: Connection 'model.epicaldemo.fact_sales_transactions' was properly closed.
[0m20:29:15.160122 [debug] [MainThread]: Connection 'model.epicaldemo.dim_stores' was properly closed.
[0m20:29:15.160122 [debug] [MainThread]: Connection 'test.epicaldemo.not_null_dim_items_item_id.9c886c9cd1' was properly closed.
[0m20:29:15.165399 [debug] [MainThread]: Connection 'test.epicaldemo.unique_dim_items_item_id.d6b0c82950' was properly closed.
[0m20:29:15.167411 [debug] [MainThread]: Command end result
[0m20:29:15.254925 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m20:29:15.274719 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m20:29:15.279786 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\run_results.json
[0m20:29:15.672042 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m20:29:15.673042 [info ] [MainThread]: Building catalog
[0m20:29:15.684379 [debug] [ThreadPool]: Acquiring new snowflake connection 'EPICALDEMO.information_schema'
[0m20:29:15.701401 [debug] [ThreadPool]: Using snowflake connection "EPICALDEMO.information_schema"
[0m20:29:15.702401 [debug] [ThreadPool]: On EPICALDEMO.information_schema: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "epicaldemo", "target_name": "dev", "connection_name": "EPICALDEMO.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from EPICALDEMO.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'category' and upper("table_name") = upper('category')

                )
             or 
                (
                    
    "table_schema" ilike 'netsuite' and upper("table_schema") = upper('netsuite')

                    and 
    "table_name" ilike 'transactions' and upper("table_name") = upper('transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_netsuite__transactions' and upper("table_name") = upper('stg_netsuite__transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'item' and upper("table_name") = upper('item')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_salesforce__customers' and upper("table_name") = upper('stg_salesforce__customers')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__dates' and upper("table_name") = upper('stg_d365_fo__dates')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'manager' and upper("table_name") = upper('manager')

                )
             or 
                (
                    
    "table_schema" ilike 'salesforce' and upper("table_schema") = upper('salesforce')

                    and 
    "table_name" ilike 'customer' and upper("table_name") = upper('customer')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_items' and upper("table_name") = upper('dim_items')

                )
             or 
                (
                    
    "table_schema" ilike 'inriver' and upper("table_schema") = upper('inriver')

                    and 
    "table_name" ilike 'item_attributes' and upper("table_name") = upper('item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__categories' and upper("table_name") = upper('stg_d365_fo__categories')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_inriver__item_attributes' and upper("table_name") = upper('stg_inriver__item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stores_snapshot' and upper("table_name") = upper('stores_snapshot')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__managers' and upper("table_name") = upper('stg_d365_fo__managers')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'fact_sales_transactions' and upper("table_name") = upper('fact_sales_transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_dates' and upper("table_name") = upper('dim_dates')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__items' and upper("table_name") = upper('stg_d365_fo__items')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__stores' and upper("table_name") = upper('stg_d365_fo__stores')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_stores' and upper("table_name") = upper('dim_stores')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'store' and upper("table_name") = upper('store')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'date' and upper("table_name") = upper('date')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_customers' and upper("table_name") = upper('dim_customers')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from EPICALDEMO.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'category' and upper("table_name") = upper('category')

                )
             or 
                (
                    
    "table_schema" ilike 'netsuite' and upper("table_schema") = upper('netsuite')

                    and 
    "table_name" ilike 'transactions' and upper("table_name") = upper('transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_netsuite__transactions' and upper("table_name") = upper('stg_netsuite__transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'item' and upper("table_name") = upper('item')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_salesforce__customers' and upper("table_name") = upper('stg_salesforce__customers')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__dates' and upper("table_name") = upper('stg_d365_fo__dates')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'manager' and upper("table_name") = upper('manager')

                )
             or 
                (
                    
    "table_schema" ilike 'salesforce' and upper("table_schema") = upper('salesforce')

                    and 
    "table_name" ilike 'customer' and upper("table_name") = upper('customer')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_items' and upper("table_name") = upper('dim_items')

                )
             or 
                (
                    
    "table_schema" ilike 'inriver' and upper("table_schema") = upper('inriver')

                    and 
    "table_name" ilike 'item_attributes' and upper("table_name") = upper('item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__categories' and upper("table_name") = upper('stg_d365_fo__categories')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_inriver__item_attributes' and upper("table_name") = upper('stg_inriver__item_attributes')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stores_snapshot' and upper("table_name") = upper('stores_snapshot')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__managers' and upper("table_name") = upper('stg_d365_fo__managers')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'fact_sales_transactions' and upper("table_name") = upper('fact_sales_transactions')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_dates' and upper("table_name") = upper('dim_dates')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__items' and upper("table_name") = upper('stg_d365_fo__items')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'stg_d365_fo__stores' and upper("table_name") = upper('stg_d365_fo__stores')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_stores' and upper("table_name") = upper('dim_stores')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'store' and upper("table_name") = upper('store')

                )
             or 
                (
                    
    "table_schema" ilike 'd365_fo' and upper("table_schema") = upper('d365_fo')

                    and 
    "table_name" ilike 'date' and upper("table_name") = upper('date')

                )
             or 
                (
                    
    "table_schema" ilike 'broman_analytics' and upper("table_schema") = upper('broman_analytics')

                    and 
    "table_name" ilike 'dim_customers' and upper("table_name") = upper('dim_customers')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m20:29:15.703555 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:29:24.246998 [debug] [ThreadPool]: SQL status: SUCCESS 150 in 8.544 seconds
[0m20:29:24.300115 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\catalog.json
[0m20:29:24.320040 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\manifest.json
[0m20:29:24.329780 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\semantic_manifest.json
[0m20:29:24.329780 [info ] [MainThread]: Catalog written to C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\epicaldemo\target\catalog.json
[0m20:29:24.329780 [debug] [MainThread]: Command `dbt docs generate` succeeded at 20:29:24.329780 after 13.40 seconds
[0m20:29:24.332814 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m20:29:24.332814 [debug] [MainThread]: Connection 'EPICALDEMO.information_schema' was left open.
[0m20:29:24.332814 [debug] [MainThread]: On EPICALDEMO.information_schema: Close
[0m20:29:24.383228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002987AD6C210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029878834BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002987E34BDD0>]}
[0m20:29:24.383228 [debug] [MainThread]: Flushing usage events
[0m20:29:24.779924 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:29:31.501903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EFD678550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EFD66BC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EFD679490>]}


============================== 20:29:31.504916 | 66bf3d36-0a36-4c96-adf3-2fb52a0ee2e1 ==============================
[0m20:29:31.504916 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:29:31.505915 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\JohanBroman\\OneDrive - Epical Consulting\\Internal\\Demo_Snowflake_dbt_PBI\\epicaldemo\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:29:31.950085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66bf3d36-0a36-4c96-adf3-2fb52a0ee2e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EFE83EB10>]}
[0m20:29:31.994527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66bf3d36-0a36-4c96-adf3-2fb52a0ee2e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EFE9B2A10>]}
[0m20:31:25.122724 [error] [MainThread]: Encountered an error:

[0m20:31:25.129229 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\cli\main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\JohanBroman\OneDrive - Epical Consulting\Internal\Demo_Snowflake_dbt_PBI\.venv\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m20:31:25.141801 [debug] [MainThread]: Command `dbt docs serve` failed at 20:31:25.140768 after 113.71 seconds
[0m20:31:25.141801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EFD66B450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EFD671950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EFD6724D0>]}
[0m20:31:25.143801 [debug] [MainThread]: Flushing usage events
[0m20:31:25.625310 [debug] [MainThread]: An error was encountered while trying to flush usage events
